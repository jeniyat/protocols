{"uri":"gradient-of-a-spatial-point-process-along-a-linear-ubhesj6","version_id":"0","protocol_name":"Gradient of a spatial point process along a linear feature","protocol_name_html":"Gradient of a spatial point process along a linear feature","is_retracted":"0","is_prepublished":"0","can_edit":"0","parent_id":null,"api_version":"1","is_new_mode":"0","last_modified":"1538645425","type_id":"1","link":null,"fork_id":"","public_fork_note":null,"number_of_steps":"5","has_versions":"0","first_published_date":null,"publish_date":"2018-10-04 09:30:25","documents":null,"have_protocol_in_step":"0","is_protocol_in_step":"0","vendor_name":"Contributed by users","vendor_link":"https:\/\/www.protocols.io","vendor_logo":"\/img\/vendors\/1.png","mod_mins":"-16","mod_secs":"7","description":"{\"blocks\":[{\"key\":\"u7hd\",\"text\":\"How we measure the gradient of he density of 19th century post offices along North American rivers in our paper Armenter, Roc, Mikl\u00f3s Koren and D\u00e1vid K Nagy. \u201cBridges\u201d \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"4jb44\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}},{\"key\":\"4b7v0\",\"text\":\"Method relies on maximum likelihood formula in Zhao, M., and M. Xie. 1996. \u201cOn Maximum Likelihood Estimation for a General Non-Homogeneous Poisson Process.\u201d Scandinavian Journal of Statistics, Theory and Applications 23 (4): 597\u2013607.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":{}}],\"entityMap\":{}}","is_bookmarked":"0","can_reassign":"1","before_start":null,"has_guidelines":"0","materials":[],"materials_text":null,"warning":null,"version_class":"16457","public":"1","is_owner":"1","is_original_owner":"1","created_on":"1538641122","protocol_affiliation":"Central European University","affiliation":"Central European University","doi":"dx.doi.org\/10.17504\/protocols.io.ubhesj6","doi_status":"2","changed_fork_steps":null,"profile_url":"MiklsKoren-w2t26443u2v2","protocol_img":"https:\/\/www.protocols.io\/img\/default_protocol.png","profile_image":"\/img\/avatars\/016.png","full_name":"Mikl\u00f3s Koren","created_by":"Mikl\u00f3s Koren","private_link":"ABD7661A9147AA44CD331528635A5770","original_img":"1","username":"mikls-koren","retraction_reason":null,"plos_id":null,"manuscript_citation":"<p>Armenter, Roc, Mikl\u00f3s Koren and D\u00e1vid K Nagy. 2018. \u201cBridges.\u201d Working paper.<\/p>","journal_name":null,"journal_link":null,"is_donations_disabled":"0","is_donations_disabled_by_user":"9","item_record_id":360681,"fork_info":[],"compare_forks":[],"protocols":[],"groups":[],"number_of_shared_runs":[],"ownership_history":[],"keywords":"","transfer_to_user":[],"sub_transfer":false,"is_transfer_pending":false,"number_of_bookmarks":"0","collections":[],"tags":[],"archived":0,"sub_authors":[],"sub_protocols_number":0,"can_edit_shared":0,"shared_access":null,"shared_runs":[],"is_shared_run":0,"is_shared":1,"banner":null,"contact_badges":[{"badge_id":"2","badge_image":"\/img\/badges\/bronze.svg","badge_description":"Author"}],"number_of_comments":0,"is_locked":0,"is_locked_by":false,"authors":"Mikl\u00f3s Koren","authors_list":[{"name":"Mikl\u00f3s Koren","affiliation":"Central European University","username":"mikls-koren","profile_image":"\/img\/avatars\/016.png"}],"user":{"profile_image":"\/img\/avatars\/016.png","username":"mikls-koren","full_name":"Mikl\u00f3s Koren","created_by":"Mikl\u00f3s Koren"},"access":{"can_view":"1","can_remove":"0","can_add":"0","can_edit":0,"can_publish":0,"can_get_doi":0,"can_share":"0","can_move":"1","can_transfer":"1","can_download":"1","is_locked":"0"},"is_contact_suspended":0,"guidelines":null,"status_id":"2","is_research":"1","status_info":"We are still developing and optimizing this protocol","steps":[{"id":"671104","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"26451A60C7AE11E8B9063D62B81B893F","previous_guid":"54495460C7B511E8A8F5A79A0052C36D","data":"{\"blocks\":[{\"key\":\"cbfp5\",\"text\":\"Create a polygon around your linear feature by extending it a D distance either circularly or by parallel shift\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"1mef8\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"offset\":0,\"length\":1,\"key\":0}],\"data\":[]},{\"key\":\"etmk\",\"text\":\"Select the intersection of this polygon with the points of interest. \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]}],\"entityMap\":[{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"key\":\"b4dba\",\"text\":\"from project_geojson import ProjectedFeature\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"1k58e\",\"text\":\"import json\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"8i57g\",\"text\":\"from shapely.geometry.geo import mapping\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"85hus\",\"text\":\"from shapely.geometry import LineString, Point, Polygon, asShape\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"1fmf1\",\"text\":\"import sys\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"baknp\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"af9po\",\"text\":\"def bank(river, side, width_km=10):\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"d2md1\",\"text\":\"\\tbank = river.parallel_offset(width_km*1000.0, side)\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"9s1dk\",\"text\":\"\\triver_coords = list(river.coords)\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"a3k54\",\"text\":\"\\tbank_coords = list(bank.coords)\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"4g1e1\",\"text\":\"\\tif side=='left':\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"evril\",\"text\":\"\\t\\tbank_coords = bank_coords[::-1]\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"6vngu\",\"text\":\"\\tlinestring = river_coords+bank_coords\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"b551v\",\"text\":\"\\treturn Polygon(linestring)\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"4v9hf\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"5aul9\",\"text\":\"if __name__ == '__main__':\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"4sjs4\",\"text\":\"\\twhich_bank = sys.argv[1]\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"b6q4v\",\"text\":\"\\twidth_km = 10\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"fl0fv\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"4knia\",\"text\":\"\\triver_json = json.load(sys.stdin)\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"6mvlg\",\"text\":\"\\triver = ProjectedFeature(river_json['features'][0]['geometry'], 'wgs84').lcc\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"bq3vo\",\"text\":\"\\tbank = ProjectedFeature(bank(river, which_bank, width_km), 'lcc').wgs84.buffer(0)\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"4jf5u\",\"text\":\"\\tmeta = river_json['features'][0]['properties']\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"87b9q\",\"text\":\"\\tmeta['bank'] = which_bank\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"cj20j\",\"text\":\"\\tmeta['width_km'] = 10.0\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"82kj0\",\"text\":\"\\tprint json.dumps(dict(type=\\\"Feature\\\", geometry=mapping(bank), properties=meta))\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]}],\"entityMap\":[]}}],\"guid\":\"26451A60C7AE11E8B9063D62B81B893F\",\"id\":671104,\"previous_id\":null,\"previous_guid\":\"54495460C7B511E8A8F5A79A0052C36D\",\"section\":\"Convert a\"}","section":"Select relevant sample of points close to linear feature","case_id":null,"section_color":"#A492FF","protocol_id":"16457","previous_id":"671109","last_modified":null},{"id":"671105","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"D970B7C0C7AE11E8B9063D62B81B893F","previous_guid":"26451A60C7AE11E8B9063D62B81B893F","data":"{\"blocks\":[{\"key\":\"diah4\",\"text\":\"Make sure you know where the start and end of your linear feature is. Measure coordinates as distance along the feature to the start.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"lis1\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"offset\":0,\"length\":1,\"key\":0}],\"data\":[]},{\"key\":\"1rf38\",\"text\":\" \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]}],\"entityMap\":[{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"key\":\"e1pp9\",\"text\":\"bridge_rivermile = river.project(bridge)\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"3ncbg\",\"text\":\"postoffice_rivermile = river.project(postoffice)\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]}],\"entityMap\":[]}}],\"guid\":\"D970B7C0C7AE11E8B9063D62B81B893F\",\"id\":671105,\"previous_id\":671104,\"previous_guid\":\"26451A60C7AE11E8B9063D62B81B893F\",\"section\":\"Project points on linear feature and convert to linear coordinates\"}","section":"Project points on linear feature and convert to linear coordinates","case_id":null,"section_color":"#94EBFF","protocol_id":"16457","previous_id":"671104","last_modified":null},{"id":"671107","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"2CD462F0C7B311E8A8F5A79A0052C36D","previous_guid":"D970B7C0C7AE11E8B9063D62B81B893F","data":"{\"blocks\":[{\"key\":\"3b1c5\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"blh5k\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"offset\":0,\"length\":1,\"key\":0}],\"data\":[]},{\"key\":\"929mh\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]}],\"entityMap\":[{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"key\":\"9om95\",\"text\":\"def distance_to_nearest_bridge(river_mile, bridges):\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"ee9bq\",\"text\":\"    return min([abs(bridge['river_mile']-river_mile) for bridge in bridges])\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"1kf7j\",\"text\":\"for postoffice in postoffices:\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"1rsc9\",\"text\":\"    postoffice['distance_to_bridge'] = distance_to_nearest_bridge(postoffice['river_mile'], bridges)\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]}],\"entityMap\":[]}}],\"guid\":\"2CD462F0C7B311E8A8F5A79A0052C36D\",\"id\":671107,\"previous_guid\":\"D970B7C0C7AE11E8B9063D62B81B893F\",\"section\":\"For each point, measure distance to nearest crossing point\"}","section":"For each point, measure distance to nearest crossing point","case_id":null,"section_color":"#A492FF","protocol_id":"16457","previous_id":"671105","last_modified":null},{"id":"671108","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"541780E0C7B311E8A8F5A79A0052C36D","previous_guid":"2CD462F0C7B311E8A8F5A79A0052C36D","data":"{\"blocks\":[{\"key\":\"dpfl9\",\"text\":\" \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"offset\":0,\"length\":1,\"key\":0}],\"data\":[]},{\"key\":\"ba5l8\",\"text\":\" \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"offset\":0,\"length\":1,\"key\":1}],\"data\":[]},{\"key\":\"24pcf\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]}],\"entityMap\":[{\"type\":\"image\",\"mutability\":\"MUTABLE\",\"data\":{\"id\":\"30787\",\"guid\":\"A2F1AC50C7B711E8A8F5A79A0052C36D\",\"source\":\"https:\\\/\\\/s3.amazonaws.com\\\/pr-journal\\\/8cd3nen.png\",\"placeholder\":\"\",\"original_name\":\"hazard.png\",\"mime\":\"image\\\/png\",\"width\":null,\"height\":null,\"is_video\":false}},{\"type\":\"image\",\"mutability\":\"MUTABLE\",\"data\":{\"id\":\"30789\",\"guid\":\"BD160680C7B711E8A8F5A79A0052C36D\",\"source\":\"https:\\\/\\\/s3.amazonaws.com\\\/pr-journal\\\/8cf3nen.png\",\"placeholder\":\"\",\"original_name\":\"logL.png\",\"mime\":\"image\\\/png\",\"width\":null,\"height\":null,\"is_video\":false}}],\"guid\":\"541780E0C7B311E8A8F5A79A0052C36D\",\"id\":671108,\"previous_guid\":\"2CD462F0C7B311E8A8F5A79A0052C36D\",\"section\":\"Given the distribution of distances, estimate gradient parameters by maximum likelihood\"}","section":"Given the distribution of distances, estimate gradient parameters by maximum likelihood","case_id":null,"section_color":"#94EBFF","protocol_id":"16457","previous_id":"671107","last_modified":null},{"id":"671109","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"54495460C7B511E8A8F5A79A0052C36D","previous_guid":null,"data":"{\"blocks\":[{\"key\":\"6mh65\",\"text\":\"Most geospatial data are in WGS84, which is not distance-invariant. Convert everything (points, lines) to a distance-invariant projection such as Lambert Conformal Conic. Make sure (x,y) coordinates are in meters.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"ft65v\",\"text\":\" \",\"type\":\"atomic\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[{\"offset\":0,\"length\":1,\"key\":0}],\"data\":[]},{\"key\":\"bhpj5\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]}],\"entityMap\":[{\"type\":\"code_insert\",\"mutability\":\"IMMUTABLE\",\"data\":{\"blocks\":[{\"key\":\"59u69\",\"text\":\"import pyproj\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"8a0gg\",\"text\":\"from shapely.ops import transform\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"nvoj\",\"text\":\"from shapely.geometry.base import BaseGeometry\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"f4rgp\",\"text\":\"from shapely.geometry import asShape\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"5o8ul\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"86vhu\",\"text\":\"from shapely.geometry import Point\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"deueu\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"m5i7\",\"text\":\"PROJECTIONS = dict(\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"op17\",\"text\":\"    wgs84 = pyproj.Proj(\\\"+init=EPSG:4326\\\"),\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"cc52i\",\"text\":\"    lcc = pyproj.Proj(proj=\\\"lcc\\\"),\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"9b2ah\",\"text\":\"    nhgis = pyproj.Proj(\\\"+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=37.5 +lon_0=-96 +x_0=0 +y_0=0 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs\\\"),\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"f1rub\",\"text\":\"    epsg3975 = pyproj.Proj(\\\"+proj=cea +lon_0=0 +lat_ts=30 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs\\\"),\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"38o1m\",\"text\":\"    albers = pyproj.Proj(\\\"+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=37.5 +lon_0=-96 +x_0=0 +y_0=0 +datum=NAD83 +units=m +no_defs \\\"),\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"chijd\",\"text\":\"    eov = pyproj.Prof(\\\"+proj=somerc +lat_0=47.14439372222222 +lon_0=19.04857177777778 +k_0=0.99993 +x_0=650000 +y_0=200000 +ellps=GRS67 +towgs84=52.17,-71.82,-14.9,0,0,0,0 +units=m +no_defs \\\")    \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"4huc1\",\"text\":\")\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"7t6as\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"8dqvt\",\"text\":\"def project_geometry(geometry, tfrom, tto):\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"141b5\",\"text\":\"    return transform(lambda x, y: pyproj.transform(PROJECTIONS[tfrom], PROJECTIONS[tto], x, y), geometry)\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"fq7ng\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"cmpqq\",\"text\":\"class ProjectedFeature(object):\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"brj2j\",\"text\":\"    def __init__(self, geometry, projection):\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"46c74\",\"text\":\"        '''\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"2stav\",\"text\":\"        Every incoming geometry (point, linestring, polygon) is stored in wgs84.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"b5i4d\",\"text\":\"        '''\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"4a91r\",\"text\":\"        if not isinstance(geometry, BaseGeometry):\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"4qp49\",\"text\":\"            # if not shapely geometry, treat as geojson dictionary\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"cj31n\",\"text\":\"            geometry = asShape(geometry)\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"mnk\",\"text\":\"        self.geometry = project_geometry(geometry, projection, 'wgs84')\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"fl5ee\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"bbh86\",\"text\":\"    def __getattr__(self, projection):\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"a7llh\",\"text\":\"        '''\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"9crlm\",\"text\":\"        We can refer to projected features as an attribute, e.g.\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"a63je\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"dnd0d\",\"text\":\"            feature.wgs84\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"7tba\",\"text\":\"            feature.lcc\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"1bb6u\",\"text\":\"        '''\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"368hj\",\"text\":\"        if projection in PROJECTIONS:\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"656iq\",\"text\":\"            return project_geometry(self.geometry, 'wgs84', projection)\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"4pcn4\",\"text\":\"        else:\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"u14s\",\"text\":\"            raise AttributeError\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"98ob0\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"2t358\",\"text\":\"if __name__ == '__main__':      \",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"21ekk\",\"text\":\"    union_sq = Point((1827011,574994))\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"b0c9e\",\"text\":\"    union_sq_geojson = {\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"7fnt9\",\"text\":\"        \\\"type\\\": \\\"Point\\\",\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"98a3\",\"text\":\"        \\\"coordinates\\\": [1827011, 574994]\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"8nhpa\",\"text\":\"    }\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"c6mav\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"cfao6\",\"text\":\"    Union_Sq = ProjectedFeature(union_sq, 'nhgis')\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"e6euh\",\"text\":\"    print Union_Sq.wgs84\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"7ts3m\",\"text\":\"    print Union_Sq.lcc\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"2dal0\",\"text\":\"\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"baddq\",\"text\":\"    Union_Sq = ProjectedFeature(union_sq_geojson, 'nhgis')\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]},{\"key\":\"8lklf\",\"text\":\"    print Union_Sq.wgs84\",\"type\":\"unstyled\",\"depth\":0,\"inlineStyleRanges\":[],\"entityRanges\":[],\"data\":[]}],\"entityMap\":[]}}],\"guid\":\"54495460C7B511E8A8F5A79A0052C36D\",\"id\":671109,\"previous_guid\":null,\"section\":\"Convert all features to a distance-invariant projection\"}","section":"Convert all features to a distance-invariant projection","case_id":null,"section_color":"#A492FF","protocol_id":"16457","previous_id":"0","last_modified":null}]}