{"id":19528,"title":"Genotype imputation workflow v3.0","title_html":"Genotype imputation workflow v3.0","image":{"source":"https:\/\/s3.amazonaws.com\/pr-journal\/be99i986.png","placeholder":"https:\/\/s3.amazonaws.com\/pr-journal\/be99i986.png"},"doi":"dx.doi.org\/10.17504\/protocols.io.xbgfijw","doi_status":2,"uri":"genotype-imputation-workflow-v3-0-xbgfijw","type_id":1,"published_on":1554112368,"version_id":1,"created_on":1548073222,"categories":null,"creator":{"name":"Priit Palta","affiliation":"FIMM, University of Helsinki","username":"priit-palta","link":null,"image":{"source":"https:\/\/s3.amazonaws.com\/pr-journal\/tsri986.jpg","placeholder":"https:\/\/s3.amazonaws.com\/pr-journal\/tsri986.jpg"},"badges":[{"id":2,"image":{"source":"\/img\/badges\/bronze.svg","placeholder":"\/img\/badges\/bronze.svg"},"name":"Author"},{"id":6,"image":{"source":"\/img\/badges\/socialbutterfly.svg","placeholder":"\/img\/badges\/socialbutterfly.svg"},"name":"Social butterfly"}],"research_interests":null},"journal":null,"journal_name":null,"journal_link":null,"public":1,"has_versions":1,"link":null,"total_collections":0,"number_of_steps":13,"authors":[{"name":"Kalle P\u00e4rn","affiliation":"FIMM, University of Helsinki","username":"kalle-prn","link":null,"image":{"source":"\/img\/avatars\/014.png","placeholder":"\/img\/avatars\/014.png"},"badges":[],"research_interests":null},{"name":"Marita A. Isokallio","affiliation":"FIMM, University of Helsinki","username":"marita-a-isokallio","link":null,"image":{"source":"https:\/\/s3.amazonaws.com\/pr-journal\/swii3gw.jpg","placeholder":"https:\/\/s3.amazonaws.com\/pr-journal\/swii3gw.jpg"},"badges":[],"research_interests":null},{"name":"Javier Nunez Fontarnau","affiliation":"FIMM, University of Helsinki","username":"javier-nunez-fontarnau","link":null,"image":{"source":"\/img\/avatars\/006.png","placeholder":"\/img\/avatars\/006.png"},"badges":[],"research_interests":null},{"name":"Aarno Palotie","affiliation":"equal contribution; FIMM, University of Helsinki","username":null,"link":null,"image":{"source":null,"placeholder":null},"badges":[],"research_interests":null},{"name":"Samuli Ripatti","affiliation":"equal contribution; FIMM, University of Helsinki","username":null,"link":null,"image":{"source":null,"placeholder":null},"badges":[],"research_interests":null},{"name":"Priit Palta","affiliation":"equal contribution; FIMM, University of Helsinki","username":"priit-palta","link":null,"image":{"source":"https:\/\/s3.amazonaws.com\/pr-journal\/tsri986.jpg","placeholder":"https:\/\/s3.amazonaws.com\/pr-journal\/tsri986.jpg"},"badges":[],"research_interests":null}],"versions":[],"groups":[{"id":617,"uri":"seqinfo","title":"FIMM HumGen Sequencing Informatics","image":{"source":"https:\/\/s3.amazonaws.com\/pr-journal\/vs7i986.png","placeholder":"https:\/\/s3.amazonaws.com\/pr-journal\/vs7i986.png"},"tech_support":{"email":null,"phone":null,"hide_contact":0,"use_email":0},"is_member":1,"request":{"id":617,"uri":"seqinfo","title":"FIMM HumGen Sequencing Informatics","image":{"source":"https:\/\/s3.amazonaws.com\/pr-journal\/vs7i986.png","placeholder":"https:\/\/s3.amazonaws.com\/pr-journal\/vs7i986.png"},"tech_support":{"email":null,"phone":null,"hide_contact":0,"use_email":0},"is_member":1,"description":null,"research_interests":null,"website":null,"location":null,"affiliation":null,"status":{"is_visible":true,"access_level":0},"stats":{"files":[],"total_members":0,"total_followers":0,"total_child_groups":0,"total_parent_groups":0,"has_collaborations":0},"user_status":{"is_member":true,"is_confirmed":true,"is_invited":false,"is_owner":false,"is_admin":false,"is_following":false},"join_link":null,"token":null,"owner":{"name":" ","affiliation":null,"username":null,"link":null,"image":{"source":null,"placeholder":null},"badges":[],"research_interests":null},"is_protocol_requested":0,"is_group_requested":0,"is_my":false,"is_request":false,"is_confirmed":1,"is_declined":0,"requester":{"name":" ","affiliation":null,"affiliation_url":null,"username":null,"link":null},"protocol":{"id":0,"title":"Genotype imputation workflow v3.0","title_html":"Genotype imputation workflow v3.0","image":{"source":null,"placeholder":null},"doi":null,"doi_status":0,"uri":"genotype-imputation-workflow-v3-0-xbgfijw","type_id":1,"published_on":null,"stats":{"number_of_views":0,"number_of_steps":0,"number_of_bookmarks":0,"number_of_comments":0,"number_of_exports":0}},"created_on":1554112368,"resolve_on":0,"resolved_user":{"name":" ","affiliation":null,"username":null,"link":null,"image":{"source":null,"placeholder":null},"badges":[],"research_interests":null},"shared":false}}],"has_subprotocols":0,"is_subprotocol":0,"is_bookmarked":0,"forks_count":{"private":0,"public":0},"access":{"can_view":1,"can_remove":0,"can_add":0,"can_edit":0,"can_publish":0,"can_get_doi":0,"can_share":1,"can_move":1,"can_move_outside":1,"can_transfer":1,"can_download":1,"is_locked":0},"steps":[{"id":700222,"guid":"3A2F0E0A1BB0470AB8A10886EFCF51BC","previous_id":null,"previous_guid":null,"modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"E38D005202C24D88A61C78AFDE0B6142","order_id":1,"type_id":6,"title":"Section","source":{"title":"Requirements and preparatory steps"}},{"id":1054724,"guid":"0628F81E737C4020AD149ED8BC652A9A","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">The actual imputation protocol begins at step 2. <\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">All consecutive steps (commands given in 'cmd COMMAND' sections) must be run to ensure high-quality results. <\/span><\/div><div class = \"text-block\"><span>For a 'quick and dirty' genotype imputation 'run', you can jump straight to <\/span><span style = \"font-weight:bold;\">Steps 9-10<\/span><span> and only run these (assuming you already have all the required files in the correct format).<\/span><\/div><div class = \"text-block\">Throughout the protocol we assume Bash shell.<\/div><div class = \"text-block\"><span>This <\/span><span style = \"font-weight:bold;\">Step 1<\/span><span> defines the requirements for the protocol (e.g. required software packages and reference genome files) and suggests example commands on how to process the files into suitable formats.<\/span><\/div><div class = \"text-block\"><span>In the protocol, we assume human reference genome build version <\/span><span style = \"font-weight:bold;\">GRCh38\/hg38<\/span><span>. To lift-over and update the build of your chip data, you can use our lift-over protocol: <\/span><\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/www.protocols.io\/view\/genotyping-chip-data-reference-genome-build-lift-o-nqtddwn<\/span><\/a><\/div><div class = \"text-block\"><span>Please note, that build 38 compatible VCF files should and auxiliary files might have<\/span><span style = \"font-weight:bold;\"> <\/span><span>'chr' prefixes in chromosome names. Therefore, some minor corresponding changes might be required in the related commands to parse\/work with these files correctly.<\/span><\/div><div class = \"text-block\">If you prefer GRCh37\/hg19 or other genome build versions, please download the corresponding reference genome, map and reference panel files and modify the suggested commands accordingly.<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">1.0 Docker images and preprepared files<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">We have prepared docker images to ease up the preparatory steps depending on your application: <\/span><\/div><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\">genotype-liftover-imputation-protocols-light<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">genotype-liftover-imputation-protocols-full<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">Light image<\/span><span> contains the software packages installed (Step 1.1), the reference genome (Step 1.2.1), genetic map files (Steps 1.2.2 and 1.2.3) and example scripts to run commands in each step (Steps 2-13). <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">Full image<\/span><span> contains the software packages installed (Step 1.1), preprepared publically available reference files (as defined in Steps 1.2 and 1.3) and example scripts to run commands in each step (Steps 2-13).<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Additional to this protocol, the images contain software packages and files required for genotyping chip data lift-over protocol version 2:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">https:\/\/www.protocols.io\/view\/genotyping-chip-data-lift-over-to-reference-genome-xbhfij6<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">The docker images are available at Docker hub <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">To pull the image, use the command below and replace <tag> with 'light' or 'full' according to which image you want:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">!! If you don't want to use Docker, you can install the software packages by yourself (Step 1.1), and either download preprepared files (below) or prepare the files by yourself (Step 1.2 and 1.3).<\/span><span style = \"font-weight:bold;\">\n<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Preprepared reference data (included into the docker images as listed above) are also available for separate downloading at:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">https:\/\/console.cloud.google.com\/storage\/browser\/fimm-public-data\/Imputation\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">And example scripts how to run each step at:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">https:\/\/console.cloud.google.com\/storage\/browser\/fimm-public-data\/Imputation\/dockers\/genotype-imputation-protocol\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.1 Software packages<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.1.1 Download and install the software packages <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Required software packages are listed below with the versions used in this protocol. However, using the latest versions is recommended.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">BCFtools v1.7 (or later version) <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">http:\/\/www.htslib.org\/download\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">R v3.4.1 (or later version) <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">https:\/\/www.r-project.org\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">R package data.table <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">https:\/\/github.com\/Rdatatable\/data.table\/wiki\/Installation<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">R package sm <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">https:\/\/cran.r-project.org\/package=sm<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Eagle v2.3.5 <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">https:\/\/data.broadinstitute.org\/alkesgroup\/Eagle\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Beagle v4.1 beagle.27Jan18.7e1.jar <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">https:\/\/faculty.washington.edu\/browning\/beagle\/b4_1.html<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Beagle bref bref.27Jan18.7e1.jar <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">https:\/\/faculty.washington.edu\/browning\/beagle\/bref.27Jan18.7e1.jar<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.1.2 Export the paths<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Once installed, export the correct paths to environment variable PATH:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">BCFtools plugin usage requires environment variable BCFTOOLS_PLUGINS exported, e.g:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.1.3 Install the R packages<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span>Once R is installed, for instance the 'data.table' package can be installed in<\/span><span style = \"font-weight:bold;\"> R<\/span><span>, e.g.:<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.2. Reference genome and genetic map files<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.2.1 Fasta files<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Homo Sapiens assembly hg38 version 0 is used and the required files are:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Homo_sapiens_assembly38.fasta<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Homo_sapiens_assembly38.fasta.fai<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The files are available for downloading at Broad Insitute storage in Google cloud at: <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">https:\/\/console.cloud.google.com\/storage\/browser\/broad-references\/hg38\/v0\/?pli=1<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">If you prefer GRCh37\/hg19, the reference genome files are available for downloading at Ensembl site at<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">https:\/\/grch37.ensembl.org\/index.html<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.2.2. Genetic map files for phasing with Eagle<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span>Genetic map file (all chromosomes in a single file) with recombination frequencies for <\/span><span style = \"font-weight:bold;\">GRCh38\/hg38<\/span><span> are available for downloading at Eagle download page at:<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">https:\/\/data.broadinstitute.org\/alkesgroup\/Eagle\/downloads\/tables\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">genetic_map_hg38_withX.txt.gz<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">We have processed the file according to the command below in order to split it per chromosome with correct headers.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The resulting files are saved as:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">eagle_chr#_b38.txt (where # is the chromosome number)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-style:italic;\">Note: Currently the chromosome notation in the Eagle genetic map files is only the chromosome number without 'chr' and chrX is '23'. Starting from Eagle v2.4, also chromosome notation with 'chr' tag is supported.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">If you prefer GRCh37\/hg19, the genetic map file is available for downloading at Eagle download page at <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">https:\/\/data.broadinstitute.org\/alkesgroup\/Eagle\/downloads\/tables\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">genetic_map_hg19_withX.txt.gz<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.2.3 Genetic map files for imputation with Beagle<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Genetic map files fro Beagle are available for downloading at Beagle download page at<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">http:\/\/bochet.gcc.biostat.washington.edu\/beagle\/genetic_maps\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">plink.GRCh38.map.zip<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Unzip the files and change the chromosome notation from PLINK format (only number or X) to GRCh38\/hg38 standard notation with 'chr' tag as follows:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-style:italic;\">Note: For GRCh38\/hg38, the chromosome notation in the Beagle genetic map files is 'chr#' and chromosome 23 is 'chrX'.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">If you prefer GRCh37\/hg19, the genetic map file is available for downloading at Beagle site:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">http:\/\/bochet.gcc.biostat.washington.edu\/beagle\/genetic_maps\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">plink.GRCh37.map.zip<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3. Imputation reference panel files<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.1 Obtain the reference panel files<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">For increased imputation accuracy, we recommend using a population-specific imputation reference panel, if available.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">If population-specific reference data is not available, for instance 1000 Genomes Project (1000 GP) (<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">www.nature.com\/articles\/nature15393<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">) data can be used instead.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">GRCh38\/hg38 files are available at EBI 1000 genomes ftp site: <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">ftp:\/\/ftp.1000genomes.ebi.ac.uk\/vol1\/ftp\/release\/20130502\/supporting\/GRCh38_positions\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">GRCh37\/hg19 files are available at Beagle site already processed to be compatible with Beagle:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">http:\/\/bochet.gcc.biostat.washington.edu\/beagle\/1000_Genomes_phase3_v5a\/b37.bref\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The 1000 GP files can be downloaded for instance with command:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">NOTE: <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">The reference panel files should contain: <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">phased genotypes,<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">chromosome names with 'chr' and chromosome X as 'chrX', <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">all variants as biallelic records,<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">only SNPs and INDELs,<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">only unique variants, <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">non-missing data,<\/span><span style = \"font-weight:bold;\"> <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">chrX as diploid genotypes, and<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">only unique IDs<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">If your reference panel files are not in the correct format, see some suggested processing commands below.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.2 Minimum quality control<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Here, we have piped most of the processing steps together in order to save significant amount of time by avoiding writing out multiple intermediate files. If your imputation reference panel does not require all the steps, modify the command accordingly.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">For 1000GP data:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Generate a text file containing space-spearated old and new chromosome names. This is required to rename the numerical chromosome names with 'chr' tag. Apply the new chromosome names with 'bcftools annotate'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Remove the rare variants, here singletons and doubletons by setting AC threshold with 'bcftools view'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Split multiallelic sites to biallelic records with 'bcftools norm'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Keep only SNPs and INDELs with 'bcftools view'. Here, the 1000GP data included a tag VT in the INFO field and data contain also structural variants which should be excluded.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Align the variants to reference genome with 'bcftools norm' in order to have the REF and ALT alleles in the shortest possible representation and to confirm that the REF allele matches the reference genome, additionally remove duplicate variants (-d none).<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">After alignment, remove multiallelic records with 'bcftools view', since these are formed during the alignment if the REF does not match with the reference genome.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Finally, remove sites containing missing data with 'bcftools view'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.3 Convert haploid genotypes to homozygous diploids<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Often chrX is represented as haploid genotypes for males, however, Beagle can only handle diploid genotypes. <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The command here produces unphased diploid genotypes. But since the haploid genotypes are in diploid format as REF\/REF or ALT\/ALT, we can simply set the phase for those alleles with a simple sed replacement. <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The chrX ploidy can be corrected as follows:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.4 Duplicate ID removal<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span>Remove duplicate IDs. If you wish to preserve all multiallelic sites, replace the ID column with a unique ID e.g. CHR_POS_REF_ALT (as indicated in <\/span><span style = \"font-weight:bold;\">Step 1.3.2<\/span><span>). <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Here, 1000GP did not contain multiallelic sites after AC filtering, and thus, RSIDs were preserved in the ID column. And since RSIDs are not always unique, duplicates should be removed.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.5 Reference panel allele frequencies<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Generate a tab-delimited file of the reference panel allele frequencies, one variant per line, with columns CHR, SNP (in format CHR_POS_REF_ALT), REF, ALT, AF (including the header line).<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">First, update (or add) AF values in the INFO field, calculate it with BCFtools plugin +fill-tags:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Extract the wanted fields from each VCF file and combine as a single output file with the header:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-style:italic;\">Note: Chromosome notation in the panel.frq file should follow the GRCh38\/hg38 notations ('chr#' for autosomal chromosomes and 'chrX' for chromosome 23).<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.6 Create binary reference panel files<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The phased reference panel files per chromosome are required in bref format (bref = binary reference). For more information, see Beagle documentation at Beagle site:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">https:\/\/faculty.washington.edu\/browning\/beagle\/bref.16Dec15.pdf<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span>The required <\/span><span style = \"font-weight:bold;\">bref.*.jar<\/span><span> is downloaded from Beagle site:<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Use the processed imputation reference panel VCFs as inputs for the example command below. <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The output files have the suffix '.bref' instead of '.vcf.gz'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.7 Generate a list of the reference panel sample IDs<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">List of sample IDs present in the reference panel, one line per sample ID can be generated from any of the VCF files as in the example below (assuming that all chromosomes contain the same set of samples):<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.4. You are ready to start! <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">As the last prepatory step, let's go over the required input data file(s) and also expected final output files!<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.4.1 Input file:<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Post-QC chip genotype data in VCFv4.2 format and chrX genotypes as diploid genotypes:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">DATASET.vcf.gz<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;font-style:italic;\">Note: Chromosome notation should follow the GRCh38\/hg38 notations (e.g. 'chr#' for autosomal chromosomes, 'chrX', 'chrY' and 'chrM').<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;font-style:italic;\">Note: If the input data was lifted over from an older genome build to build version 38, cautious inspection of the data is highly recommended before proceeding with the protocol.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;font-style:italic;\">Note: If chrX is represented as haploid genotypes, follow step 1.3.3 first 'bcftools +fixploidy' command (not the other two piped commands) to convert to diploid genotypes.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.4.2 Final output files:<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">DATASET_imputed_info_chr#.vcf.gz (where # is chromosome number)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">DATASET_postimputation_summary_plots.pdf<\/li><\/ul><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Light image<\/span><span> contains the software packages installed (Step 1.1), the reference genome (Step 1.2.1), genetic map files (Steps 1.2.2 and 1.2.3) and example scripts to run commands in each step (Steps 2-13). <\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Full image<\/span><span> contains the software packages installed (Step 1.1), preprepared publically available reference files (as defined in Steps 1.2 and 1.3) and example scripts to run commands in each step (Steps 2-13).<\/span><\/div><div class = \"text-block\">Additional to this protocol, the images contain software packages and files required for genotyping chip data lift-over protocol version 2:<\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/www.protocols.io\/view\/genotyping-chip-data-lift-over-to-reference-genome-xbhfij6<\/span><\/a><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">The docker images are available at Docker hub <\/span><\/div><div class = \"text-block\">To pull the image, use the command below and replace <tag> with 'light' or 'full' according to which image you want:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">!! If you don't want to use Docker, you can install the software packages by yourself (Step 1.1), and either download preprepared files (below) or prepare the files by yourself (Step 1.2 and 1.3).<\/span><span style = \"font-weight:bold;\">\n<\/span><\/div><div class = \"text-block\">Preprepared reference data (included into the docker images as listed above) are also available for separate downloading at:<\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/console.cloud.google.com\/storage\/browser\/fimm-public-data\/Imputation\/<\/span><\/a><\/div><div class = \"text-block\">And example scripts how to run each step at:<\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/console.cloud.google.com\/storage\/browser\/fimm-public-data\/Imputation\/dockers\/genotype-imputation-protocol\/<\/span><\/a><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">1.1 Software packages<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">1.1.1 Download and install the software packages <\/span><\/div><div class = \"text-block\">Required software packages are listed below with the versions used in this protocol. However, using the latest versions is recommended.<\/div><div class = \"text-block\">BCFtools v1.7 (or later version) <\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">http:\/\/www.htslib.org\/download\/<\/span><\/a><\/div><div class = \"text-block\">R v3.4.1 (or later version) <\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/www.r-project.org\/<\/span><\/a><\/div><div class = \"text-block\">R package data.table <\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/github.com\/Rdatatable\/data.table\/wiki\/Installation<\/span><\/a><\/div><div class = \"text-block\">R package sm <\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/cran.r-project.org\/package=sm<\/span><\/a><\/div><div class = \"text-block\">Eagle v2.3.5 <\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/data.broadinstitute.org\/alkesgroup\/Eagle\/<\/span><\/a><\/div><div class = \"text-block\">Beagle v4.1 beagle.27Jan18.7e1.jar <\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/faculty.washington.edu\/browning\/beagle\/b4_1.html<\/span><\/a><\/div><div class = \"text-block\">Beagle bref bref.27Jan18.7e1.jar <\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/faculty.washington.edu\/browning\/beagle\/bref.27Jan18.7e1.jar<\/span><\/a><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">1.1.2 Export the paths<\/span><\/div><div class = \"text-block\">Once installed, export the correct paths to environment variable PATH:<\/div><div class = \"text-block\">BCFtools plugin usage requires environment variable BCFTOOLS_PLUGINS exported, e.g:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">1.1.3 Install the R packages<\/span><\/div><div class = \"text-block\"><span>Once R is installed, for instance the 'data.table' package can be installed in<\/span><span style = \"font-weight:bold;\"> R<\/span><span>, e.g.:<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">1.2. Reference genome and genetic map files<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">1.2.1 Fasta files<\/span><\/div><div class = \"text-block\">Homo Sapiens assembly hg38 version 0 is used and the required files are:<\/div><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\">Homo_sapiens_assembly38.fasta<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Homo_sapiens_assembly38.fasta.fai<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The files are available for downloading at Broad Insitute storage in Google cloud at: <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">https:\/\/console.cloud.google.com\/storage\/browser\/broad-references\/hg38\/v0\/?pli=1<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">If you prefer GRCh37\/hg19, the reference genome files are available for downloading at Ensembl site at<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">https:\/\/grch37.ensembl.org\/index.html<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.2.2. Genetic map files for phasing with Eagle<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span>Genetic map file (all chromosomes in a single file) with recombination frequencies for <\/span><span style = \"font-weight:bold;\">GRCh38\/hg38<\/span><span> are available for downloading at Eagle download page at:<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">https:\/\/data.broadinstitute.org\/alkesgroup\/Eagle\/downloads\/tables\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">genetic_map_hg38_withX.txt.gz<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">We have processed the file according to the command below in order to split it per chromosome with correct headers.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The resulting files are saved as:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">eagle_chr#_b38.txt (where # is the chromosome number)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-style:italic;\">Note: Currently the chromosome notation in the Eagle genetic map files is only the chromosome number without 'chr' and chrX is '23'. Starting from Eagle v2.4, also chromosome notation with 'chr' tag is supported.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">If you prefer GRCh37\/hg19, the genetic map file is available for downloading at Eagle download page at <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">https:\/\/data.broadinstitute.org\/alkesgroup\/Eagle\/downloads\/tables\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">genetic_map_hg19_withX.txt.gz<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.2.3 Genetic map files for imputation with Beagle<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Genetic map files fro Beagle are available for downloading at Beagle download page at<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">http:\/\/bochet.gcc.biostat.washington.edu\/beagle\/genetic_maps\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">plink.GRCh38.map.zip<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Unzip the files and change the chromosome notation from PLINK format (only number or X) to GRCh38\/hg38 standard notation with 'chr' tag as follows:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-style:italic;\">Note: For GRCh38\/hg38, the chromosome notation in the Beagle genetic map files is 'chr#' and chromosome 23 is 'chrX'.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">If you prefer GRCh37\/hg19, the genetic map file is available for downloading at Beagle site:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">http:\/\/bochet.gcc.biostat.washington.edu\/beagle\/genetic_maps\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">plink.GRCh37.map.zip<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3. Imputation reference panel files<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.1 Obtain the reference panel files<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">For increased imputation accuracy, we recommend using a population-specific imputation reference panel, if available.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">If population-specific reference data is not available, for instance 1000 Genomes Project (1000 GP) (<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">www.nature.com\/articles\/nature15393<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">) data can be used instead.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">GRCh38\/hg38 files are available at EBI 1000 genomes ftp site: <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">ftp:\/\/ftp.1000genomes.ebi.ac.uk\/vol1\/ftp\/release\/20130502\/supporting\/GRCh38_positions\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">GRCh37\/hg19 files are available at Beagle site already processed to be compatible with Beagle:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">http:\/\/bochet.gcc.biostat.washington.edu\/beagle\/1000_Genomes_phase3_v5a\/b37.bref\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The 1000 GP files can be downloaded for instance with command:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">NOTE: <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">The reference panel files should contain: <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">phased genotypes,<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">chromosome names with 'chr' and chromosome X as 'chrX', <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">all variants as biallelic records,<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">only SNPs and INDELs,<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">only unique variants, <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">non-missing data,<\/span><span style = \"font-weight:bold;\"> <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">chrX as diploid genotypes, and<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">only unique IDs<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">If your reference panel files are not in the correct format, see some suggested processing commands below.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.2 Minimum quality control<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Here, we have piped most of the processing steps together in order to save significant amount of time by avoiding writing out multiple intermediate files. If your imputation reference panel does not require all the steps, modify the command accordingly.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">For 1000GP data:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Generate a text file containing space-spearated old and new chromosome names. This is required to rename the numerical chromosome names with 'chr' tag. Apply the new chromosome names with 'bcftools annotate'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Remove the rare variants, here singletons and doubletons by setting AC threshold with 'bcftools view'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Split multiallelic sites to biallelic records with 'bcftools norm'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Keep only SNPs and INDELs with 'bcftools view'. Here, the 1000GP data included a tag VT in the INFO field and data contain also structural variants which should be excluded.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Align the variants to reference genome with 'bcftools norm' in order to have the REF and ALT alleles in the shortest possible representation and to confirm that the REF allele matches the reference genome, additionally remove duplicate variants (-d none).<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">After alignment, remove multiallelic records with 'bcftools view', since these are formed during the alignment if the REF does not match with the reference genome.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Finally, remove sites containing missing data with 'bcftools view'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.3 Convert haploid genotypes to homozygous diploids<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Often chrX is represented as haploid genotypes for males, however, Beagle can only handle diploid genotypes. <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The command here produces unphased diploid genotypes. But since the haploid genotypes are in diploid format as REF\/REF or ALT\/ALT, we can simply set the phase for those alleles with a simple sed replacement. <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The chrX ploidy can be corrected as follows:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.4 Duplicate ID removal<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span>Remove duplicate IDs. If you wish to preserve all multiallelic sites, replace the ID column with a unique ID e.g. CHR_POS_REF_ALT (as indicated in <\/span><span style = \"font-weight:bold;\">Step 1.3.2<\/span><span>). <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Here, 1000GP did not contain multiallelic sites after AC filtering, and thus, RSIDs were preserved in the ID column. And since RSIDs are not always unique, duplicates should be removed.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.5 Reference panel allele frequencies<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Generate a tab-delimited file of the reference panel allele frequencies, one variant per line, with columns CHR, SNP (in format CHR_POS_REF_ALT), REF, ALT, AF (including the header line).<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">First, update (or add) AF values in the INFO field, calculate it with BCFtools plugin +fill-tags:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Extract the wanted fields from each VCF file and combine as a single output file with the header:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-style:italic;\">Note: Chromosome notation in the panel.frq file should follow the GRCh38\/hg38 notations ('chr#' for autosomal chromosomes and 'chrX' for chromosome 23).<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.6 Create binary reference panel files<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The phased reference panel files per chromosome are required in bref format (bref = binary reference). For more information, see Beagle documentation at Beagle site:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">https:\/\/faculty.washington.edu\/browning\/beagle\/bref.16Dec15.pdf<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span>The required <\/span><span style = \"font-weight:bold;\">bref.*.jar<\/span><span> is downloaded from Beagle site:<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Use the processed imputation reference panel VCFs as inputs for the example command below. <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The output files have the suffix '.bref' instead of '.vcf.gz'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.7 Generate a list of the reference panel sample IDs<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">List of sample IDs present in the reference panel, one line per sample ID can be generated from any of the VCF files as in the example below (assuming that all chromosomes contain the same set of samples):<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.4. You are ready to start! <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">As the last prepatory step, let's go over the required input data file(s) and also expected final output files!<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.4.1 Input file:<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Post-QC chip genotype data in VCFv4.2 format and chrX genotypes as diploid genotypes:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">DATASET.vcf.gz<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;font-style:italic;\">Note: Chromosome notation should follow the GRCh38\/hg38 notations (e.g. 'chr#' for autosomal chromosomes, 'chrX', 'chrY' and 'chrM').<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;font-style:italic;\">Note: If the input data was lifted over from an older genome build to build version 38, cautious inspection of the data is highly recommended before proceeding with the protocol.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;font-style:italic;\">Note: If chrX is represented as haploid genotypes, follow step 1.3.3 first 'bcftools +fixploidy' command (not the other two piped commands) to convert to diploid genotypes.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.4.2 Final output files:<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">DATASET_imputed_info_chr#.vcf.gz (where # is chromosome number)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">DATASET_postimputation_summary_plots.pdf<\/li><\/ul><\/div><div class = \"text-block\">The files are available for downloading at Broad Insitute storage in Google cloud at: <\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/console.cloud.google.com\/storage\/browser\/broad-references\/hg38\/v0\/?pli=1<\/span><\/a><\/div><div class = \"text-block\">If you prefer GRCh37\/hg19, the reference genome files are available for downloading at Ensembl site at<\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/grch37.ensembl.org\/index.html<\/span><\/a><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">1.2.2. Genetic map files for phasing with Eagle<\/span><\/div><div class = \"text-block\"><span>Genetic map file (all chromosomes in a single file) with recombination frequencies for <\/span><span style = \"font-weight:bold;\">GRCh38\/hg38<\/span><span> are available for downloading at Eagle download page at:<\/span><\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/data.broadinstitute.org\/alkesgroup\/Eagle\/downloads\/tables\/<\/span><\/a><\/div><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\">genetic_map_hg38_withX.txt.gz<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">We have processed the file according to the command below in order to split it per chromosome with correct headers.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The resulting files are saved as:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">eagle_chr#_b38.txt (where # is the chromosome number)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-style:italic;\">Note: Currently the chromosome notation in the Eagle genetic map files is only the chromosome number without 'chr' and chrX is '23'. Starting from Eagle v2.4, also chromosome notation with 'chr' tag is supported.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">If you prefer GRCh37\/hg19, the genetic map file is available for downloading at Eagle download page at <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">https:\/\/data.broadinstitute.org\/alkesgroup\/Eagle\/downloads\/tables\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">genetic_map_hg19_withX.txt.gz<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.2.3 Genetic map files for imputation with Beagle<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Genetic map files fro Beagle are available for downloading at Beagle download page at<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">http:\/\/bochet.gcc.biostat.washington.edu\/beagle\/genetic_maps\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">plink.GRCh38.map.zip<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Unzip the files and change the chromosome notation from PLINK format (only number or X) to GRCh38\/hg38 standard notation with 'chr' tag as follows:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-style:italic;\">Note: For GRCh38\/hg38, the chromosome notation in the Beagle genetic map files is 'chr#' and chromosome 23 is 'chrX'.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">If you prefer GRCh37\/hg19, the genetic map file is available for downloading at Beagle site:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">http:\/\/bochet.gcc.biostat.washington.edu\/beagle\/genetic_maps\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">plink.GRCh37.map.zip<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3. Imputation reference panel files<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.1 Obtain the reference panel files<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">For increased imputation accuracy, we recommend using a population-specific imputation reference panel, if available.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">If population-specific reference data is not available, for instance 1000 Genomes Project (1000 GP) (<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">www.nature.com\/articles\/nature15393<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">) data can be used instead.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">GRCh38\/hg38 files are available at EBI 1000 genomes ftp site: <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">ftp:\/\/ftp.1000genomes.ebi.ac.uk\/vol1\/ftp\/release\/20130502\/supporting\/GRCh38_positions\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">GRCh37\/hg19 files are available at Beagle site already processed to be compatible with Beagle:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">http:\/\/bochet.gcc.biostat.washington.edu\/beagle\/1000_Genomes_phase3_v5a\/b37.bref\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The 1000 GP files can be downloaded for instance with command:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">NOTE: <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">The reference panel files should contain: <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">phased genotypes,<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">chromosome names with 'chr' and chromosome X as 'chrX', <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">all variants as biallelic records,<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">only SNPs and INDELs,<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">only unique variants, <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">non-missing data,<\/span><span style = \"font-weight:bold;\"> <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">chrX as diploid genotypes, and<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">only unique IDs<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">If your reference panel files are not in the correct format, see some suggested processing commands below.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.2 Minimum quality control<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Here, we have piped most of the processing steps together in order to save significant amount of time by avoiding writing out multiple intermediate files. If your imputation reference panel does not require all the steps, modify the command accordingly.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">For 1000GP data:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Generate a text file containing space-spearated old and new chromosome names. This is required to rename the numerical chromosome names with 'chr' tag. Apply the new chromosome names with 'bcftools annotate'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Remove the rare variants, here singletons and doubletons by setting AC threshold with 'bcftools view'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Split multiallelic sites to biallelic records with 'bcftools norm'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Keep only SNPs and INDELs with 'bcftools view'. Here, the 1000GP data included a tag VT in the INFO field and data contain also structural variants which should be excluded.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Align the variants to reference genome with 'bcftools norm' in order to have the REF and ALT alleles in the shortest possible representation and to confirm that the REF allele matches the reference genome, additionally remove duplicate variants (-d none).<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">After alignment, remove multiallelic records with 'bcftools view', since these are formed during the alignment if the REF does not match with the reference genome.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Finally, remove sites containing missing data with 'bcftools view'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.3 Convert haploid genotypes to homozygous diploids<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Often chrX is represented as haploid genotypes for males, however, Beagle can only handle diploid genotypes. <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The command here produces unphased diploid genotypes. But since the haploid genotypes are in diploid format as REF\/REF or ALT\/ALT, we can simply set the phase for those alleles with a simple sed replacement. <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The chrX ploidy can be corrected as follows:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.4 Duplicate ID removal<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span>Remove duplicate IDs. If you wish to preserve all multiallelic sites, replace the ID column with a unique ID e.g. CHR_POS_REF_ALT (as indicated in <\/span><span style = \"font-weight:bold;\">Step 1.3.2<\/span><span>). <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Here, 1000GP did not contain multiallelic sites after AC filtering, and thus, RSIDs were preserved in the ID column. And since RSIDs are not always unique, duplicates should be removed.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.5 Reference panel allele frequencies<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Generate a tab-delimited file of the reference panel allele frequencies, one variant per line, with columns CHR, SNP (in format CHR_POS_REF_ALT), REF, ALT, AF (including the header line).<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">First, update (or add) AF values in the INFO field, calculate it with BCFtools plugin +fill-tags:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Extract the wanted fields from each VCF file and combine as a single output file with the header:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-style:italic;\">Note: Chromosome notation in the panel.frq file should follow the GRCh38\/hg38 notations ('chr#' for autosomal chromosomes and 'chrX' for chromosome 23).<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.6 Create binary reference panel files<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The phased reference panel files per chromosome are required in bref format (bref = binary reference). For more information, see Beagle documentation at Beagle site:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">https:\/\/faculty.washington.edu\/browning\/beagle\/bref.16Dec15.pdf<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span>The required <\/span><span style = \"font-weight:bold;\">bref.*.jar<\/span><span> is downloaded from Beagle site:<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Use the processed imputation reference panel VCFs as inputs for the example command below. <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The output files have the suffix '.bref' instead of '.vcf.gz'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.7 Generate a list of the reference panel sample IDs<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">List of sample IDs present in the reference panel, one line per sample ID can be generated from any of the VCF files as in the example below (assuming that all chromosomes contain the same set of samples):<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.4. You are ready to start! <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">As the last prepatory step, let's go over the required input data file(s) and also expected final output files!<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.4.1 Input file:<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Post-QC chip genotype data in VCFv4.2 format and chrX genotypes as diploid genotypes:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">DATASET.vcf.gz<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;font-style:italic;\">Note: Chromosome notation should follow the GRCh38\/hg38 notations (e.g. 'chr#' for autosomal chromosomes, 'chrX', 'chrY' and 'chrM').<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;font-style:italic;\">Note: If the input data was lifted over from an older genome build to build version 38, cautious inspection of the data is highly recommended before proceeding with the protocol.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;font-style:italic;\">Note: If chrX is represented as haploid genotypes, follow step 1.3.3 first 'bcftools +fixploidy' command (not the other two piped commands) to convert to diploid genotypes.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.4.2 Final output files:<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">DATASET_imputed_info_chr#.vcf.gz (where # is chromosome number)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">DATASET_postimputation_summary_plots.pdf<\/li><\/ul><\/div><div class = \"text-block\">We have processed the file according to the command below in order to split it per chromosome with correct headers.<\/div><div class = \"text-block\">The resulting files are saved as:<\/div><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\">eagle_chr#_b38.txt (where # is the chromosome number)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-style:italic;\">Note: Currently the chromosome notation in the Eagle genetic map files is only the chromosome number without 'chr' and chrX is '23'. Starting from Eagle v2.4, also chromosome notation with 'chr' tag is supported.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">If you prefer GRCh37\/hg19, the genetic map file is available for downloading at Eagle download page at <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">https:\/\/data.broadinstitute.org\/alkesgroup\/Eagle\/downloads\/tables\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">genetic_map_hg19_withX.txt.gz<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.2.3 Genetic map files for imputation with Beagle<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Genetic map files fro Beagle are available for downloading at Beagle download page at<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">http:\/\/bochet.gcc.biostat.washington.edu\/beagle\/genetic_maps\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">plink.GRCh38.map.zip<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Unzip the files and change the chromosome notation from PLINK format (only number or X) to GRCh38\/hg38 standard notation with 'chr' tag as follows:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-style:italic;\">Note: For GRCh38\/hg38, the chromosome notation in the Beagle genetic map files is 'chr#' and chromosome 23 is 'chrX'.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">If you prefer GRCh37\/hg19, the genetic map file is available for downloading at Beagle site:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">http:\/\/bochet.gcc.biostat.washington.edu\/beagle\/genetic_maps\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">plink.GRCh37.map.zip<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3. Imputation reference panel files<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.1 Obtain the reference panel files<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">For increased imputation accuracy, we recommend using a population-specific imputation reference panel, if available.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">If population-specific reference data is not available, for instance 1000 Genomes Project (1000 GP) (<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">www.nature.com\/articles\/nature15393<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">) data can be used instead.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">GRCh38\/hg38 files are available at EBI 1000 genomes ftp site: <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">ftp:\/\/ftp.1000genomes.ebi.ac.uk\/vol1\/ftp\/release\/20130502\/supporting\/GRCh38_positions\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">GRCh37\/hg19 files are available at Beagle site already processed to be compatible with Beagle:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">http:\/\/bochet.gcc.biostat.washington.edu\/beagle\/1000_Genomes_phase3_v5a\/b37.bref\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The 1000 GP files can be downloaded for instance with command:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">NOTE: <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">The reference panel files should contain: <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">phased genotypes,<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">chromosome names with 'chr' and chromosome X as 'chrX', <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">all variants as biallelic records,<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">only SNPs and INDELs,<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">only unique variants, <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">non-missing data,<\/span><span style = \"font-weight:bold;\"> <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">chrX as diploid genotypes, and<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">only unique IDs<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">If your reference panel files are not in the correct format, see some suggested processing commands below.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.2 Minimum quality control<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Here, we have piped most of the processing steps together in order to save significant amount of time by avoiding writing out multiple intermediate files. If your imputation reference panel does not require all the steps, modify the command accordingly.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">For 1000GP data:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Generate a text file containing space-spearated old and new chromosome names. This is required to rename the numerical chromosome names with 'chr' tag. Apply the new chromosome names with 'bcftools annotate'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Remove the rare variants, here singletons and doubletons by setting AC threshold with 'bcftools view'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Split multiallelic sites to biallelic records with 'bcftools norm'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Keep only SNPs and INDELs with 'bcftools view'. Here, the 1000GP data included a tag VT in the INFO field and data contain also structural variants which should be excluded.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Align the variants to reference genome with 'bcftools norm' in order to have the REF and ALT alleles in the shortest possible representation and to confirm that the REF allele matches the reference genome, additionally remove duplicate variants (-d none).<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">After alignment, remove multiallelic records with 'bcftools view', since these are formed during the alignment if the REF does not match with the reference genome.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Finally, remove sites containing missing data with 'bcftools view'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.3 Convert haploid genotypes to homozygous diploids<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Often chrX is represented as haploid genotypes for males, however, Beagle can only handle diploid genotypes. <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The command here produces unphased diploid genotypes. But since the haploid genotypes are in diploid format as REF\/REF or ALT\/ALT, we can simply set the phase for those alleles with a simple sed replacement. <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The chrX ploidy can be corrected as follows:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.4 Duplicate ID removal<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span>Remove duplicate IDs. If you wish to preserve all multiallelic sites, replace the ID column with a unique ID e.g. CHR_POS_REF_ALT (as indicated in <\/span><span style = \"font-weight:bold;\">Step 1.3.2<\/span><span>). <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Here, 1000GP did not contain multiallelic sites after AC filtering, and thus, RSIDs were preserved in the ID column. And since RSIDs are not always unique, duplicates should be removed.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.5 Reference panel allele frequencies<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Generate a tab-delimited file of the reference panel allele frequencies, one variant per line, with columns CHR, SNP (in format CHR_POS_REF_ALT), REF, ALT, AF (including the header line).<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">First, update (or add) AF values in the INFO field, calculate it with BCFtools plugin +fill-tags:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Extract the wanted fields from each VCF file and combine as a single output file with the header:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-style:italic;\">Note: Chromosome notation in the panel.frq file should follow the GRCh38\/hg38 notations ('chr#' for autosomal chromosomes and 'chrX' for chromosome 23).<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.6 Create binary reference panel files<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The phased reference panel files per chromosome are required in bref format (bref = binary reference). For more information, see Beagle documentation at Beagle site:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">https:\/\/faculty.washington.edu\/browning\/beagle\/bref.16Dec15.pdf<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span>The required <\/span><span style = \"font-weight:bold;\">bref.*.jar<\/span><span> is downloaded from Beagle site:<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Use the processed imputation reference panel VCFs as inputs for the example command below. <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The output files have the suffix '.bref' instead of '.vcf.gz'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.7 Generate a list of the reference panel sample IDs<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">List of sample IDs present in the reference panel, one line per sample ID can be generated from any of the VCF files as in the example below (assuming that all chromosomes contain the same set of samples):<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.4. You are ready to start! <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">As the last prepatory step, let's go over the required input data file(s) and also expected final output files!<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.4.1 Input file:<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Post-QC chip genotype data in VCFv4.2 format and chrX genotypes as diploid genotypes:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">DATASET.vcf.gz<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;font-style:italic;\">Note: Chromosome notation should follow the GRCh38\/hg38 notations (e.g. 'chr#' for autosomal chromosomes, 'chrX', 'chrY' and 'chrM').<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;font-style:italic;\">Note: If the input data was lifted over from an older genome build to build version 38, cautious inspection of the data is highly recommended before proceeding with the protocol.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;font-style:italic;\">Note: If chrX is represented as haploid genotypes, follow step 1.3.3 first 'bcftools +fixploidy' command (not the other two piped commands) to convert to diploid genotypes.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.4.2 Final output files:<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">DATASET_imputed_info_chr#.vcf.gz (where # is chromosome number)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">DATASET_postimputation_summary_plots.pdf<\/li><\/ul><\/div><div class = \"text-block\"><span style = \"font-style:italic;\">Note: Currently the chromosome notation in the Eagle genetic map files is only the chromosome number without 'chr' and chrX is '23'. Starting from Eagle v2.4, also chromosome notation with 'chr' tag is supported.<\/span><\/div><div class = \"text-block\">If you prefer GRCh37\/hg19, the genetic map file is available for downloading at Eagle download page at <\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/data.broadinstitute.org\/alkesgroup\/Eagle\/downloads\/tables\/<\/span><\/a><\/div><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\">genetic_map_hg19_withX.txt.gz<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.2.3 Genetic map files for imputation with Beagle<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Genetic map files fro Beagle are available for downloading at Beagle download page at<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">http:\/\/bochet.gcc.biostat.washington.edu\/beagle\/genetic_maps\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">plink.GRCh38.map.zip<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Unzip the files and change the chromosome notation from PLINK format (only number or X) to GRCh38\/hg38 standard notation with 'chr' tag as follows:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-style:italic;\">Note: For GRCh38\/hg38, the chromosome notation in the Beagle genetic map files is 'chr#' and chromosome 23 is 'chrX'.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">If you prefer GRCh37\/hg19, the genetic map file is available for downloading at Beagle site:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">http:\/\/bochet.gcc.biostat.washington.edu\/beagle\/genetic_maps\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">plink.GRCh37.map.zip<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3. Imputation reference panel files<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.1 Obtain the reference panel files<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">For increased imputation accuracy, we recommend using a population-specific imputation reference panel, if available.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">If population-specific reference data is not available, for instance 1000 Genomes Project (1000 GP) (<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">www.nature.com\/articles\/nature15393<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">) data can be used instead.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">GRCh38\/hg38 files are available at EBI 1000 genomes ftp site: <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">ftp:\/\/ftp.1000genomes.ebi.ac.uk\/vol1\/ftp\/release\/20130502\/supporting\/GRCh38_positions\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">GRCh37\/hg19 files are available at Beagle site already processed to be compatible with Beagle:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">http:\/\/bochet.gcc.biostat.washington.edu\/beagle\/1000_Genomes_phase3_v5a\/b37.bref\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The 1000 GP files can be downloaded for instance with command:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">NOTE: <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">The reference panel files should contain: <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">phased genotypes,<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">chromosome names with 'chr' and chromosome X as 'chrX', <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">all variants as biallelic records,<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">only SNPs and INDELs,<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">only unique variants, <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">non-missing data,<\/span><span style = \"font-weight:bold;\"> <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">chrX as diploid genotypes, and<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">only unique IDs<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">If your reference panel files are not in the correct format, see some suggested processing commands below.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.2 Minimum quality control<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Here, we have piped most of the processing steps together in order to save significant amount of time by avoiding writing out multiple intermediate files. If your imputation reference panel does not require all the steps, modify the command accordingly.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">For 1000GP data:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Generate a text file containing space-spearated old and new chromosome names. This is required to rename the numerical chromosome names with 'chr' tag. Apply the new chromosome names with 'bcftools annotate'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Remove the rare variants, here singletons and doubletons by setting AC threshold with 'bcftools view'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Split multiallelic sites to biallelic records with 'bcftools norm'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Keep only SNPs and INDELs with 'bcftools view'. Here, the 1000GP data included a tag VT in the INFO field and data contain also structural variants which should be excluded.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Align the variants to reference genome with 'bcftools norm' in order to have the REF and ALT alleles in the shortest possible representation and to confirm that the REF allele matches the reference genome, additionally remove duplicate variants (-d none).<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">After alignment, remove multiallelic records with 'bcftools view', since these are formed during the alignment if the REF does not match with the reference genome.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Finally, remove sites containing missing data with 'bcftools view'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.3 Convert haploid genotypes to homozygous diploids<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Often chrX is represented as haploid genotypes for males, however, Beagle can only handle diploid genotypes. <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The command here produces unphased diploid genotypes. But since the haploid genotypes are in diploid format as REF\/REF or ALT\/ALT, we can simply set the phase for those alleles with a simple sed replacement. <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The chrX ploidy can be corrected as follows:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.4 Duplicate ID removal<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span>Remove duplicate IDs. If you wish to preserve all multiallelic sites, replace the ID column with a unique ID e.g. CHR_POS_REF_ALT (as indicated in <\/span><span style = \"font-weight:bold;\">Step 1.3.2<\/span><span>). <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Here, 1000GP did not contain multiallelic sites after AC filtering, and thus, RSIDs were preserved in the ID column. And since RSIDs are not always unique, duplicates should be removed.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.5 Reference panel allele frequencies<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Generate a tab-delimited file of the reference panel allele frequencies, one variant per line, with columns CHR, SNP (in format CHR_POS_REF_ALT), REF, ALT, AF (including the header line).<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">First, update (or add) AF values in the INFO field, calculate it with BCFtools plugin +fill-tags:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Extract the wanted fields from each VCF file and combine as a single output file with the header:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-style:italic;\">Note: Chromosome notation in the panel.frq file should follow the GRCh38\/hg38 notations ('chr#' for autosomal chromosomes and 'chrX' for chromosome 23).<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.6 Create binary reference panel files<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The phased reference panel files per chromosome are required in bref format (bref = binary reference). For more information, see Beagle documentation at Beagle site:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">https:\/\/faculty.washington.edu\/browning\/beagle\/bref.16Dec15.pdf<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span>The required <\/span><span style = \"font-weight:bold;\">bref.*.jar<\/span><span> is downloaded from Beagle site:<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Use the processed imputation reference panel VCFs as inputs for the example command below. <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The output files have the suffix '.bref' instead of '.vcf.gz'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.7 Generate a list of the reference panel sample IDs<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">List of sample IDs present in the reference panel, one line per sample ID can be generated from any of the VCF files as in the example below (assuming that all chromosomes contain the same set of samples):<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.4. You are ready to start! <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">As the last prepatory step, let's go over the required input data file(s) and also expected final output files!<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.4.1 Input file:<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Post-QC chip genotype data in VCFv4.2 format and chrX genotypes as diploid genotypes:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">DATASET.vcf.gz<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;font-style:italic;\">Note: Chromosome notation should follow the GRCh38\/hg38 notations (e.g. 'chr#' for autosomal chromosomes, 'chrX', 'chrY' and 'chrM').<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;font-style:italic;\">Note: If the input data was lifted over from an older genome build to build version 38, cautious inspection of the data is highly recommended before proceeding with the protocol.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;font-style:italic;\">Note: If chrX is represented as haploid genotypes, follow step 1.3.3 first 'bcftools +fixploidy' command (not the other two piped commands) to convert to diploid genotypes.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.4.2 Final output files:<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">DATASET_imputed_info_chr#.vcf.gz (where # is chromosome number)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">DATASET_postimputation_summary_plots.pdf<\/li><\/ul><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">1.2.3 Genetic map files for imputation with Beagle<\/span><\/div><div class = \"text-block\">Genetic map files fro Beagle are available for downloading at Beagle download page at<\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">http:\/\/bochet.gcc.biostat.washington.edu\/beagle\/genetic_maps\/<\/span><\/a><\/div><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\">plink.GRCh38.map.zip<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Unzip the files and change the chromosome notation from PLINK format (only number or X) to GRCh38\/hg38 standard notation with 'chr' tag as follows:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-style:italic;\">Note: For GRCh38\/hg38, the chromosome notation in the Beagle genetic map files is 'chr#' and chromosome 23 is 'chrX'.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">If you prefer GRCh37\/hg19, the genetic map file is available for downloading at Beagle site:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">http:\/\/bochet.gcc.biostat.washington.edu\/beagle\/genetic_maps\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">plink.GRCh37.map.zip<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3. Imputation reference panel files<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.1 Obtain the reference panel files<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">For increased imputation accuracy, we recommend using a population-specific imputation reference panel, if available.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">If population-specific reference data is not available, for instance 1000 Genomes Project (1000 GP) (<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">www.nature.com\/articles\/nature15393<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">) data can be used instead.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">GRCh38\/hg38 files are available at EBI 1000 genomes ftp site: <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">ftp:\/\/ftp.1000genomes.ebi.ac.uk\/vol1\/ftp\/release\/20130502\/supporting\/GRCh38_positions\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">GRCh37\/hg19 files are available at Beagle site already processed to be compatible with Beagle:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">http:\/\/bochet.gcc.biostat.washington.edu\/beagle\/1000_Genomes_phase3_v5a\/b37.bref\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The 1000 GP files can be downloaded for instance with command:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">NOTE: <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">The reference panel files should contain: <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">phased genotypes,<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">chromosome names with 'chr' and chromosome X as 'chrX', <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">all variants as biallelic records,<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">only SNPs and INDELs,<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">only unique variants, <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">non-missing data,<\/span><span style = \"font-weight:bold;\"> <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">chrX as diploid genotypes, and<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">only unique IDs<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">If your reference panel files are not in the correct format, see some suggested processing commands below.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.2 Minimum quality control<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Here, we have piped most of the processing steps together in order to save significant amount of time by avoiding writing out multiple intermediate files. If your imputation reference panel does not require all the steps, modify the command accordingly.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">For 1000GP data:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Generate a text file containing space-spearated old and new chromosome names. This is required to rename the numerical chromosome names with 'chr' tag. Apply the new chromosome names with 'bcftools annotate'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Remove the rare variants, here singletons and doubletons by setting AC threshold with 'bcftools view'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Split multiallelic sites to biallelic records with 'bcftools norm'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Keep only SNPs and INDELs with 'bcftools view'. Here, the 1000GP data included a tag VT in the INFO field and data contain also structural variants which should be excluded.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Align the variants to reference genome with 'bcftools norm' in order to have the REF and ALT alleles in the shortest possible representation and to confirm that the REF allele matches the reference genome, additionally remove duplicate variants (-d none).<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">After alignment, remove multiallelic records with 'bcftools view', since these are formed during the alignment if the REF does not match with the reference genome.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Finally, remove sites containing missing data with 'bcftools view'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.3 Convert haploid genotypes to homozygous diploids<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Often chrX is represented as haploid genotypes for males, however, Beagle can only handle diploid genotypes. <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The command here produces unphased diploid genotypes. But since the haploid genotypes are in diploid format as REF\/REF or ALT\/ALT, we can simply set the phase for those alleles with a simple sed replacement. <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The chrX ploidy can be corrected as follows:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.4 Duplicate ID removal<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span>Remove duplicate IDs. If you wish to preserve all multiallelic sites, replace the ID column with a unique ID e.g. CHR_POS_REF_ALT (as indicated in <\/span><span style = \"font-weight:bold;\">Step 1.3.2<\/span><span>). <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Here, 1000GP did not contain multiallelic sites after AC filtering, and thus, RSIDs were preserved in the ID column. And since RSIDs are not always unique, duplicates should be removed.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.5 Reference panel allele frequencies<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Generate a tab-delimited file of the reference panel allele frequencies, one variant per line, with columns CHR, SNP (in format CHR_POS_REF_ALT), REF, ALT, AF (including the header line).<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">First, update (or add) AF values in the INFO field, calculate it with BCFtools plugin +fill-tags:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Extract the wanted fields from each VCF file and combine as a single output file with the header:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-style:italic;\">Note: Chromosome notation in the panel.frq file should follow the GRCh38\/hg38 notations ('chr#' for autosomal chromosomes and 'chrX' for chromosome 23).<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.6 Create binary reference panel files<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The phased reference panel files per chromosome are required in bref format (bref = binary reference). For more information, see Beagle documentation at Beagle site:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">https:\/\/faculty.washington.edu\/browning\/beagle\/bref.16Dec15.pdf<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span>The required <\/span><span style = \"font-weight:bold;\">bref.*.jar<\/span><span> is downloaded from Beagle site:<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Use the processed imputation reference panel VCFs as inputs for the example command below. <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The output files have the suffix '.bref' instead of '.vcf.gz'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.7 Generate a list of the reference panel sample IDs<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">List of sample IDs present in the reference panel, one line per sample ID can be generated from any of the VCF files as in the example below (assuming that all chromosomes contain the same set of samples):<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.4. You are ready to start! <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">As the last prepatory step, let's go over the required input data file(s) and also expected final output files!<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.4.1 Input file:<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Post-QC chip genotype data in VCFv4.2 format and chrX genotypes as diploid genotypes:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">DATASET.vcf.gz<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;font-style:italic;\">Note: Chromosome notation should follow the GRCh38\/hg38 notations (e.g. 'chr#' for autosomal chromosomes, 'chrX', 'chrY' and 'chrM').<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;font-style:italic;\">Note: If the input data was lifted over from an older genome build to build version 38, cautious inspection of the data is highly recommended before proceeding with the protocol.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;font-style:italic;\">Note: If chrX is represented as haploid genotypes, follow step 1.3.3 first 'bcftools +fixploidy' command (not the other two piped commands) to convert to diploid genotypes.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.4.2 Final output files:<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">DATASET_imputed_info_chr#.vcf.gz (where # is chromosome number)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">DATASET_postimputation_summary_plots.pdf<\/li><\/ul><\/div><div class = \"text-block\">Unzip the files and change the chromosome notation from PLINK format (only number or X) to GRCh38\/hg38 standard notation with 'chr' tag as follows:<\/div><div class = \"text-block\"><span style = \"font-style:italic;\">Note: For GRCh38\/hg38, the chromosome notation in the Beagle genetic map files is 'chr#' and chromosome 23 is 'chrX'.<\/span><\/div><div class = \"text-block\">If you prefer GRCh37\/hg19, the genetic map file is available for downloading at Beagle site:<\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">http:\/\/bochet.gcc.biostat.washington.edu\/beagle\/genetic_maps\/<\/span><\/a><\/div><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\">plink.GRCh37.map.zip<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3. Imputation reference panel files<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.1 Obtain the reference panel files<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">For increased imputation accuracy, we recommend using a population-specific imputation reference panel, if available.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">If population-specific reference data is not available, for instance 1000 Genomes Project (1000 GP) (<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">www.nature.com\/articles\/nature15393<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">) data can be used instead.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">GRCh38\/hg38 files are available at EBI 1000 genomes ftp site: <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">ftp:\/\/ftp.1000genomes.ebi.ac.uk\/vol1\/ftp\/release\/20130502\/supporting\/GRCh38_positions\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">GRCh37\/hg19 files are available at Beagle site already processed to be compatible with Beagle:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">http:\/\/bochet.gcc.biostat.washington.edu\/beagle\/1000_Genomes_phase3_v5a\/b37.bref\/<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The 1000 GP files can be downloaded for instance with command:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">NOTE: <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">The reference panel files should contain: <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">phased genotypes,<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">chromosome names with 'chr' and chromosome X as 'chrX', <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">all variants as biallelic records,<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">only SNPs and INDELs,<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">only unique variants, <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">non-missing data,<\/span><span style = \"font-weight:bold;\"> <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">chrX as diploid genotypes, and<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">only unique IDs<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">If your reference panel files are not in the correct format, see some suggested processing commands below.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.2 Minimum quality control<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Here, we have piped most of the processing steps together in order to save significant amount of time by avoiding writing out multiple intermediate files. If your imputation reference panel does not require all the steps, modify the command accordingly.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">For 1000GP data:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Generate a text file containing space-spearated old and new chromosome names. This is required to rename the numerical chromosome names with 'chr' tag. Apply the new chromosome names with 'bcftools annotate'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Remove the rare variants, here singletons and doubletons by setting AC threshold with 'bcftools view'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Split multiallelic sites to biallelic records with 'bcftools norm'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Keep only SNPs and INDELs with 'bcftools view'. Here, the 1000GP data included a tag VT in the INFO field and data contain also structural variants which should be excluded.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Align the variants to reference genome with 'bcftools norm' in order to have the REF and ALT alleles in the shortest possible representation and to confirm that the REF allele matches the reference genome, additionally remove duplicate variants (-d none).<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">After alignment, remove multiallelic records with 'bcftools view', since these are formed during the alignment if the REF does not match with the reference genome.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Finally, remove sites containing missing data with 'bcftools view'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.3 Convert haploid genotypes to homozygous diploids<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Often chrX is represented as haploid genotypes for males, however, Beagle can only handle diploid genotypes. <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The command here produces unphased diploid genotypes. But since the haploid genotypes are in diploid format as REF\/REF or ALT\/ALT, we can simply set the phase for those alleles with a simple sed replacement. <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The chrX ploidy can be corrected as follows:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.4 Duplicate ID removal<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span>Remove duplicate IDs. If you wish to preserve all multiallelic sites, replace the ID column with a unique ID e.g. CHR_POS_REF_ALT (as indicated in <\/span><span style = \"font-weight:bold;\">Step 1.3.2<\/span><span>). <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Here, 1000GP did not contain multiallelic sites after AC filtering, and thus, RSIDs were preserved in the ID column. And since RSIDs are not always unique, duplicates should be removed.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.5 Reference panel allele frequencies<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Generate a tab-delimited file of the reference panel allele frequencies, one variant per line, with columns CHR, SNP (in format CHR_POS_REF_ALT), REF, ALT, AF (including the header line).<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">First, update (or add) AF values in the INFO field, calculate it with BCFtools plugin +fill-tags:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Extract the wanted fields from each VCF file and combine as a single output file with the header:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-style:italic;\">Note: Chromosome notation in the panel.frq file should follow the GRCh38\/hg38 notations ('chr#' for autosomal chromosomes and 'chrX' for chromosome 23).<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.6 Create binary reference panel files<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The phased reference panel files per chromosome are required in bref format (bref = binary reference). For more information, see Beagle documentation at Beagle site:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">https:\/\/faculty.washington.edu\/browning\/beagle\/bref.16Dec15.pdf<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span>The required <\/span><span style = \"font-weight:bold;\">bref.*.jar<\/span><span> is downloaded from Beagle site:<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Use the processed imputation reference panel VCFs as inputs for the example command below. <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The output files have the suffix '.bref' instead of '.vcf.gz'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.7 Generate a list of the reference panel sample IDs<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">List of sample IDs present in the reference panel, one line per sample ID can be generated from any of the VCF files as in the example below (assuming that all chromosomes contain the same set of samples):<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.4. You are ready to start! <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">As the last prepatory step, let's go over the required input data file(s) and also expected final output files!<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.4.1 Input file:<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Post-QC chip genotype data in VCFv4.2 format and chrX genotypes as diploid genotypes:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">DATASET.vcf.gz<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;font-style:italic;\">Note: Chromosome notation should follow the GRCh38\/hg38 notations (e.g. 'chr#' for autosomal chromosomes, 'chrX', 'chrY' and 'chrM').<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;font-style:italic;\">Note: If the input data was lifted over from an older genome build to build version 38, cautious inspection of the data is highly recommended before proceeding with the protocol.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;font-style:italic;\">Note: If chrX is represented as haploid genotypes, follow step 1.3.3 first 'bcftools +fixploidy' command (not the other two piped commands) to convert to diploid genotypes.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.4.2 Final output files:<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">DATASET_imputed_info_chr#.vcf.gz (where # is chromosome number)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">DATASET_postimputation_summary_plots.pdf<\/li><\/ul><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">1.3. Imputation reference panel files<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">1.3.1 Obtain the reference panel files<\/span><\/div><div class = \"text-block\">For increased imputation accuracy, we recommend using a population-specific imputation reference panel, if available.<\/div><div class = \"text-block\">If population-specific reference data is not available, for instance 1000 Genomes Project (1000 GP) (<\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">www.nature.com\/articles\/nature15393<\/span><\/a><\/div><div class = \"text-block\">) data can be used instead.<\/div><div class = \"text-block\">GRCh38\/hg38 files are available at EBI 1000 genomes ftp site: <\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">ftp:\/\/ftp.1000genomes.ebi.ac.uk\/vol1\/ftp\/release\/20130502\/supporting\/GRCh38_positions\/<\/span><\/a><\/div><div class = \"text-block\">GRCh37\/hg19 files are available at Beagle site already processed to be compatible with Beagle:<\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">http:\/\/bochet.gcc.biostat.washington.edu\/beagle\/1000_Genomes_phase3_v5a\/b37.bref\/<\/span><\/a><\/div><div class = \"text-block\">The 1000 GP files can be downloaded for instance with command:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">NOTE: <\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">The reference panel files should contain: <\/span><\/div><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">phased genotypes,<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">chromosome names with 'chr' and chromosome X as 'chrX', <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">all variants as biallelic records,<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">only SNPs and INDELs,<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">only unique variants, <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">non-missing data,<\/span><span style = \"font-weight:bold;\"> <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">chrX as diploid genotypes, and<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">only unique IDs<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">If your reference panel files are not in the correct format, see some suggested processing commands below.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.2 Minimum quality control<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Here, we have piped most of the processing steps together in order to save significant amount of time by avoiding writing out multiple intermediate files. If your imputation reference panel does not require all the steps, modify the command accordingly.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">For 1000GP data:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Generate a text file containing space-spearated old and new chromosome names. This is required to rename the numerical chromosome names with 'chr' tag. Apply the new chromosome names with 'bcftools annotate'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Remove the rare variants, here singletons and doubletons by setting AC threshold with 'bcftools view'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Split multiallelic sites to biallelic records with 'bcftools norm'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Keep only SNPs and INDELs with 'bcftools view'. Here, the 1000GP data included a tag VT in the INFO field and data contain also structural variants which should be excluded.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Align the variants to reference genome with 'bcftools norm' in order to have the REF and ALT alleles in the shortest possible representation and to confirm that the REF allele matches the reference genome, additionally remove duplicate variants (-d none).<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">After alignment, remove multiallelic records with 'bcftools view', since these are formed during the alignment if the REF does not match with the reference genome.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Finally, remove sites containing missing data with 'bcftools view'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.3 Convert haploid genotypes to homozygous diploids<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Often chrX is represented as haploid genotypes for males, however, Beagle can only handle diploid genotypes. <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The command here produces unphased diploid genotypes. But since the haploid genotypes are in diploid format as REF\/REF or ALT\/ALT, we can simply set the phase for those alleles with a simple sed replacement. <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The chrX ploidy can be corrected as follows:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.4 Duplicate ID removal<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span>Remove duplicate IDs. If you wish to preserve all multiallelic sites, replace the ID column with a unique ID e.g. CHR_POS_REF_ALT (as indicated in <\/span><span style = \"font-weight:bold;\">Step 1.3.2<\/span><span>). <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Here, 1000GP did not contain multiallelic sites after AC filtering, and thus, RSIDs were preserved in the ID column. And since RSIDs are not always unique, duplicates should be removed.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.5 Reference panel allele frequencies<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Generate a tab-delimited file of the reference panel allele frequencies, one variant per line, with columns CHR, SNP (in format CHR_POS_REF_ALT), REF, ALT, AF (including the header line).<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">First, update (or add) AF values in the INFO field, calculate it with BCFtools plugin +fill-tags:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Extract the wanted fields from each VCF file and combine as a single output file with the header:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-style:italic;\">Note: Chromosome notation in the panel.frq file should follow the GRCh38\/hg38 notations ('chr#' for autosomal chromosomes and 'chrX' for chromosome 23).<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.6 Create binary reference panel files<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The phased reference panel files per chromosome are required in bref format (bref = binary reference). For more information, see Beagle documentation at Beagle site:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">https:\/\/faculty.washington.edu\/browning\/beagle\/bref.16Dec15.pdf<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span>The required <\/span><span style = \"font-weight:bold;\">bref.*.jar<\/span><span> is downloaded from Beagle site:<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Use the processed imputation reference panel VCFs as inputs for the example command below. <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">The output files have the suffix '.bref' instead of '.vcf.gz'.<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.3.7 Generate a list of the reference panel sample IDs<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">List of sample IDs present in the reference panel, one line per sample ID can be generated from any of the VCF files as in the example below (assuming that all chromosomes contain the same set of samples):<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.4. You are ready to start! <\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">As the last prepatory step, let's go over the required input data file(s) and also expected final output files!<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.4.1 Input file:<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">Post-QC chip genotype data in VCFv4.2 format and chrX genotypes as diploid genotypes:<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">DATASET.vcf.gz<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;font-style:italic;\">Note: Chromosome notation should follow the GRCh38\/hg38 notations (e.g. 'chr#' for autosomal chromosomes, 'chrX', 'chrY' and 'chrM').<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;font-style:italic;\">Note: If the input data was lifted over from an older genome build to build version 38, cautious inspection of the data is highly recommended before proceeding with the protocol.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;font-style:italic;\">Note: If chrX is represented as haploid genotypes, follow step 1.3.3 first 'bcftools +fixploidy' command (not the other two piped commands) to convert to diploid genotypes.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.4.2 Final output files:<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">DATASET_imputed_info_chr#.vcf.gz (where # is chromosome number)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">DATASET_postimputation_summary_plots.pdf<\/li><\/ul><\/div><div class = \"text-block\">If your reference panel files are not in the correct format, see some suggested processing commands below.<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">1.3.2 Minimum quality control<\/span><\/div><div class = \"text-block\">Here, we have piped most of the processing steps together in order to save significant amount of time by avoiding writing out multiple intermediate files. If your imputation reference panel does not require all the steps, modify the command accordingly.<\/div><div class = \"text-block\">For 1000GP data:<\/div><div class = \"text-block\"><ol style = \"list-style-type: decimal;\"><li style = \"counter-reset:ol0;\">Generate a text file containing space-spearated old and new chromosome names. This is required to rename the numerical chromosome names with 'chr' tag. Apply the new chromosome names with 'bcftools annotate'.<\/li><li style = \"counter-reset:ol0;\">Remove the rare variants, here singletons and doubletons by setting AC threshold with 'bcftools view'.<\/li><li style = \"counter-reset:ol0;\">Split multiallelic sites to biallelic records with 'bcftools norm'.<\/li><li style = \"counter-reset:ol0;\">Keep only SNPs and INDELs with 'bcftools view'. Here, the 1000GP data included a tag VT in the INFO field and data contain also structural variants which should be excluded.<\/li><li style = \"counter-reset:ol0;\">Align the variants to reference genome with 'bcftools norm' in order to have the REF and ALT alleles in the shortest possible representation and to confirm that the REF allele matches the reference genome, additionally remove duplicate variants (-d none).<\/li><li style = \"counter-reset:ol0;\">After alignment, remove multiallelic records with 'bcftools view', since these are formed during the alignment if the REF does not match with the reference genome.<\/li><li style = \"counter-reset:ol0;\">Finally, remove sites containing missing data with 'bcftools view'.<\/li><\/ol><\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><div class = \"text-block\">If multiallelic sites are present in your data, in order to preserve them throughout the protocol, set ID field with unique IDs e.g. in format CHR_POS_REF_ALT. (RSIDs might contain duplicates, when the multiallelic sites are decomposed.)<\/div><\/div><\/code><\/pre><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">1.3.3 Convert haploid genotypes to homozygous diploids<\/span><\/div><div class = \"text-block\">Often chrX is represented as haploid genotypes for males, however, Beagle can only handle diploid genotypes. <\/div><div class = \"text-block\">The command here produces unphased diploid genotypes. But since the haploid genotypes are in diploid format as REF\/REF or ALT\/ALT, we can simply set the phase for those alleles with a simple sed replacement. <\/div><div class = \"text-block\">The chrX ploidy can be corrected as follows:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">1.3.4 Duplicate ID removal<\/span><\/div><div class = \"text-block\"><span>Remove duplicate IDs. If you wish to preserve all multiallelic sites, replace the ID column with a unique ID e.g. CHR_POS_REF_ALT (as indicated in <\/span><span style = \"font-weight:bold;\">Step 1.3.2<\/span><span>). <\/span><\/div><div class = \"text-block\">Here, 1000GP did not contain multiallelic sites after AC filtering, and thus, RSIDs were preserved in the ID column. And since RSIDs are not always unique, duplicates should be removed.<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">1.3.5 Reference panel allele frequencies<\/span><\/div><div class = \"text-block\">Generate a tab-delimited file of the reference panel allele frequencies, one variant per line, with columns CHR, SNP (in format CHR_POS_REF_ALT), REF, ALT, AF (including the header line).<\/div><div class = \"text-block\">First, update (or add) AF values in the INFO field, calculate it with BCFtools plugin +fill-tags:<\/div><div class = \"text-block\">Extract the wanted fields from each VCF file and combine as a single output file with the header:<\/div><div class = \"text-block\"><span style = \"font-style:italic;\">Note: Chromosome notation in the panel.frq file should follow the GRCh38\/hg38 notations ('chr#' for autosomal chromosomes and 'chrX' for chromosome 23).<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">1.3.6 Create binary reference panel files<\/span><\/div><div class = \"text-block\">The phased reference panel files per chromosome are required in bref format (bref = binary reference). For more information, see Beagle documentation at Beagle site:<\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/faculty.washington.edu\/browning\/beagle\/bref.16Dec15.pdf<\/span><\/a><\/div><div class = \"text-block\">.<\/div><div class = \"text-block\"><span>The required <\/span><span style = \"font-weight:bold;\">bref.*.jar<\/span><span> is downloaded from Beagle site:<\/span><\/div><div class = \"text-block\">Use the processed imputation reference panel VCFs as inputs for the example command below. <\/div><div class = \"text-block\">The output files have the suffix '.bref' instead of '.vcf.gz'.<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">1.3.7 Generate a list of the reference panel sample IDs<\/span><\/div><div class = \"text-block\">List of sample IDs present in the reference panel, one line per sample ID can be generated from any of the VCF files as in the example below (assuming that all chromosomes contain the same set of samples):<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">1.4. You are ready to start! <\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">As the last prepatory step, let's go over the required input data file(s) and also expected final output files!<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">1.4.1 Input file:<\/span><\/div><div class = \"text-block\">Post-QC chip genotype data in VCFv4.2 format and chrX genotypes as diploid genotypes:<\/div><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\">DATASET.vcf.gz<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;font-style:italic;\">Note: Chromosome notation should follow the GRCh38\/hg38 notations (e.g. 'chr#' for autosomal chromosomes, 'chrX', 'chrY' and 'chrM').<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;font-style:italic;\">Note: If the input data was lifted over from an older genome build to build version 38, cautious inspection of the data is highly recommended before proceeding with the protocol.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;font-style:italic;\">Note: If chrX is represented as haploid genotypes, follow step 1.3.3 first 'bcftools +fixploidy' command (not the other two piped commands) to convert to diploid genotypes.<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"> <\/li><li style = \"counter-reset:ol0;list-style-type:disc;\"><span style = \"font-weight:bold;\">1.4.2 Final output files:<\/span><\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">DATASET_imputed_info_chr#.vcf.gz (where # is chromosome number)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">DATASET_postimputation_summary_plots.pdf<\/li><\/ul><\/div><div class = \"text-block\"><span style = \"font-weight:bold;font-style:italic;\">Note: Chromosome notation should follow the GRCh38\/hg38 notations (e.g. 'chr#' for autosomal chromosomes, 'chrX', 'chrY' and 'chrM').<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;font-style:italic;\">Note: If the input data was lifted over from an older genome build to build version 38, cautious inspection of the data is highly recommended before proceeding with the protocol.<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;font-style:italic;\">Note: If chrX is represented as haploid genotypes, follow step 1.3.3 first 'bcftools +fixploidy' command (not the other two piped commands) to convert to diploid genotypes.<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">1.4.2 Final output files:<\/span><\/div><div class = \"text-block\"><ul style = \"list-style-type:disc;\"><li style = \"counter-reset:ol0;list-style-type:disc;\">DATASET_imputed_info_chr#.vcf.gz (where # is chromosome number)<\/li><li style = \"counter-reset:ol0;list-style-type:disc;\">DATASET_postimputation_summary_plots.pdf<\/li><\/ul><\/div><div class = \"text-block\"><span style = \"font-style:italic;\">Note: Several intermediate files are created during the protocol. Those files can be used for troubleshooting and deleted once the successful imputation is confirmed.<\/span><\/div><\/div>"}},{"id":1054725,"guid":"ADDA66504BC611E9B85011B082D47038","order_id":2,"type_id":15,"title":"command","source":{"name":"docker pull seqinfoteam\/genotype-liftover-imputation-protocols:<tag>","command":"","os_name":"","os_version":""}},{"id":1054726,"guid":"DD2A728030F811E9A9B49D8B50117E56","order_id":3,"type_id":15,"title":"command","source":{"name":"echo PATH=\/path\/to\/bcftools\/:\/path\/to\/R\/:\/path\/to\/eagle\/:$PATH \\\n>> $HOME\/.bashrc\n\nsource $HOME\/.bashrc","command":"","os_name":"","os_version":""}},{"id":1054727,"guid":"4105581030F911E9AD33C50682547CCC","order_id":4,"type_id":15,"title":"command","source":{"name":"echo export BCFTOOLS_PLUGINS=\/path\/to\/bcftools\/plugins \\\n>> $HOME\/.bashrc\n\nsource $HOME\/.bashrc","command":"","os_name":"","os_version":""}},{"id":1054728,"guid":"6A8371E030F911E9AD33C50682547CCC","order_id":5,"type_id":15,"title":"command","source":{"name":"install.packages('data.table', type = 'source', \nrepos = 'http:\/\/Rdatatable.github.io\/data.table')","command":"","os_name":"","os_version":""}},{"id":1054729,"guid":"DE35279030FF11E9AD33C50682547CCC","order_id":6,"type_id":15,"title":"command","source":{"name":"for CHR in {1..23}; do\n    zcat genetic_map_hg38_withX.txt.gz | \\\n    grep ^${CHR} | \\\n    sed '1ichr position COMBINED_rate(cM\/Mb) Genetic_Map(cM)' \\\n    > eagle_chr${CHR}_b38.map\ndone","command":"","os_name":"","os_version":""}},{"id":1054730,"guid":"81716E5030FB11E9AD33C50682547CCC","order_id":7,"type_id":15,"title":"command","source":{"name":"# Unzip the files\nunzip plink.GRCh38.map.zip\n\n# Rename chromosome 23\nmv plink.chrX.GRCh38.map plink.chr23.GRCh38.map\n\n# Add 'chr' tag to the beginning of the line and \n# store the output with suitable filename\nfor CHR in {1..23}; do \n    cat plink.chr${CHR}.GRCh38.map | \\\n    sed 's\/^\/chr\/' \\\n    > beagle_chr${CHR}_b38.map\ndone","command":"","os_name":"","os_version":""}},{"id":1054731,"guid":"1E7DF0A030FD11E9AD33C50682547CCC","order_id":8,"type_id":15,"title":"command","source":{"name":"wget http:\/\/ftp.1000genomes.ebi.ac.uk\/vol1\/ftp\/release\/20130502\/supporting\/GRCh38_positions\/ALL.chr{{1..22},X}_GRCh38.genotypes.20170504.vcf.gz{,.tbi}","command":"","os_name":"","os_version":""}},{"id":1054732,"guid":"A0F9183035B611E9800E4108612186FC","order_id":9,"type_id":15,"title":"command","source":{"name":"# Fix the chromosome X ploidy to phased diploid\n# Requires a ploidy.txt file containing \n# space-separated CHROM,FROM,TO,SEX,PLOIDY \necho \"chrX 1 156040895 M 2\" > ploidy.txt\nbcftools +fixploidy \\\n    1000GP_chrX.vcf.gz -Ov -- -p ploidy.txt | \\\n    sed 's#0\/0#0\\|0#g;s#1\/1#1\\|1#g' | \\\nbcftools view -Oz -o 1000GP_chr23.vcf.gz\"","command":"","os_name":"","os_version":""}},{"id":1054733,"guid":"2CD4ED6038EC11E9AF6511A49689DBEE","order_id":10,"type_id":15,"title":"command","source":{"name":"for CHR in {1..23}; do\n    bcftools query -f '%ID\\n' 1000GP_chr${CHR}.vcf.gz | \\\n    sort | uniq -d > 1000GP_chr${CHR}.dup_id\n\n    if [[ -s 1000GP_chr${CHR}.dup_id ]]; then\n    \tbcftools view -e ID=@1000GP_chr${CHR}.dup_id \\\n    \t1000GP_chr${CHR}.vcf.gz \\\n        -Oz -o 1000GP_filtered_chr${CHR}.vcf.gz\n    else \n    \tmv 1000GP_chr${CHR}.vcf.gz \\\n        1000GP_filtered_chr${CHR}.vcf.gz\n    fi\ndone","command":"","os_name":"","os_version":""}},{"id":1054734,"guid":"7E8B4F70312911E98A9C351215C94C60","order_id":11,"type_id":15,"title":"command","source":{"name":"# Check if the VCF does NOT contain AF in the INFO field,\n# and calculate it with bcftools +fill-tags plugin\n\nfor CHR in {1..23}; do\n    bcftools +fill-tags \\\n        1000GP_filtered_chr${CHR}.vcf.gz \\\n        -Oz -o 1000GP_AF_chr${CHR}.vcf.gz -- -t AF\ndone","command":"","os_name":"","os_version":""}},{"id":1054735,"guid":"212856B0312A11E98A9C351215C94C60","order_id":12,"type_id":15,"title":"command","source":{"name":"# Generate a tab-delimited header\necho -e 'CHR\\tSNP\\tREF\\tALT\\tAF' \\\n    > 1000GP_imputation_all.frq\n\n# Query the required fields from the VCF file \n# and append to the allele frequency file \nfor CHR in {1..23}; do\n    bcftools query \\\n    -f '%CHROM\\t%CHROM\\_%POS\\_%REF\\_%ALT\\t%REF\\t%ALT\\t%INFO\/AF\\n' \\\n    1000GP_AF_chr${CHR}.vcf.gz \\\n    >> 1000GP_imputation_all.frq\ndone","command":"","os_name":"","os_version":""}},{"id":1054736,"guid":"04E1BF903A7C11E9AF6511A49689DBEE","order_id":13,"type_id":15,"title":"command","source":{"name":"wget https:\/\/faculty.washington.edu\/browning\/beagle\/bref.27Jan18.7e1.jar","command":"","os_name":"","os_version":""}},{"id":1054737,"guid":"32D092D0312D11E9AF39BF05142E5F6A","order_id":14,"type_id":15,"title":"command","source":{"name":"# Convert each file to bref format\nfor CHR in {1..23}; do\n    java -jar \/path\/to\/bref.27Jan18.7e1.jar \\\n        1000GP_AF_chr${CHR}.vcf.gz\ndone","command":"","os_name":"","os_version":""}},{"id":1054738,"guid":"7946682038EE11E9AF6511A49689DBEE","order_id":15,"type_id":15,"title":"command","source":{"name":"bcftools query -l 1000GP_AF_chr22.vcf.gz \\\n    > 1000GP_sample_IDs.txt","command":"","os_name":"","os_version":""}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":700223,"guid":"C9475F2000C14B35BF2090F0B20ACCC0","previous_id":700224,"previous_guid":"0335C0DC6FD2430B915FC8569FEF1193","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"34118282520E4E4E9D8D25B221A200B7","order_id":1,"type_id":6,"title":"Section","source":{"title":"Chip data validation and VCF formatting"}},{"id":1054724,"guid":"29089ED509BC449D947CEAA108D67148","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Align the variant alleles to human reference genome to correct for any dataset-specific REF\/ALT flips.\n\nEnsure that only biallelic sites are kept in the chip data, as 'bcftools norm' may introduce false multiallelic sites if the REF does not match to the reference genome.\n\nFinally, replace the ID column with an 'SNP ID' in format CHR_POS_REF_ALT ie. chromosome_position_<reference allele>_<alternative allele>.<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Input files:<\/span><\/div><div class = \"text-block\"><span>\u2022 DATASET_chrfiltered.vcf.gz (<\/span><span style = \"font-weight:bold;\">Step 2<\/span><span>)<\/span><\/div><div class = \"text-block\"><span>\u2022 Homo_sapiens_assembly38.fasta or another wanted reference genome file (<\/span><span style = \"font-weight:bold;\">Step 1.2.1<\/span><span>)<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Outpt file:<\/span><\/div><div class = \"text-block\">\u2022 DATASET_SNPID.vcf.gz<\/div><div class = \"text-block\"><span style = \"font-style:italic;\">Note: Confirm the results for example by comparing the input and output file sizes and line counts.<\/span><\/div><\/div>"}},{"id":1054725,"guid":"D1889331D0854E6FBA664C8EC36F6F0D","order_id":2,"type_id":15,"title":"command","source":{"name":"DATASET=your_dataset_prefix\nFASTA=\/path\/to\/your\/reference_genome.fasta\n\n# Align the alleles to the reference genome, \n# and keep only biallelic records\nbcftools norm -f ${FASTA} -c ws \\\n    ${DATASET}_chrfiltered.vcf.gz -Ou | \\\nbcftools view -m 2 -M 2 \\\n    -Oz -o ${DATASET}_refcorrected.vcf.gz\n\n# Replace the ID column with a CHR_POS_REF_ALT\nbcftools annotate \\\n    --set-id '%CHROM\\_%POS\\_%REF\\_%ALT' \\\n    ${DATASET}_refcorrected.vcf.gz \\\n    -Oz -o ${DATASET}_SNPID.vcf.gz","command":"bcftools norm parameters:\n-f reference genome\n-c what to do when incorrect\/missing REF allele is encountered:\nws warn (w) and set\/fix (s) bad sites\nbcftools view\n-m minimum number of alleles listed in REF and ALT columns\n-M maximum number of alleles listed in REF and ALT columns\n-Ou uncompressed output\n-Oz compressed output\nbcftools annotate parameter:\n--set-id set ID column, % indicates a VCF field","os_name":"","os_version":""}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":700224,"guid":"0335C0DC6FD2430B915FC8569FEF1193","previous_id":700222,"previous_guid":"3A2F0E0A1BB0470AB8A10886EFCF51BC","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"754132DBD7F84B08B91D62F2F5846D74","order_id":1,"type_id":6,"title":"Section","source":{"title":"Chip data validation and VCF formatting"}},{"id":1054724,"guid":"89B8ADEBE9A24EF18BCAFE94189EF2D4","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Only autosomal and X chromosomes are kept for the imputation.<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Input file:<\/span><\/div><div class = \"text-block\">\u2022 DATASET.vcf.gz (your QC'ed genotyping chip data in VCFv4.2 format, chrX as diploid genotypes)<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Outpt file:<\/span><\/div><div class = \"text-block\">\u2022 DATASET_chrfiltered.vcf.gz<\/div><div class = \"text-block\"><span style = \"font-style:italic;\">Note: Confirm the results for example by comparing the input and output file sizes and line counts.<\/span><\/div><\/div>"}},{"id":1054725,"guid":"82828459DC824045A86595D2F3B1300D","order_id":2,"type_id":15,"title":"command","source":{"name":"DATASET=your_dataset_prefix\n# A comma-separated string of chrs to keep\nchrs=$(echo chr{1..22} chrX | tr ' ' ',')\n\n# Keep only those wanted chromosomes\nbcftools view -t $chrs ${DATASET}.vcf.gz \\\n    -Oz -o ${DATASET}_chrfiltered.vcf.gz","command":"bcftools view parameters:\n-t targets\n-Oz compressed output","os_name":"","os_version":""}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":700225,"guid":"AA45420D698540FEBA57F58ED8174A17","previous_id":700223,"previous_guid":"C9475F2000C14B35BF2090F0B20ACCC0","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"AB23AB2888DF4B85B7E7DF5C7595CB5F","order_id":1,"type_id":6,"title":"Section","source":{"title":"Chip data validation and VCF formatting"}},{"id":1054724,"guid":"A5DD9A1000204BF9B1D32C27C3D0A6C7","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Ensure that duplicate individuals do not exist in the chip data or between the chip and the imputation reference panel. Furthermore, ensure that there are no duplicate variants (these might appear in some chip genotype datasets and after reference genome alignment). Both sample and variant duplicates would compromise the imputation.<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Input files:<\/span><\/div><div class = \"text-block\"><span>\u2022 DATASET_SNPID.vcf.gz (<\/span><span style = \"font-weight:bold;\">Step 3<\/span><span>)<\/span><\/div><div class = \"text-block\"><span>\u2022 panel_sample_IDs.txt (<\/span><span style = \"font-weight:bold;\">Step 1.3.7<\/span><span>)<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Outpt file:<\/span><\/div><div class = \"text-block\">\u2022 DATASET_noduplicate_variants.vcf.gz<\/div><div class = \"text-block\"><span style = \"font-style:italic;\">Note: Confirm the results for example by comparing the input and output file sizes and line counts.<\/span><\/div><\/div>"}},{"id":1054725,"guid":"C38332174EC44ABFB460E174D44740A4","order_id":2,"type_id":15,"title":"command","source":{"name":"DATASET=your_dataset_prefix\nPANEL_ID=panel_sample_IDs.txt\n\n# Copy the panel sample ID file with \n# a different name to the working directory\ncp ${PANEL_ID} duplicate_sample_IDs.txt\n\n# Generate a list of chip data sample IDs, \n# keep only duplicates and \n# append to the list of panel sample IDs\nbcftools query -l ${DATASET}_SNPID.vcf.gz | \\\n    uniq -d >> duplicate_sample_IDs.txt\n\n# Exclude duplicate samples and MAC=0 variants, \n# and update AF value after sample removals.\n# Finally, exclude duplicate variants\nbcftools view -S ^duplicate_sample_IDs.txt \\\n   --force-samples ${DATASET}.vcf.gz -Ou | \\\nbcftools +fill-tags -Ou -- -t AC,AN,AF | \\\nbcftools norm -d none \\\n    -Oz -o ${DATASET}_noduplicate_variants.vcf.gz","command":"bcftools query parameters:\n-l list of sample IDs\nuniq\n-d only print duplicate lines\nbcftools view parameters:\n-S file of sample IDs to include\n^ exclusion prefix\n--force-samples only warn about unknown subset of samples\n-Ou uncompressed output\n+fill-tags plugin specific parameters after --\n-t tags to be updated, here AC, AN and AF\n-Oz compressed output","os_name":"","os_version":""}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":700227,"guid":"20B352F4AEF84B05B2B8B322B790B588","previous_id":700225,"previous_guid":"AA45420D698540FEBA57F58ED8174A17","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"3EE093020ED34A87A0C924C525E5BD95","order_id":1,"type_id":6,"title":"Section","source":{"title":"Chip data validation and VCF formatting"}},{"id":1054724,"guid":"67704DD016A5412C8867A4890E82CE27","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Exclude rare variants (redundant step if they are already removed in quality control steps taken before this protocol).<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Input file:<\/span><\/div><div class = \"text-block\"><span>\u2022 DATASET_noduplicate_variants.vcf.gz (<\/span><span style = \"font-weight:bold;\">Step 4<\/span><span>)<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Outpt file:<\/span><\/div><div class = \"text-block\">\u2022 DATASET_AF.vcf.gz<\/div><div class = \"text-block\"><span style = \"font-style:italic;\">Note: Confirm the results for example by comparing the input and output file sizes and line counts.<\/span><\/div><\/div>"}},{"id":1054725,"guid":"0B9BC2A862B9412CA0E84421051863D2","order_id":2,"type_id":15,"title":"command","source":{"name":"DATASET=your_dataset_prefix\n\n# Remove low allele count variants \n# (redundant if they are already removed)\nbcftools view -e 'INFO\/AC<3 | (INFO\/AN-INFO\/AC)<3' \\\n    ${DATASET}_noduplicate_variants.vcf.gz \\\n    -Oz -o ${DATASET}_AF.vcf.gz","command":"bcftools view parameters:\n-e exclude based on expression\n-Oz compressed output","os_name":"","os_version":""}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":700228,"guid":"AB459A0DE04A4B48A42625BC28951B8D","previous_id":700227,"previous_guid":"20B352F4AEF84B05B2B8B322B790B588","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"5236433612C5404C9BAFC9E64F84D66D","order_id":1,"type_id":6,"title":"Section","source":{"title":"Chip data validation and VCF formatting"}},{"id":1054724,"guid":"A4A45ECB219B48898CFEE5F84752AFA8","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Generate a frequency file for the chip data and the imputation reference panel allele frequency comparison.<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Input file:<\/span><\/div><div class = \"text-block\"><span>\u2022 DATASET_AF.vcf.gz (<\/span><span style = \"font-weight:bold;\">Step 5<\/span><span>)<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Outpt file:<\/span><\/div><div class = \"text-block\">\u2022 DATASET_chip.frq<\/div><\/div>"}},{"id":1054725,"guid":"E70B2C58A16E4B8BBEB1347B74F5D40D","order_id":2,"type_id":15,"title":"command","source":{"name":"DATASET=your_dataset_prefix\n\n# Generate a tab-delimited header\necho -e 'CHR\\tSNP\\tREF\\tALT\\tAF' \\\n    > ${DATASET}_chip.frq\n\n# Query the required fields from the VCF file \n# and append to the allele frequency file\nbcftools query \\\n    -f '%CHROM\\t%ID\\t%REF\\t%ALT\\t%INFO\/AF\\n' \\\n    ${DATASET}_AF.vcf.gz \\\n    >> ${DATASET}_chip.frq","command":"echo parameter:\n-e enable interpretation of backslash escapes\nbcftools query parameter and syntax:\n-f format, where\n%field refers to a column in VCF file\nexpression '%CHROM\\t%ID\\t%REF\\t%ALT\\t%INFO\/AF\\n' generates for each variant line a tab-delimited format of:\nCHR, CHR_POS_REF_ALT, REF, ALT, AF","os_name":"","os_version":""}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":700229,"guid":"D6FFBF909A9E4EA7AEA269E56F1A67C9","previous_id":700228,"previous_guid":"AB459A0DE04A4B48A42625BC28951B8D","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"8BA60F54E57443FC9202B84305CC4C4F","order_id":1,"type_id":6,"title":"Section","source":{"title":"Chip data validation and VCF formatting"}},{"id":1054724,"guid":"6B772BB98E074B2189B596E8F65D2CFF","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Compare the chip data and the imputation reference panel allele frequencies and generate an exclusion list of those variants where AF values differ more than 10 pp or their log2 fold change is >5 or <-5. <\/div><div class = \"text-block\"><span>Variants showing highly discrepant AF frequency will be excluded (in the next step). Confirm from the plot that number of concordant variants is high (preferably >300k) to ensure successful phasing (in <\/span><span style = \"font-weight:bold;\">Step 9<\/span><span>). <\/span><\/div><div class = \"text-block\">Copy and save the R script below as 'plot_AF.R'.<\/div><div class = \"text-block\">Set the script as executable for instance with 'chmod +x plot_AF.R' before running it for the first time.<\/div><div class = \"text-block\">Run the script as indicated in the example command below. <\/div><div class = \"text-block\">Here, we use 0.1 as a threshold for AF difference and 5 for the log2 fold change e.g. if chip data AF differs more than 10 pp from the reference data AF, it is marked as discordant. However, less conservative values may be more suitable if a population specific reference data is not available.<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Input files:<\/span><\/div><div class = \"text-block\"><span>\u2022 DATASET_chip.frq (<\/span><span style = \"font-weight:bold;\">Step 6<\/span><span>)<\/span><\/div><div class = \"text-block\"><span>\u2022 panel.frq (<\/span><span style = \"font-weight:bold;\">Step 1.3.5<\/span><span>)<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Outpt files:<\/span><\/div><div class = \"text-block\">\u2022 DATASET_AFs.png<\/div><div class = \"text-block\">\u2022 DATASET_exclude.txt<\/div><div class = \"text-block\">\u2022 DATASET_nonpanel_exclude.txt<\/div><div class = \"text-block\">Additional output files:<\/div><div class = \"text-block\">\u2022 DATASET_panel_isec.txt<\/div><div class = \"text-block\">\u2022 DATASET_discrepant_AF.txt<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">!! Inspect the generated plots before proceeding to the next step:<\/span><\/div><div class = \"text-block\">See in the expected results section at the end of this step, for examples of plots from a high-quality dataset.<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Left plot<\/span><\/div><div class = \"text-block\">Comparison of the chip AF values to the panel AF values. Ideally, it should show a quite tight, uniform diagonal line of increasing slope 1. Variants with AF values differing more than 10 pp or log2 fold change >5 or <-5 are marked with red color and included into the exclusion list. See also the number of non-panel variants which should not be high in comparison to concordant variant count. with a population-specific <\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Right plot<\/span><\/div><div class = \"text-block\">Distribution of the AF values. Ideally the histogram should be smooth and skewed towards the smallest AF values.<\/div><\/div>"}},{"id":1054725,"guid":"A20AEB7554834E8C894200813ED4D146","order_id":2,"type_id":15,"title":"command","source":{"name":"DATASET=your_dataset_prefix\nPANEL_FRQ=\/path\/to\/panel.frq\n\n# Copy and save the given 'plot_AF.R' file and run it with:\nRscript --no-save \/path\/to\/plot_AF.R \\\n    ${DATASET}_chip.frq \\\n    ${DATASET} \\\n    ${PANEL_FRQ} \\\n    0.1 \\\n    5","command":"","os_name":"","os_version":""}},{"id":1054726,"guid":"AB18422663B548569AE00302DAFB68C2","order_id":3,"type_id":15,"title":"command","source":{"name":"#!\/bin\/env Rscript --no-save\n\n# Required packages\n# install.packages(\"data.table\")\nlibrary(data.table) # For fast fread()\n\n# Input variables\nargs <- commandArgs(TRUE)\ninfrq <- args[1] # Full path to chip data .frq file\nindataset <- args[2] # Dataset name prefix\nsub_dataset <- basename(indataset) # Subset the dataset name\nref_panel <- args[3] # Full path to reference panel .frq file\naf_diff <- as.numeric(args[4]) # Max AF difference to panel\naf_fc <- as.numeric(args[5]) # Max AF fold change to panel\n\n# Read in the frequency files\nchip <- fread(infrq, header = TRUE)\npanel <- fread(ref_panel, header = TRUE)\n\n# Take an intersection of the panel and chip data \n# based on SNP column (in format CHR_POS_REF_ALT)\nisec <- merge(panel, chip, by = c(\"CHR\", \"SNP\", \"REF\", \"ALT\"))\ncolnames(isec)[c(5,6)] <- c(\"AF_PANEL\", \"AF_CHIP\")\n\nisec$AF_diff <- abs(isec$AF_PANEL - isec$AF_CHIP)\nisec$AF_ratio <- isec$AF_CHIP\/isec$AF_PANEL\nisec$AF_FC <- log2(isec$AF_ratio)\n\n# Check if AFs are within the pp and fold change ranges\naf_ok <- ((isec$AF_diff < af_diff) & \n         ((isec$AF_FC < af_fc) & (isec$AF_FC > -af_fc)))\n\nexclude <- !af_ok\n\n# Generate an exclusion list for variants not in the panel\nnonpanel <- chip[!(chip$SNP) %in% (isec$SNP)]\n# Generate AF list for discordant variants\naf_discrepant <- isec[exclude]\n\n# Save the plots as png\npng(paste0(sub_dataset, \"_AFs.png\"), \n    width = 1200, height = 600)\n    par(mfrow = c(1,2)) \n    par(cex.axis = 1.6, cex.lab = 1.5, cex.main = 1.6)\n\n    # Plot first all and then excludable variants\n    plot(isec$AF_PANEL, isec$AF_CHIP, col=1, pch=20, \n           main=paste0(\"Chip data AF vs. reference panel AF\\n\", \n           sub_dataset), \n           xlab=\"Panel AF\", ylab=\"Chip AF\")\n    points(isec[exclude]$AF_PANEL, isec[exclude]$AF_CHIP, \n            col=2, pch=20)\n    # Draw a legend\n    legend(\"topleft\", legend=c(\n           paste0(\"Concordant AF, n = \", nrow(isec[!exclude])), \n           paste0(\"Discordant AF, n = \", nrow(isec[exclude])), \n           paste0(\"Non-panel, n = \", nrow(nonpanel))), \n           col=c(\"black\", \"red\", \"white\"), pch=20, cex=1.2)\n\n    # Add chip AF histogram to the same png\n    hist(isec[!exclude]$AF_CHIP, breaks=100, \n            main=paste0(\"Chip AF for concordant variants\\n\", \n            sub_dataset), \n            xlab=\"Chip AF\")\ndev.off()\n\n# Write out the exclusion lists (SNPID for bcftools)\n# Highly discrepant AF values\nwrite.table(isec[exclude]$SNP, \n        paste0(sub_dataset, \"_exclude.txt\"), \n        quote=F, row.names=F, col.names=F)\n# Variants noit present in the reference panel\nwrite.table(nonpanel$SNP, \n        paste0(sub_dataset, \"_nonpanel_exclude.txt\"), \n        quote=F, row.names=F, col.names=F)\n\n# Write out the isec without exclusions \nwrite.table(isec[!exclude]$SNP, \n        paste0(sub_dataset, \"_panel_isec.txt\"), \n        quote=F, row.names=F, col.names=F)\n\n# Write out the discrepant AFs in case needed\nwrite.table(af_discrepant, \n        paste0(sub_dataset, \"_discrepant_AF.txt\"), \n        quote = F, row.names = F, sep = \"\\t\")","command":"","os_name":"plot_AF.R","os_version":""}},{"id":1054727,"guid":"72C186558F974EF7A70091D8F33D725B","order_id":4,"type_id":17,"title":"result","source":{"body":"<div class = \"text-blocks\"><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/pr-journal\/bd8ca.png\" \/><\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":700230,"guid":"8C569838A8E74B609CBC84B2EA490B41","previous_id":700229,"previous_guid":"D6FFBF909A9E4EA7AEA269E56F1A67C9","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"F95B26CCBF6F4EDE9438E2BA65C46651","order_id":1,"type_id":6,"title":"Section","source":{"title":"Chip data validation and VCF formatting"}},{"id":1054724,"guid":"969B87063BC94A7C9ACC54BEF7B5F662","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Exclude the variants showing highly discordant allele frequencies or not present in the imputation reference panel as listed in the previous step.<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Input files:<\/span><\/div><div class = \"text-block\"><span>\u2022 DATASET_exclude.txt\u00a0(<\/span><span style = \"font-weight:bold;\">Step7<\/span><span>)<\/span><\/div><div class = \"text-block\"><span>\u2022 DATASET_nonpanel_exclude.txt\u00a0(<\/span><span style = \"font-weight:bold;\">Step 7<\/span><span>)<\/span><\/div><div class = \"text-block\"><span>\u2022 DATASET_AF.vcf.gz \u00a0(<\/span><span style = \"font-weight:bold;\">Step 5<\/span><span>)<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Outpt files:<\/span><\/div><div class = \"text-block\">\u2022 DATASET_exclusion1.txt<\/div><div class = \"text-block\">\u2022 DATASET_exclusion2.txt<\/div><div class = \"text-block\">\u2022 DATASET_for_phasing.vcf.gz<\/div><div class = \"text-block\"><span style = \"font-style:italic;\">Note: Confirm the results for example by comparing the input and output file sizes and line counts.<\/span><\/div><\/div>"}},{"id":1054725,"guid":"8B0EEA12572F42C88B238F626C2AFE96","order_id":2,"type_id":15,"title":"command","source":{"name":"DATASET=your_dataset_prefix\n\n# Sort the exclusion lists\nsort -V ${DATASET}_exclude.txt \\\n    > ${DATASET}_exclusion1.txt\nsort -V ${DATASET}_nonpanel_exclude.txt \\\n    > ${DATASET}_exclusion2.txt\n\n# Exclude the variants showing highly discrepant AF\nbcftools view -e ID=@${DATASET}_exclusion1.txt  \\\n    ${DATASET}_AF.vcf.gz \\\n    -Oz -o ${DATASET}_exclusion1.vcf.gz\n\n# Exclude the variants not present in the reference panel\nbcftools view -e ID=@${DATASET}_exclusion2.txt \\\n    ${DATASET}_discrepant_AF_excluded.vcf.gz \\\n    -Oz -o ${DATASET}_for_phasing.vcf.gz","command":"bcftools view parameters:\n-e exclusion\nexpression:\nID=@file IDs in indicated file\n-Oz compressed output","os_name":"","os_version":""}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":700231,"guid":"C3973706C32944A2827FC84B27FFDDAC","previous_id":700230,"previous_guid":"8C569838A8E74B609CBC84B2EA490B41","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"A1753DB509AF42B784CA3ABE4306A0E0","order_id":1,"type_id":6,"title":"Section","source":{"title":"Chip data pre-phasing"}},{"id":1054724,"guid":"B9314A917C254CC8AAF9C112E8155300","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Chip data pre-phasing will speed up the genotype imputation step.<\/div><div class = \"text-block\">Phase haplotypes for each chromosome separately before imputation. <\/div><div class = \"text-block\">Here, adjust the number of threads and parallelization of the phasing for each chromosomes according to your computing environment. We generally use 8 threads per chromosome and run all chromosomes in parallel distributed on 23 cores.<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Input files:<\/span><\/div><div class = \"text-block\"><span>\u2022 DATASET_for_phasing.vcf.gz (<\/span><span style = \"font-weight:bold;\">Step 8<\/span><span>)<\/span><\/div><div class = \"text-block\"><span>\u2022 eagle_chr#_b38.map (where # is chromosome number) (<\/span><span style = \"font-weight:bold;\">Step 1.2.2<\/span><span>)<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Outpt file:<\/span><\/div><div class = \"text-block\">\u2022 DATASET_for_imputation_chr#.vcf.gz (where # is chromosome number)<\/div><div class = \"text-block\"><span style = \"font-style:italic;\">Note: Confirm the results for example by comparing the input and output file sizes and line counts.<\/span><\/div><\/div>"}},{"id":1054725,"guid":"F9F3A8F00F874E32A0CAFBD77DC4A846","order_id":2,"type_id":15,"title":"command","source":{"name":"DATASET=your_dataset_prefix\n\n# Run phasing for each chromosome\nfor CHR in {1..23}; do \n\n    # Chromosome 23 is coded as 'chrX', \n    # whereas autosomal chrs are numbers alone\n    if [ \"$CHR\" == \"23\" ]; then\n          chrname=chrX\n    else\n          chrname=$CHR\n    fi\n\n    # Run phasing for each chromosome separately\n    eagle \\\n           --vcf ${DATASET}_for_phasing.vcf.gz \\\n           --chrom ${chrname} \\\n           --geneticMapFile eagle_chr${CHR}_b38.map \\\n           --numThreads=8 \\\n           --Kpbwt=20000 \\\n           --outPrefix ${DATASET}_for_imputation_chr${CHR} \ndone","command":"","os_name":"","os_version":""}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":700232,"guid":"A98B482DC36B4309B0BB7C6FFE06C21C","previous_id":700231,"previous_guid":"C3973706C32944A2827FC84B27FFDDAC","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"E367E7E8403B4AE19495FAE9F09C991D","order_id":1,"type_id":6,"title":"Section","source":{"title":"Genotype imputation"}},{"id":1054724,"guid":"C91B6949B7DB4CC59F6FA9B5F2795084","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Run genotype imputation for each chromosome separately. <\/div><div class = \"text-block\">Here, adjust the number of threads and parallelization of the imputation for each chromosomes according to your computing environment. We have observed the fastest runs by using 16 threads pre chromosome and running all chromosomes in parallel distributed on 23 cores.<\/div><div class = \"text-block\"><span style = \"font-style:italic;\">\n<\/span><span style = \"font-style:italic;\">NOTE: Chromosome X should be represented as diploid genotypes. If this is not the case, fix the ploidy with the example command from <\/span><span style = \"font-style:italic;font-weight:bold;\">Step 1.3.3<\/span><span style = \"font-style:italic;font-weight:bold;\">.<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Input files:<\/span><\/div><div class = \"text-block\"><span>\u2022 DATASET_for_imputation_chr#.vcf.gz (<\/span><span style = \"font-weight:bold;\">Step 9<\/span><span>)<\/span><\/div><div class = \"text-block\"><span>\u2022 panel_phased_AF_chr#.bref (where # is chromosome number) (<\/span><span style = \"font-weight:bold;\">Step 1.3.6<\/span><span>)<\/span><\/div><div class = \"text-block\"><span>\u2022 beagle_chr#_b38.map (where # is chromosome number) (<\/span><span style = \"font-weight:bold;\">Step 1.2.3<\/span><span>)<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Outpt file:<\/span><\/div><div class = \"text-block\">\u2022 DATASET_imputed_chr#.vcf.gz (where # is chromosome number)<\/div><\/div>"}},{"id":1054725,"guid":"132E9DE4762A4B889A5771D030BEAB76","order_id":2,"type_id":15,"title":"command","source":{"name":"DATASET=your_dataset_prefix\nBEAGLE_PATH=\/path\/to\/beagle\nREFERENCE_BREF=\/path\/to\/panel_phased_AF\n\n# Run imputation for each chromosome\nfor CHR in {1..23}; do \n\n    java -Xss5m -Xmx16g \\\n      -jar ${BEAGLE_PATH}\/beagle.27Jan18.7e1.jar \\\n        gt=${DATASET}_for_imputation_chr${CHR}.vcf.gz \\\n        ref=${REFERENCE_BREF}_chr${CHR}.bref \\\n        map=beagle_chr${CHR}_b38.map \\\n        out=${DATASET}_imputed_chr${CHR} \\\n        nthreads=16 \\\n        niterations=10 \\\n        ne=20000 \\\n        impute=true \\\n        gprobs=true \\\n        seed=-99999 \ndone","command":"beagle parameters:\ngt - a VCF file containing the genotypes\nref - a VCF file containing the phased reference genotypes\nmap - PLINK format genetic map on the cM scale\nout - output file prefix\nnthreads - number of threads\nniterations - number of phasing iterations\nne - effective population size when imputing ungenotyped markers\nimpute - whether markers that are present in the reference panel but absent in your data will be imputed\ngprobs - whether a GP format field (genotype probability) will be included in the output VCF file when imputing ungenotyped markers\nseed - seed for the random number generator","os_name":"","os_version":""}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":700233,"guid":"2E0AEB3AA4AB476486D25D2B75033602","previous_id":700232,"previous_guid":"A98B482DC36B4309B0BB7C6FFE06C21C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"2B476C2C911B46ADA77BD0B91ACB066C","order_id":1,"type_id":6,"title":"Section","source":{"title":"Post-imputation processing and quality assurance"}},{"id":1054724,"guid":"AFE0C5643CEE4A65AAF408A8B3580C26","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Re-calculate\/add INFO field values and compute Impute2-like INFO scores for each variant.<\/div><div class = \"text-block\">Here, we use bcftools plugin +fill-tags to only add AF value. However, the plugin is able to add also other values, such as Hardy-Weinberg equilibrium p-value, if required. See documentation for details at: <\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">http:\/\/samtools.github.io\/bcftools\/howtos\/plugin.fill-tags.html<\/span><\/a><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Input file:<\/span><\/div><div class = \"text-block\"><span>\u2022 DATASET_imputed_chr#.vcf.gz (where # is chromosome number) (<\/span><span style = \"font-weight:bold;\">Step 10<\/span><span>)<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Outpt files:<\/span><\/div><div class = \"text-block\">\u2022 DATASET_imputed_chr#.vcf.gz (where # is chromosome number)<\/div><div class = \"text-block\">\u2022 DATASET_imputed_info_chr#.vcf.gz.tbi (where # is chromosome number)<\/div><\/div>"}},{"id":1054725,"guid":"97EF8723587242739624AF765E8A89E2","order_id":2,"type_id":15,"title":"command","source":{"name":"DATASET=your_dataset_prefix\n\n# Re-calculate and add INFO field values for each chromosome\nfor CHR in {1..23}; do\n\n    # Create index file\n    bcftools index -t ${DATASET}_imputed_chr${CHR}.vcf.gz\n\t\n    # Re-calculate allele frequency and \n    # compute Impute2-like INFO score\n    bcftools +fill-tags ${DATASET}_imputed_chr${CHR}.vcf.gz \\\n        -Ou -- -t AF | \\\n    bcftools +impute-info \\\n        -Oz -o ${DATASET}_imputed_info_chr${CHR}.vcf.gz\ndone","command":"bcftools plugins syntax and parameters:\n+fill-tags re-calculates\/adds INFO field tags (see BCFtools documentation for complete list)\n-- separator for plugin-specific parameters\n-t define the tags to be re-calculated\/added\n+impute-info computes Impute2-like INFO score\n-Ou uncompressed output\n-Oz compressed output\nAlternatively, if all INFO field tags are wanted, remove the plugin-specific parameter:\nbcftools +fill-tags <dataset>_imputed_chr${chr}.vcf.gz -Ou\n","os_name":"","os_version":""}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":700234,"guid":"64537A32E0874B608C36D354485ACA38","previous_id":700233,"previous_guid":"2E0AEB3AA4AB476486D25D2B75033602","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"C5BDC4BC41BA40BC8A077063D9933AEF","order_id":1,"type_id":6,"title":"Section","source":{"title":"Post-imputation processing and quality assurance"}},{"id":1054724,"guid":"6DA5FF7E40344800A0AE2FA9F3016611","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Extract allele frequencies (AF) and INFO scores from the imputed VCF file.<\/div><div class = \"text-block\">Group the variants by their AF into either of the following categories,<\/div><div class = \"text-block\">1: AF >= 5% or AF <= 95% (common variants)<\/div><div class = \"text-block\">2: 0.5%\u00a0 <= AF < 5% or 95% < AF <= 99.5% (low-frequency variants)<\/div><div class = \"text-block\">3: AF < 0.5% or AF > 99.5% (rare variants)<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Input file:<\/span><\/div><div class = \"text-block\"><span>\u2022 DATASET_imputed_info_chr#.vcf.gz (where # is chromosome number) (<\/span><span style = \"font-weight:bold;\">Step 11<\/span><span>)<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Outpt file:<\/span><\/div><div class = \"text-block\">\u2022 DATASET_INFO_group_chr#.txt (where # is chromosome number)<\/div><\/div>"}},{"id":1054725,"guid":"77577A03C2274D3F9FE41650D26739B2","order_id":2,"type_id":15,"title":"command","source":{"name":"DATASET=your_dataset_prefix\n\n# Generate an allele frequency file for plotting for each chrs\nfor CHR in {1..23}; do\n\n    # Generate a header for the output file\n    echo -e 'CHR\\tSNP\\tREF\\tALT\\tAF\\tINFO\\tAF_GROUP' \\\n        > ${DATASET}_INFO_group_chr${CHR}.txt\n\n    # Query the required fields and \n    # add frequency group (1, 2 or 3) as the last column\n    bcftools query -f \\\n        '%CHROM\\t%CHROM\\_%POS\\_%REF\\_%ALT\\t%REF\\t%ALT\\t%INFO\/AF\\t%INFO\/INFO\\t-\\n' \\\n        ${DATASET}_imputed_info_chr${CHR}.vcf.gz | \\\n    # Here $5 refers to AF values, $7 refers to AF group\n    awk -v OFS=\"\\t\" \\\n        '{if ($5>=0.05 && $5<=0.95) $7=1; \\\n            else if(($5>=0.005 && $5<0.05) || \\\n            ($5<=0.995 && $5>0.95)) $7=2; else $7=3} \\\n            { print $1, $2, $3, $4, $5, $6, $7 }' \\\n        >> ${DATASET}_INFO_group_chr${CHR}.txt\ndone","command":"","os_name":"","os_version":""}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":700235,"guid":"68D8227C5A7947A6A3FC99711BB17646","previous_id":700234,"previous_guid":"64537A32E0874B608C36D354485ACA38","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"4F3E84D59F9F48E79F17BB5B920F165D","order_id":1,"type_id":6,"title":"Section","source":{"title":"Post-imputation processing and quality assurance"}},{"id":1054724,"guid":"FBB2659070354BF8BEFF0C4B86DDBD2E","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Produce multiple plots to illustrate the distribution of Impute2-like INFO scores and allele frequencies of the imputed data as well as the comparison of allele frequencies between the imputed data and the imputation reference panel.<\/div><div class = \"text-block\">Copy and store the R script below as 'plot_INFO_and_AF_for_imputed_chrs.R'.<\/div><div class = \"text-block\">Set the script as executable for instance with 'chmod +x plot_INFO_and_AF_for_imputed_chrs.R' before running it for the first time.<\/div><div class = \"text-block\">Run the script as indicated in the example command below.<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Input files:<\/span><\/div><div class = \"text-block\"><span>\u2022 DATASET_INFO_group_chr#.txt (where # is chromosome number) (<\/span><span style = \"font-weight:bold;\">Step 12<\/span><span>)<\/span><\/div><div class = \"text-block\"><span>\u2022 panel.frq (<\/span><span style = \"font-weight:bold;\">Step 1.3.5<\/span><span>)<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Outpt files:<\/span><\/div><div class = \"text-block\">\u2022 DATASET_chr#_postimputation_summary_plots.png (where # is chromosome number)<\/div><div class = \"text-block\">\u2022 DATASET_postimputation_summary_plots.pdf<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">!! Inspect the plots:<\/span><\/div><div class = \"text-block\">See example of the produced plots in expected results section a the end of this step.<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Top left:<\/span><\/div><div class = \"text-block\">Impute2-like INFO score density for each AF group.<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Bottom left:<\/span><\/div><div class = \"text-block\">AF distribution of the imputed chip data.<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Top right:<\/span><\/div><div class = \"text-block\">AF comparison between the panel and imputed chip data.<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">Bottom right:<\/span><\/div><div class = \"text-block\">Absolute AF difference along the chromosome positions between the panel and imputed chip data.<\/div><\/div>"}},{"id":1054725,"guid":"F71EA5360457411A91EB0AB03BBC3611","order_id":2,"type_id":15,"title":"command","source":{"name":"DATASET=your_dataset_prefix\nDATASET_INFO=${DATASET}_INFO_group\nOUTPUT=${DATASET}_postimputation_summary_plots\n\n# Copy and save the given 'plot_INFO_and_AF_for_imputed_chrs.R' file \n# and run it with:\nfor CHR in {1..23}; do\n    Rscript --no-save  \\\n        plot_INFO_and_AF_for_imputed_chrs.R \\\n        ${DATASET_INFO}_chr${CHR}.txt \\\n        ${OUTPUT}_chr${CHR} \\\n        ${REFERENCE_FRQ}\ndone\n\n# Combine the plots per chromosome into a single pdf file\nconvert $(ls ${OUTPUT}_chr*.png | sort -V) \\\n     ${OUTPUT}.pdf","command":"","os_name":"","os_version":""}},{"id":1054726,"guid":"4A1CE078D4C24D449CBE061A1441845A","order_id":3,"type_id":15,"title":"command","source":{"name":"#!\/bin\/env Rscript --no-save\n\n# Required libraries\nlibrary(data.table) # For fast fread\nlibrary(sm)         # For density plotting\n\n# Input variables\nargs <- commandArgs(TRUE)\ninfile <- args[1]       # Input file\noutdataset <- args[2]    # Output prefix\npanel.frq <- args[3]    # Path to panel frq file\npanel <- fread(panel.frq, header = TRUE)\n\n# Creates the filename as DATASET_tag_chr#.png\npng(filename = paste0(outdataset,  \".png\"), \n    width = 1200, height = 1200, unit = \"px\")\n\n    # Set the plots as two rows and columns\n    par(mfrow = c(2,2))\n    par(cex.axis = 1.6, cex.lab = 1.5, cex.main = 1.6)\n\n    # Read in data for a file DATASET_INFO_group_chr#.txt\n    imp_vars <- fread(infile), header = TRUE)\n\n    # Create random sample for INFO-value plot\n    rand1 <- sample(1:dim(imp_vars)[1], 100000, \n            replace = FALSE)\n    temp1 <- imp_vars[rand1,]\n\n    # Merge by common variants, \n    # SNP column in format CHR_POS_REF_ALT\n    isec <- merge(panel, imp_vars, by=\"SNP\")\n\n    # Plot INFO-value distributions\n    sm.density.compare(temp1$INFO, temp1$AF_GROUP, \n        xlab = \"INFO-value\", ylab = \"Density\", \n        col = col, lty = rep(1,3), lwd = 3, \n        xlim = c(0,1), cex = 1.4, h = 0.05)\n    title(paste0(\"Imputation of chr \", chr, \" variants\"))\n    legend(\"topleft\", \n        legend = c(\"MAF > 5%\", \"MAF 0.5-5%\", \"MAF < 0.5%\"), \n        lty = c(1, 1, 1), lwd = c(2.5, 2.5, 2.5), \n        col = c(\"red\", \"green3\", \"blue\"))\n\n    # Plot AF of panel vs. imputed variants\n    plot(isec$AF.x, isec$AF.y, col = 1, pch = 20, \n        main = \"Imputed AF vs. reference panel AF\", \n        xlab = \"Reference panel AF\", ylab = \"Imputed AF\", \n        xlim = c(0,1), ylim = c(0,1))\n\n    # Imputed data AF histogram for intersecting variants\n    hist(isec$AF.y, breaks = 200, \n        main = \"AF distribution of imputed variants\", \n        xlab = \"Imputed AF\")\n\n    # Plot absolute AF difference as imputed AF - panel AF\n    isec$POS <- as.numeric(as.character(\n         data.frame(do.call('rbind', \n             strsplit(as.character(\n                  isec$SNP),'_',fixed=TRUE)))[,2]))\n    # Order the variants by position\n    sisec <- isec[order(isec$POS),]\n    plot(sisec$POS, sisec$AF.y - sisec$AF.x, \n        main = \"Absolute AF differences along the chromosome\", \n        col = rgb(0,100,0,50, maxColorValue=255), \n        ylim = c(-0.1, 0.1), pch = 16, \n        xlab = \"Chromosome position\", \n        ylab = \"AF difference (imputed - panel)\")\n\n# Close the png\ndev.off()","command":"","os_name":"plot_INFO_and_AF_for_imputed_chrs.R","os_version":""}},{"id":1054727,"guid":"8ABC758F298943FFB03C72CCE423FB6C","order_id":4,"type_id":17,"title":"result","source":{"body":"<div class = \"text-blocks\"><div class = \"text-block\">Example of chromosome 2 post-imputation summary plots with a population-specific imputation reference panel.<\/div><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/pr-journal\/ut3i3gw.png\" \/><\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":null}],"materials":[],"description":"<div class = \"text-blocks\"><\/div>","changed_on":1554119274}