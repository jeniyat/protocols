{"id":19812,"title":"Protocol for a reproducible circRNA analysis using Docker4Circ","title_html":"Protocol for a reproducible circRNA analysis using Docker4Circ","image":{"source":"https:\/\/www.protocols.io\/img\/default_protocol.png","placeholder":"https:\/\/www.protocols.io\/img\/default_protocol.png"},"doi":"dx.doi.org\/10.17504\/protocols.io.xkcfksw","doi_status":2,"uri":"protocol-for-a-reproducible-circrna-analysis-using-xkcfksw","type_id":1,"published_on":1548844595,"version_id":1,"created_on":1548844257,"categories":null,"creator":{"name":"Giulio Ferrero","affiliation":"University of Turin","username":"giulio-ferrero","link":null,"image":{"source":"\/img\/avatars\/010.png","placeholder":"\/img\/avatars\/010.png"},"badges":[{"id":2,"image":{"source":"\/img\/badges\/bronze.svg","placeholder":"\/img\/badges\/bronze.svg"},"name":"Author"}],"research_interests":null},"journal":null,"journal_name":null,"journal_link":null,"public":1,"has_versions":1,"link":null,"number_of_steps":18,"authors":[{"name":"Giulio Ferrero","affiliation":"University of Turin","username":"giulio-ferrero","link":null,"image":{"source":"\/img\/avatars\/010.png","placeholder":"\/img\/avatars\/010.png"},"badges":[],"research_interests":null},{"name":"Nicola Licheri","affiliation":"University of Turin","username":"nicola-licheri","link":null,"image":{"source":"\/img\/avatars\/015.png","placeholder":"\/img\/avatars\/015.png"},"badges":[],"research_interests":null},{"name":"Lucia Coscujuela Tarrero","affiliation":"University of Turin","username":null,"link":null,"image":{"source":null,"placeholder":null},"badges":[],"research_interests":null},{"name":"Carlo De Intinis","affiliation":"University of Turin","username":null,"link":null,"image":{"source":null,"placeholder":null},"badges":[],"research_interests":null},{"name":"Valentina Miano","affiliation":"University of Turin","username":null,"link":null,"image":{"source":null,"placeholder":null},"badges":[],"research_interests":null},{"name":"Raffaele Adolfo Calogero","affiliation":"University of Turin","username":null,"link":null,"image":{"source":null,"placeholder":null},"badges":[],"research_interests":null},{"name":"Francesca Cordero","affiliation":"University of Turin","username":"francesca-cordero","link":null,"image":{"source":"\/img\/avatars\/003.png","placeholder":"\/img\/avatars\/003.png"},"badges":[],"research_interests":null},{"name":"Marco Beccuti","affiliation":"University of Turin","username":"marco-beccuti","link":null,"image":{"source":"\/img\/avatars\/013.png","placeholder":"\/img\/avatars\/013.png"},"badges":[],"research_interests":null},{"name":"Michele De Bortoli","affiliation":"University of Turin","username":null,"link":null,"image":{"source":null,"placeholder":null},"badges":[],"research_interests":null}],"versions":[],"groups":[{"id":1052,"uri":"qbio-turin","title":"Q-Bio Turin","image":{"source":"https:\/\/www.protocols.io\/img\/group_placeholder.png","placeholder":"https:\/\/www.protocols.io\/img\/group_placeholder.png"},"tech_support":{"email":"","phone":"","hide_contact":0,"use_email":0},"is_member":1,"request":{"id":1052,"uri":"qbio-turin","is_protocol_requested":0,"is_group_requested":0,"is_my":false,"is_request":false,"is_confirmed":1,"is_declined":0,"visible":1,"image":{"source":"","placeholder":""},"is_member":1,"title":"Q-Bio Turin","requester":{"name":" ","affiliation":null,"affiliation_url":null,"username":null,"link":null},"protocol":{"id":0,"title":"Protocol for a reproducible circRNA analysis using Docker4Circ","title_html":"Protocol for a reproducible circRNA analysis using Docker4Circ","image":{"source":null,"placeholder":null},"doi":null,"doi_status":0,"uri":"protocol-for-a-reproducible-circrna-analysis-using-xkcfksw","type_id":1,"published_on":null,"stats":{"number_of_views":0,"number_of_steps":0,"number_of_bookmarks":0,"number_of_comments":0}},"created_on":1548844595,"resolve_on":0,"resolved_user":{"name":" ","affiliation":null,"username":null,"link":null,"image":{"source":null,"placeholder":null},"badges":[],"research_interests":null}}}],"has_subprotocols":0,"is_subprotocol":0,"is_bookmarked":0,"forks_count":{"private":0,"public":0},"steps":[{"id":702748,"guid":"2D4356FA783F43A9B0B3AB139E5D65D4","previous_id":null,"previous_guid":null,"modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"20677CC7D7034C37ADA2D7159F4781F3","order_id":1,"type_id":6,"title":"Section","source":{"title":"Softwares and datasets preparation"}},{"id":1054724,"guid":"EA362C247657494C888B06F67D2686D5","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Installation of the docker4seq R package.<\/span><\/div><div class = \"text-block\">In the R environment digit the following command to install and run the docker4seq pipeline<\/div><div class = \"text-block\"><pre><code><div class = \"text-blocks\"><\/div><\/code><\/pre><\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":"#d0021b"},{"id":702749,"guid":"7D37C6A3E6A74625962A58BB88E043F2","previous_id":702748,"previous_guid":"2D4356FA783F43A9B0B3AB139E5D65D4","modified_on":1548844325,"protocol_id":0,"components":[{"id":1054723,"guid":"E68FFDF9A8D647568AA3D60546CAC8C6","order_id":1,"type_id":6,"title":"Section","source":{"title":"Softwares and datasets preparation"}},{"id":1054724,"guid":"165D432E2DB549BD8DAAEEDF58249474","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Creation of the analysis folders.<\/span><\/div><div class = \"text-block\"><span>Before running the analyses, create the following directories in the working folder \"<\/span><span style = \"font-weight:bold;\">data<\/span><span>\" \"<\/span><span style = \"font-weight:bold;\">reference<\/span><span>\" \"<\/span><span style = \"font-weight:bold;\">scratch<\/span><span>\". <\/span><\/div><div class = \"text-block\">The \"data\" folder will be used to store all the input and output data, the \"scratch\" folder will be used to store the temporary data, and the \"reference\" folder will be used to store the reference genome and annotation data. <\/div><div class = \"text-block\"><span>The folders can be created in your working directory using the command \"<\/span><span style = \"font-weight:bold;\">mkdir<\/span><span>\".<\/span><\/div><div class = \"text-block\"><span>Based on the path of your working directory, the path to these folder will be different. In our example the working directory is \"<\/span><span style = \"font-weight:bold;\">\/home\"<\/span><span>. Then, the path to these three folders will be \"<\/span><span style = \"font-weight:bold;\">\/home\/data<\/span><span>\" \"<\/span><span style = \"font-weight:bold;\">\/home\/scratch<\/span><span>\" \"<\/span><span style = \"font-weight:bold;\">\/home\/reference<\/span><span style = \"font-weight:bold;\">\"<\/span><\/div><div class = \"text-block\">You can obtain the path to your working directory using the R getwd() command.<\/div><\/div>"}},{"id":1054725,"guid":"5BEB7E40182411E9A3ED97343731D3AC","order_id":2,"type_id":15,"title":"command","source":{"name":"# Creation of the directories for the analysis\nsystem(\"mkdir data reference scratch\")","command":"Creation of working folders","os_name":"","os_version":""}}],"cases":null,"data":null,"section":null,"section_color":"#d0021b"},{"id":702750,"guid":"7C0823E66D05412CB6FC03C7128AC905","previous_id":702749,"previous_guid":"7D37C6A3E6A74625962A58BB88E043F2","modified_on":1548844325,"protocol_id":0,"components":[{"id":1054723,"guid":"59655033706B488084A9AA525EA4E17B","order_id":1,"type_id":6,"title":"Section","source":{"title":"Softwares and datasets preparation"}},{"id":1054724,"guid":"56FA576340274A9A955E81511270FC4B","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Download of the input RNA-Seq data<\/span><\/div><div class = \"text-block\"><span>The RNA-Seq raw reads for the circRNA prediction can be downloaded from <\/span><span style = \"font-weight:bold;\">PRJNA393626<\/span><span>. This dataset includes a triplicate paired-end total and RNAse-R treated RNA-Seq performed on <\/span><span style = \"font-weight:bold;\">NCM460<\/span><span> (normal colon cells), <\/span><span style = \"font-weight:bold;\">SW480<\/span><span> (primary colorectal cancer cells), and <\/span><span style = \"font-weight:bold;\">SW620<\/span><span> cell lines (metastatic colorectal cancer cells).<\/span><\/div><div class = \"text-block\">The detailed list of datasets needed for the analysis is the following:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">SRA ID               ID<\/span><\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">SRR5889371<\/span><\/a><\/div><div class = \"text-block\">    NCM460_rep1<\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">SRR5889366<\/span><\/a><\/div><div class = \"text-block\">    NCM460_rep2<\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">SRR5889367<\/span><\/a><\/div><div class = \"text-block\">    NCM460_rep3<\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">SRR5889368<\/span><\/a><\/div><div class = \"text-block\">    SW480_rep1<\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">SRR5889369<\/span><\/a><\/div><div class = \"text-block\">    SW480_rep2<\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">SRR5889362<\/span><\/a><\/div><div class = \"text-block\">    SW480_rep3<\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">SRR5889363<\/span><\/a><\/div><div class = \"text-block\">    SW620_rep1<\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">SRR5889364<\/span><\/a><\/div><div class = \"text-block\">    SW620_rep2<\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">SRR5889365<\/span><\/a><\/div><div class = \"text-block\">    SW620_rep3<\/div><div class = \"text-block\"><span>The the .fastq files can be downloaded from the ENA page of the experiment (linked below). The links to these files are reported under the column \"<\/span><span style = \"font-weight:bold;\">FASTQ files (FTP)<\/span><span>\". <\/span><\/div><div class = \"text-block\">Each dataset should be located in a specific directory, for example the experiment SRR5889371 should be put in the folder \/data\/SRR5889371.<\/div><div class = \"text-block\">Use the following code to automatically create these folders:<\/div><div class = \"text-block\">To download the files you can use the following R code.<\/div><\/div>"}},{"id":1054725,"guid":"59D504E0182511E9A3ED97343731D3AC","order_id":2,"type_id":9,"title":"dataset","source":{"name":"PRJNA411984","link":"https:\/\/www.ebi.ac.uk\/ena\/data\/view\/PRJNA411984"}},{"id":1054726,"guid":"4D521C60196C11E99BAE3DECD134B349","order_id":3,"type_id":15,"title":"command","source":{"name":"# Define a list containing the dataset ids\nids = c(\"SRR5889362\", \"SRR5889363\", \"SRR5889364\", \"SRR5889365\", \"SRR5889366\", \"SRR5889367\", \"SRR5889368\", \"SRR5889369\", \"SRR5889371\")\n\n# Define a variable storing the path to data folder\ndata = paste0(getwd(), \"\/data\")\n\n# Create each dataset folder\nfor(i in 1:length(ids)){\n\ndir.create(paste0(data, \"\/\", ids[i]))\n\n}","command":"Creation of the dataset folders","os_name":"","os_version":""}},{"id":1054727,"guid":"01E14490197111E99BAE3DECD134B349","order_id":4,"type_id":15,"title":"command","source":{"name":"# Define a variable storing the fastq url\nurl1 <- \"ftp:\/\/ftp.sra.ebi.ac.uk\/vol1\/fastq\/SRR588\/002\/SRR5889362\/SRR5889362_1.fastq.gz\"\nurl2 <- \"ftp:\/\/ftp.sra.ebi.ac.uk\/vol1\/fastq\/SRR588\/002\/SRR5889362\/SRR5889362_2.fastq.gz\"\n\n# Call wget to download the dataset into a specific folder\nsystem(paste(\"wget\", url1, \"-P\", paste0(data, \"\/SRR5889362\"))) \nsystem(paste(\"wget\", url2, \"-P\", paste0(data, \"\/SRR5889362\")))","command":"Dataset download","os_name":"","os_version":""}}],"cases":null,"data":null,"section":null,"section_color":"#d0021b"},{"id":702751,"guid":"1FBB46E93E564CCE9AA5104A7D7D5D91","previous_id":702750,"previous_guid":"7C0823E66D05412CB6FC03C7128AC905","modified_on":1548844345,"protocol_id":0,"components":[{"id":1054723,"guid":"5D86B35C220642259833E70B847A102C","order_id":1,"type_id":6,"title":"Section","source":{"title":"Module 1a: circRNAs prediction with CIRI2"}},{"id":1054724,"guid":"D78D7B469E634477A399D7459E24F02F","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Indexing of the reference genome<\/span><span style = \"font-weight:bold;\"> <\/span><\/div><div class = \"text-block\"><span>The first module of Docker4Circ was designed for the prediction of circRNAs from raw RNA-Seq reads. In this part of the protocol, the prediction performed using the <\/span><span style = \"font-weight:bold;\">CIRI2<\/span><span> algorithm is described. The first step of the pipeline is the BWA indexing of a reference genome using the <\/span><span style = \"font-weight:bold;font-style:italic;\">bwaIndex<\/span><span> function.<\/span><\/div><div class = \"text-block\">All the index files of the reference genome will be stored in the reference folder.<\/div><\/div>"}},{"id":1054725,"guid":"FBBF6600197A11E99BAE3DECD134B349","order_id":2,"type_id":15,"title":"command","source":{"name":"# Define a variable storing the path to the reference folder\nref <- paste0(getwd(), \"\/reference\")\n\n# Define a variable storing the url to the reference genome sequence\ngenome <- \"ftp:\/\/ftp.ensembl.org\/pub\/grch37\/update\/fasta\/homo_sapiens\/dna\/Homo_sapiens.GRCh37.dna.toplevel.fa.gz\"\n\n# BWA indexing of the genomic sequence\nbwaIndex(group=\"docker\", genome.folder=ref, genome.url=genome, mode=\"General\")","command":"Human genome BWA indexing","os_name":"","os_version":""}}],"cases":null,"data":null,"section":null,"section_color":"#f5a623"},{"id":702752,"guid":"D8A5F22CA0D540AD8E2100EBED6BF061","previous_id":702751,"previous_guid":"1FBB46E93E564CCE9AA5104A7D7D5D91","modified_on":1548844563,"protocol_id":0,"components":[{"id":1054723,"guid":"7396E08BBBD541C98732BA903FE76BE4","order_id":1,"type_id":6,"title":"Section","source":{"title":"Module 1a: circRNAs prediction with CIRI2"}},{"id":1054724,"guid":"8AA35FCB2D6F41BE892DE197B12904E4","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Read alignment with BWA<\/span><\/div><div class = \"text-block\"><span>The second step of the pipeline will be the RNA-Seq read quality control using the <\/span><span style = \"font-weight:bold;font-style:italic;\">fastqc<\/span><span> function, the read aligment using the <\/span><span style = \"font-weight:bold;font-style:italic;\">bwa<\/span><span> function, and the circRNAs prediction using <\/span><span style = \"font-weight:bold;font-style:italic;\">ciri2<\/span><span> function. The sequential call of these three functions is implemented in the <\/span><span style = \"font-weight:bold;font-style:italic;\">wrapperCiri <\/span><span>function that can be used as follow:<\/span><\/div><div class = \"text-block\">The read alignment quality control files,  the BWA read alignment files and the set of predicted circRNAs (.ciri files) will be stored in the folder in which the input fastq files are located.<\/div><\/div>"}},{"id":1054725,"guid":"1C82BD00197C11E99BAE3DECD134B349","order_id":2,"type_id":15,"title":"command","source":{"name":"# Define a variable storing the path to the scratch folder\nscratch = paste0(getwd, \"\/scratch\")\n\n# Define a variable storing the path to the reference genome sequence\ngs <- paste0(reference, \"\/Homo_sapiens.GRCh37.dna.toplevel.fa\")\n\n# Download the reference gene annotations\nurl_gene <- \"ftp:\/\/ftp.ebi.ac.uk\/pub\/databases\/gencode\/Gencode_human\/release_28\/GRCh37_mapping\/gencode.v28lift37.annotation.gtf.gz\"\n\nsystem(paste(\"wget\", url_gene, \"-F\", ref)) \n\n# Define a variable storing the path to the reference gene annotations\ngtf <- paste0(reference, \"\/gencode.v28lift37.annotation.gtf.gz\")\n\n# Repeat the BWA alignment for each dataset\nfor (i in 1:length(ids)){\n\nfqfolder <- paste(data, ids[i] , sep=\"\/\")\n\nwrapperCiri(group = \"docker\", scratch.folder=scratch, data.folder=fqfolder, \ngenome.file=gs, seq.type=\"pe\", sample.id=ids[i], threads=1, annotation.file=gtf, \nmax.span=200000, stringency.value=\"high\", quality.threshold=10)\n\n}","command":"BWA RNA-Seq read alignment and circRNAs prediction with CIRI2","os_name":"","os_version":""}}],"cases":null,"data":null,"section":null,"section_color":"#f5a623"},{"id":702753,"guid":"7BF16DB8B2E44439815717DC0DA49BFE","previous_id":702752,"previous_guid":"D8A5F22CA0D540AD8E2100EBED6BF061","modified_on":1548844371,"protocol_id":0,"components":[{"id":1054723,"guid":"E81CF6681EB74892B64F3F9C3CB6A28B","order_id":1,"type_id":6,"title":"Section","source":{"title":"Module 1a: circRNAs prediction with CIRI2"}},{"id":1054724,"guid":"42449D544E234C09BEBD585A5A1CA994","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Merge of multiple CIRI2 predictions<\/span><\/div><div class = \"text-block\"><span>To merge multiple CIRI2 circRNAs predictions into a common list of circRNAs, the function <\/span><span style = \"font-weight:bold;\">ciri2MergePredictions <\/span><span>was implemented. Each .ciri files located in a specific dataset folder will be merged into a single file. Each sample name should be reported ad element of the <\/span><span style = \"font-weight:bold;\">samples.list<\/span><span> vector with correponding sample type specified as element of the <\/span><span style = \"font-weight:bold;\">covariate.list<\/span><span> vector.<\/span><\/div><div class = \"text-block\"><span>This function generates two files named <\/span><span style = \"font-weight:bold;\">merged_circs.crna <\/span><span>and <\/span><span style = \"font-weight:bold;\">merged_circs.crna_count<\/span><span>. The first file reports the ids and coordinates of each circRNA while the second file is a matrix reporting the number of backsplicing reads supporting each circRNA in each dataset.<\/span><\/div><\/div>"}},{"id":1054725,"guid":"5C0D250019AE11E997BCA9AC776D78C0","order_id":2,"type_id":15,"title":"command","source":{"name":"# Copy each CIRI2 prediction in the data folder\nsystem(paste0(\"cp \", data, \"\/*\/*.ciri \", data))\n\n# Define a list of sample groups\ncov <- c(\"1\",\"1\",\"1\",\"2\",\"2\",\"2\",\"3\",\"3\",\"3\")\n\n# Merge the CIRI2 outputs\nciri2MergePredictions(group=\"docker\", scratch.folder=scratch, data.folder=data,\n samples.list=ids, covariate.list=cov, min_reads=2, min_reps=2, min_avg=10)","command":"Merge of different CIRI2 predictions","os_name":"","os_version":""}}],"cases":null,"data":null,"section":null,"section_color":"#f5a623"},{"id":702754,"guid":"5AD1A56909A14473AA0370D585F2A22B","previous_id":702753,"previous_guid":"7BF16DB8B2E44439815717DC0DA49BFE","modified_on":1548844381,"protocol_id":0,"components":[{"id":1054723,"guid":"EEA5FBA24FAE4076B575BC470C954832","order_id":1,"type_id":6,"title":"Section","source":{"title":"Module 1b: circRNAs prediction with STARChip"}},{"id":1054724,"guid":"F8892919C1C74FA987242992F9CA501F","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Indexing of the reference genome<\/span><span style = \"font-weight:bold;\"> <\/span><\/div><div class = \"text-block\"><span>In this part of the protocol, the prediction performed using the <\/span><span style = \"font-weight:bold;\">STARChip<\/span><span> algorithm is described. The first step of the pipeline is the STAR indexing of a reference genome using the <\/span><span style = \"font-weight:bold;font-style:italic;\">rsemstarIndex<\/span><span> function.<\/span><\/div><div class = \"text-block\"><span>The STAR index files of the reference genome will be stored in the <\/span><span style = \"font-weight:bold;\">reference<\/span><span> folder.<\/span><\/div><\/div>"}},{"id":1054725,"guid":"0D6497F01B0A11E9838C790F64222528","order_id":2,"type_id":15,"title":"command","source":{"name":"# Define a variable storing the url of the gene annotations\nurl_gene <- \"tp:\/\/ftp.ensembl.org\/pub\/grch37\/update\/gtf\/homo_sapiens\/Homo_sapiens.GRCh37.87.gtf.gz\"\n\n# Call the function to index the reference genome\nrsemstarIndex(group=\"docker\",  genome.folder=ref, \nensembl.urlgenome=genome, ensembl.urlgtf=url_gene, threads=40)","command":"Reference genome indexing with STAR","os_name":"","os_version":""}}],"cases":null,"data":null,"section":null,"section_color":"#f8e71c"},{"id":702755,"guid":"61169702A4634671BF530C5C7E57F9BF","previous_id":702754,"previous_guid":"5AD1A56909A14473AA0370D585F2A22B","modified_on":1548844381,"protocol_id":0,"components":[{"id":1054723,"guid":"40D70652D292440DA258847AB6E5ED0F","order_id":1,"type_id":6,"title":"Section","source":{"title":"Module 1b: circRNAs prediction with STARChip"}},{"id":1054724,"guid":"61C4AB236A7144468B3294C7D5E24A9D","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Create the reference file for STARChip<\/span><\/div><div class = \"text-block\"><span>The STARChip algorithm required an additional .bed file defined starting from the STAR-indexed reference genome. To generate this file, the function <\/span><span style = \"font-weight:bold;font-style:italic;\">starChipIndex <\/span><span>should be applied as follow:<\/span><\/div><div class = \"text-block\"><span>Two files called <\/span><span style = \"font-weight:bold;\">genome.gtf.bed <\/span><span>and <\/span><span style = \"font-weight:bold;\">genome.gtf.exon.bed <\/span><span>will be generated in the <\/span><span style = \"font-weight:bold;\">reference<\/span><span> folder.<\/span><\/div><\/div>"}},{"id":1054725,"guid":"CF3AC9301B0A11E9838C790F64222528","order_id":2,"type_id":15,"title":"command","source":{"name":"# Creation of the STARChip reference file\nstarChipIndex(group=\"docker\", genome.folder=ref)","command":"Reference creation for STARChip","os_name":"","os_version":""}}],"cases":null,"data":null,"section":null,"section_color":"#f8e71c"},{"id":702756,"guid":"B208B30E92814157A059D51E13F0C099","previous_id":702755,"previous_guid":"61169702A4634671BF530C5C7E57F9BF","modified_on":1548844388,"protocol_id":0,"components":[{"id":1054723,"guid":"BE1B1ED3614F4E9ABCB77EE30AB23247","order_id":1,"type_id":6,"title":"Section","source":{"title":"Module 1b: circRNAs prediction with STARChip"}},{"id":1054724,"guid":"6737A7CB075D424E81CB51B0FE44BA51","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Running of STAR chimeric analysis<\/span><\/div><div class = \"text-block\"><span>The STARChip circRNAs prediction require a run of STAR chimeric algorithm on the RNA-Seq reads. The STAR chimeric analysis is implemented in the <\/span><span style = \"font-weight:bold;font-style:italic;\">starChimeric<\/span><span> function that shoul be applied as follow:<\/span><\/div><div class = \"text-block\">This function will generate each STAR chimeric output in each sample directory.<\/div><\/div>"}},{"id":1054725,"guid":"B50EB1601B0B11E9838C790F64222528","order_id":2,"type_id":15,"title":"command","source":{"name":"# Run of the STAR chimeric analysis on each RNA-Seq dataset\nfor(i in 1:length(ids)){\n\nfqfolder = paste(path, ids[i] , sep=\"\")\n\nstarChimeric(group=\"docker\", fastq.folder=fqfolder, scratch.folder=scratch, genome.folder=ref threads=40, chimSegmentMin=20, chimJunctionOverhangMin=15)\n\n}","command":"STAR chimeric analysis","os_name":"","os_version":""}}],"cases":null,"data":null,"section":null,"section_color":"#f8e71c"},{"id":702757,"guid":"AAC069A203C8420196C59F794DB18E88","previous_id":702756,"previous_guid":"B208B30E92814157A059D51E13F0C099","modified_on":1548844534,"protocol_id":0,"components":[{"id":1054723,"guid":"3D813D9BDBD14AB386466C3259BF961A","order_id":1,"type_id":6,"title":"Section","source":{"title":"Module 1b: circRNAs prediction with STARChip"}},{"id":1054724,"guid":"3C0B3C93D1FB439E94553EA0CC53DBA3","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">STARChip circRNAs prediction<\/span><\/div><div class = \"text-block\"><span>The circRNA prediction will be performed using the <\/span><span style = \"font-weight:bold;font-style:italic;\">starchipCircle <\/span><span>function applied on the <\/span><span style = \"font-weight:bold;\">data<\/span><span> folder containing each sample-specific folder<\/span><\/div><\/div>"}},{"id":1054725,"guid":"4DF3C6901B0C11E9838C790F64222528","order_id":2,"type_id":15,"title":"command","source":{"name":"# Prediction of circRNAs using STARChip\nstarchipCircle_temp(group=\"docker\", genome.folder=ref, scratch.folder=scratch, \nsamples.folder=data, reads.cutoff=1, min.subject.limit=2, threads=40, \ndo.splice=\"True\", cpm.cutoff=0, subjectCPM.cutoff=0, annotation=\"true\")","command":"STARChip circRNAs prediction","os_name":"","os_version":""}}],"cases":null,"data":null,"section":null,"section_color":"#f8e71c"},{"id":702758,"guid":"03926303F3084612913CB3A7BDBDBE36","previous_id":702757,"previous_guid":"AAC069A203C8420196C59F794DB18E88","modified_on":1548844423,"protocol_id":0,"components":[{"id":1054723,"guid":"A4AF2B79D2B942E3B13DDDA24746C427","order_id":1,"type_id":6,"title":"Section","source":{"title":"Module 2: circRNAs annotation and classification"}},{"id":1054724,"guid":"00650FF6EE6943C69C59FD31D36E6C0D","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Preparation of the reference files for the classification<\/span><\/div><div class = \"text-block\"><span>To classify the circRNAs a reference of Ensembl exon and transcript annotations is required. To provide these data in the correct format, the <\/span><span style = \"font-weight:bold;font-style:italic;\">circrnaPrepareFiles <\/span><span>function should be applied as follow.<\/span><\/div><div class = \"text-block\"><span>Two files called <\/span><span style = \"font-weight:bold;\">exons_reference<\/span><span> and <\/span><span style = \"font-weight:bold;\">isoforms_reference <\/span><span>reporting the exons and the gene isoform annotations respectively, will be generated in the data folder.<\/span><\/div><\/div>"}},{"id":1054725,"guid":"F60143C019AF11E997BCA9AC776D78C0","order_id":2,"type_id":15,"title":"command","source":{"name":"# Create the reference exon and gene isoforms files required for the circRNA classification analysis\ncircrnaPrepareFiles(group=\"docker\", scratch.folder=scratch, data.folder=data, \nassembly=\"hg19\")","command":"Preparation of the reference files for the classification","os_name":"","os_version":""}}],"cases":null,"data":null,"section":null,"section_color":"#8b572a"},{"id":702759,"guid":"CEF21A1F818946DABE5D61EE32851977","previous_id":702758,"previous_guid":"03926303F3084612913CB3A7BDBDBE36","modified_on":1548844511,"protocol_id":0,"components":[{"id":1054723,"guid":"FD43C6E84B364894BB8C4240B76EBE02","order_id":1,"type_id":6,"title":"Section","source":{"title":"Module 2: circRNAs annotation and classification"}},{"id":1054724,"guid":"6F50C6B659F94889AEA9022292DC031F","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Classification of circRNAs based on their mapping location<\/span><\/div><div class = \"text-block\"><span>To classify the circRNAs into distinct classes the function <\/span><span style = \"font-weight:bold;font-style:italic;\">circrnaClassification<\/span><span> should be applied as follow.<\/span><\/div><div class = \"text-block\"><span>Two files called <\/span><span style = \"font-weight:bold;\">circRNA_classification<\/span><span> and <\/span><span style = \"font-weight:bold;\">circRNA_univocal_classification <\/span><span>reporting the transcript- and the gene-level classification respectively, will be generated in the data folder.<\/span><\/div><\/div>"}},{"id":1054725,"guid":"7767A35019B011E997BCA9AC776D78C0","order_id":2,"type_id":15,"title":"command","source":{"name":"# Classification of a circRNA set\ncircrnaClassification(group=\"docker\", scratch.folder=scratch, \ncircrna.data=paste0(data,\"\/merged_circs.crna\"), exon.data=paste0(data,\"\/exons_reference\", \nisoform.data=paste0(data,\"\/isoforms_reference\"), assembly=\"hg19\"))","command":"circRNAs classification","os_name":"","os_version":""}}],"cases":null,"data":null,"section":null,"section_color":"#8b572a"},{"id":702760,"guid":"357B15CE91AA4AAA84B801F8EA5B9CFB","previous_id":702763,"previous_guid":"D9676CA6685145B084CFFDB912FF0CE5","modified_on":1548844449,"protocol_id":0,"components":[{"id":1054723,"guid":"E8E15AC2A83B4793A24F350E12C90DA9","order_id":1,"type_id":6,"title":"Section","source":{"title":"Module 3: circRNAs sequence analysis"}},{"id":1054724,"guid":"C0CAAE91C94E4D1DA4A6FD5E9D4D4019","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Reconstruction of the circRNAs backsplicing junction sequences<\/span><\/div><div class = \"text-block\"><span>To reconstruct the sequence of the backsplicing junction of each circRNA the function <\/span><span style = \"font-weight:bold;font-style:italic;\">circrnaBSJunctions <\/span><span>should be applied as follow<\/span><\/div><div class = \"text-block\"><span>This function will generate a files called <\/span><span style = \"font-weight:bold;\">circRNA_backsplicing_sequences.fasta <\/span><span>reporting the reconstructed sequence.<\/span><\/div><\/div>"}},{"id":1054725,"guid":"F1BE09E019B111E997BCA9AC776D78C0","order_id":2,"type_id":15,"title":"command","source":{"name":"# Reconstruction of circRNA backsplicing junction sequence\ncircrnaBSJunctions(group=\"docker\", scratch.folder=scratch, \ncircrna.data=paste0(data,\"\/merged_circs.crna\"), exon.data=paste0(data,\"\/exons_reference\"), \nassembly=\"hg19\")","command":"Backsplicing sequence reconstruction","os_name":"","os_version":""}}],"cases":null,"data":null,"section":null,"section_color":"#7ed321"},{"id":702761,"guid":"3E8C88AABC1F4A008E412993A509FF4A","previous_id":702760,"previous_guid":"357B15CE91AA4AAA84B801F8EA5B9CFB","modified_on":1548844428,"protocol_id":0,"components":[{"id":1054723,"guid":"72C4392E32B443AAA574641A7EDD829C","order_id":1,"type_id":6,"title":"Section","source":{"title":"Module 3: circRNAs sequence analysis"}},{"id":1054724,"guid":"80975BDA6B7841658D7A44425A78C76C","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Prediction of alternative splicing events involving the circRNAs<\/span><\/div><div class = \"text-block\"><span>To predict the set of alternative splicing events involving the circRNA, the <\/span><span style = \"font-weight:bold;font-style:italic;\">ciriAS<\/span><span> function can be applied as follow using each BWA read alignment file and CIRI2 output.<\/span><\/div><div class = \"text-block\"><span>The output of the function will be a two different files called <\/span><span style = \"font-weight:bold;\">structure.list <\/span><span>and <\/span><span style = \"font-weight:bold;\">structure_AS.list<\/span><span>. <\/span><\/div><\/div>"}},{"id":1054725,"guid":"553F5DC019B211E997BCA9AC776D78C0","order_id":2,"type_id":15,"title":"command","source":{"name":"# Application of CIRI AS algorithm on each dataset\nfor(i in 1:length(ids)){\n\nfqfolder = paste(path, ids[i] , sep=\"\")\n\nciriAS(group=\"docker\", scratch.folder=scratch, sam.file=paste0(fqfolder,\"\/aligned_reads.sam\"), \nciri.file=paste0(fqfolder, \"\/\", ids[i], \".ciri\"), genome.file=genome, \nannotation.file=gtf)\n\n}","command":"Detection of alternative splicing events involving the circRNAs","os_name":"","os_version":""}}],"cases":null,"data":null,"section":null,"section_color":"#7ed321"},{"id":702762,"guid":"A82B84F373134921813BBE77CB4DCEBA","previous_id":702764,"previous_guid":"C75466728ACD4B8C94A74BBABDF5396D","modified_on":1548844500,"protocol_id":0,"components":[{"id":1054723,"guid":"762116A4F2A147D59A0B6732907D3679","order_id":1,"type_id":6,"title":"Section","source":{"title":"Module 4: circRNAs expression analysis"}},{"id":1054724,"guid":"E609B4EAE7CE4034B141DDD029F0DA99","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Quantification of circRNAs expression in RNA-Seq datasets<\/span><\/div><div class = \"text-block\"><span>The quantification of each circRNA in a specific RNA-Seq dataset is computed using the <\/span><span style = \"font-weight:bold;font-style:italic;\">circrnaQuantification <\/span><span>function <\/span><\/div><div class = \"text-block\"><span>This function will generate a file with extension <\/span><span style = \"font-weight:bold;\">.hashcirc <\/span><span>reporting for each dataset the number of reads supporting each circRNA.<\/span><\/div><\/div>"}},{"id":1054725,"guid":"CB16251019B211E997BCA9AC776D78C0","order_id":2,"type_id":15,"title":"command","source":{"name":"# Define a list containing the dataset ids\nids2 <- c(\"SRR6067723\", \"SRR6067725\", \"SRR6067727\", \"SRR6067729\", \"SRR6067731\", \"SRR6067733\")\n\n# Apply the quantification function on the fastq file stored in each sample folder\nfor(i in 1:length(ids2)){\n\nfqfolder = paste0(data, \"\/\", ids2[i] , sep=\"\")\n\nsetwd(fqfolder)\n\n# For paired-end reads, the two fastq files must be joined into a single fastq file \nsystem(paste0(\"cat \", ids2[i], \"_1.fastq \",  ids2[i], \"_2.fastq > \", ids2[i], \".fastq\"))\n\ncircrnaQuantification(group=\"docker\", scratch.folder=scratch, rnaseq.data=paste0(fqfolder, \"\/\", ids2[i], \".fastq\"), \nbacksplicing_junctions.data=paste0(data, \"\/circRNA_backsplicing_sequences.fasta\"), \nhc.params=c(21, 40, 1000000, 1000000, 17, 30))\n\n}","command":"CircRNAs expression analysis","os_name":"","os_version":""}}],"cases":null,"data":null,"section":null,"section_color":"#417505"},{"id":702763,"guid":"D9676CA6685145B084CFFDB912FF0CE5","previous_id":702759,"previous_guid":"CEF21A1F818946DABE5D61EE32851977","modified_on":1548844505,"protocol_id":0,"components":[{"id":1054723,"guid":"2283D794CCF24DA8910E121F06FD8C49","order_id":1,"type_id":6,"title":"Section","source":{"title":"Module 2: circRNAs annotation and classification"}},{"id":1054724,"guid":"93DD6EF3F8234E8B93DACAEEAD0C5BCF","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Annotation of the circRNA based on databases information<\/span><\/div><div class = \"text-block\"><span>To annotate the circRNAs based on the information stored in the circBase and TSCD database, the function <\/span><span style = \"font-weight:bold;font-style:italic;\">circAnnotation<\/span><span> should be applied as follow.<\/span><\/div><div class = \"text-block\"><span>Different files with suffix <\/span><span style = \"font-weight:bold;\">.anno<\/span><span> will be will be generated in the data folder. Each of these files will report the information about the circRNAs found in a specific database (es. circbase.anno will report the circBase information)<\/span><\/div><\/div>"}},{"id":1054725,"guid":"38A4EFF019B111E997BCA9AC776D78C0","order_id":2,"type_id":15,"title":"command","source":{"name":"# Annotation of a circRNA set based on information from public databases\ncircAnnotations(group=\"docker\", scratch.folder=scratch,\n ciri.file=paste0(data,\"\/merged_circs.crna\"), genome.version=\"hg19\")","command":"circRNAs annotation","os_name":"","os_version":""}}],"cases":null,"data":null,"section":null,"section_color":"#8b572a"},{"id":702764,"guid":"C75466728ACD4B8C94A74BBABDF5396D","previous_id":702761,"previous_guid":"3E8C88AABC1F4A008E412993A509FF4A","modified_on":1548844462,"protocol_id":0,"components":[{"id":1054723,"guid":"856B17AD9C704760AF8128B3DAA7D752","order_id":1,"type_id":6,"title":"Section","source":{"title":"Module 4: circRNAs expression analysis"}},{"id":1054724,"guid":"A9F0B1944ABD48129EB14A7B00925A46","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">Download of the RNA-Seq data in which quantify the expression of a circRNA set<\/span><\/div><div class = \"text-block\"><span>The RNA-Seq raw reads for the circRNAs quantification can be downloaded from <\/span><span style = \"font-weight:bold;\">PRJNA-411984<\/span><span>. This dataset includes RNA-Seq data of three CRC samples with matched data from normal mucosa samples.<\/span><\/div><div class = \"text-block\">The detailed list of datasets needed for the analysis is the following:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">SRA ID<\/span><span>                <\/span><span style = \"font-weight:bold;\">ID<\/span><\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">SRR6067723<\/span><\/a><\/div><div class = \"text-block\">     CRC_1<\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">SRR6067725<\/span><\/a><\/div><div class = \"text-block\">     CRC_2<\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">SRR6067727<\/span><\/a><\/div><div class = \"text-block\">     CRC_3<\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">SRR6067729<\/span><\/a><\/div><div class = \"text-block\">     Normal mucosa 1<\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">SRR6067731<\/span><\/a><\/div><div class = \"text-block\">     Normal mucosa 2\n<\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">SRR6067733<\/span><\/a><\/div><div class = \"text-block\">     Normal mucosa 3<\/div><div class = \"text-block\">For each dataset a specific folder in the data folder <\/div><div class = \"text-block\">The datasets can be downloaded using the following code applied using the url of the different datasets.<\/div><\/div>"}},{"id":1054725,"guid":"59D504E0182511E9A3ED97343731D3AC","order_id":2,"type_id":9,"title":"dataset","source":{"name":"PRJNA411984","link":"https:\/\/www.ebi.ac.uk\/ena\/data\/view\/PRJNA411984"}},{"id":1054726,"guid":"537EDC101A4111E9B5A33300E49046CD","order_id":3,"type_id":15,"title":"command","source":{"name":"# Define a variable storing the fastq url\nurl1 <- \"ftp:\/\/ftp.sra.ebi.ac.uk\/vol1\/fastq\/SRR606\/003\/SRR6067723\/SRR6067723_1.fastq.gz\"\nurl2 <- \"ftp:\/\/ftp.sra.ebi.ac.uk\/vol1\/fastq\/SRR606\/003\/SRR6067723\/SRR6067723_2.fastq.gz\"\n\n# Call wget to download the dataset into a specific folder\nsystem(paste(\"wget\", url1, \"-P\", paste0(data, \"\/SRR6067723\"))) \nsystem(paste(\"wget\", url2, \"-P\", paste0(data, \"\/SRR6067723\")))","command":"Download dataset","os_name":"","os_version":""}}],"cases":null,"data":null,"section":null,"section_color":"#417505"},{"id":702765,"guid":"541B0436E9C94CA9B763342CE4612C70","previous_id":702762,"previous_guid":"A82B84F373134921813BBE77CB4DCEBA","modified_on":1548844487,"protocol_id":0,"components":[{"id":1054723,"guid":"F31F7F1420204AA2847CA4390769F59B","order_id":1,"type_id":6,"title":"Section","source":{"title":"Module 4: circRNAs expression analysis"}},{"id":1054724,"guid":"0E6CD208BA314EB7B922A396DD8D903E","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span style = \"font-weight:bold;\">CircRNAs differential expression analysis<\/span><\/div><div class = \"text-block\"><span>Before the differential expression analysis of the circRNAs level detected by the circrnaQuantification function, the function <\/span><span style = \"font-weight:bold;font-style:italic;\">mergeData<\/span><span> should be applied in order to merge the result obtained for each dataset.<\/span><\/div><div class = \"text-block\"><span>The output of this function called <\/span><span style = \"font-weight:bold;\">MergedData.tsv <\/span><span>is a table reporting the counts of each annotation for each dataset. Furthermore, the sample identifiers reported in the header will be report the sample id followed by the corresponding  sample class. On this table the differential expression analysis can be perfomed using DESeq2 algorithm implemented in the <\/span><span style = \"font-weight:bold;font-style:italic;\">wrapperDeseq2<\/span><span> function.<\/span><\/div><\/div>"}},{"id":1054725,"guid":"22D7AE101A6511E9A5F4010F63310B07","order_id":2,"type_id":15,"title":"command","source":{"name":"# Define a variable storing the list of sample classes\ncov <- c(\"T\", \"T\", \"T\", \"N\", \"N\", \"N\")\ncov.order <- c(\"T\", \"N\")\n\n# Merge different file with extension hashcirc in the subfolders of data \nmergeData(group=\"docker\", scratch.folder=scratch, sample.ids=ids2, covariates=cov, covariate.order=cov.order, data.folder=data, \nextension=\"hashcirc\", column_index=2)","command":"Merge different data","os_name":"","os_version":""}},{"id":1054726,"guid":"049A2CB01A6611E9A5F4010F63310B07","order_id":3,"type_id":15,"title":"command","source":{"name":"# Differential expression analysis with DESeq2\nwrapperDeseq2(group=\"docker\",  output.folder=data,\nexperiment.table=paste0(data, \"\/MergedData.tsv\"), log2fc=0, fdr=0.05, ref.covar=\"N\", \ntype=\"gene\", batch=FALSE)","command":"Differential expression analysis","os_name":"","os_version":""}}],"cases":null,"data":null,"section":null,"section_color":"#417505"}],"materials":[],"description":"<div class = \"text-blocks\"><div class = \"text-block\">Despite many computational tools were developed to predict circular RNAs (circRNAs), a limited number of work-flows exists to fully analyse a circRNA set ensuring the computational reproducibility of the whole analysis.<\/div><div class = \"text-block\">For this purpose, we designed Docker4Circ, a computational work-flow for a comprehensive circRNAs analysis of a circRNAs composed of four modules: the circRNAs prediction (module 1), the circRNAs classification and annotation (module 2), the circRNAs sequence analysis (module 3),  and circRNAs expression analysis (module 4).<\/div><div class = \"text-block\"><span>To ensure reproducibility each function of Docker4Circ was embeded into a docker image following guideline provided by Reproducible Bioinformatics Project (RBP, <\/span><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">http:\/\/reproducible-bioinformatics.org\/)<\/span><\/a><span>. Each function is included in the Docker4Seq R package which already includes different solutions for reproducible bioinformatic analyses.<\/span><\/div><div class = \"text-block\">This protocol describes the use of each function of Docker4Circ to analyse the circRNAs predicted from a set of RNA-Seq experiments performed in normal colon and colorectal cancer cell lines. Furthermore, the description of the functions required to compute the expression level of the analysed circRNAs in a set of RNA-Seq experiments of colorectal primary tumors is provided.<\/div><\/div>","changed_on":1548844595}