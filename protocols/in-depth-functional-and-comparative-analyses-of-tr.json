{"uri":"in-depth-functional-and-comparative-analyses-of-tr-nhzdb76","version_id":"0","protocol_name":"In-depth functional and comparative analyses of transcriptomes with TRAPID","protocol_name_html":"In-depth functional and comparative analyses of transcriptomes with TRAPID","is_prepublished":"0","can_edit":"0","parent_id":null,"api_version":"1","is_new_mode":"0","last_modified":"1522231932","type_id":"1","link":"http:\/\/bioinformatics.psb.ugent.be\/webtools\/trapid","fork_id":"","public_fork_note":"","number_of_steps":"4","has_versions":"0","first_published_date":"1519991300","publish_date":"2018-03-02 11:48:20","documents":null,"have_protocol_in_step":"0","is_protocol_in_step":"0","vendor_name":"Contributed by users","vendor_link":"https:\/\/www.protocols.io","vendor_logo":"\/img\/vendors\/1.png","mod_mins":"-45","mod_secs":"1","description":"<section>\n<p><a href=\"http:\/\/bioinformatics.psb.ugent.be\/webtools\/trapid\/\" target=\"_blank\">TRAPID<\/a> is an online tool for the fast, reliable and user-friendly analysis of <em>de novo<\/em> transcriptomes, developed and maintained by the CNB group at VIB-UGent Center for Plant Systems Biology.<\/p>\n<p>\u00a0<\/p>\n<\/section>\n<p>This protocol explains how to perform advanced functional and comparative analyses after a transcriptome dataset was functionally annotated using TRAPID. <\/p>","is_bookmarked":"0","can_reassign":"1","before_start":"<p>In order to use TRAPID, make sure that:<\/p>\n<ul>\n<li>You are using a web browser with JavaScript and Adobe Flash enabled. Supported browsers: Safari, Chrome, Firefox (most recent versions).<\/li>\n<li>Java is installed on your machine (version JRE 6.0 or higher). This is required to launch the JalView alignment editor and the Archeopteryx tree viewer.<\/li>\n<\/ul>","has_guidelines":"1","materials":[],"warning":null,"version_class":"10521","public":"1","is_owner":"1","is_original_owner":"1","created_on":"1519737866","protocol_affiliation":"VIB-UGent Center for Plant Systems Biology","affiliation":null,"doi":"dx.doi.org\/10.17504\/protocols.io.nhzdb76","doi_status":"2","changed_fork_steps":null,"profile_url":"y2u274w2y2","protocol_img":"https:\/\/www.protocols.io\/img\/default_protocol.png","profile_image":"\/img\/avatars\/008.png","full_name":"Klaas Vandepoele","created_by":"Klaas Vandepoele","private_link":"B34AA78A31CEADB8ED7D829134859EBB","original_img":"1","username":"klaas-vandepoele","is_retracted":"0","retraction_reason":null,"plos_id":null,"manuscript_citation":null,"journal_name":null,"is_donations_disabled":"0","is_donations_disabled_by_user":"9","item_record_id":268054,"fork_info":[],"compare_forks":[{"protocol_id":"10610","protocol_name":"In-depth functional and comparative analyses of transcriptomes with TRAPID","protocol_name_html":"In-depth functional and comparative analyses of transcriptomes with TRAPID","uri":"in-depth-functional-and-comparative-analyses-of-tr-nksdcwe","full_name":"Klaas Vandepoele","affiliation":null,"affiliation_url":null,"username":"klaas-vandepoele"}],"protocols":[],"groups":[{"group_id":"502","group_uri":"SINGEK_ITN","group_name":"SINGEK_ITN","group_logo":"https:\/\/s3.amazonaws.com\/pr-journal\/n9ahxjn.png","requested_uid":null,"request_flag":null,"my_request":"1"}],"number_of_shared_runs":[],"ownership_history":[],"keywords":"TRAPID, transcriptomics, functional annotation, comparative genomics, RNA-seq","transfer_to_user":[],"sub_transfer":false,"is_transfer_pending":false,"number_of_bookmarks":"0","collections":[],"tags":[],"archived":0,"sub_authors":[],"sub_protocols_number":0,"can_edit_shared":0,"shared_runs":[],"is_shared_run":0,"is_shared":1,"banner":null,"contact_badges":[{"badge_id":"2","badge_image":"\/img\/badges\/bronze.svg","badge_description":"Author!"},{"badge_id":"5","badge_image":"\/img\/badges\/earlyadopter.svg","badge_description":"Early adopter"},{"badge_id":"6","badge_image":"\/img\/badges\/socialbutterfly.svg","badge_description":"Social butterfly"}],"number_of_comments":0,"is_locked":0,"is_locked_by":false,"authors":"Francois Bucchini,Michiel Van Bal,Klaas Vandepoele","authors_list":[{"name":"Francois Bucchini","affiliation":"VIB-UGent Center for Plant Systems Biology","username":null,"profile_image":null},{"name":"Michiel Van Bal","affiliation":"VIB-UGent Center for Plant Systems Biology","username":null,"profile_image":null},{"name":"Klaas Vandepoele","affiliation":"VIB-UGent Center for Plant Systems Biology","username":"klaas-vandepoele","profile_image":"\/img\/avatars\/008.png"}],"user":{"profile_image":"\/img\/avatars\/008.png","username":"klaas-vandepoele","full_name":"Klaas Vandepoele","created_by":"Klaas Vandepoele"},"access":{"can_view":"1","can_remove":"0","can_add":"0","can_edit":0,"can_publish":0,"can_get_doi":0,"can_share":"0","can_move":"1","can_transfer":"1","can_download":"1","is_locked":"0"},"is_contact_suspended":0,"guidelines":"<p>In this protocol, we work with an example dataset consisting in 25,392 transcript sequences from <em>Panicum hallii <\/em>(<a href=\"https:\/\/doi.org\/10.1111\/j.1365-313X.2012.04938.x\" target=\"_blank\">Meyer et al. 2012<\/a>). This dataset can be retrieved from TRAPID's FTP <a href=\"ftp:\/\/ftp.psb.ugent.be\/pub\/trapid\/datasets\/panicum\" target=\"_blank\">here<\/a>.<\/p>","status_id":"1","is_research":"1","status_info":"We use this protocol in our group and it is working","steps":[{"id":"611755","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"5240382929D3424CB3E98C001A2DE2AF","previous_guid":null,"previous_id":"0","last_modified":"1519833134","components":[{"component_id":"1065036","previous_id":0,"original_id":"0","guid":"CD0EC2A71D654E289C17749F2F3BC228","previous_guid":null,"component_type_id":"1","data_id":null,"data":"<p>The analyses presented in this protocol require to know how to perform initial processing of transcript sequences using TRAPID.\u00a0 For detailed guidelines regarding how to perform initial processing and a general overview of the TRAPID platform, please see our 'Functional annotation and analysis of de novo transcriptomes with TRAPID' protocol.<\/p>\n<p>\u00a0<\/p>\n<p>In this second protocol, we will work with the same example dataset as in the first one. It consists in 25,392 transcript sequences from <em>Panicum hallii <\/em>(<a href=\"https:\/\/doi.org\/10.1111\/j.1365-313X.2012.04938.x\" target=\"_blank\">Meyer et al. 2012<\/a>). This dataset can be retrieved from TRAPID's FTP <a href=\"ftp:\/\/ftp.psb.ugent.be\/pub\/trapid\/datasets\/panicum\" target=\"_blank\">here<\/a>.<\/p>","order_id":"0","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>The analyses presented in this protocol require to know how to perform initial processing of transcript sequences using TRAPID.\u00a0 For detailed guidelines regarding how to perform initial processing and a general overview of the TRAPID platform, please see our 'Functional annotation and analysis of de novo transcriptomes with TRAPID' protocol.<\/p>\n<p>\u00a0<\/p>\n<p>In this second protocol, we will work with the same example dataset as in the first one. It consists in 25,392 transcript sequences from <em>Panicum hallii <\/em>(<a href=\"https:\/\/doi.org\/10.1111\/j.1365-313X.2012.04938.x\" target=\"_blank\">Meyer et al. 2012<\/a>). This dataset can be retrieved from TRAPID's FTP <a href=\"ftp:\/\/ftp.psb.ugent.be\/pub\/trapid\/datasets\/panicum\" target=\"_blank\">here<\/a>.<\/p>"},"is_project":0},{"component_id":"1065037","previous_id":"1065036","original_id":"0","guid":"3A0F317B6130465397051757FBCF01D3","previous_guid":"CD0EC2A71D654E289C17749F2F3BC228","component_type_id":"6","data_id":"0","data":"Initial processing","order_id":"1","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Initial processing"},"is_project":0}]},{"id":"611756","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"183113214A4942C6AF4ADEA9DEF680B7","previous_guid":"EBC34D7CBC324C6DA0095EA34D8EC40C","previous_id":"612024","last_modified":"1519838577","components":[{"component_id":"1065038","previous_id":0,"original_id":"0","guid":"3AA534D98E884EE5BA87329ED017E9C8","previous_guid":null,"component_type_id":"1","data_id":null,"data":"<div>\n<div>\n<p>Apart from the functional annotation of individual transcripts, and the analyses in the gene family context, TRAPID also supports the quantitative analysis of experiment subsets using GO and protein domain enrichment statistics. For more details regarding subset creation, refer to our other protocol. <\/p>\n<p>\u00a0<\/p>\n<p>Specific comparative analyses than can be performed using subsets are:<\/p>\n<p>\u00a0<\/p>\n<ul>\n<li>GO terms or InterPro protein domains enrichment (subset versus all; hypergeometric distribution, <\/li>\n<li>GO terms \/ InterPro protein domains ratios between subsets, including subset-specific GO annotations, <\/li>\n<li>Subsets examination. It is possible to examine transcripts specific to a certain subset or a combination of subsets.<\/li>\n<\/ul>\n<\/div>\n<\/div>\n<div>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>\n<p><strong>Functional enrichment analysis example: cell cycle genes<\/strong><\/p>\n<p>\u00a0<\/p>\n<p>In this example, we want to see if there are any GO terms or protein domains that are significantly over-represented in a set of cell cycle transcripts compared to the whole <em>Panicum <\/em>transcriptome.<\/p>\n<p>\u00a0<\/p>\n<ol>\n<li>Download the list of cell cycle transcripts, available <a href=\"ftp:\/\/ftp.psb.ugent.be\/pub\/trapid\/datasets\/panicum\/panicum_cell_cycle.lst\" target=\"_blank\">here<\/a> (TRAPID FTP).<\/li>\n<li>Add the labels to the dataset. From the experiment overview page, click <em>Import data<\/em> next to <em>Import transcript labels<\/em>. On the next page, hit browse to select the file, enter a label (e.g. <em>Cell_cycle<\/em>) and click <em>Import labels<\/em>.<\/li>\n<li>Go back to the experiment overview page, in the <em>Toolbox<\/em> a number of new options are enabled. To check if this set is enriched for specific GO terms or protein domains, click <em>GO enrichment from a subset compared to background<\/em> or <em>Protein domain enrichment from a set compared to background<\/em>. For both GO and Protein domains, select the subset (here <em>Cell_cycle<\/em>) and the desired p-value and click <em>Compute enrichment<\/em>. The enrichment should be computed within a few minutes, at most.\u00a0 <\/li>\n<\/ol>\n<p>\u00a0<\/p>\n<p>Figure 10 shows the enrichment resultspage with for each of the enriched InterPro domains the fold enrichment, significance and a short description. Note that the InterPro domain codes are hyperlinks to pages with more detailed information.<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>\n<br \/>\n<p>\u00a0<\/p>\n<div style=\"width: 278px;\"><a href=\"http:\/\/bioinformatics.psb.ugent.be\/webtools\/trapid\/img\/tutorial\/011_interpro_enrichment.png\" target=\"_blank\"><img src=\"http:\/\/bioinformatics.psb.ugent.be\/webtools\/trapid\/img\/tutorial\/011_interpro_enrichment.png\" alt=\"InterPro enrichment\" width=\"276\" \/><\/a> <br \/><strong> FIGURE 11 ENRICHED INTERPRO DOMAINS<\/strong> Overview of InterPro domain enrichted within the 'Cell Cycle' subset<\/div>\n<p>\u00a0<\/p>\n<\/div>","order_id":"0","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<div>\n<div>\n<p>Apart from the functional annotation of individual transcripts, and the analyses in the gene family context, TRAPID also supports the quantitative analysis of experiment subsets using GO and protein domain enrichment statistics. For more details regarding subset creation, refer to our other protocol. <\/p>\n<p>\u00a0<\/p>\n<p>Specific comparative analyses than can be performed using subsets are:<\/p>\n<p>\u00a0<\/p>\n<ul>\n<li>GO terms or InterPro protein domains enrichment (subset versus all; hypergeometric distribution, <\/li>\n<li>GO terms \/ InterPro protein domains ratios between subsets, including subset-specific GO annotations, <\/li>\n<li>Subsets examination. It is possible to examine transcripts specific to a certain subset or a combination of subsets.<\/li>\n<\/ul>\n<\/div>\n<\/div>\n<div>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>\n<p><strong>Functional enrichment analysis example: cell cycle genes<\/strong><\/p>\n<p>\u00a0<\/p>\n<p>In this example, we want to see if there are any GO terms or protein domains that are significantly over-represented in a set of cell cycle transcripts compared to the whole <em>Panicum <\/em>transcriptome.<\/p>\n<p>\u00a0<\/p>\n<ol>\n<li>Download the list of cell cycle transcripts, available <a href=\"ftp:\/\/ftp.psb.ugent.be\/pub\/trapid\/datasets\/panicum\/panicum_cell_cycle.lst\" target=\"_blank\">here<\/a> (TRAPID FTP).<\/li>\n<li>Add the labels to the dataset. From the experiment overview page, click <em>Import data<\/em> next to <em>Import transcript labels<\/em>. On the next page, hit browse to select the file, enter a label (e.g. <em>Cell_cycle<\/em>) and click <em>Import labels<\/em>.<\/li>\n<li>Go back to the experiment overview page, in the <em>Toolbox<\/em> a number of new options are enabled. To check if this set is enriched for specific GO terms or protein domains, click <em>GO enrichment from a subset compared to background<\/em> or <em>Protein domain enrichment from a set compared to background<\/em>. For both GO and Protein domains, select the subset (here <em>Cell_cycle<\/em>) and the desired p-value and click <em>Compute enrichment<\/em>. The enrichment should be computed within a few minutes, at most.\u00a0 <\/li>\n<\/ol>\n<p>\u00a0<\/p>\n<p>Figure 10 shows the enrichment resultspage with for each of the enriched InterPro domains the fold enrichment, significance and a short description. Note that the InterPro domain codes are hyperlinks to pages with more detailed information.<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>\n<br \/>\n<p>\u00a0<\/p>\n<div style=\"width: 278px;\"><a href=\"http:\/\/bioinformatics.psb.ugent.be\/webtools\/trapid\/img\/tutorial\/011_interpro_enrichment.png\" target=\"_blank\"><img src=\"http:\/\/bioinformatics.psb.ugent.be\/webtools\/trapid\/img\/tutorial\/011_interpro_enrichment.png\" alt=\"InterPro enrichment\" width=\"276\" \/><\/a> <br \/><strong> FIGURE 11 ENRICHED INTERPRO DOMAINS<\/strong> Overview of InterPro domain enrichted within the 'Cell Cycle' subset<\/div>\n<p>\u00a0<\/p>\n<\/div>"},"is_project":0},{"component_id":"1065039","previous_id":"1065038","original_id":"0","guid":"1FD45808E561451A9CDD0854A2EEFB30","previous_guid":"3AA534D98E884EE5BA87329ED017E9C8","component_type_id":"6","data_id":"0","data":"Within-transcriptome functional analysis using experiment subsets","order_id":"1","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Within-transcriptome functional analysis using experiment subsets"},"is_project":0}]},{"id":"612018","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"15A27A3F843644679CF37AD549C7EA68","previous_guid":"5240382929D3424CB3E98C001A2DE2AF","previous_id":"611755","last_modified":"1519834294","components":[{"component_id":"1065651","previous_id":0,"original_id":"0","guid":"4852004A2C1B4963A59B296699F21F12","previous_guid":null,"component_type_id":"1","data_id":null,"data":"<p>For transcripts that were flagged as potentially containing frameshifts during the initial processing, we offer the possibility to run <a href=\"https:\/\/doi.org\/10.1093\/bioinformatics\/btp024\" target=\"_blank\">FrameDP<\/a> to putatively correct the transcript sequence and identify the correct Open Reading Frame (ORF). FrameDP is a program that uses BLAST together with machine learning methods to build models used to test whether a sequence has a putative frameshift or not. The model is then used to correct the sequence (by inserting N-nucleotides at the necessary locations), which of course also impacts the associated ORF.\u00a0\u00a0<\/p>\n<p>\u00a0<\/p>\n<p>To perform frameshift correction of a transcript, select <em>'Correct framseshifts with FrameDP'<\/em> in the <em>'Toolbox'<\/em> on any transcript page.<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>\n<p><strong>Frameshift correction example<\/strong> (single <em>Panicum<\/em> transcript containing an indel)<\/p>\n<p>\u00a0<\/p>\n<ol>\n<li>Create a new experiment (named <em>'Tutorial 2'<\/em> for example) using the example <em>Panicum <\/em>dataset and PLAZA 2.5 as reference database.<\/li>\n<li>Start the transcript processing using <em>'Eudicots'<\/em> as the phylogenetic clade.<\/li>\n<li>Once the processing is finished, go to the <em>Experiment overview<\/em> page and select a transcript (e.g. <em>contig17160<\/em>).<\/li>\n<li>The transcript page will show the line 'A putative frameshift was detected in this sequence'. To attempt to correct this frameshift, select <em>Correct framseshifts with FrameDP<\/em> in the toolbox.<\/li>\n<li>The next page asks if you want to correct additional genes from the same family. This is not needed here, so you can click <em>'Perform frameshift correction'<\/em>.<\/li>\n<li>A new job is started and after a while you will receive a notification via e-mail.<\/li>\n<li>After completion, TRAPID will indicate if a frameshift was corrected or not and on the transcript page the corrected ORF can be obtained.<\/li>\n<\/ol>","order_id":"0","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>For transcripts that were flagged as potentially containing frameshifts during the initial processing, we offer the possibility to run <a href=\"https:\/\/doi.org\/10.1093\/bioinformatics\/btp024\" target=\"_blank\">FrameDP<\/a> to putatively correct the transcript sequence and identify the correct Open Reading Frame (ORF). FrameDP is a program that uses BLAST together with machine learning methods to build models used to test whether a sequence has a putative frameshift or not. The model is then used to correct the sequence (by inserting N-nucleotides at the necessary locations), which of course also impacts the associated ORF.\u00a0\u00a0<\/p>\n<p>\u00a0<\/p>\n<p>To perform frameshift correction of a transcript, select <em>'Correct framseshifts with FrameDP'<\/em> in the <em>'Toolbox'<\/em> on any transcript page.<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>\n<p><strong>Frameshift correction example<\/strong> (single <em>Panicum<\/em> transcript containing an indel)<\/p>\n<p>\u00a0<\/p>\n<ol>\n<li>Create a new experiment (named <em>'Tutorial 2'<\/em> for example) using the example <em>Panicum <\/em>dataset and PLAZA 2.5 as reference database.<\/li>\n<li>Start the transcript processing using <em>'Eudicots'<\/em> as the phylogenetic clade.<\/li>\n<li>Once the processing is finished, go to the <em>Experiment overview<\/em> page and select a transcript (e.g. <em>contig17160<\/em>).<\/li>\n<li>The transcript page will show the line 'A putative frameshift was detected in this sequence'. To attempt to correct this frameshift, select <em>Correct framseshifts with FrameDP<\/em> in the toolbox.<\/li>\n<li>The next page asks if you want to correct additional genes from the same family. This is not needed here, so you can click <em>'Perform frameshift correction'<\/em>.<\/li>\n<li>A new job is started and after a while you will receive a notification via e-mail.<\/li>\n<li>After completion, TRAPID will indicate if a frameshift was corrected or not and on the transcript page the corrected ORF can be obtained.<\/li>\n<\/ol>"},"is_project":0},{"component_id":"1065652","previous_id":"1065651","original_id":"0","guid":"43CA759D4677458CA93139ED8C85ABD9","previous_guid":"4852004A2C1B4963A59B296699F21F12","component_type_id":"6","data_id":"0","data":"Frameshift correction","order_id":"1","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Frameshift correction"},"is_project":0}]},{"id":"612024","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"EBC34D7CBC324C6DA0095EA34D8EC40C","previous_guid":"15A27A3F843644679CF37AD549C7EA68","previous_id":"612018","last_modified":"1519835140","components":[{"component_id":"1065663","previous_id":0,"original_id":"0","guid":"8B155689CEC449F19885094AC2830BD7","previous_guid":null,"component_type_id":"1","data_id":null,"data":"<div>\n<p><strong>Multiple sequence alignments<\/strong><\/p>\n<p>\u00a0<\/p>\n<p style=\"text-align: justify;\">Starting from any given transcript, you can generate amino acid multiple sequence alignment (MSA) within a gene family context. As such, you can create an MSA containing the transcripts within a gene family together with a selection of coding sequences from the reference database. Within TRAPID, MSAs are created using <a href=\"http:\/\/www.ebi.ac.uk\/Tools\/msa\/muscle\/\" target=\"_blank\">MUSCLE<\/a>. In order to reduce the computation time, the maximum number of iterations in the MUSCLE algorithm is fixed at three, and all other settings are left at default values.<\/p>\n<\/div>\n<div style=\"text-align: justify;\">\u00a0<\/div>\n<div style=\"text-align: justify;\"><strong>Phylogenetic trees<\/strong><\/div>\n<div style=\"text-align: justify;\">\u00a0<\/div>\n<div style=\"text-align: justify;\">\n<p>Similar to the MSA, you can also create a phylogenetic tree within a gene family context. In order to create phylogenetic trees which are less dependent on putative large gaps, the standard MSA is transformed to a <em>stripped<\/em> MSA. In this stripped MSA the alignment length is reduced by removing all positions for which a certain fraction (0.10 for stringent editing, 0.25 for relaxed editing) is a gap. As such, all gaps introduced by a small number of sequences will be removed. Note that in some cases the stringent editing yields a stripped MSA with zero or only a few conserved alignment positions. In this happens, please re-run the tree analysis using the relaxed editing option (which will yield more conserved alignment positions).<\/p>\n<p>\u00a0<\/p>\n<p>Two different tree inference algorithms can be use within TRAPID: <a href=\"http:\/\/meta.microbesonline.org\/fasttree\/\" target=\"_blank\">FastTree<\/a> and <a href=\"http:\/\/www.atgc-montpellier.fr\/phyml\/\" target=\"_blank\">PhyMl<\/a>. Although FastTree is used by default (because of its very short execution time), you can choose which algorithm to use, and -if desired- how many bootstrap runs will be applied. If you defined subsets within your experiment, these subsets can also be displayed on the phylogenetic tree, making subsequent analyses much easier. By default, the meta-annotation is displayed as domains next to the phylogenetic tree.<\/p>\n<p>\u00a0<\/p>\n<p>From the phylogenetic tree page, the tree can be exported in PhyloXML and Newick formats.<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>\n<p><strong>How to generate MSAs and trees<\/strong><\/p>\n<p>\u00a0<\/p>\n<ol>\n<li>Select a transcript, either through the search function, or through any link in the platform<\/li>\n<li>On the transcript page, select the associated gene family<\/li>\n<li>On the gene family page, select the <em>create multiple sequence alignment<\/em> or<em> create phylogenetic tree<\/em> from the toolbox<\/li>\n<li>Select the reference species from the reference database you want to include in the tree<\/li>\n<\/ol>\n<\/div>\n<p style=\"text-align: justify;\">\u00a0<\/p>\n<p style=\"text-align: justify;\">\u00a0<\/p>\n<p style=\"text-align: justify;\"><strong>MSA and phylogenetic tree creation example<\/strong><strong><br \/><\/strong><\/p>\n<p style=\"text-align: justify;\">\u00a0<\/p>\n<p style=\"text-align: justify;\">Using the processed <em>Panicum <\/em>dataset (as shown in our first protocol):<\/p>\n<p style=\"text-align: justify;\">\u00a0<\/p>\n<ol>\n<li>Search for the GO term <em>leaf senescence<\/em> and look at the genes assigned this label in the dataset.<\/li>\n<li>\u00a0Look at <strong>contig04501<\/strong>, this transcript is annotated as quasi full length. Now click the gene family ID next to the transcript identifier: this will take you to the corresponding gene family page.<\/li>\n<li>Build the multiple sequence alignment for this gene family by clicking <em>Create multiple sequence alignment<\/em> in the toolbox. After the alignment is generated, a link will appear to start JalView to view the sequence alignment, or download the alignment.<\/li>\n<li>Click <em>View full multiple sequence alignment<\/em> to start JalView. From this alignment can be seen the transcript has indeed a good alignment with most of the other members in the family, though at the N-terminal end there likely is a portion missing (and hence is indeed quasi full length). The other transcript (contig20276) is the opposite, here the C-terminal end appears to be missing. Potentially both contigs represent a single, split transcript.<\/li>\n<li>Go back and look for <strong>contig01069<\/strong>. Find the gene family page of this transcript and in the toolbox select <em>Create phylogenetic tree<\/em>.<\/li>\n<li>On the next page, tree creation settings can be adjusted. Switch the Editing from <em>Stringent editing<\/em> to <em>Relaxed editing<\/em> (optionally fewer species can be selected). Click <em>Create phylogenetic tree<\/em>.<\/li>\n<li>Once the tree is built and you received the confirmation email (usually within a few minutes), go back to the gene family page and click View<em> phylogenetic tree<\/em> to view the created tree. Now an ATV applet will be included on the page which displays the tree, as shown in figure 1.<\/li>\n<\/ol>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>\n<p><img src=\"https:\/\/s3.amazonaws.com\/pr-journal\/t5shxq6.png\" width=\"411\" height=\"446\" data-src=\"https:\/\/s3.amazonaws.com\/pr-journal\/t5rhxq6.png\" data-ofn=\"010_phylo_tree.png\" \/><\/p>\n<p><strong>Figure 1:<\/strong> phylogenetic tree ATV applet displaying the phylogenetic tree of\u00a0 contig01069 and its orthologs.<\/p>\n<div style=\"width: 278px;\">\n<p>\u00a0<\/p>\n<\/div>","order_id":"0","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<div>\n<p><strong>Multiple sequence alignments<\/strong><\/p>\n<p>\u00a0<\/p>\n<p style=\"text-align: justify;\">Starting from any given transcript, you can generate amino acid multiple sequence alignment (MSA) within a gene family context. As such, you can create an MSA containing the transcripts within a gene family together with a selection of coding sequences from the reference database. Within TRAPID, MSAs are created using <a href=\"http:\/\/www.ebi.ac.uk\/Tools\/msa\/muscle\/\" target=\"_blank\">MUSCLE<\/a>. In order to reduce the computation time, the maximum number of iterations in the MUSCLE algorithm is fixed at three, and all other settings are left at default values.<\/p>\n<\/div>\n<div style=\"text-align: justify;\">\u00a0<\/div>\n<div style=\"text-align: justify;\"><strong>Phylogenetic trees<\/strong><\/div>\n<div style=\"text-align: justify;\">\u00a0<\/div>\n<div style=\"text-align: justify;\">\n<p>Similar to the MSA, you can also create a phylogenetic tree within a gene family context. In order to create phylogenetic trees which are less dependent on putative large gaps, the standard MSA is transformed to a <em>stripped<\/em> MSA. In this stripped MSA the alignment length is reduced by removing all positions for which a certain fraction (0.10 for stringent editing, 0.25 for relaxed editing) is a gap. As such, all gaps introduced by a small number of sequences will be removed. Note that in some cases the stringent editing yields a stripped MSA with zero or only a few conserved alignment positions. In this happens, please re-run the tree analysis using the relaxed editing option (which will yield more conserved alignment positions).<\/p>\n<p>\u00a0<\/p>\n<p>Two different tree inference algorithms can be use within TRAPID: <a href=\"http:\/\/meta.microbesonline.org\/fasttree\/\" target=\"_blank\">FastTree<\/a> and <a href=\"http:\/\/www.atgc-montpellier.fr\/phyml\/\" target=\"_blank\">PhyMl<\/a>. Although FastTree is used by default (because of its very short execution time), you can choose which algorithm to use, and -if desired- how many bootstrap runs will be applied. If you defined subsets within your experiment, these subsets can also be displayed on the phylogenetic tree, making subsequent analyses much easier. By default, the meta-annotation is displayed as domains next to the phylogenetic tree.<\/p>\n<p>\u00a0<\/p>\n<p>From the phylogenetic tree page, the tree can be exported in PhyloXML and Newick formats.<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>\n<p><strong>How to generate MSAs and trees<\/strong><\/p>\n<p>\u00a0<\/p>\n<ol>\n<li>Select a transcript, either through the search function, or through any link in the platform<\/li>\n<li>On the transcript page, select the associated gene family<\/li>\n<li>On the gene family page, select the <em>create multiple sequence alignment<\/em> or<em> create phylogenetic tree<\/em> from the toolbox<\/li>\n<li>Select the reference species from the reference database you want to include in the tree<\/li>\n<\/ol>\n<\/div>\n<p style=\"text-align: justify;\">\u00a0<\/p>\n<p style=\"text-align: justify;\">\u00a0<\/p>\n<p style=\"text-align: justify;\"><strong>MSA and phylogenetic tree creation example<\/strong><strong><br \/><\/strong><\/p>\n<p style=\"text-align: justify;\">\u00a0<\/p>\n<p style=\"text-align: justify;\">Using the processed <em>Panicum <\/em>dataset (as shown in our first protocol):<\/p>\n<p style=\"text-align: justify;\">\u00a0<\/p>\n<ol>\n<li>Search for the GO term <em>leaf senescence<\/em> and look at the genes assigned this label in the dataset.<\/li>\n<li>\u00a0Look at <strong>contig04501<\/strong>, this transcript is annotated as quasi full length. Now click the gene family ID next to the transcript identifier: this will take you to the corresponding gene family page.<\/li>\n<li>Build the multiple sequence alignment for this gene family by clicking <em>Create multiple sequence alignment<\/em> in the toolbox. After the alignment is generated, a link will appear to start JalView to view the sequence alignment, or download the alignment.<\/li>\n<li>Click <em>View full multiple sequence alignment<\/em> to start JalView. From this alignment can be seen the transcript has indeed a good alignment with most of the other members in the family, though at the N-terminal end there likely is a portion missing (and hence is indeed quasi full length). The other transcript (contig20276) is the opposite, here the C-terminal end appears to be missing. Potentially both contigs represent a single, split transcript.<\/li>\n<li>Go back and look for <strong>contig01069<\/strong>. Find the gene family page of this transcript and in the toolbox select <em>Create phylogenetic tree<\/em>.<\/li>\n<li>On the next page, tree creation settings can be adjusted. Switch the Editing from <em>Stringent editing<\/em> to <em>Relaxed editing<\/em> (optionally fewer species can be selected). Click <em>Create phylogenetic tree<\/em>.<\/li>\n<li>Once the tree is built and you received the confirmation email (usually within a few minutes), go back to the gene family page and click View<em> phylogenetic tree<\/em> to view the created tree. Now an ATV applet will be included on the page which displays the tree, as shown in figure 1.<\/li>\n<\/ol>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>\n<p><img src=\"https:\/\/s3.amazonaws.com\/pr-journal\/t5shxq6.png\" width=\"411\" height=\"446\" data-src=\"https:\/\/s3.amazonaws.com\/pr-journal\/t5rhxq6.png\" data-ofn=\"010_phylo_tree.png\" \/><\/p>\n<p><strong>Figure 1:<\/strong> phylogenetic tree ATV applet displaying the phylogenetic tree of\u00a0 contig01069 and its orthologs.<\/p>\n<div style=\"width: 278px;\">\n<p>\u00a0<\/p>\n<\/div>"},"is_project":0},{"component_id":"1065664","previous_id":"1065663","original_id":"0","guid":"9C590943E6AE457883DE05A7008D8788","previous_guid":"8B155689CEC449F19885094AC2830BD7","component_type_id":"6","data_id":"0","data":"Phylogenetic analysis of a specific gene family","order_id":"1","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Phylogenetic analysis of a specific gene family"},"is_project":0},{"component_id":"1065883","previous_id":"1065664","original_id":"0","guid":"F2F78CE4F6EC491FA6E9FABFD476180E","previous_guid":"9C590943E6AE457883DE05A7008D8788","component_type_id":"26","data_id":"17709","data":"","order_id":"2","name":"Note","data_by_id":"1","type_id":"26","source_data":{"annotation_id":"17709","thread_id":"17709","id":"17709","thread_title":"Comment on step 3 of In-depth functional and comparative analyses of transcriptomes with TRAPID","uri":"comment-on-step-3-of-indepth-functional-and-comparative","thread_uri":"comment-on-step-3-of-indepth-functional-and-comparative","step_id":"612024","protocol_uri":"in-depth-functional-and-comparative-analyses-of-tr-nhzdb76","protocol_name":"In-depth functional and comparative analyses of transcriptomes with TRAPID","protocol_name_html":"In-depth functional and comparative analyses of transcriptomes with TRAPID","annotation":"<p><strong>Settings used for phylogenetic tree creation:<\/strong> for FastTree we use the following non-default settings: <span style=\"font-size: x-small;\"> '--wag gamma'<\/span>, which indicate that the algorithm uses the WAG+CAT model, and rescales the branch lengths. For PhyML we use the following non-default settings: <span style=\"font-size: x-small;\">'-m WAG -f e -c 4 -a e'<\/span>, which indicate that the algorithm uses the WAG+CAT model, that empirical amino acid frequencies are used, that 4 relative substitution rate categories are used, and that the parameter for the gamma distribution shape is based on the maximum likelihood estimate.<\/p>\n<p>\u00a0<\/p>","thread_text":"<p><strong>Settings used for phylogenetic tree creation:<\/strong> for FastTree we use the following non-default settings: <span style=\"font-size: x-small;\"> '--wag gamma'<\/span>, which indicate that the algorithm uses the WAG+CAT model, and rescales the branch lengths. For PhyML we use the following non-default settings: <span style=\"font-size: x-small;\">'-m WAG -f e -c 4 -a e'<\/span>, which indicate that the algorithm uses the WAG+CAT model, that empirical amino acid frequencies are used, that 4 relative substitution rate categories are used, and that the parameter for the gamma distribution shape is based on the maximum likelihood estimate.<\/p>\n<p>\u00a0<\/p>","body":"<p><strong>Settings used for phylogenetic tree creation:<\/strong> for FastTree we use the following non-default settings: <span style=\"font-size: x-small;\"> '--wag gamma'<\/span>, which indicate that the algorithm uses the WAG+CAT model, and rescales the branch lengths. For PhyML we use the following non-default settings: <span style=\"font-size: x-small;\">'-m WAG -f e -c 4 -a e'<\/span>, which indicate that the algorithm uses the WAG+CAT model, that empirical amino acid frequencies are used, that 4 relative substitution rate categories are used, and that the parameter for the gamma distribution shape is based on the maximum likelihood estimate.<\/p>\n<p>\u00a0<\/p>","is_private":"0","public_protocol":"1","can_edit":0,"can_delete":"0","show_name":"0","created_date":"1519834130","created_on":"1519834130","modified_on":null,"last_updated":null,"profile_image":"\/img\/avatars\/008.png","full_name":"Klaas Vandepoele","affiliation":null,"username":"klaas-vandepoele","email":"klaas.vandepoele@psb.vib-ugent.be","pa_useranme":"klaas-vandepoele","comments":[]},"is_project":0}]}]}