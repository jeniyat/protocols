{"uri":"stranded-mapping-from-long-reads-n8ddhs6","version_id":"1","protocol_name":"Stranded Mapping from Long Reads","protocol_name_html":"Stranded Mapping from Long Reads","is_prepublished":"0","can_edit":"0","parent_id":"11236","api_version":"1","is_new_mode":"0","last_modified":"1522840849","type_id":"1","link":"https:\/\/bioinformatics.stackexchange.com\/a\/3922\/73","fork_id":"","public_fork_note":"","number_of_steps":"15","has_versions":"1","first_published_date":"1522840849","publish_date":"2018-04-04 11:20:49","documents":null,"have_protocol_in_step":"0","is_protocol_in_step":"0","vendor_name":"Contributed by users","vendor_link":"https:\/\/www.protocols.io","vendor_logo":"\/img\/vendors\/1.png","mod_mins":"-45","mod_secs":"1","description":"<p>This protocol demonstrates how to convert raw long reads produced using a strand-specific sequencing protocol (e.g. ONT's strand-switching protocol) into strand-specific mapped reads.<\/p>\n<p>\u00a0<\/p>\n<p>The general ides is to use LAST to identify the adapter orientation relative to the genome, and then use that information to split BAM files up and recombine them to create two strand-specific files that are displayable in a genome browser.<\/p>","is_bookmarked":"0","can_reassign":"1","before_start":"<p>I have written <a href=\"https:\/\/github.com\/gringer\/bioinfscripts\/blob\/master\/maf_bcsplit.pl\" target=\"_blank\" rel=\"noopener noreferrer\">my own script<\/a> to process LAST results into a CSV format, which makes it easier to do line-by-line data filtering. I have also created a <a href=\"https:\/\/github.com\/gringer\/bioinfscripts\/blob\/master\/fastx-fetch.pl\" target=\"_blank\" rel=\"noopener noreferrer\">fastq filtering script<\/a> that helps for filtering reads into different files.<\/p>\n<p>\u00a0<\/p>\n<p>You will also need access to the following free and open-source software programs:<\/p>\n<ul>\n<li><a href=\"http:\/\/last.cbrc.jp\/\" target=\"_blank\" rel=\"noopener noreferrer\">LAST<\/a><\/li>\n<li><a href=\"https:\/\/github.com\/lh3\/minimap2#install\" target=\"_blank\" rel=\"noopener noreferrer\">minimap2<\/a><\/li>\n<li><a href=\"http:\/\/www.htslib.org\/download\/\" target=\"_blank\" rel=\"noopener noreferrer\">samtools<\/a><\/li>\n<\/ul>\n<p>And the following additional data files:<\/p>\n<ul>\n<li>a FASTA file containing strand-specific primer \/ adapter sequences.<\/li>\n<\/ul>","has_guidelines":"0","materials":[],"warning":"<p><em>T<\/em>hese scripts have been slightly modified from scripts that I have run. Consider them demonstrative: pay attention to the words rather than the script.<\/p>","version_class":"11236","public":"1","is_owner":"1","is_original_owner":"1","created_on":"1522819027","protocol_affiliation":"Malaghan Institute of Medical Research (NZ)","affiliation":"Malaghan Institute of Medical Research (NZ)","doi":"dx.doi.org\/10.17504\/protocols.io.n8ddhs6","doi_status":"2","changed_fork_steps":null,"profile_url":"DavidEccles-y2138443y2","protocol_img":"https:\/\/s3.amazonaws.com\/pr-journal\/vi4jpt6.png","profile_image":"https:\/\/s3.amazonaws.com\/pr-journal\/vi7jpt6.jpg","full_name":"David Eccles","created_by":"David Eccles","private_link":"EA3083BE7EBBE0040AD89737DC3D8E3C","original_img":"1","username":"david-eccles","is_retracted":"0","retraction_reason":null,"plos_id":null,"manuscript_citation":null,"journal_name":null,"is_donations_disabled":"0","is_donations_disabled_by_user":"9","item_record_id":301059,"fork_info":[],"compare_forks":[],"protocols":[],"groups":[],"number_of_shared_runs":[],"ownership_history":[{"created_on":"2018-04-04 05:17:07","change_time":"2018-04-04 05:17:07","username":"lenny-teytelman8","full_name":"Lenny Teytelman","profile_image":"https:\/\/s3.amazonaws.com\/pr-journal\/st2cz36.png","affiliation":"protocols.io"},{"created_on":"2018-04-04 05:28:26","change_time":"2018-04-04 05:28:26","username":"david-eccles","profile_image":"https:\/\/s3.amazonaws.com\/pr-journal\/vi7jpt6.jpg","full_name":"David Eccles","affiliation":"Malaghan Institute of Medical Research (NZ)"}],"keywords":"","transfer_to_user":[],"sub_transfer":false,"is_transfer_pending":false,"number_of_bookmarks":"2","collections":[],"tags":[{"tag_id":"8","tag_name":"RNA-seq"},{"tag_id":"454","tag_name":"bioinformatics"},{"tag_id":"472","tag_name":"RNA"},{"tag_id":"643","tag_name":"long read sequencing"},{"tag_id":"767","tag_name":"Analysis"},{"tag_id":"893","tag_name":"cDNA"}],"archived":0,"sub_authors":[],"sub_protocols_number":0,"can_edit_shared":0,"shared_runs":[],"is_shared_run":0,"is_shared":1,"banner":null,"contact_badges":[{"badge_id":"2","badge_image":"\/img\/badges\/bronze.svg","badge_description":"Author!"},{"badge_id":"6","badge_image":"\/img\/badges\/socialbutterfly.svg","badge_description":"Social butterfly"}],"number_of_comments":1,"big_protocol_img":"https:\/\/s3.amazonaws.com\/pr-journal\/vi3jpt6.png","big_protocol_img_ofn":"stranded_mtdna.png","is_locked":0,"is_locked_by":false,"authors":"David Eccles","authors_list":[{"name":"David Eccles","affiliation":"Malaghan Institute of Medical Research (NZ)","username":"david-eccles","profile_image":"https:\/\/s3.amazonaws.com\/pr-journal\/vi7jpt6.jpg"}],"user":{"profile_image":"https:\/\/s3.amazonaws.com\/pr-journal\/vi7jpt6.jpg","username":"david-eccles","full_name":"David Eccles","created_by":"David Eccles"},"access":{"can_view":"1","can_remove":"0","can_add":"0","can_edit":0,"can_publish":0,"can_get_doi":0,"can_share":"0","can_move":"1","can_transfer":"1","can_download":"1","is_locked":"0"},"is_contact_suspended":0,"guidelines":null,"status_id":"2","is_research":"1","status_info":"We are still developing and optimizing this protocol","steps":[{"id":"618702","is_changed":1,"original_id":"618696","is_skipped":"0","is_checked":"0","guid":"3CC00A4FDD174DF5A3AD508593A09621","previous_guid":"EE1B77E477C14EB78C29658480384015","previous_id":"618785","last_modified":"1522836761","components":[{"component_id":"1083170","previous_id":0,"original_id":"1083159","guid":"8CEBDD934E4D420198DCD8BDEBFE2D59","previous_guid":null,"component_type_id":"6","data_id":null,"data":"Read Correction","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Read Correction"},"is_project":0},{"component_id":"1083171","previous_id":"1083170","original_id":"1083158","guid":"02F5EA6E3C504361886CC37F3F70B279","previous_guid":"8CEBDD934E4D420198DCD8BDEBFE2D59","component_type_id":"1","data_id":null,"data":"<p>I prefer starting off my data analysis with a read correction with Canu (ideally v1.7 now that it's out, because that attempts correction of <em>all<\/em> reads, but here I use canu v1.6). I use <code>minimap<\/code> as the mapper to speed this up. The <code>genomeSize<\/code> parameter should be approximately a tenth to a fortieth of the number of bases in your dataset to make sure that no sequences are excluded (bigger is better, as long as Canu doesn't freak out about memory consumption):<\/p>\n<p>\u00a0<\/p>\n<p>(This creates a file <code>4T1_BC06\/4T1_BC06.correctedReads.fasta.gz<\/code>.)<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>I prefer starting off my data analysis with a read correction with Canu (ideally v1.7 now that it's out, because that attempts correction of <em>all<\/em> reads, but here I use canu v1.6). I use <code>minimap<\/code> as the mapper to speed this up. The <code>genomeSize<\/code> parameter should be approximately a tenth to a fortieth of the number of bases in your dataset to make sure that no sequences are excluded (bigger is better, as long as Canu doesn't freak out about memory consumption):<\/p>\n<p>\u00a0<\/p>\n<p>(This creates a file <code>4T1_BC06\/4T1_BC06.correctedReads.fasta.gz<\/code>.)<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>"},"is_project":0},{"component_id":"1083377","previous_id":"1083171","original_id":"0","guid":"2B5979C3A9274C8EAC4576AB7F3C2C66","previous_guid":"02F5EA6E3C504361886CC37F3F70B279","component_type_id":"15","data_id":"3721","data":"","order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"~\/install\/canu\/canu-1.6\/Linux-amd64\/bin\/canu overlapper=minimap genomeSize=100M minReadLength=100 minOverlapLength=30 -correct -p 4T1_BC06 -d 4T1_BC06 -nanopore-raw  workspace\/pass\/barcode06\/fastq_runid_*.fastq","description":"Read correction using Canu v1.6","os_name":"","os_version":"","can_edit":"1"},"is_project":0}],"available_protocols":["11236"]},{"id":"618704","is_changed":1,"original_id":"618698","is_skipped":"0","is_checked":"0","guid":"87B8CBAB18F64099A0C34B516D71B835","previous_guid":"1609C9FF90C74F1F86EEA2D9C0A6B998","previous_id":"618708","last_modified":"1522838467","components":[{"component_id":"1083174","previous_id":0,"original_id":"1083163","guid":"8F4C8B03C10E4B26B1AD8B3000146676","previous_guid":null,"component_type_id":"6","data_id":null,"data":"Adapter filtering","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Adapter filtering"},"is_project":0},{"component_id":"1083175","previous_id":"1083174","original_id":"1083162","guid":"2E7EC196D10048AF819C52883813114D","previous_guid":"8F4C8B03C10E4B26B1AD8B3000146676","component_type_id":"1","data_id":null,"data":"<p>Along roughly similar lines to the chimeric read filtering, I then look for the strand switch and VNT adapters in the sequences. For a forward-orientated query, I expect the strand switch primer to be in the forward direction, and the VNP primer to be in the reverse direction.<\/p>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>Along roughly similar lines to the chimeric read filtering, I then look for the strand switch and VNT adapters in the sequences. For a forward-orientated query, I expect the strand switch primer to be in the forward direction, and the VNP primer to be in the reverse direction.<\/p>"},"is_project":0}],"available_protocols":["11236"]},{"id":"618705","is_changed":1,"original_id":"618699","is_skipped":"0","is_checked":"0","guid":"DA60B5EECB7248DD8512A79B702D8F40","previous_guid":"0DCE5895D1F845FE88E66C1A362865C4","previous_id":"618803","last_modified":"1522838649","components":[{"component_id":"1083176","previous_id":0,"original_id":"1083165","guid":"23D479BE26824B9C946123C6D26D1CAF","previous_guid":null,"component_type_id":"6","data_id":null,"data":"Read Mapping","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Read Mapping"},"is_project":0},{"component_id":"1083177","previous_id":"1083176","original_id":"1083164","guid":"8FB4856EC87F4EC5B03179EDCB0890D4","previous_guid":"23D479BE26824B9C946123C6D26D1CAF","component_type_id":"1","data_id":null,"data":"<p>Now that the reads have been oriented, the mapping can be done<code>.<\/code> I use <code>minimap2<\/code> for mapping long reads to a transcriptome.<\/p>\n<p><code>\n<\/code><\/p>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>Now that the reads have been oriented, the mapping can be done<code>.<\/code> I use <code>minimap2<\/code> for mapping long reads to a transcriptome.<\/p>\n<p><code>\n<\/code><\/p>"},"is_project":0},{"component_id":"1083435","previous_id":"1083177","original_id":"0","guid":"9C77B019284F49009FF58DC136255C0C","previous_guid":"8FB4856EC87F4EC5B03179EDCB0890D4","component_type_id":"15","data_id":"3730","data":"","order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"~\/install\/minimap2\/minimap2 -t 10 -a mmus_ucsc_all_cdna.idx -x splice fwd_4T1_BC06.correctedReads.uniqueOnly.fasta.gz  > fwd_4T1_BC06.CU_vs_mmus.bam\n\n~\/install\/minimap2\/minimap2 -t 10 -a mmus_ucsc_all_cdna.idx -x splice rev_4T1_BC06.correctedReads.uniqueOnly.fasta.gz  > rev_4T1_BC06.CU_vs_mmus.bam","description":"Mapping reads to a transcriptome using minimap2","os_name":"","os_version":"","can_edit":"1"},"is_project":0}],"available_protocols":["11236"]},{"id":"618707","is_changed":1,"original_id":"618701","is_skipped":"0","is_checked":"0","guid":"817E0F0FFD3F4CFEA42D94AF38497650","previous_guid":"C2D14BC740F54DE9939F3A8CD5BFFD92","previous_id":"618807","last_modified":"1522840289","components":[{"component_id":"1083180","previous_id":0,"original_id":"1083169","guid":"5C8E8EC17D914FE3AC2188D70ABF7F30","previous_guid":null,"component_type_id":"6","data_id":null,"data":"Sanity Check","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Sanity Check"},"is_project":0},{"component_id":"1083181","previous_id":"1083180","original_id":"1083168","guid":"72F5545EB9714501BF24F130613FA2B7","previous_guid":"5C8E8EC17D914FE3AC2188D70ABF7F30","component_type_id":"1","data_id":null,"data":"","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":""},"is_project":0},{"component_id":"1083452","previous_id":"1083181","original_id":"0","guid":"F56F22D38D444DE6A8AF75F17805C374","previous_guid":"72F5545EB9714501BF24F130613FA2B7","component_type_id":"17","data_id":"1530","data":"<p>If this has worked properly, then mapping human or mouse to the mitochondrial genome should show most expression appearing on the positive strand, with a small scattering of negative-strand expression, a bit like this:<\/p>\n<p><a href=\"https:\/\/i.stack.imgur.com\/YU56W.png\" target=\"_blank\" rel=\"noopener noreferrer\"><img src=\"https:\/\/i.stack.imgur.com\/YU56W.png\" alt=\"mtDNA transcript expression (nanopore)\" \/><\/a><\/p>","order_id":"2","name":"Expected result","data_by_id":"1","type_id":"17","source_data":{"result":"<p>If this has worked properly, then mapping human or mouse to the mitochondrial genome should show most expression appearing on the positive strand, with a small scattering of negative-strand expression, a bit like this:<\/p>\n<p><a href=\"https:\/\/i.stack.imgur.com\/YU56W.png\" target=\"_blank\" rel=\"noopener noreferrer\"><img src=\"https:\/\/i.stack.imgur.com\/YU56W.png\" alt=\"mtDNA transcript expression (nanopore)\" \/><\/a><\/p>"},"is_project":0}],"available_protocols":["11236"]},{"id":"618708","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"1609C9FF90C74F1F86EEA2D9C0A6B998","previous_guid":"C3D0F811AB9345E592BBE87B6FCD2EA0","previous_id":"618797","last_modified":"1522838420","components":[{"component_id":"1083185","previous_id":0,"original_id":"0","guid":"BEA00EFC14724AC6990A6655BFB8A9EC","previous_guid":null,"component_type_id":"6","data_id":"0","data":"Chimeric read filtering","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Chimeric read filtering"},"is_project":0},{"component_id":"1083184","previous_id":"1083185","original_id":"0","guid":"7B74713434D44715BCB20CD10B985CE9","previous_guid":"BEA00EFC14724AC6990A6655BFB8A9EC","component_type_id":"1","data_id":null,"data":"<p>I use this file to filter out chimeric reads from the corrected dataset using another <a href=\"https:\/\/github.com\/gringer\/bioinfscripts\/blob\/master\/fastx-fetch.pl\" target=\"_blank\" rel=\"noopener noreferrer\">fastq filtering script<\/a> I've created:<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>I use this file to filter out chimeric reads from the corrected dataset using another <a href=\"https:\/\/github.com\/gringer\/bioinfscripts\/blob\/master\/fastx-fetch.pl\" target=\"_blank\" rel=\"noopener noreferrer\">fastq filtering script<\/a> I've created:<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>"},"is_project":0},{"component_id":"1083434","previous_id":"1083184","original_id":"0","guid":"71EA9B62F8FB4585949EDB57EB632E23","previous_guid":"7B74713434D44715BCB20CD10B985CE9","component_type_id":"15","data_id":"3729","data":"","order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"~\/scripts\/fastx-fetch.pl -v -i reads_with_duplicated_adapters.txt 4T1_BC06\/4T1_BC06.correctedReads.fasta.gz |  gzip > 4T1_BC06.correctedReads.uniqueOnly.fasta.gz","description":"Removing reads with duplicated adapters","os_name":"","os_version":"","can_edit":"1"},"is_project":0}]},{"id":"618785","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"EE1B77E477C14EB78C29658480384015","previous_guid":null,"previous_id":"0","last_modified":"1522836605","components":[{"component_id":"1083380","previous_id":0,"original_id":"0","guid":"79682904EA984E34B8D76623C6CB18D3","previous_guid":null,"component_type_id":"6","data_id":"0","data":"Read Correction","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Read Correction"},"is_project":0},{"component_id":"1083379","previous_id":"1083380","original_id":"0","guid":"60CE22E098904D858FA37A34C7937038","previous_guid":"79682904EA984E34B8D76623C6CB18D3","component_type_id":"1","data_id":null,"data":"<p>Download canu v1.6 or later<\/p>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>Download canu v1.6 or later<\/p>"},"is_project":0},{"component_id":"1083385","previous_id":"1083379","original_id":"0","guid":"06FE6F4ABA52498D9D4BCF6B882AE9E5","previous_guid":"60CE22E098904D858FA37A34C7937038","component_type_id":"8","data_id":"231","data":"","order_id":"2","name":"Software package","data_by_id":"1","type_id":"8","source_data":{"id":"231","name":"canu","developer":"Maryland Bioinformatics Labs","repository":"https:\/\/github.com\/marbl\/canu","link":"https:\/\/github.com\/marbl\/canu\/releases","os_name":"Linux \/ Darwin","os_version":"","version":"1.6","can_edit":"1"},"is_project":0}]},{"id":"618797","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"C3D0F811AB9345E592BBE87B6FCD2EA0","previous_guid":"3CC00A4FDD174DF5A3AD508593A09621","previous_id":"618702","last_modified":"1522837470","components":[{"component_id":"1083417","previous_id":0,"original_id":"0","guid":"2C8E543270364C4E95C0D5836975E53E","previous_guid":null,"component_type_id":"6","data_id":"0","data":"Chimeric read filtering","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Chimeric read filtering"},"is_project":0},{"component_id":"1083416","previous_id":"1083417","original_id":"0","guid":"D645ECCFAA284620A858D491CAC418FE","previous_guid":"2C8E543270364C4E95C0D5836975E53E","component_type_id":"1","data_id":null,"data":"<p>The next step I carry out is a basic read-level QC to exclude <a href=\"https:\/\/f1000research.com\/articles\/6-631\/v2\" target=\"_blank\" rel=\"noopener noreferrer\">chimeric reads<\/a>. <a href=\"https:\/\/github.com\/rrwick\/Porechop\" target=\"_blank\" rel=\"noopener noreferrer\">Porechop<\/a> can be used for this, although that removes adapters by default, which is not particularly useful in this case.<\/p>\n<p>\u00a0<\/p>\n<p>I use LAST to search for adapter sequences within the corrected reads, pass it through <a href=\"https:\/\/github.com\/gringer\/bioinfscripts\/blob\/master\/maf_bcsplit.pl\" target=\"_blank\" rel=\"noopener noreferrer\">my conversion script<\/a>, and extract out duplicated mappings (i.e. where the same read\/adapter pair appears more than once in the mapping results):<\/p>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>The next step I carry out is a basic read-level QC to exclude <a href=\"https:\/\/f1000research.com\/articles\/6-631\/v2\" target=\"_blank\" rel=\"noopener noreferrer\">chimeric reads<\/a>. <a href=\"https:\/\/github.com\/rrwick\/Porechop\" target=\"_blank\" rel=\"noopener noreferrer\">Porechop<\/a> can be used for this, although that removes adapters by default, which is not particularly useful in this case.<\/p>\n<p>\u00a0<\/p>\n<p>I use LAST to search for adapter sequences within the corrected reads, pass it through <a href=\"https:\/\/github.com\/gringer\/bioinfscripts\/blob\/master\/maf_bcsplit.pl\" target=\"_blank\" rel=\"noopener noreferrer\">my conversion script<\/a>, and extract out duplicated mappings (i.e. where the same read\/adapter pair appears more than once in the mapping results):<\/p>"},"is_project":0},{"component_id":"1083418","previous_id":"1083416","original_id":"0","guid":"93F39468879849E99A96A4560A499DB5","previous_guid":"D645ECCFAA284620A858D491CAC418FE","component_type_id":"15","data_id":"3725","data":"","order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"lastal -P 10 ONT_barcodes_adapters.fa <(zcat 4T1_BC06\/4T1_BC06.correctedReads.fasta.gz) | ~\/scripts\/maf_bcsplit.pl | awk -F',' '{print $1,$2}' | sort | uniq -d | awk '{print $1}' | uniq > reads_with_duplicated_adapters.txt","description":"Mapping adapter sequences with LAST","os_name":"","os_version":"","can_edit":"1"},"is_project":0}]},{"id":"618798","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"683E39AECA6C419A9A39E8B8D0465FF8","previous_guid":"87B8CBAB18F64099A0C34B516D71B835","previous_id":"618704","last_modified":"1522838446","components":[{"component_id":"1083420","previous_id":0,"original_id":"0","guid":"E2BC3B93D5EE41248967F35304F8708F","previous_guid":null,"component_type_id":"6","data_id":"0","data":"Adapter filtering","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Adapter filtering"},"is_project":0},{"component_id":"1083419","previous_id":"1083420","original_id":"0","guid":"3AB08A822AFF4AB5BCDD663242FEEA61","previous_guid":"E2BC3B93D5EE41248967F35304F8708F","component_type_id":"1","data_id":null,"data":"<p>Transcript-forward reads are identified. In this case a sequence is transcript-forward if the `ONT_SSP`primer is in the forward orientation, or the `ONT_VNP` primer is in the reverse orientation.<\/p>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>Transcript-forward reads are identified. In this case a sequence is transcript-forward if the `ONT_SSP`primer is in the forward orientation, or the `ONT_VNP` primer is in the reverse orientation.<\/p>"},"is_project":0},{"component_id":"1083421","previous_id":"1083419","original_id":"0","guid":"FBC4FB0351474C8D9C9906E1477849B4","previous_guid":"3AB08A822AFF4AB5BCDD663242FEEA61","component_type_id":"15","data_id":"3726","data":"","order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"lastal -P 10 ONT_barcodes_adapters.fa <(zcat 4T1_BC06.correctedReads.uniqueOnly.fasta.gz) | ~\/scripts\/maf_bcsplit.pl | grep -e 'ONT_SSP,+' -e 'ONT_VNP,-' |   awk -F',' '{print $1}' | sort | uniq > fwdQry_seqs_BC06.txt","description":"Identifying transcript-forward reads with LAST","os_name":"","os_version":"","can_edit":"1"},"is_project":0}]},{"id":"618800","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"338D253BAD564630AF4F9C62672EBF4D","previous_guid":"683E39AECA6C419A9A39E8B8D0465FF8","previous_id":"618798","last_modified":"1522837933","components":[{"component_id":"1083425","previous_id":0,"original_id":"0","guid":"4A476A86C39348F1A3037CDD79C646B0","previous_guid":null,"component_type_id":"6","data_id":"0","data":"Adapter filtering","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Adapter filtering"},"is_project":0},{"component_id":"1083424","previous_id":"1083425","original_id":"0","guid":"0D1034211FD24DFC9C7CF2B2F4FDD190","previous_guid":"4A476A86C39348F1A3037CDD79C646B0","component_type_id":"1","data_id":null,"data":"<p>Transcript-reverse reads are identified. In this case a sequence is transcript-reverse if the `ONT_SSP`primer is in the reverse orientation, or the `ONT_VNP` primer is in the forward orientation.<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>Transcript-reverse reads are identified. In this case a sequence is transcript-reverse if the `ONT_SSP`primer is in the reverse orientation, or the `ONT_VNP` primer is in the forward orientation.<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>"},"is_project":0},{"component_id":"1083427","previous_id":"1083424","original_id":"0","guid":"55943D8FF1DA46FE963E99AC56CED032","previous_guid":"0D1034211FD24DFC9C7CF2B2F4FDD190","component_type_id":"15","data_id":"3727","data":"","order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"lastal -P 10 barcodes_primerSeqs.fa <(zcat 4T1_BC06.correctedReads.uniqueOnly.fasta.gz) | ~\/scripts\/maf_bcsplit.pl | grep -e 'ONT_SSP,-' -e 'ONT_VNP,+' |  awk -F',' '{print $1}' | sort | uniq > revQry_seqs_BC06.txt","description":"Identifying transcript-reverse reads with LAST","os_name":"","os_version":"","can_edit":"1"},"is_project":0}]},{"id":"618802","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"B8220B406FD24FFD9AA62D3896FE268E","previous_guid":"338D253BAD564630AF4F9C62672EBF4D","previous_id":"618800","last_modified":"1522838311","components":[{"component_id":"1083432","previous_id":0,"original_id":"0","guid":"CD41ED46126F4EB2885F4A43A465F373","previous_guid":null,"component_type_id":"6","data_id":"0","data":"Adapter filtering","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Adapter filtering"},"is_project":0},{"component_id":"1083431","previous_id":"1083432","original_id":"0","guid":"59280879E5C84C1FA9FA3E9940566695","previous_guid":"CD41ED46126F4EB2885F4A43A465F373","component_type_id":"1","data_id":null,"data":"<p>The read name lists are used by my <a href=\"https:\/\/github.com\/gringer\/bioinfscripts\/blob\/master\/fastx-fetch.pl\" target=\"_blank\" rel=\"noopener noreferrer\">read filtering script<\/a> to split the original reads up into transcript-forward and transcript-reverse subsets:<\/p>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>The read name lists are used by my <a href=\"https:\/\/github.com\/gringer\/bioinfscripts\/blob\/master\/fastx-fetch.pl\" target=\"_blank\" rel=\"noopener noreferrer\">read filtering script<\/a> to split the original reads up into transcript-forward and transcript-reverse subsets:<\/p>"},"is_project":0},{"component_id":"1083433","previous_id":"1083431","original_id":"0","guid":"10D50FC267C643F8AADD7AD76E8C211C","previous_guid":"59280879E5C84C1FA9FA3E9940566695","component_type_id":"15","data_id":"3728","data":"","order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"~\/scripts\/fastx-fetch.pl -i fwdQry_seqs_BC06.txt 4T1_BC06.correctedReads.uniqueOnly.fasta.gz |  gzip > fwd_4T1_BC06.correctedReads.uniqueOnly.fasta.gz\n\n~\/scripts\/fastx-fetch.pl -i revQry_seqs_BC06.txt 4T1_BC06.correctedReads.uniqueOnly.fasta.gz | gzip > rev_4T1_BC06.correctedReads.uniqueOnly.fasta.gz","description":"Filtering reads into transcript-forward and transcript-reverse subsets","os_name":"","os_version":"","can_edit":"1"},"is_project":0}]},{"id":"618803","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"0DCE5895D1F845FE88E66C1A362865C4","previous_guid":"B8220B406FD24FFD9AA62D3896FE268E","previous_id":"618802","last_modified":"1522838918","components":[{"component_id":"1083437","previous_id":0,"original_id":"0","guid":"42614D69BB2E43738BE0F4731D90CAF2","previous_guid":null,"component_type_id":"6","data_id":"0","data":"Read Mapping","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Read Mapping"},"is_project":0},{"component_id":"1083436","previous_id":"1083437","original_id":"0","guid":"3EB32079CA89428798FFF9387877B024","previous_guid":"42614D69BB2E43738BE0F4731D90CAF2","component_type_id":"1","data_id":null,"data":"<p>Download minimap2 v2.10 or later<\/p>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>Download minimap2 v2.10 or later<\/p>"},"is_project":0},{"component_id":"1083439","previous_id":"1083436","original_id":"0","guid":"BDF80AA6D5024C28AAE576F655583049","previous_guid":"3EB32079CA89428798FFF9387877B024","component_type_id":"8","data_id":"232","data":"","order_id":"2","name":"Software package","data_by_id":"1","type_id":"8","source_data":{"id":"232","name":"minimap2","developer":"Heng Li","repository":"https:\/\/github.com\/lh3\/minimap2","link":"https:\/\/github.com\/lh3\/minimap2\/releases","os_name":"Linux","os_version":"","version":"2.10","can_edit":"1"},"is_project":0}]},{"id":"618804","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"6261DFAB2D17436E8CBE81A002D3E7B9","previous_guid":"DA60B5EECB7248DD8512A79B702D8F40","previous_id":"618705","last_modified":"1522839215","components":[{"component_id":"1083441","previous_id":0,"original_id":"0","guid":"C8921B9D104F407EB1F31DB96742FC86","previous_guid":null,"component_type_id":"6","data_id":"0","data":"Splitting and recombining strands","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Splitting and recombining strands"},"is_project":0},{"component_id":"1083440","previous_id":"1083441","original_id":"0","guid":"9D4964BFFD604F56A0AC079EDE1911EA","previous_guid":"C8921B9D104F407EB1F31DB96742FC86","component_type_id":"1","data_id":null,"data":"<p>Download samtools v1.8 or later<\/p>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>Download samtools v1.8 or later<\/p>"},"is_project":0},{"component_id":"1083442","previous_id":"1083440","original_id":"0","guid":"D895D92D26064AA88A2EB15884D49433","previous_guid":"9D4964BFFD604F56A0AC079EDE1911EA","component_type_id":"8","data_id":"233","data":"","order_id":"2","name":"Software package","data_by_id":"1","type_id":"8","source_data":{"id":"233","name":"SAMtools","developer":"Wellcome Trust Sanger Institute","repository":"https:\/\/github.com\/samtools\/samtools","link":"http:\/\/www.htslib.org\/download\/","os_name":"Linux","os_version":"","version":"1.8","can_edit":"1"},"is_project":0}]},{"id":"618805","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"27C1A23FFD9C46C0A85ED56316AA02C3","previous_guid":"6261DFAB2D17436E8CBE81A002D3E7B9","previous_id":"618804","last_modified":"1522839763","components":[{"component_id":"1083445","previous_id":0,"original_id":"0","guid":"A10F04756F1C4CF3ADCD0A72CA1AB804","previous_guid":null,"component_type_id":"6","data_id":"0","data":"Splitting and recombining strands","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Splitting and recombining strands"},"is_project":0},{"component_id":"1083444","previous_id":"1083445","original_id":"0","guid":"0CAEEFFCBB424CE8A784F8696DF2C36E","previous_guid":"A10F04756F1C4CF3ADCD0A72CA1AB804","component_type_id":"1","data_id":null,"data":"<p>Mapped BAM files are split based on how they are oriented to the <em>genome<\/em> using SAMtools. This uses the `-F` or `-f` options of `samtools view` to exclude or include reads (respectively) that are mapped to the genome in the forward or reverse orientation (respectively).<\/p>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>Mapped BAM files are split based on how they are oriented to the <em>genome<\/em> using SAMtools. This uses the `-F` or `-f` options of `samtools view` to exclude or include reads (respectively) that are mapped to the genome in the forward or reverse orientation (respectively).<\/p>"},"is_project":0},{"component_id":"1083446","previous_id":"1083444","original_id":"0","guid":"5A81D81E32EF427DBB54001E512736FD","previous_guid":"0CAEEFFCBB424CE8A784F8696DF2C36E","component_type_id":"15","data_id":"3732","data":"","order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"samtools view -F 0x10 -b fwd_4T1_BC06.CU_vs_mmus.bam > fwd_fwd_4T1_BC06.CU_vs_mmus.bam \n\nsamtools view -f 0x10 -b fwd_4T1_BC06.CU_vs_mmus.bam > rev_fwd_4T1_BC06.CU_vs_mmus.bam \n\nsamtools view -F 0x10 -b rev_4T1_BC06.CU_vs_mmus.bam > fwd_rev_4T1_BC06.CU_vs_mmus.bam \n\nsamtools view -f 0x10 -b rev_4T1_BC06.CU_vs_mmus.bam > rev_rev_4T1_BC06.CU_vs_mmus.bam","description":"Splitting BAM files with samtools based on genome-relative orientation","os_name":"","os_version":"","can_edit":"1"},"is_project":0}]},{"id":"618806","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"D409F7BDA08D4113A1936C82612F9809","previous_guid":"27C1A23FFD9C46C0A85ED56316AA02C3","previous_id":"618805","last_modified":"1522840219","components":[{"component_id":"1083450","previous_id":0,"original_id":"0","guid":"0BD7FF1130A3476B91C45E16EF9649E9","previous_guid":null,"component_type_id":"6","data_id":"0","data":"Splitting and recombining strands","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Splitting and recombining strands"},"is_project":0},{"component_id":"1083449","previous_id":"1083450","original_id":"0","guid":"BFFCF50934A141F6AF5B3A6EE8F9C7FD","previous_guid":"0BD7FF1130A3476B91C45E16EF9649E9","component_type_id":"1","data_id":null,"data":"<p>And finally the files are recombined to identify forward and reverse-encoded transcripts via <code>samtools merge<\/code>. I'm calling the \"pos\" strand the one that is encoded in the same direction as the genome, and the \"neg\" strand the reverse-complement direction:<\/p>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>And finally the files are recombined to identify forward and reverse-encoded transcripts via <code>samtools merge<\/code>. I'm calling the \"pos\" strand the one that is encoded in the same direction as the genome, and the \"neg\" strand the reverse-complement direction:<\/p>"},"is_project":0},{"component_id":"1083451","previous_id":"1083449","original_id":"0","guid":"45D3AB2A3C414EC08CEDE90560293744","previous_guid":"BFFCF50934A141F6AF5B3A6EE8F9C7FD","component_type_id":"15","data_id":"3735","data":"","order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"samtools merge pos_4T1_BC06.CU_vs_mmus.bam  rev_fwd_4T1_BC06.CU_vs_mmus.bam fwd_rev_4T1_BC06.CU_vs_mmus.bam\n\nsamtools merge neg_4T1_BC06.CU_vs_mmus.bam  fwd_fwd_4T1_BC06.CU_vs_mmus.bam rev_rev_4T1_BC06.CU_vs_mmus.bam","description":"Merging forward and reverse-oriented reads with `samtools merge`","os_name":"","os_version":"","can_edit":"1"},"is_project":0}]},{"id":"618807","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"C2D14BC740F54DE9939F3A8CD5BFFD92","previous_guid":"D409F7BDA08D4113A1936C82612F9809","previous_id":"618806","last_modified":"1522840525","components":[{"component_id":"1083454","previous_id":0,"original_id":"0","guid":"6AECE8923021463C8160CA1C594D0523","previous_guid":null,"component_type_id":"6","data_id":"0","data":"Splitting and recombining strands","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Splitting and recombining strands"},"is_project":0},{"component_id":"1083453","previous_id":"1083454","original_id":"0","guid":"A2E8FED870E847269BED3038BFECB518","previous_guid":"6AECE8923021463C8160CA1C594D0523","component_type_id":"1","data_id":null,"data":"","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":""},"is_project":0},{"component_id":"1083455","previous_id":"1083453","original_id":"0","guid":"5BB72363901E4890B6BC86AAC3D69705","previous_guid":"A2E8FED870E847269BED3038BFECB518","component_type_id":"26","data_id":"18172","data":"","order_id":"2","name":"Note","data_by_id":"1","type_id":"26","source_data":{"annotation_id":"18172","thread_id":"18172","id":"18172","thread_title":"Comment on step 14 of Stranded Mapping from Long Reads","uri":"comment-on-step-14-of-stranded-mapping-from-long-reads","thread_uri":"comment-on-step-14-of-stranded-mapping-from-long-reads","step_id":"618807","protocol_uri":"stranded-mapping-from-long-reads-n8ddhs6","protocol_name":"Stranded Mapping from Long Reads","protocol_name_html":"Stranded Mapping from Long Reads","annotation":"<p>Alternatively, it's possible to set the BAM flags for read 1 and read 2 for the reverse and forward-encoded adapters respectively, which allows everything to then be combined into a single BAM file (and treated in the same way as a strand-specific Illumina BAM file).<\/p>","thread_text":"<p>Alternatively, it's possible to set the BAM flags for read 1 and read 2 for the reverse and forward-encoded adapters respectively, which allows everything to then be combined into a single BAM file (and treated in the same way as a strand-specific Illumina BAM file).<\/p>","body":"<p>Alternatively, it's possible to set the BAM flags for read 1 and read 2 for the reverse and forward-encoded adapters respectively, which allows everything to then be combined into a single BAM file (and treated in the same way as a strand-specific Illumina BAM file).<\/p>","is_private":"0","public_protocol":"1","can_edit":0,"can_delete":"0","show_name":"0","created_date":"1522840360","created_on":"1522840360","modified_on":null,"last_updated":null,"profile_image":"https:\/\/s3.amazonaws.com\/pr-journal\/vi7jpt6.jpg","full_name":"David Eccles","affiliation":"Malaghan Institute of Medical Research (NZ)","username":"david-eccles","email":"bioinformatics@gringene.org","pa_useranme":"david-eccles","comments":[]},"is_project":0}]}]}