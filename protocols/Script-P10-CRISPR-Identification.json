{"uri":"Script-P10-CRISPR-Identification-ehdbb26","version_id":"0","protocol_name":"Script P10: CRISPR Identification","protocol_name_html":"Script P10: CRISPR Identification","is_prepublished":"0","can_edit":"0","parent_id":null,"api_version":"2","is_new_mode":"1","last_modified":"1516341603","type_id":"1","link":"http:\/\/mbio.asm.org\/content\/6\/5\/e01578-15.full","fork_id":"","public_fork_note":"","number_of_steps":"55","has_versions":"0","first_published_date":"1457616342","publish_date":"2016-03-11 02:57:00","documents":"null","have_protocol_in_step":"0","is_protocol_in_step":"0","vendor_name":"Contributed by users","vendor_link":"https:\/\/www.protocols.io","vendor_logo":"\/img\/vendors\/1.png","mod_mins":"-45","mod_secs":"1","description":"This protocol provides a method for identifing CRIPR repeats using the program PilerCR on assembled contigs. Based on the methods from the following publication:\u00a0<br \/><br \/>Hannigan, Geoffrey D., et al. \"The Human Skin Double-Stranded DNA Virome: Topographical and Temporal Diversity, Genetic Enrichment, and Dynamic Associations with the Host Microbiome.\"\u00a0<em>mBio<\/em>\u00a06.5 (2015): e01578-15.","is_bookmarked":"0","can_reassign":"1","before_start":"Perl scripts and other supplemental information available at:<br \/><br \/><a href=\"https:\/\/figshare.com\/articles\/The_Human_Skin_dsDNA_Virome_Topographical_and_Temporal_Diversity_Genetic_Enrichment_and_Dynamic_Associations_with_the_Host_Microbiome\/1281248\" target=\"_blank\">https:\/\/figshare.com\/articles\/The_Human_Skin_dsDNA_Virome_Topographical_and_Temporal_Diversity_Genetic_Enrichment_and_Dynamic_Associations_with_the_Host_Microbiome\/1281248<\/a>","has_guidelines":"1","materials":[],"warning":"","version_class":"2309","public":"1","is_owner":"1","is_original_owner":"1","created_on":"1454450307","protocol_affiliation":"DEPARTMENT OF DERMATOLOGY UNIVERSITY OF PENNSYLVANIA","affiliation":"Merck Research Labs","doi":"dx.doi.org\/10.17504\/protocols.io.ehdbb26","doi_status":"2","changed_fork_steps":null,"profile_url":"Geoffrey-w2y254v2q2","protocol_img":"https:\/\/www.protocols.io\/img\/default_protocol.png","profile_image":"https:\/\/s3.amazonaws.com\/pr-journal\/cpedy2n.jpg","full_name":"Geoffrey Hannigan","created_by":"Geoffrey Hannigan","private_link":"2CF453E842F1FA2C787FABFDA10CD8AC","original_img":"1","username":"geoffrey-hannigan","is_retracted":"0","retraction_reason":null,"plos_id":null,"manuscript_citation":null,"journal_name":null,"is_donations_disabled":"0","is_donations_disabled_by_user":"9","item_record_id":226779,"fork_info":[],"compare_forks":[],"protocols":[],"groups":[{"group_id":"45","group_uri":"verve-net","group_name":"VERVE Net","group_logo":"https:\/\/s3.amazonaws.com\/pr-journal\/cdqcwwe.png","requested_uid":null,"request_flag":null,"my_request":"1"},{"group_id":"138","group_uri":"club-grice","group_name":"Club Grice","group_logo":"https:\/\/s3.amazonaws.com\/pr-journal\/cp7dzme.png","requested_uid":null,"request_flag":null,"my_request":"1"}],"number_of_shared_runs":[],"ownership_history":[],"keywords":"","transfer_to_user":[],"sub_transfer":false,"is_transfer_pending":false,"number_of_bookmarks":"0","collections":[{"protocol_name":"The Human Skin dsDNA Virome: Topographical and Temporal Diversity, Genetic Enrichment, and its Dynamic Associations with the Host Microbiome","protocol_name_html":"The Human Skin dsDNA Virome: Topographical and Temporal Diversity, Genetic Enrichment, and its Dynamic Associations with the Host Microbiome","uri":"The-Human-Skin-dsDNA-Virome-Topographical-and-Temp-ekubcww","username":"geoffrey-hannigan","profile_image":"https:\/\/s3.amazonaws.com\/pr-journal\/cpedy2n.jpg","protocol_img":"https:\/\/www.protocols.io\/img\/default_protocol.png","full_name":"Geoffrey Hannigan"}],"tags":[],"archived":0,"sub_authors":[],"sub_protocols_number":0,"can_edit_shared":0,"shared_runs":[],"is_shared_run":0,"is_shared":1,"banner":null,"contact_badges":[{"badge_id":"4","badge_image":"\/img\/badges\/gold.svg","badge_description":"Gold power author!"},{"badge_id":"5","badge_image":"\/img\/badges\/earlyadopter.svg","badge_description":"Early adopter"},{"badge_id":"6","badge_image":"\/img\/badges\/socialbutterfly.svg","badge_description":"Social butterfly"}],"number_of_comments":0,"is_locked":0,"is_locked_by":false,"authors":"HANNIGAN GD, GRICE EA, ET AL.","authors_list":[{"name":"HANNIGAN GD","affiliation":"DEPARTMENT OF DERMATOLOGY UNIVERSITY OF PENNSYLVANIA","username":null,"profile_image":null},{"name":" GRICE EA","affiliation":"DEPARTMENT OF DERMATOLOGY UNIVERSITY OF PENNSYLVANIA","username":null,"profile_image":null},{"name":" ET AL.","affiliation":"DEPARTMENT OF DERMATOLOGY UNIVERSITY OF PENNSYLVANIA","username":null,"profile_image":null}],"user":{"profile_image":"https:\/\/s3.amazonaws.com\/pr-journal\/cpedy2n.jpg","username":"geoffrey-hannigan","full_name":"Geoffrey Hannigan","created_by":"Geoffrey Hannigan"},"access":{"can_view":"1","can_remove":"0","can_add":"0","can_edit":0,"can_publish":0,"can_get_doi":0,"can_share":"0","can_move":"1","can_transfer":"1","can_download":"1","is_locked":"0"},"is_contact_suspended":0,"guidelines":"Required Software:<br \/>\n<ul>\n<li>PilerCR v1.06<\/li>\n<li>NCBI's BLAST+ v2.2.0<\/li>\n<li>mothur<\/li>\n<\/ul>\nRelevant Files<br \/>Output:<br \/>\n<ul>\n<li>CRISPRs\/spacer_lengths.txt<\/li>\n<li>CRISPRs\/all_viral_hits.txt<\/li>\n<li>CRISPRs\/viral_hit_seqs_blastn_formatted.txt<\/li>\n<li>CRISPRs\/read_assignment_blastn.txt<\/li>\n<li>CRISPRs\/read_spacer_assignment.txt<\/li>\n<\/ul>\nR Script: <a href=\"https:\/\/www.protocols.io\/view\/Script-R16-CRISPR-Analysis-ejqbcmw\" target=\"_blank\">R16<\/a>","status_id":"1","is_research":"1","status_info":null,"steps":[{"id":"141541","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"BEC152A932764B819A41C1197A3E84DF","previous_guid":null,"previous_id":"0","last_modified":"1502718712","components":[{"component_id":"977475","previous_id":0,"original_id":"0","guid":"1DF39255A2BE4228916DDF709AF3F90D","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148408","previous_id":"977475","original_id":"0","guid":"641D0241B5F14BAAB878EFB90AB89AF4","previous_guid":"1DF39255A2BE4228916DDF709AF3F90D","component_type_id":"1","data_id":"0","data":"In order to look at CRISPRs, we identified CRISPR repeats using the program PilerCR on our individually assembled contigs. First, we move to the correct working directory, copy over the contigs we want to work with and remove contig files that are empty.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"In order to look at CRISPRs, we identified CRISPR repeats using the program PilerCR on our individually assembled contigs. First, we move to the correct working directory, copy over the contigs we want to work with and remove contig files that are empty."},"is_project":0},{"component_id":"148415","previous_id":"148408","original_id":"0","guid":"6F6E8C0B5B934E8D81A8E59CAA312572","previous_guid":"641D0241B5F14BAAB878EFB90AB89AF4","component_type_id":"15","data_id":"562","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"cd Ray\n\nmkdir pilercr_contigs\ncd .\/ray_contigs_from_cat","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141549","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"D8ACB4C8DCC3465B9A91A4C57809E16F","previous_guid":"BEC152A932764B819A41C1197A3E84DF","previous_id":"141541","last_modified":"1502718713","components":[{"component_id":"977482","previous_id":0,"original_id":"0","guid":"23707B84FDE94272AD7FD49CE00E5135","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148417","previous_id":"977482","original_id":"0","guid":"9ED19AF7DD4740BAA2C5EDB16C868DE9","previous_guid":"23707B84FDE94272AD7FD49CE00E5135","component_type_id":"1","data_id":"0","data":"Get the sample IDs for the specific samples in our cohort (16 subjects, 2 timepoints).","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Get the sample IDs for the specific samples in our cohort (16 subjects, 2 timepoints)."},"is_project":0},{"component_id":"148418","previous_id":"148417","original_id":"0","guid":"3CF941DFC42D4253B067667135E19FCF","previous_guid":"9ED19AF7DD4740BAA2C5EDB16C868DE9","component_type_id":"15","data_id":"563","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"cut -f 1 MappingFiles\/SkinMet_001_metadata_subset.tsv | tail -n+2 > skinmet_samples_to_include.txt","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141550","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"F45D1DF7EBFA4583AC8473A30DB43FAF","previous_guid":"D8ACB4C8DCC3465B9A91A4C57809E16F","previous_id":"141549","last_modified":"1502718713","components":[{"component_id":"977483","previous_id":0,"original_id":"0","guid":"32281DE73B684908B37A82177749652E","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148419","previous_id":"977483","original_id":"0","guid":"61B779CB4DBC4F73AA746431EFC6FFF8","previous_guid":"32281DE73B684908B37A82177749652E","component_type_id":"1","data_id":"0","data":"Get contigs.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Get contigs."},"is_project":0},{"component_id":"148420","previous_id":"148419","original_id":"0","guid":"214B65A3243F4FBA9AB0EBC5CD51588E","previous_guid":"61B779CB4DBC4F73AA746431EFC6FFF8","component_type_id":"15","data_id":"564","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"for file in $(cat skinmet_samples_to_include.txt); do\n\tcp .\/$file\/${file}_Contigs_with_format.fa Ray\/pilercr_contigs\/${file}_contigs.fa\ndone\n\ncd Ray\/pilercr_contigs\/","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141551","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"A592583AE5334A96B30A15313E327288","previous_guid":"F45D1DF7EBFA4583AC8473A30DB43FAF","previous_id":"141550","last_modified":"1502718713","components":[{"component_id":"977484","previous_id":0,"original_id":"0","guid":"FD78584C1A1C4890AC1461C54291A4FB","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148421","previous_id":"977484","original_id":"0","guid":"EB5C7C729DA049B3B3213DBD3DF597F6","previous_guid":"FD78584C1A1C4890AC1461C54291A4FB","component_type_id":"1","data_id":"0","data":"Remove empty contigs.fa files.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Remove empty contigs.fa files."},"is_project":0},{"component_id":"148422","previous_id":"148421","original_id":"0","guid":"D49AA8C1134140438486D32278BCD1E7","previous_guid":"EB5C7C729DA049B3B3213DBD3DF597F6","component_type_id":"15","data_id":"565","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"find Ray\/pilercr_contigs\/ -empty -type f -delete","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141552","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"49A8D4A7F3E44C0680D965524CCB28CB","previous_guid":"A592583AE5334A96B30A15313E327288","previous_id":"141551","last_modified":"1502718713","components":[{"component_id":"977485","previous_id":0,"original_id":"0","guid":"16AFA24689EC489787879D8D6FC07D09","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148423","previous_id":"977485","original_id":"0","guid":"4B015DE0E535417881DAB18232F23069","previous_guid":"16AFA24689EC489787879D8D6FC07D09","component_type_id":"1","data_id":"0","data":"Identify crispr arrays with pilercr.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Identify crispr arrays with pilercr."},"is_project":0},{"component_id":"148424","previous_id":"148423","original_id":"0","guid":"F048F80711FF4DCAA0B2025225CA166D","previous_guid":"4B015DE0E535417881DAB18232F23069","component_type_id":"8","data_id":"32","data":null,"order_id":"2","name":"Software package","data_by_id":"1","type_id":"8","source_data":{"id":"32","name":"PILER","developer":"Edgar, R.C.","repository":"","link":"http:\/\/www.drive5.com\/pilercr\/","os_name":"Unix","os_version":"","version":"1.06","can_edit":"0"},"is_project":0},{"component_id":"148425","previous_id":"148424","original_id":"0","guid":"B37CDC805CD9442EBB6194C80AC1A3CB","previous_guid":"F048F80711FF4DCAA0B2025225CA166D","component_type_id":"15","data_id":"566","data":null,"order_id":"3","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"for f in $(ls); do\n\tout=${f%contigs.fa}pilercr  # the % sign indicates you are removing _contigs.fa and replacing it with pliercr (delete from end using the sortest possible match) \n\tout=${out##*\/}        # this cuts off the initial path from the file name, now output goes to the currently directory not the assembly directory\n\t\n\tpilercr1.06\/pilercr -in $f -out $out\ndone","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141553","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"66A258EDE52B45958CBAD10C07AA0F33","previous_guid":"49A8D4A7F3E44C0680D965524CCB28CB","previous_id":"141552","last_modified":"1502718713","components":[{"component_id":"977486","previous_id":0,"original_id":"0","guid":"A2617B5B4E0E40568B26AE4CF2F0AD0A","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148426","previous_id":"977486","original_id":"0","guid":"977A92BE60C4492BB6C4BD8FD771C38B","previous_guid":"A2617B5B4E0E40568B26AE4CF2F0AD0A","component_type_id":"1","data_id":"0","data":"Extract the crispr repeat sequences from the pilercr output.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Extract the crispr repeat sequences from the pilercr output."},"is_project":0},{"component_id":"148427","previous_id":"148426","original_id":"0","guid":"81DC26CF972A470884CEF7004E1C29F8","previous_guid":"977A92BE60C4492BB6C4BD8FD771C38B","component_type_id":"15","data_id":"567","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"for file in *pilercr; do\n\tsed -n \"\/SUMMARY BY POSITION\/,\/Help on reading\/p\" $file | sed '\/Array\/d' | sed '\/====\/d' | sed '\/SUMMARY\/d' | sed '\/Help\/d' | sed '\/^$\/d' | sed '\/>\/d' | awk 'BEGIN{OFS=\"\\n\";} {print $NF}' > ${file\/pilercr\/repeats.fa}\ndone","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141554","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"B56D49066FAF45C1821C688424B3FB9B","previous_guid":"66A258EDE52B45958CBAD10C07AA0F33","previous_id":"141553","last_modified":"1502718713","components":[{"component_id":"977487","previous_id":0,"original_id":"0","guid":"CF7A099573844B5997053374EE5D7CAC","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148428","previous_id":"977487","original_id":"0","guid":"A944B026B70F4411AEF1986EE215B038","previous_guid":"CF7A099573844B5997053374EE5D7CAC","component_type_id":"1","data_id":"0","data":"Concatenate all of the repeat sequences from all samples.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Concatenate all of the repeat sequences from all samples."},"is_project":0},{"component_id":"148429","previous_id":"148428","original_id":"0","guid":"CB145E918EE3422992EC88FC3BDC331B","previous_guid":"A944B026B70F4411AEF1986EE215B038","component_type_id":"15","data_id":"568","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"cat *repeats.fa > crispr_repeats.txt","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141555","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"6665AB045D8C4641ABCDEB50A5C38E30","previous_guid":"B56D49066FAF45C1821C688424B3FB9B","previous_id":"141554","last_modified":"1502718713","components":[{"component_id":"977488","previous_id":0,"original_id":"0","guid":"DB96BAB37D3744908A882ECECF41EDCF","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148430","previous_id":"977488","original_id":"0","guid":"45AF85048FFD4D9E82E888E49D14D3E7","previous_guid":"DB96BAB37D3744908A882ECECF41EDCF","component_type_id":"1","data_id":"0","data":"Since we do not know the direction of the CRISPRs, we write a function to identify the reverse complement of our sequences to use later on in our analysis.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Since we do not know the direction of the CRISPRs, we write a function to identify the reverse complement of our sequences to use later on in our analysis."},"is_project":0},{"component_id":"148431","previous_id":"148430","original_id":"0","guid":"BC499379DB0F49668DD7C7AB59612EC5","previous_guid":"45AF85048FFD4D9E82E888E49D14D3E7","component_type_id":"15","data_id":"569","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"function rrev() {\n\tcase $1 in\n\t\t\"T\")\n\t\techo -n A\n\t\t;;\n\t\t\"A\")\n\t\techo -n T\n\t\t;;\n\t\t\"G\")\n\t\techo -n C\n\t\t;;\n\t\t\"C\")\n\t\techo -n G\n\t\t;;\n\t\t\"N\")\n\t\techo -n N\n\t\t;;\n\tesac\n}\n\nfunction RC(){\n\tdna=$1\n\tdna=`echo $dna|rev`\n\tfor i in $(seq 0 $((${#dna}-1)))\n\t\tdo\n\t\trrev ${dna:$i:1};\n\t\tdone\n}","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141557","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"40EE7EA764A94EB3B2E82CF0F31E3A4B","previous_guid":"6665AB045D8C4641ABCDEB50A5C38E30","previous_id":"141555","last_modified":"1502718713","components":[{"component_id":"977490","previous_id":0,"original_id":"0","guid":"B3CBB8377192471FA1F5348C09C9C141","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148433","previous_id":"977490","original_id":"0","guid":"05ADA40A734E4359963CF4FB790AC41A","previous_guid":"B3CBB8377192471FA1F5348C09C9C141","component_type_id":"1","data_id":"0","data":"Once we have a list of all the repeats, we want to remove redundant repeat sequences and repeat sequences less than 20 nt long. Additionally, some repeat sequences can be substrings of other repeat sequences, with only one or two nucleotide differences on either end. To simplify our analyses, we only keep the shortest substring repeat.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Once we have a list of all the repeats, we want to remove redundant repeat sequences and repeat sequences less than 20 nt long. Additionally, some repeat sequences can be substrings of other repeat sequences, with only one or two nucleotide differences on either end. To simplify our analyses, we only keep the shortest substring repeat."},"is_project":0},{"component_id":"148434","previous_id":"148433","original_id":"0","guid":"1CB34104D45943CAB014DACA3D27C369","previous_guid":"05ADA40A734E4359963CF4FB790AC41A","component_type_id":"26","data_id":"10231","data":"","order_id":"2","name":"Note","data_by_id":"1","type_id":"26","source_data":{"annotation_id":"10231","thread_id":"10231","id":"10231","thread_title":"Annotation on step 9 of Script P10: CRISPR Identification","uri":"annotation-on-step-9-of-script-p10-crispr-identification","thread_uri":"annotation-on-step-9-of-script-p10-crispr-identification","step_id":"141557","protocol_uri":"Script-P10-CRISPR-Identification-ehdbb26","protocol_name":"Script P10: CRISPR Identification","protocol_name_html":"Script P10: CRISPR Identification","annotation":"For instance, if one repeat was \"AATCCGGA\" and another repeat was \"GAATCCGGAA\", we only keep \"AATCCGGA\". Since we do not identify the direction of the CRISPRs, we remove repeat sequences that have a reverse complement to reduce redundancy.","thread_text":"For instance, if one repeat was \"AATCCGGA\" and another repeat was \"GAATCCGGAA\", we only keep \"AATCCGGA\". Since we do not identify the direction of the CRISPRs, we remove repeat sequences that have a reverse complement to reduce redundancy.","body":"For instance, if one repeat was \"AATCCGGA\" and another repeat was \"GAATCCGGAA\", we only keep \"AATCCGGA\". Since we do not identify the direction of the CRISPRs, we remove repeat sequences that have a reverse complement to reduce redundancy.","is_private":"0","public_protocol":"1","can_edit":0,"can_delete":"0","show_name":"0","created_date":"1454451425","created_on":"1454451425","modified_on":"1457537906","last_updated":"1457537906","profile_image":"https:\/\/s3.amazonaws.com\/pr-journal\/cpedy2n.jpg","full_name":"Geoffrey Hannigan","affiliation":"Merck Research Labs","username":"geoffrey-hannigan","email":"hanni035@d.umn.edu","pa_useranme":"geoffrey-hannigan","comments":[]},"is_project":0},{"component_id":"148435","previous_id":"148434","original_id":"0","guid":"6F33EE237FD54D0CA996178E31F0B537","previous_guid":"1CB34104D45943CAB014DACA3D27C369","component_type_id":"15","data_id":"570","data":null,"order_id":"3","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"# Remove redundant repeats and repeats shorter than 20 nt\ncat crispr_repeats.txt | sort -u | awk -F, 'length($0)>=20' > crispr_repeats_unique_sorted.txt","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141558","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"04C505EA89AE4DB284946383361E98FA","previous_guid":"40EE7EA764A94EB3B2E82CF0F31E3A4B","previous_id":"141557","last_modified":"1502718713","components":[{"component_id":"977491","previous_id":0,"original_id":"0","guid":"D1292943EA634998B50F233226649951","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148436","previous_id":"977491","original_id":"0","guid":"A543386F20C1485284F06594CAC93E6A","previous_guid":"D1292943EA634998B50F233226649951","component_type_id":"1","data_id":"0","data":"Check to see if a repeat is almost the same as another repeat and only differs from another repeat by one or two nucleotides on either end if so, store it in nonunique_repeats.txt","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Check to see if a repeat is almost the same as another repeat and only differs from another repeat by one or two nucleotides on either end if so, store it in nonunique_repeats.txt"},"is_project":0},{"component_id":"148437","previous_id":"148436","original_id":"0","guid":"47793827F984453BA9C6F288BAEC4F3E","previous_guid":"A543386F20C1485284F06594CAC93E6A","component_type_id":"15","data_id":"571","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"for line in $(cat crispr_repeats_unique_sorted.txt); do\n\tcount=`egrep -c -w \"[A-Z]{0,2}$line[A-Z]{0,2}\" crispr_repeats_unique_sorted.txt`\n\tif [ $count -gt \"1\" ]; then \n\t\techo $line >> nonunique_repeats.txt\n\tfi","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141559","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"1FDBFB39E4AE444F82C4C972AF8FB997","previous_guid":"04C505EA89AE4DB284946383361E98FA","previous_id":"141558","last_modified":"1502718713","components":[{"component_id":"977492","previous_id":0,"original_id":"0","guid":"6F47F42F72284D379CD78CE3E8CF1A82","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148438","previous_id":"977492","original_id":"0","guid":"E834F181D1DE456588E4772EBEAAD90B","previous_guid":"6F47F42F72284D379CD78CE3E8CF1A82","component_type_id":"1","data_id":"0","data":"If a repeat is a reverse complement of another repeat, add it to nonunique_repeats.txt.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"If a repeat is a reverse complement of another repeat, add it to nonunique_repeats.txt."},"is_project":0},{"component_id":"148439","previous_id":"148438","original_id":"0","guid":"F8FCC01357F04AD696AC52D638FF3B1F","previous_guid":"E834F181D1DE456588E4772EBEAAD90B","component_type_id":"15","data_id":"572","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"RCrepeat=`RC $line`\n    RCcount=`grep -c -w \"$RCrepeat\" crispr_repeats_unique_sorted.txt`\n    if [ $RCcount -gt \"0\" ]; then\n        if [ -f nonunique_repeats.txt ]; then\n            RCcount_remove=`grep -c -w \"$RCrepeat\" nonunique_repeats.txt`\n            if [ $RCcount_remove -eq \"0\" ]; then\n                echo $line >> nonunique_repeats.txt\n            fi\n        else\n            echo $name >> nonunique_repeats.txt\n        fi\n    fi\n\ndone","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141560","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"C786707AE01C46EC8D0E307834C54B90","previous_guid":"1FDBFB39E4AE444F82C4C972AF8FB997","previous_id":"141559","last_modified":"1502718713","components":[{"component_id":"977493","previous_id":0,"original_id":"0","guid":"72A9DBC5CA2A4CC18CC4FEFCFFC857A1","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148440","previous_id":"977493","original_id":"0","guid":"BE6714CF759F4B118317C4F6DBBC4A09","previous_guid":"72A9DBC5CA2A4CC18CC4FEFCFFC857A1","component_type_id":"1","data_id":"0","data":"If you have substrings in multiple repeat sequences, keep the shortest substring and remove the longer sequences.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"If you have substrings in multiple repeat sequences, keep the shortest substring and remove the longer sequences."},"is_project":0},{"component_id":"148441","previous_id":"148440","original_id":"0","guid":"B70E5AF7318B418E8B7E9010390D5E12","previous_guid":"BE6714CF759F4B118317C4F6DBBC4A09","component_type_id":"15","data_id":"573","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"for line in $(cat nonunique_repeats.txt); do\n\tegrep \"$line\" crispr_repeats_unique_sorted.txt | awk '{ print length, $0 }' | sort -n | tail -n +2 | awk '{ print $2 }' >> tmp_multiple_to_remove.txt\ndone\n\ncat tmp_multiple_to_remove.txt RC_nonunique_repeats.txt | sort -u | sed '\/^$\/d' > tmp_to_remove.txt","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141561","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"2E7869EA4E3344E1912D088FC3B0B427","previous_guid":"C786707AE01C46EC8D0E307834C54B90","previous_id":"141560","last_modified":"1502718713","components":[{"component_id":"977494","previous_id":0,"original_id":"0","guid":"7701245E71184415B3878FFFDF4728DA","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148442","previous_id":"977494","original_id":"0","guid":"2B7EC76DE4534D2EA493CA43386D8551","previous_guid":"7701245E71184415B3878FFFDF4728DA","component_type_id":"1","data_id":"0","data":"Remove repeats that contain substrings of other repeats, add headers to the repeat files, assigning each repeat a number id.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Remove repeats that contain substrings of other repeats, add headers to the repeat files, assigning each repeat a number id."},"is_project":0},{"component_id":"148443","previous_id":"148442","original_id":"0","guid":"235514D713CC471EAC8EDCD0DE8B9C81","previous_guid":"2B7EC76DE4534D2EA493CA43386D8551","component_type_id":"15","data_id":"574","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"grep -v -x -f tmp_to_remove.txt crispr_repeats_unique_sorted.txt | awk ' {print \">repeat_\"NR\"\\n\"$NF}' > crispr_repeats_unique_sorted.fa","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141562","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"D062B844EB5544BE903799341444C0CC","previous_guid":"2E7869EA4E3344E1912D088FC3B0B427","previous_id":"141561","last_modified":"1502718713","components":[{"component_id":"977495","previous_id":0,"original_id":"0","guid":"795C68C2FA06448EBF3BAB70D36B4919","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148444","previous_id":"977495","original_id":"0","guid":"7522FFE5137048F6AB77302CC253BF9A","previous_guid":"795C68C2FA06448EBF3BAB70D36B4919","component_type_id":"1","data_id":"0","data":"Pull out reads that contain the raw repeats.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Pull out reads that contain the raw repeats."},"is_project":0},{"component_id":"148445","previous_id":"148444","original_id":"0","guid":"8A14B6E9568043888F5C04D8AD8EF34D","previous_guid":"7522FFE5137048F6AB77302CC253BF9A","component_type_id":"26","data_id":"10232","data":"","order_id":"2","name":"Note","data_by_id":"1","type_id":"26","source_data":{"annotation_id":"10232","thread_id":"10232","id":"10232","thread_title":"Annotation on step 14 of Script P10: CRISPR Identification","uri":"annotation-on-step-14-of-script-p10-crispr-identification","thread_uri":"annotation-on-step-14-of-script-p10-crispr-identification","step_id":"141562","protocol_uri":"Script-P10-CRISPR-Identification-ehdbb26","protocol_name":"Script P10: CRISPR Identification","protocol_name_html":"Script P10: CRISPR Identification","annotation":"Because we do not know the direction of the repeats, we search for both the repeat sequence and its reverse complement in the contigs.","thread_text":"Because we do not know the direction of the repeats, we search for both the repeat sequence and its reverse complement in the contigs.","body":"Because we do not know the direction of the repeats, we search for both the repeat sequence and its reverse complement in the contigs.","is_private":"0","public_protocol":"1","can_edit":0,"can_delete":"0","show_name":"0","created_date":"1454451425","created_on":"1454451425","modified_on":"1457537906","last_updated":"1457537906","profile_image":"https:\/\/s3.amazonaws.com\/pr-journal\/cpedy2n.jpg","full_name":"Geoffrey Hannigan","affiliation":"Merck Research Labs","username":"geoffrey-hannigan","email":"hanni035@d.umn.edu","pa_useranme":"geoffrey-hannigan","comments":[]},"is_project":0},{"component_id":"148446","previous_id":"148445","original_id":"0","guid":"1505F6F444DA4B979D037BE27DE2C7D6","previous_guid":"8A14B6E9568043888F5C04D8AD8EF34D","component_type_id":"15","data_id":"575","data":null,"order_id":"3","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"cd Ray\/pilercr_contigs\nmkdir raw_repeats\n\ncat crispr_repeats_unique_sorted.fa | while read line; do\n\tif [ \"${line:0:1}\" == \">\" ]\n\t\tthen\n        # this line is a header so keep the name information\n\t\tname=${line#>}\n\t\telse\n        # this line is a repeat sequence; store the repeat and its reverse complement\n\t\trepeat=$line\n\t\tRCrepeat=`RC $repeat`\n\t\tpath=\"Ray\/pilercr_contigs\"","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141563","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"D422720977614D1C8B8E07B4AEDA30D5","previous_guid":"D062B844EB5544BE903799341444C0CC","previous_id":"141562","last_modified":"1502718713","components":[{"component_id":"977496","previous_id":0,"original_id":"0","guid":"093092C3202A4A11974A477D4D4A57A9","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148447","previous_id":"977496","original_id":"0","guid":"C5797DA9873444289A6FDFE2749C9DC1","previous_guid":"093092C3202A4A11974A477D4D4A57A9","component_type_id":"1","data_id":"0","data":"Search all of the contigs for the repeat and its reverse complement. If found, store the read where it is found is a file that is named first with what repeat it contains, then the sample ID\u00a0it is found in.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Search all of the contigs for the repeat and its reverse complement. If found, store the read where it is found is a file that is named first with what repeat it contains, then the sample ID\u00a0it is found in."},"is_project":0},{"component_id":"148448","previous_id":"148447","original_id":"0","guid":"A098F722D9144872853309A25C0CBFA1","previous_guid":"C5797DA9873444289A6FDFE2749C9DC1","component_type_id":"15","data_id":"576","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"for samp in *_contigs.fa; do\n\t\t\tcat $path\/$samp | fgrep -B1 \"$repeat\" >> .\/raw_repeats\/$name.${samp\/_contigs.fa\/}.reads.fasta\n\t\t\tcat $path\/$samp | fgrep -B1 \"$RCrepeat\" >> .\/raw_repeats\/$name.${samp\/_contigs.fa\/}.reads.fasta  \n\t\tdone\n\tfi\ndone","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141564","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"5C48571EBFA040CC8967EA74EF5008F2","previous_guid":"D422720977614D1C8B8E07B4AEDA30D5","previous_id":"141563","last_modified":"1502718713","components":[{"component_id":"977497","previous_id":0,"original_id":"0","guid":"E484D9B55C4044608E46BA3A7FBA79F1","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148449","previous_id":"977497","original_id":"0","guid":"C269C38A72754261A4EEF90B7FE45E44","previous_guid":"E484D9B55C4044608E46BA3A7FBA79F1","component_type_id":"1","data_id":"0","data":"Remove empty files.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Remove empty files."},"is_project":0},{"component_id":"148450","previous_id":"148449","original_id":"0","guid":"D9031406C2A747F98EAD36ED8F9A9338","previous_guid":"C269C38A72754261A4EEF90B7FE45E44","component_type_id":"15","data_id":"577","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"find .\/raw_repeats -type f -empty -delete\ncd raw_repeats","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141565","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"08B6E8BB94A644C6AC8D55EB06FD1F59","previous_guid":"5C48571EBFA040CC8967EA74EF5008F2","previous_id":"141564","last_modified":"1502718713","components":[{"component_id":"977498","previous_id":0,"original_id":"0","guid":"1F680D0C6C5D438391B73274B0617CE5","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148451","previous_id":"977498","original_id":"0","guid":"AB2409DDA40149048510859FCFC72AD6","previous_guid":"1F680D0C6C5D438391B73274B0617CE5","component_type_id":"1","data_id":"0","data":"What we are most interested in are the CRISPR spacers. Now that we have pulled out the samples containing repeat sequences, we need to pull out spacers from these samples. We are only interested in spacers that are flanked by two repeat sequences and spacers that are between 2 and 100 nucleotides long.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"What we are most interested in are the CRISPR spacers. Now that we have pulled out the samples containing repeat sequences, we need to pull out spacers from these samples. We are only interested in spacers that are flanked by two repeat sequences and spacers that are between 2 and 100 nucleotides long."},"is_project":0}]},{"id":"141566","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"26880F8C1723403E85B3689999A4CFDB","previous_guid":"08B6E8BB94A644C6AC8D55EB06FD1F59","previous_id":"141565","last_modified":"1502718713","components":[{"component_id":"977499","previous_id":0,"original_id":"0","guid":"A866A1472E9D4DC786A8455AF1B30D6C","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148452","previous_id":"977499","original_id":"0","guid":"FD0CED5D5EDD4B5FB69DC4B786A80DAD","previous_guid":"A866A1472E9D4DC786A8455AF1B30D6C","component_type_id":"1","data_id":"0","data":"Loop through repeats and pull out spacers from each sample.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Loop through repeats and pull out spacers from each sample."},"is_project":0},{"component_id":"148453","previous_id":"148452","original_id":"0","guid":"39D09B07A6984F1BAE427CB359AB4CB0","previous_guid":"FD0CED5D5EDD4B5FB69DC4B786A80DAD","component_type_id":"15","data_id":"578","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"for file in $(ls *.reads.fasta); do\n    # determine which repeat we are working with from the file name\n\tname=${file\/.MG*.reads.fasta\/}\n    # go back to the repeat fasta file and extract the repeat sequence\n\trepeat=`grep -A1 -w \"$name\" ..\/crispr_repeats_unique_sorted.fa | tail -n 1`","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141567","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"168CAA74D85B416A8F8E452F1B41E885","previous_guid":"26880F8C1723403E85B3689999A4CFDB","previous_id":"141566","last_modified":"1502718713","components":[{"component_id":"977500","previous_id":0,"original_id":"0","guid":"72AF94C6B38144D489F3428E24384747","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148454","previous_id":"977500","original_id":"0","guid":"56D02235B1A84E38AE4AFB01B94040EC","previous_guid":"72AF94C6B38144D489F3428E24384747","component_type_id":"1","data_id":"0","data":"Replace all instances of the repeat in the file with the repeat name. For instance, if it is repeat 1, replace each instance of the repeat with \"&gt;&gt;repeat1&gt;&gt;repeat1\"","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Replace all instances of the repeat in the file with the repeat name. For instance, if it is repeat 1, replace each instance of the repeat with \"&gt;&gt;repeat1&gt;&gt;repeat1\""},"is_project":0},{"component_id":"148455","previous_id":"148454","original_id":"0","guid":"EC03614420DA4E7681DB2164BBD90402","previous_guid":"56D02235B1A84E38AE4AFB01B94040EC","component_type_id":"15","data_id":"579","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"perl -pe 's\/'$repeat'\/>>'$name'>>'$name'>>\/g' $file > ${file\/reads.fasta\/tmp.txt}\n    # extract spacers flanked by two repeats\n\tegrep -o \"(>>$name>>[A-Z]{2,100}>>$name)+?\" ${file\/reads.fasta\/tmp.txt} >> ${file\/.reads.fasta\/_crispr_arrays.txt}\n\tegrep -B 1  \">>$name>>[A-Z]{2,100}>>$name\" ${file\/reads.fasta\/tmp.txt} | sed '\/^[A-Z]\/d' >  ${file\/reads.fasta\/tmp_to_keep.txt}\n\t# take the reverse complement of the repeat sequence\n    RCrepeat=`RC $repeat`","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141568","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"CEFAE8BC76194E36B9C1E3A1AA560F8D","previous_guid":"168CAA74D85B416A8F8E452F1B41E885","previous_id":"141567","last_modified":"1502718713","components":[{"component_id":"977501","previous_id":0,"original_id":"0","guid":"BC4862E4F2A948B2BE502AABE7D12E1A","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148456","previous_id":"977501","original_id":"0","guid":"4254CBBA149E4DF6AC45DEED3F171E5B","previous_guid":"BC4862E4F2A948B2BE502AABE7D12E1A","component_type_id":"1","data_id":"0","data":"Replace all instances of the reverse complement repeat in the file with the RCrepeat name.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Replace all instances of the reverse complement repeat in the file with the RCrepeat name."},"is_project":0},{"component_id":"148457","previous_id":"148456","original_id":"0","guid":"49F3567B950243FDAA8FF871441DDF49","previous_guid":"4254CBBA149E4DF6AC45DEED3F171E5B","component_type_id":"15","data_id":"580","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"# replace all instances of the reverse complement repeat in the file with the RCrepeat name \n\tperl -pe 's\/'$RCrepeat'\/>>'$name'>>'$name'>>\/g' $file > ${file\/reads.fasta\/tmpRC.txt}\n\t # extract spacers flanked by two reverse complement repeats\n    egrep -o \"(>>$name>>[A-Z]{2,100}>>$name)+?\" ${file\/reads.fasta\/tmpRC.txt} >> ${file\/.reads.fasta\/_crispr_arrays.txt}\n\tegrep -B 1  \">>$name>>[A-Z]{2,100}>>$name\" ${file\/reads.fasta\/tmpRC.txt} | sed '\/^[A-Z]\/d' >>  ${file\/reads.fasta\/tmp_to_keep.txt}","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141569","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"DFF4C15790184D76BE805B0373CB4052","previous_guid":"CEFAE8BC76194E36B9C1E3A1AA560F8D","previous_id":"141568","last_modified":"1502718714","components":[{"component_id":"977502","previous_id":0,"original_id":"0","guid":"68824504FFD543D3871BE0154E3D04F9","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148458","previous_id":"977502","original_id":"0","guid":"F731BFB2C3204424A93DB0EB134EB129","previous_guid":"68824504FFD543D3871BE0154E3D04F9","component_type_id":"1","data_id":"0","data":"Format the output file.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Format the output file."},"is_project":0},{"component_id":"148459","previous_id":"148458","original_id":"0","guid":"2E6E3BDC0B0147838B803C44DF2811CA","previous_guid":"F731BFB2C3204424A93DB0EB134EB129","component_type_id":"15","data_id":"581","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"cat ${file\/reads.fasta\/tmp_to_keep.txt} | sort -u | sed '\/--\/d' > ${file\/reads.fasta\/tmp_to_keep_unique.txt}\ndone","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141570","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"F92CB15C96CB4F64BC4EEF5EEB763063","previous_guid":"DFF4C15790184D76BE805B0373CB4052","previous_id":"141569","last_modified":"1502718714","components":[{"component_id":"977503","previous_id":0,"original_id":"0","guid":"D37DD07D3AE0442598A9402EFE49DD4F","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148460","previous_id":"977503","original_id":"0","guid":"59FB98E41B6C4683A23521DDFB6BB931","previous_guid":"D37DD07D3AE0442598A9402EFE49DD4F","component_type_id":"1","data_id":"0","data":"Some samples have both spacers flanked by repeats and instances in which only one repeat sequence was found keep only the sequences that have flanking repeats remove *.reads.fata files that aren't used.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Some samples have both spacers flanked by repeats and instances in which only one repeat sequence was found keep only the sequences that have flanking repeats remove *.reads.fata files that aren't used."},"is_project":0},{"component_id":"148461","previous_id":"148460","original_id":"0","guid":"1996481C128E456D9BF869A57B46ACAF","previous_guid":"59FB98E41B6C4683A23521DDFB6BB931","component_type_id":"15","data_id":"582","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"find . -type f -empty -delete\nfor file in *.reads.fasta; do\n\tfile2=${file\/.reads.fasta\/_crispr_arrays.txt}\n\tif [ ! -f $file2 ]; then\n\t\trm $file\n\tfi\ndone\n\nfind .\/*tmp_to_keep_unique.txt -type f -empty -delete","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141571","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"713DBAA644434D26A9E8739AAC535725","previous_guid":"F92CB15C96CB4F64BC4EEF5EEB763063","previous_id":"141570","last_modified":"1502718714","components":[{"component_id":"977504","previous_id":0,"original_id":"0","guid":"C09B002AE3734F76922FEA735B8A1F0A","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148462","previous_id":"977504","original_id":"0","guid":"B4D7681C114E4FD79D3E452167FF68C1","previous_guid":"C09B002AE3734F76922FEA735B8A1F0A","component_type_id":"1","data_id":"0","data":"Extract only the sequences that have flanking repeats (we will blast them later).","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Extract only the sequences that have flanking repeats (we will blast them later)."},"is_project":0},{"component_id":"148463","previous_id":"148462","original_id":"0","guid":"D01BEEF0188A4F55BD925B7F9BAD9834","previous_guid":"B4D7681C114E4FD79D3E452167FF68C1","component_type_id":"15","data_id":"583","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"for file in $(ls *.tmp_to_keep_unique.txt ); do\n\tfor line in $( cat $file ); do\n\t\tgrep -w -A 1 \"$line\" ${file\/tmp_to_keep_unique.txt\/reads.fasta} >> ${file\/tmp_to_keep_unique.txt\/reads.good.fasta}\n\tdone\ndone","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141572","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"99C8AE0C78814BDFB4A63E174466A904","previous_guid":"713DBAA644434D26A9E8739AAC535725","previous_id":"141571","last_modified":"1502718714","components":[{"component_id":"977505","previous_id":0,"original_id":"0","guid":"97F50CCE30014FA499EF2D410ACC4B96","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148464","previous_id":"977505","original_id":"0","guid":"3C38190E9BFA465CB9EBFC7A75ACA21F","previous_guid":"97F50CCE30014FA499EF2D410ACC4B96","component_type_id":"1","data_id":"0","data":"Now we need to do some file formatting. We have files named *_crispr_arrays.txt that contain repeat\/spacer information.<br \/>Each line contains the following information: &gt;&gt;repeat_number&gt;&gt;[spacer sequence]&gt;&gt;repeat_number","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Now we need to do some file formatting. We have files named *_crispr_arrays.txt that contain repeat\/spacer information.<br \/>Each line contains the following information: &gt;&gt;repeat_number&gt;&gt;[spacer sequence]&gt;&gt;repeat_number"},"is_project":0}]},{"id":"141573","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"7409703A14054C40B84380F5C5811511","previous_guid":"99C8AE0C78814BDFB4A63E174466A904","previous_id":"141572","last_modified":"1502718714","components":[{"component_id":"977506","previous_id":0,"original_id":"0","guid":"4E4AF57592964492BAA5DB4B3AF4C3B8","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148465","previous_id":"977506","original_id":"0","guid":"39289EDB317347CA92CFF6695654D6FA","previous_guid":"4E4AF57592964492BAA5DB4B3AF4C3B8","component_type_id":"1","data_id":"0","data":"<div class=\"text_cell_render border-box-sizing rendered_html\">\n<p>First, we combine all of the repeat\/spacers into one file and keep only the unique sequnces and then we extract spacer sequences.<\/p>\n<\/div>\n<div class=\"cell border-box-sizing code_cell vbox\">\u00a0<\/div>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<div class=\"text_cell_render border-box-sizing rendered_html\">\n<p>First, we combine all of the repeat\/spacers into one file and keep only the unique sequnces and then we extract spacer sequences.<\/p>\n<\/div>\n<div class=\"cell border-box-sizing code_cell vbox\">\u00a0<\/div>"},"is_project":0},{"component_id":"148466","previous_id":"148465","original_id":"0","guid":"DBC8156F1BC0406F8C9FC4E901B6D168","previous_guid":"39289EDB317347CA92CFF6695654D6FA","component_type_id":"15","data_id":"584","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"# concatenate all arrays and remove repetitive arrays\ncat *_crispr_arrays.txt | sort -u  > crispr_arrays_unique.txt","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141574","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"E9FE2DB6CE744D62BC516117CC0766F6","previous_guid":"7409703A14054C40B84380F5C5811511","previous_id":"141573","last_modified":"1502718714","components":[{"component_id":"977507","previous_id":0,"original_id":"0","guid":"D5B68FD635BD4BB786C1977174358164","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148467","previous_id":"977507","original_id":"0","guid":"38E9807493A84B9F9EF18F86BF721931","previous_guid":"D5B68FD635BD4BB786C1977174358164","component_type_id":"1","data_id":"0","data":"Extract spacers. Split the file so that each line contains either a repeat id or a spacer sequence.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Extract spacers. Split the file so that each line contains either a repeat id or a spacer sequence."},"is_project":0},{"component_id":"148468","previous_id":"148467","original_id":"0","guid":"81D7CABF5E4245B998BE41CD2A8282ED","previous_guid":"38E9807493A84B9F9EF18F86BF721931","component_type_id":"15","data_id":"585","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"cat crispr_arrays_unique.txt | tr '>' '\\n' | sed '\/^$\/d' > spacers_tmp.txt\n\nfor line in $(cat spacers_tmp.txt); do\n    # if the line contains the repeat id, store it as the name\n\tif [ \"${line:0:2}\" == \"re\" ]; then\n\t\tname=$line\n\telse","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141575","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"799A2502B89E454BBC5B65EEA7D56897","previous_guid":"E9FE2DB6CE744D62BC516117CC0766F6","previous_id":"141574","last_modified":"1502718714","components":[{"component_id":"977508","previous_id":0,"original_id":"0","guid":"3D171C75A5894C9680E2CE0C65FFA4C0","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148469","previous_id":"977508","original_id":"0","guid":"D65C25F612124665A75453D7BF96252C","previous_guid":"3D171C75A5894C9680E2CE0C65FFA4C0","component_type_id":"1","data_id":"0","data":"Check to see if the repeat\/spacer combination is a repeat.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Check to see if the repeat\/spacer combination is a repeat."},"is_project":0},{"component_id":"148470","previous_id":"148469","original_id":"0","guid":"DAC7B1B374F1438F8EEF0DA42A5C80DE","previous_guid":"D65C25F612124665A75453D7BF96252C","component_type_id":"15","data_id":"586","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"if [ -f spacers_tmp2.txt ]; then\n            spacerRC=`RC $line`\n\t\t\tcountSpacer=`grep -c -w \"$line\" spacers_tmp2.txt`\n            countSpacerRC=`grep -c -w \"$spacerRC\" spacers_tmp2.txt`","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141576","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"925588ED9D934359B65A4C5ACBC88586","previous_guid":"799A2502B89E454BBC5B65EEA7D56897","previous_id":"141575","last_modified":"1502718714","components":[{"component_id":"977509","previous_id":0,"original_id":"0","guid":"40FF9A68C5BD4EDFA48CF36ABB49D9AE","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148471","previous_id":"977509","original_id":"0","guid":"75A1C48514C940D7BA1E4DD6D97B3086","previous_guid":"40FF9A68C5BD4EDFA48CF36ABB49D9AE","component_type_id":"1","data_id":"0","data":"If it is not a repeat, store the spacer repeat combination in spacers_tmp2.txt","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"If it is not a repeat, store the spacer repeat combination in spacers_tmp2.txt"},"is_project":0},{"component_id":"148472","previous_id":"148471","original_id":"0","guid":"556482565F4143D09E027A2AE45B7473","previous_guid":"75A1C48514C940D7BA1E4DD6D97B3086","component_type_id":"15","data_id":"587","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"if [ $countSpacer -eq \"0\" ] && [ $countSpacerRC -eq \"0\" ]; then\n\t\t\t\techo -e \"\\n$line\" >> spacers_tmp2.txt\n            fi\n        else\n\t\t\techo -e \"\\n$line\" >> spacers_tmp2.txt\n        fi\n\tfi\ndone\nrm spacers_tmp.txt","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141577","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"077C62BE466F49B1B863BC583F95FD5A","previous_guid":"925588ED9D934359B65A4C5ACBC88586","previous_id":"141576","last_modified":"1502718714","components":[{"component_id":"977510","previous_id":0,"original_id":"0","guid":"8C3849633FF8462E945257891E1CC190","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148473","previous_id":"977510","original_id":"0","guid":"72723B24774048589A4734DDE91A4328","previous_guid":"8C3849633FF8462E945257891E1CC190","component_type_id":"1","data_id":"0","data":"Format spacer headers so they are informative.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Format spacer headers so they are informative."},"is_project":0},{"component_id":"148474","previous_id":"148473","original_id":"0","guid":"C2D8604E7AD049C9B73C6BCCDFC99842","previous_guid":"72723B24774048589A4734DDE91A4328","component_type_id":"15","data_id":"588","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"spacer_count=1\ncat spacers_tmp2.txt| sed '\/^$\/d' | while read line; do\n    echo \">spacer_\"$spacer_count >> spacers.fa\n    echo $line >> spacers.fa\n    let spacer_count++\ndone","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141578","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"81BAC1F8D9FF4AF69AD814ECE276972D","previous_guid":"077C62BE466F49B1B863BC583F95FD5A","previous_id":"141577","last_modified":"1502718714","components":[{"component_id":"977511","previous_id":0,"original_id":"0","guid":"CA6B82558D4944BEB9CCC6D6F743E66D","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148475","previous_id":"977511","original_id":"0","guid":"C4BAA8C2AF4D485CB4B9E15BD037799C","previous_guid":"CA6B82558D4944BEB9CCC6D6F743E66D","component_type_id":"1","data_id":"0","data":"Get length of spacers.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Get length of spacers."},"is_project":0},{"component_id":"148476","previous_id":"148475","original_id":"0","guid":"2C6C8ACAB0A34B7D98FFCAEC433FE780","previous_guid":"C4BAA8C2AF4D485CB4B9E15BD037799C","component_type_id":"15","data_id":"589","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"for line in $(cat spacers.fa); do\n\tif [ \"${line:0:1}\" == \">\" ]; then \n\t\tname=`echo $line | sed 's\/>\/\/g'`\n\telse \n\t\techo $line | awk -v name=$name '{print name\"\\n\"length($0)}' >> spacer_lengths.txt\n\tfi \ndone","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141579","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"C39289A7ECB947FA85A9E6DC3D269E14","previous_guid":"81BAC1F8D9FF4AF69AD814ECE276972D","previous_id":"141578","last_modified":"1502718714","components":[{"component_id":"977512","previous_id":0,"original_id":"0","guid":"4380F5E6A59A47378D74D326932F6C73","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148477","previous_id":"977512","original_id":"0","guid":"D93A498439054478BFA4011CDC734EAE","previous_guid":"4380F5E6A59A47378D74D326932F6C73","component_type_id":"1","data_id":"0","data":"Since we have a concise list of unique spacers associated with their repeats, we can now blast viral contigs against the spacers. We keep hits with 97% identity.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Since we have a concise list of unique spacers associated with their repeats, we can now blast viral contigs against the spacers. We keep hits with 97% identity."},"is_project":0}]},{"id":"141580","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"FF1948EEDBA949848DA8A7068293A7F6","previous_guid":"C39289A7ECB947FA85A9E6DC3D269E14","previous_id":"141579","last_modified":"1502718714","components":[{"component_id":"977513","previous_id":0,"original_id":"0","guid":"C9C44FA7576E464FA7CE910AEEEACEA1","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148478","previous_id":"977513","original_id":"0","guid":"67C8A92DF85549909D5AB421928FFF5F","previous_guid":"C9C44FA7576E464FA7CE910AEEEACEA1","component_type_id":"1","data_id":"0","data":"Fix viral contigs for blast.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Fix viral contigs for blast."},"is_project":0},{"component_id":"148479","previous_id":"148478","original_id":"0","guid":"D407C4578A1E4B3D836AD4A6E356DC99","previous_guid":"67C8A92DF85549909D5AB421928FFF5F","component_type_id":"15","data_id":"590","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"for file in $(ls ray_contigs_neg_clean_for_crisprs\/); do\n\t#Remove block format in contig fasta file | Next three part of same thing | Replace the spaces in the contig names with underscores | Add sample ID to the end of each name\n\tsed -r 's\/\\s\/_\/g' ray_contigs_neg_clean_for_crisprs\/${file}\/Contigs.fasta | sed 's\/^\\([A,T,G,C,n]*\\)$\/\\1\\@\/g' | sed ':a;N;$!ba;s\/\\@\\n\\([A,C,G,T,n]\\)\/\\1\/g' | sed 's\/\\@\/\/g' | sed '\/\\>\/s\/ \/_\/g' | sed \"\/>\/s\/$\/\\_$file\/\" > ray_contigs_neg_clean_for_crisprs\/${file}_Contigs_with_format.fa\ndone","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141581","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"206A5E8CEC6B46E69F0F1C17A318DA3F","previous_guid":"FF1948EEDBA949848DA8A7068293A7F6","previous_id":"141580","last_modified":"1502718714","components":[{"component_id":"977514","previous_id":0,"original_id":"0","guid":"B5431860C84748F782CFD0A61D8DB124","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148480","previous_id":"977514","original_id":"0","guid":"4693A56D8D66468DBD65259696987AC7","previous_guid":"B5431860C84748F782CFD0A61D8DB124","component_type_id":"1","data_id":"0","data":"Remove empty contig files.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Remove empty contig files."},"is_project":0},{"component_id":"148481","previous_id":"148480","original_id":"0","guid":"5CC74046F1DA46A587A986F373FDB260","previous_guid":"4693A56D8D66468DBD65259696987AC7","component_type_id":"15","data_id":"591","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"find ray_contigs_neg_clean_for_crisprs\/ -type f -empty -delete","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141582","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"EEB1ADE61A604A82AC86E99C67D30CD5","previous_guid":"206A5E8CEC6B46E69F0F1C17A318DA3F","previous_id":"141581","last_modified":"1502718714","components":[{"component_id":"977515","previous_id":0,"original_id":"0","guid":"7906234B371F40EB8646352C2DFEEAF2","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148482","previous_id":"977515","original_id":"0","guid":"F00526BD765D4C74A3787ACC7AA388EC","previous_guid":"7906234B371F40EB8646352C2DFEEAF2","component_type_id":"1","data_id":"0","data":"Look at viral samples from our specific cohort (16 subjects, 2 timepoints).","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Look at viral samples from our specific cohort (16 subjects, 2 timepoints)."},"is_project":0},{"component_id":"148483","previous_id":"148482","original_id":"0","guid":"80D2DEC937B24796855D1747F12A1EDD","previous_guid":"F00526BD765D4C74A3787ACC7AA388EC","component_type_id":"15","data_id":"592","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"cut -f 1 MappingFiles\/Virome_001_metadata_subset.tsv | tail -n+2 > virome_samples_to_include.txt","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141583","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"6FD20FA53296458996F7224D1D4CBA0B","previous_guid":"EEB1ADE61A604A82AC86E99C67D30CD5","previous_id":"141582","last_modified":"1502718714","components":[{"component_id":"977516","previous_id":0,"original_id":"0","guid":"F145BD7A354A48DDBF24076AA5289725","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148484","previous_id":"977516","original_id":"0","guid":"7328FB76D474435C9B990292D7C15F34","previous_guid":"F145BD7A354A48DDBF24076AA5289725","component_type_id":"1","data_id":"0","data":"Make a blast database for each sample from the sample contig file.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Make a blast database for each sample from the sample contig file."},"is_project":0},{"component_id":"148485","previous_id":"148484","original_id":"0","guid":"C51C571A42384D04AF0ABDD3F78C2BEB","previous_guid":"7328FB76D474435C9B990292D7C15F34","component_type_id":"15","data_id":"593","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"for file in $(cat virome_samples_to_include.txt); do\n\tmakeblastdb -in ray_virome_contigs_neg_clean_for_crisprs\/${file}_Contigs_with_format.fa -dbtype nucl -out ray_virome_contigs_neg_clean_for_crisprs\/${file}\ndone\n\nmkdir viral_contig_blastn","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141584","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"953E63A5BFD043319D398A5F433792F9","previous_guid":"6FD20FA53296458996F7224D1D4CBA0B","previous_id":"141583","last_modified":"1502718714","components":[{"component_id":"977517","previous_id":0,"original_id":"0","guid":"CE4DBB34ACF349799F0B3ACB4C61CA35","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148486","previous_id":"977517","original_id":"0","guid":"78D0FF8D2CB8457692A44416CF75FC8C","previous_guid":"CE4DBB34ACF349799F0B3ACB4C61CA35","component_type_id":"1","data_id":"0","data":"Blast spacers against viral contig databases.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Blast spacers against viral contig databases."},"is_project":0},{"component_id":"148487","previous_id":"148486","original_id":"0","guid":"1EAF546524044685920902BB5CA95A17","previous_guid":"78D0FF8D2CB8457692A44416CF75FC8C","component_type_id":"8","data_id":"22","data":null,"order_id":"2","name":"Software package","data_by_id":"1","type_id":"8","source_data":{"id":"22","name":"BLAST Toolkit","developer":"NCBI","repository":"ftp:\/\/ftp.ncbi.nlm.nih.gov\/blast\/executables\/blast+\/LATEST\/","link":"https:\/\/blast.ncbi.nlm.nih.gov\/Blast.cgi?PAGE_TYPE=BlastDocs&DOC_TYPE=Download","os_name":"Unix","os_version":"","version":"2.2.0","can_edit":"0"},"is_project":0},{"component_id":"148488","previous_id":"148487","original_id":"0","guid":"DE64697B62C4486C9B0EB8903D53B0FD","previous_guid":"1EAF546524044685920902BB5CA95A17","component_type_id":"15","data_id":"594","data":null,"order_id":"3","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"for file in $(ls ray_contigs_neg_clean_for_crisprs\/MG100*.nhr); do\n        name=`echo $file | sed 's\/^.*M\/M\/g' | sed 's\/.nhr\/\/g'`\n        echo $name\n        blastn -query spacers.fa -out .\/viral_contig_blastn\/${name}_blastn.txt -db ${file\/.nhr\/} -outfmt 6 -num_threads 32 -gapopen 5 -gapextend 2 -perc_identity 97\ndone","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141585","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"68F5587EB86A4BF6BC342BB147EDEB6E","previous_guid":"953E63A5BFD043319D398A5F433792F9","previous_id":"141584","last_modified":"1502718714","components":[{"component_id":"977518","previous_id":0,"original_id":"0","guid":"AD27A4C1EC1C4499ACA4D402E6DBCEA8","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148489","previous_id":"977518","original_id":"0","guid":"B275CB8C6727465283CC44A6E324EDE3","previous_guid":"AD27A4C1EC1C4499ACA4D402E6DBCEA8","component_type_id":"1","data_id":"0","data":"Once we have the blast hits, we only want to keep hits that are within 3 nucleotides of the same length of our spacers.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Once we have the blast hits, we only want to keep hits that are within 3 nucleotides of the same length of our spacers."},"is_project":0},{"component_id":"148490","previous_id":"148489","original_id":"0","guid":"3356C8D6120D4ED49048D24AE653A2D1","previous_guid":"B275CB8C6727465283CC44A6E324EDE3","component_type_id":"15","data_id":"595","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"for line in $(cat spacer_lengths.txt); do\n    if [ \"${line:0:1}\" == \"s\" ]; then\n        name=${line}\n    else\n        length=`expr $line - 3`\n        for file in .\/viral_contig_blastn\/*_blastn.txt; do\n            grep -w \"$name\" $file | awk -v len=\"$length\" '$4 >= len {print $0}' >> .\/viral_contig_blastn\/${name}_hits.txt\n        done\n    fi\ndone\n\nfind .\/viral_contig_blastn -type f -empty -delete","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141586","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"9E683D7C695240D08E589901396F0238","previous_guid":"68F5587EB86A4BF6BC342BB147EDEB6E","previous_id":"141585","last_modified":"1502718714","components":[{"component_id":"977519","previous_id":0,"original_id":"0","guid":"42827E6FBE3D4DE299E4916B1932C545","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148491","previous_id":"977519","original_id":"0","guid":"BF87F7F80623433597E46FF1F1C96CBB","previous_guid":"42827E6FBE3D4DE299E4916B1932C545","component_type_id":"1","data_id":"0","data":"We can format and combine our blast hits.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"We can format and combine our blast hits."},"is_project":0},{"component_id":"148492","previous_id":"148491","original_id":"0","guid":"532BE9F6ED664CF8A185E6CBBC4C5D20","previous_guid":"BF87F7F80623433597E46FF1F1C96CBB","component_type_id":"15","data_id":"596","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"for file in .\/viral_contig_blastn\/spacer*_hits.txt; do \n\tcat $file | awk '{ print $1\"\\t\"$2 }'  >> .\/viral_contig_blastn\/all_viral_hits.txt\ndone","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141587","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"DCC37E7E3AA045E496C3875FBCBEC6C7","previous_guid":"9E683D7C695240D08E589901396F0238","previous_id":"141586","last_modified":"1502718714","components":[{"component_id":"977520","previous_id":0,"original_id":"0","guid":"9CEE44CAECB9479FA3F7C73A2F1C72DD","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148493","previous_id":"977520","original_id":"0","guid":"D4026F949A274F88AE1584BB078BC17F","previous_guid":"9CEE44CAECB9479FA3F7C73A2F1C72DD","component_type_id":"1","data_id":"0","data":"We want to know the identify of the viral sequences that contain CRISPR spacer hits.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"We want to know the identify of the viral sequences that contain CRISPR spacer hits."},"is_project":0},{"component_id":"148494","previous_id":"148493","original_id":"0","guid":"4B159880FC1A467C920AF199D2661BF9","previous_guid":"D4026F949A274F88AE1584BB078BC17F","component_type_id":"15","data_id":"597","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"cat \/project\/egricelab\/SkinMetVirome_tmp_files\/ray_contigs_neg_clean_for_crisprs\/*_Contigs_with_format.fa > .\/viral_contig_blastn\/viral_contigs.fa\ncat .\/viral_contig_blastn\/all_viral_hits.txt | awk '{print $2}' | sort -u > .\/viral_contig_blastn\/viral_contig_hits.txt\n\nfor line in $(cat .\/viral_contig_blastn\/viral_contig_hits.txt ); do\n\tgrep -A 1 \"$line\" .\/viral_contig_blastn\/viral_contigs.fa >> .\/viral_contig_blastn\/viral_hit_seqs.fa\ndone\n\nblastx -query .\/viral_contig_blastn\/viral_hit_seqs.fa -out .\/viral_contig_blastn\/viral_hit_seqs_blastn.txt -db references\/UniProt-Virus-Phage\/uniprot_virus_and_phage_TrEMBL_db -outfmt 7 -num_threads 32 -max_target_seqs 1 -evalue 1e-5\ngrep \"^contig*\" .\/viral_contig_blastn\/viral_hit_seqs_blastn.txt | awk '{print $1\"\\t\"$2}' >> .\/viral_contig_blastn\/viral_hit_seqs_blastn_formatted.txt\ngrep -B 2 \"# 0 hits found\" .\/viral_contig_blastn\/viral_hit_seqs_blastn.txt | sed 's\/# Query: \/\/g' | sed '\/# Database\/d' | sed '\/# 0 hits found\/d' | sed '\/--\/d' | awk '{print $1 \"\\tNot_Assigned\"}' >> .\/viral_contig_blastn\/viral_hit_seqs_blastn_formatted.txt","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141588","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"98230940AF1D461CAFD9999B7B4A3A1F","previous_guid":"DCC37E7E3AA045E496C3875FBCBEC6C7","previous_id":"141587","last_modified":"1502718714","components":[{"component_id":"977521","previous_id":0,"original_id":"0","guid":"7C14B56A525E4FB08BEDC465F2513F66","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148495","previous_id":"977521","original_id":"0","guid":"CA9F2F8F834D429A92BFDC93AEC49BC6","previous_guid":"7C14B56A525E4FB08BEDC465F2513F66","component_type_id":"1","data_id":"0","data":"We also want to know the identity of the bacterial host.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"We also want to know the identity of the bacterial host."},"is_project":0},{"component_id":"148496","previous_id":"148495","original_id":"0","guid":"2298609DEC9A44829925D9E9CAD49C58","previous_guid":"CA9F2F8F834D429A92BFDC93AEC49BC6","component_type_id":"15","data_id":"598","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"mkdir read_assignment","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141590","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"E962D879AF424713B614A7BD2AC063B8","previous_guid":"98230940AF1D461CAFD9999B7B4A3A1F","previous_id":"141588","last_modified":"1502718714","components":[{"component_id":"977522","previous_id":0,"original_id":"0","guid":"6B6B4E629ACF4A1EB2818848A39994CC","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148498","previous_id":"977522","original_id":"0","guid":"7809B31B45D44B00A57BB89AA17CD5DB","previous_guid":"6B6B4E629ACF4A1EB2818848A39994CC","component_type_id":"1","data_id":"0","data":"Look at reads containing crispr arrays for each repeat. This generates a fasta file for each repeat.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Look at reads containing crispr arrays for each repeat. This generates a fasta file for each repeat."},"is_project":0},{"component_id":"148499","previous_id":"148498","original_id":"0","guid":"D43B6787807C40D08EBF2417EEEE9779","previous_guid":"7809B31B45D44B00A57BB89AA17CD5DB","component_type_id":"15","data_id":"599","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"for file in *reads.good.fasta; do \n\tcat $file >> .\/read_assignment\/${file\/.MG*\/}.fa\ndone\n\ncd read_assignment\nfind . -type f -empty -delete\n\nfor file in $(ls); do \n# blast these reads against the NCBI non redundant database, keeping the top hit\n\tblastn -query $file -out ${file\/.fa\/_blastn.txt} -db references\/ncbi\/nt -outfmt '7 qseqid staxids' -num_threads 32 -evalue 1e-10 -max_target_seqs 1","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141591","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"7758656F08E64125ABBAEC284D0672B1","previous_guid":"E962D879AF424713B614A7BD2AC063B8","previous_id":"141590","last_modified":"1502718714","components":[{"component_id":"977523","previous_id":0,"original_id":"0","guid":"BF460035A35241A6B8DD6F3E6341D236","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148500","previous_id":"977523","original_id":"0","guid":"DA9A198E865745AF836B57E2A84F3BD0","previous_guid":"BF460035A35241A6B8DD6F3E6341D236","component_type_id":"1","data_id":"0","data":"Format the output so it is tab delimited with the contig id in the first column and taxonomic assignment in the second column.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Format the output so it is tab delimited with the contig id in the first column and taxonomic assignment in the second column."},"is_project":0},{"component_id":"148501","previous_id":"148500","original_id":"0","guid":"9F12BEC8ADE44D53BDFAEFB0730E0F11","previous_guid":"DA9A198E865745AF836B57E2A84F3BD0","component_type_id":"15","data_id":"600","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"grep \"^contig*\" ${file\/.fa\/_blastn.txt} >> ${file\/.fa\/_blastn_formatted.txt}\n\tgrep -B 2 \"# 0 hits found\" ${file\/.fa\/_blastn.txt} | sed 's\/# Query: \/\/g' | sed '\/# Database\/d' | sed '\/# 0 hits found\/d' | sed '\/--\/d' | awk '{print $1 \"\\tNot_Assigned\"}' >> ${file\/.fa\/_blastn_formatted.txt}\ndone","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141592","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"84E053BC4C984497B2C01EEE1CB8B224","previous_guid":"7758656F08E64125ABBAEC284D0672B1","previous_id":"141591","last_modified":"1502718714","components":[{"component_id":"977524","previous_id":0,"original_id":"0","guid":"0576F51252E140239ADD054C3EFF2633","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148502","previous_id":"977524","original_id":"0","guid":"67DFFD6F97364AE7AAAA43D66CD91ADA","previous_guid":"0576F51252E140239ADD054C3EFF2633","component_type_id":"1","data_id":"0","data":"Remove empty files.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Remove empty files."},"is_project":0},{"component_id":"148503","previous_id":"148502","original_id":"0","guid":"570565E3C89B490DBCE53435B6B0C8A2","previous_guid":"67DFFD6F97364AE7AAAA43D66CD91ADA","component_type_id":"15","data_id":"601","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"find . -type f -empty -delete","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141593","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"63EDBE8DB77E4F9EBB6152A2C957040F","previous_guid":"84E053BC4C984497B2C01EEE1CB8B224","previous_id":"141592","last_modified":"1502718714","components":[{"component_id":"977525","previous_id":0,"original_id":"0","guid":"EF90103D4B8240718A009CA871EAE6DA","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148504","previous_id":"977525","original_id":"0","guid":"872D878B2B954F1EAA57998A936F6CC7","previous_guid":"EF90103D4B8240718A009CA871EAE6DA","component_type_id":"1","data_id":"0","data":"Add a column to the formatted blast output containing the repeat information so the *_blastn_formatted_labeled.txt has 3 columns; crispr repeat, contig id, and taxonomic assignment.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Add a column to the formatted blast output containing the repeat information so the *_blastn_formatted_labeled.txt has 3 columns; crispr repeat, contig id, and taxonomic assignment."},"is_project":0},{"component_id":"148505","previous_id":"148504","original_id":"0","guid":"B42B00BB6F814279B7BA80BE296A45D1","previous_guid":"872D878B2B954F1EAA57998A936F6CC7","component_type_id":"15","data_id":"602","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"for file in *_blastn_formatted.txt; do\n\tawk -F, '{print FILENAME , $0}' OFS=\"\\t\" $file > ${file\/.txt\/_labeled.txt}\ndone","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141594","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"4F3ABB37A0C441E7B3ED10F96A736770","previous_guid":"63EDBE8DB77E4F9EBB6152A2C957040F","previous_id":"141593","last_modified":"1502718714","components":[{"component_id":"977526","previous_id":0,"original_id":"0","guid":"AED1CD5F51074868B4050A64B10C1F83","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148506","previous_id":"977526","original_id":"0","guid":"82B98B1819B34CF4AE881BB24ACB52B1","previous_guid":"AED1CD5F51074868B4050A64B10C1F83","component_type_id":"1","data_id":"0","data":"Combine all blast hits.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Combine all blast hits."},"is_project":0},{"component_id":"148507","previous_id":"148506","original_id":"0","guid":"6BC96B283B5144798F94AFB27332E360","previous_guid":"82B98B1819B34CF4AE881BB24ACB52B1","component_type_id":"15","data_id":"603","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"cat *_blastn_formatted_labeled.txt | sort -u > read_assignment_blastn.txt","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141595","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"6B684543D2DB4CDC9B4E28B82CFD8F92","previous_guid":"4F3ABB37A0C441E7B3ED10F96A736770","previous_id":"141594","last_modified":"1502718714","components":[{"component_id":"977527","previous_id":0,"original_id":"0","guid":"9CFB68203A1C445D9E0F1D00FFBE3D0C","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148508","previous_id":"977527","original_id":"0","guid":"D425AE0FB6E7472297D6567D119D938E","previous_guid":"9CFB68203A1C445D9E0F1D00FFBE3D0C","component_type_id":"1","data_id":"0","data":"Finally, we want to map each repeat, spacer combination to the metagenomic sample it is found in.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Finally, we want to map each repeat, spacer combination to the metagenomic sample it is found in."},"is_project":0},{"component_id":"148509","previous_id":"148508","original_id":"0","guid":"997D1DEC56B34C458DB281BC464CC5EB","previous_guid":"D425AE0FB6E7472297D6567D119D938E","component_type_id":"15","data_id":"604","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"for file in repeat*.fa; do\n    name=${file\/.fa\/}\n    repeat=`grep -A 1 -w \"$name\" ..\/..\/crispr_repeats_unique_sorted.fa | sed '\/^>repeat*\/d'`\n    RCrepeat=`RC $repeat`\n    for line in $(cat ..\/spacers.fa); do\n        if [ \"${line:0:1}\" == \">\" ]; then\n            spacerName=${line#>}\n        else\n        \tegrep -B 1 \"$repeat$line$repeat\" $file | grep \"^>\" | sed 's\/>\/\/g' | awk -v name=$name -v spacer=$spacerName '{print name\"_\"spacer\"\\t\"$0}' >> read_spacer_assignment.txt\n        \tegrep -B 1 \"$RCrepeat$line$RCrepeat\" $file | grep \"^>\" | sed 's\/>\/\/g' | awk -v name=$name -v spacer=$spacerName '{print name\"_\"spacer\"\\t\"$0}' >> read_spacer_assignment.txt\n            spacer_RC=`RC $line`\n            egrep -B 1 \"$repeat$spacer_RC$repeat\" $file | grep \"^>\" | sed 's\/>\/\/g' | awk -v name=$name -v spacer=$spacerName '{print name\"_\"spacer\"\\t\"$0}' >> read_spacer_assignment.txt\n            egrep -B 1 \"$RCrepeat$spacer_RC$RCrepeat\" $file | grep \"^>\" | sed 's\/>\/\/g' | awk -v name=$name -v spacer=$spacerName '{print name\"_\"spacer\"\\t\"$0}' >> read_spacer_assignment.txt\n        fi\n    done\ndone","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141596","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"FEDE6EE0AEDB4A41B571F3BF2AFCE8F0","previous_guid":"6B684543D2DB4CDC9B4E28B82CFD8F92","previous_id":"141595","last_modified":"1502718714","components":[{"component_id":"977528","previous_id":0,"original_id":"0","guid":"360A5F1615C146D59E024CD8B20D2A70","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148510","previous_id":"977528","original_id":"0","guid":"D081C94A0CBC419D9A7A61D2DF69CFFA","previous_guid":"360A5F1615C146D59E024CD8B20D2A70","component_type_id":"1","data_id":"0","data":"<div class=\"text_cell_render border-box-sizing rendered_html\">\n<p>The file read_spacer_assignment.txt contains two columns; the first with the repeat and spacer id and the second with the contig it is found in. We can now format files in R for easier analysis. To determine whether the CRISPRs were targeting coding or non-coding regions in phage, we blasted the CRISPR spacers against the Glimmer identified ORFs from the viral contigs that the spacers mapped to.<\/p>\n<\/div>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<div class=\"text_cell_render border-box-sizing rendered_html\">\n<p>The file read_spacer_assignment.txt contains two columns; the first with the repeat and spacer id and the second with the contig it is found in. We can now format files in R for easier analysis. To determine whether the CRISPRs were targeting coding or non-coding regions in phage, we blasted the CRISPR spacers against the Glimmer identified ORFs from the viral contigs that the spacers mapped to.<\/p>\n<\/div>"},"is_project":0}]},{"id":"141597","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"6550DC38330E41A0A17D4614293EB4DC","previous_guid":"FEDE6EE0AEDB4A41B571F3BF2AFCE8F0","previous_id":"141596","last_modified":"1502718714","components":[{"component_id":"977529","previous_id":0,"original_id":"0","guid":"B62BBDF0FFD54AB4991208D1505F1A08","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148511","previous_id":"977529","original_id":"0","guid":"FC0B2B42B87C413AA4B84DAA26560E90","previous_guid":"B62BBDF0FFD54AB4991208D1505F1A08","component_type_id":"1","data_id":"0","data":"Keep only info about repeat, spacer, skinmet contig, viral contig, and viral sample body site.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Keep only info about repeat, spacer, skinmet contig, viral contig, and viral sample body site."},"is_project":0},{"component_id":"148512","previous_id":"148511","original_id":"0","guid":"4B520224137F49D08B087914E8F28C2B","previous_guid":"FC0B2B42B87C413AA4B84DAA26560E90","component_type_id":"15","data_id":"605","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"cut -f 1,2,3,11,14 crispr_hits.txt > crispr_contig_hits.txt","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141598","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"B96A6159BE7E4914BCA515A3B7A1D22C","previous_guid":"6550DC38330E41A0A17D4614293EB4DC","previous_id":"141597","last_modified":"1502718714","components":[{"component_id":"977530","previous_id":0,"original_id":"0","guid":"2719EDE8B10C47B88B148C7ACB078A42","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148513","previous_id":"977530","original_id":"0","guid":"7DB5669D138C476A8FA2158D0E781AFB","previous_guid":"2719EDE8B10C47B88B148C7ACB078A42","component_type_id":"1","data_id":"0","data":"Paste repeat and spacer together and format file.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Paste repeat and spacer together and format file."},"is_project":0},{"component_id":"148514","previous_id":"148513","original_id":"0","guid":"A56E025C3A0844F8BC7E6DF24C6F3AD9","previous_guid":"7DB5669D138C476A8FA2158D0E781AFB","component_type_id":"15","data_id":"606","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"awk '{print $0\"\\t\"$2\"_\"$1}' crispr_contig_hits.txt | cut -f 6,4 > tmp2.txt\nhead -n 1 tmp2.txt > formatted_crispr_contig_hits.txt\ntail -n+2 tmp2.txt | sort -u >> formatted_crispr_contig_hits.txt\nrm tmp2.txt","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141599","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"25B310D08D6143FE93BD933FC8DD72FE","previous_guid":"B96A6159BE7E4914BCA515A3B7A1D22C","previous_id":"141598","last_modified":"1502718714","components":[{"component_id":"977531","previous_id":0,"original_id":"0","guid":"85CEC9634C71416B9B3BBAE7A2430EB4","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148515","previous_id":"977531","original_id":"0","guid":"3F712A1FE1DE42CCA4984A9003B09E71","previous_guid":"85CEC9634C71416B9B3BBAE7A2430EB4","component_type_id":"1","data_id":"0","data":"Extract the Glimmer predicted open reading frames for the contigs targeted by CRISPR spacers.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Extract the Glimmer predicted open reading frames for the contigs targeted by CRISPR spacers."},"is_project":0},{"component_id":"148516","previous_id":"148515","original_id":"0","guid":"7FB1A0D916A640CCBCE7C2C31F6F1010","previous_guid":"3F712A1FE1DE42CCA4984A9003B09E71","component_type_id":"15","data_id":"607","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"tail -n+2 formatted_crispr_contig_hits.txt | awk '{print $1}' | while read LINE; do  \n\tSAMPLE=${LINE\/contig*nucleotides_\/}\n\tgrep -A 1 $LINE \/project\/egricelab\/SkinMetVirome_tmp_files\/ray_contigs_neg_clean_for_crisprs\/glimmer3\/output\/${SAMPLE}_no_block.genes > ${LINE}_orfs.fa\ndone","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141600","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"DB8457A70B35437B90A8C05AB80EF90D","previous_guid":"25B310D08D6143FE93BD933FC8DD72FE","previous_id":"141599","last_modified":"1502718714","components":[{"component_id":"977532","previous_id":0,"original_id":"0","guid":"392954B7330C4B028F16C6B9B52C0FE8","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148517","previous_id":"977532","original_id":"0","guid":"909A65DF2C214FACA2CF74E7397DD12F","previous_guid":"392954B7330C4B028F16C6B9B52C0FE8","component_type_id":"1","data_id":"0","data":"Remove empty files.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Remove empty files."},"is_project":0},{"component_id":"148518","previous_id":"148517","original_id":"0","guid":"86696760F44749E1B6D5EAD7D69D8F8D","previous_guid":"909A65DF2C214FACA2CF74E7397DD12F","component_type_id":"15","data_id":"608","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"find . -type f -empty -delete","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141601","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"124F81C104A848BABE538306E5A07D4E","previous_guid":"DB8457A70B35437B90A8C05AB80EF90D","previous_id":"141600","last_modified":"1502718714","components":[{"component_id":"977533","previous_id":0,"original_id":"0","guid":"E02B310F5C59436BBDDB36E24B2B7167","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148519","previous_id":"977533","original_id":"0","guid":"C3539E1C4B1D488EBDBC915510FE05D0","previous_guid":"E02B310F5C59436BBDDB36E24B2B7167","component_type_id":"1","data_id":"0","data":"BLAST spacers against the open reading frames in the virome they came from.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"BLAST spacers against the open reading frames in the virome they came from."},"is_project":0},{"component_id":"148520","previous_id":"148519","original_id":"0","guid":"EA3B35DA71E14AC59B1D0E10CD583413","previous_guid":"C3539E1C4B1D488EBDBC915510FE05D0","component_type_id":"15","data_id":"609","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"for file in *_orfs.fa; do\n\tmakeblastdb -dbtype nucl -in $file -out ${file\/.fa\/_db}\ndone\n\ntail -n+2 formatted_crispr_contig_hits.txt | while read LINE; do\n\tCONTIG=${LINE\/repeat*\/};\n\tCONTIG=`echo $CONTIG | sed 's\/[ \\t]*$\/\/'`;\n\tSPACER=${LINE\/contig*MG100[0-9][0-9][0-9]*repeat_*_spacer\/spacer};\n\tgrep -w -A 1 $SPACER .\/raw_repeats\/spacers.fa > tmp_seq.fa;\n\tif [ -f ${CONTIG}_orfs.fa ]; then \n\t\tblastn -query tmp_seq.fa -out ${SPACER}_${CONTIG}_blast.txt -db ${CONTIG}_orfs_db -outfmt 7 -num_threads 32 -evalue 1e-10 -max_target_seqs 1 -perc_identity 97\n\tfi\n\trm tmp_seq.fa;\ndone","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141602","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"141D7D10C0564AEDA3297446BCC70598","previous_guid":"124F81C104A848BABE538306E5A07D4E","previous_id":"141601","last_modified":"1502718714","components":[{"component_id":"977534","previous_id":0,"original_id":"0","guid":"581BDC43FB354B409B5A7710FA4ABD9A","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148521","previous_id":"977534","original_id":"0","guid":"2DED92BC02B24B5697274255495BF48A","previous_guid":"581BDC43FB354B409B5A7710FA4ABD9A","component_type_id":"1","data_id":"0","data":"Find which spacers hit open reading frames and which ones do not.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Find which spacers hit open reading frames and which ones do not."},"is_project":0},{"component_id":"148522","previous_id":"148521","original_id":"0","guid":"283FF2EE7D0F4C428C8F91594FAD5561","previous_guid":"2DED92BC02B24B5697274255495BF48A","component_type_id":"15","data_id":"610","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"for file in spacer*blast.txt; do \n\tcount=`grep -c \"# 0 hits found\" $file`; \n\tif [ $count -gt 0 ]; then \n\t\trm $file;\n\telse \n\t\tgrep \"^spacer*\" $file >> crispr_orf_hits.txt;\n\tfi; \ndone","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141603","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"6F68B3F674BE4ED8A52B07654059AD36","previous_guid":"141D7D10C0564AEDA3297446BCC70598","previous_id":"141602","last_modified":"1502718714","components":[{"component_id":"977535","previous_id":0,"original_id":"0","guid":"F1B715B815D04FBA82C18A4FE2E12DF7","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148523","previous_id":"977535","original_id":"0","guid":"8CFCB0EB86FE4FE3A41D13555DD37150","previous_guid":"F1B715B815D04FBA82C18A4FE2E12DF7","component_type_id":"1","data_id":"0","data":"Count how many total hits there were and how many hits were to open reading frames.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Count how many total hits there were and how many hits were to open reading frames."},"is_project":0},{"component_id":"148524","previous_id":"148523","original_id":"0","guid":"75514F79F57A4C01A7431199A7B5A742","previous_guid":"8CFCB0EB86FE4FE3A41D13555DD37150","component_type_id":"15","data_id":"611","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"echo \"CRISPR SPACER CONTIG MATCHES\" > crispr_orf_hits_stats.txt\ntail -n+2 formatted_crispr_contig_hits.txt | wc -l >> crispr_orf_hits_stats.txt\necho \"CRISPR HITS TO ORFS\" >> crispr_orf_hits_stats.txt\nwc -l crispr_orf_hits.txt >> crispr_orf_hits_stats.txt","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"141604","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"2152FF83C67945D5B65BF2FE56EDB85C","previous_guid":"6F68B3F674BE4ED8A52B07654059AD36","previous_id":"141603","last_modified":"1502718714","components":[{"component_id":"977536","previous_id":0,"original_id":"0","guid":"D9BAABED4EC741A4BE20840C2B164CF8","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"148525","previous_id":"977536","original_id":"0","guid":"AF7AE492A85F49BC848BCB55225B2334","previous_guid":"D9BAABED4EC741A4BE20840C2B164CF8","component_type_id":"1","data_id":"0","data":"To identify what the ORFs targeted by spacers encode, we blasted the ORFs against the UniProt TrEMBL database.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"To identify what the ORFs targeted by spacers encode, we blasted the ORFs against the UniProt TrEMBL database."},"is_project":0},{"component_id":"148526","previous_id":"148525","original_id":"0","guid":"7D707F10022147A690CE755812F85404","previous_guid":"AF7AE492A85F49BC848BCB55225B2334","component_type_id":"15","data_id":"612","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"awk '{print $2}' crispr_orf_hits.txt | sort -u | while read LINE; do\n\tgrep -A 1 $LINE ${LINE\/.orf*\/_orfs.fa} >> crispr_orf_hits.fa\ndone\n\nblastx -query crispr_orf_hits.fa -out crispr_orf_hits_blast_uniprot.txt -db \/project\/egricelab\/references\/TrEMBL\/uniprot_trembl -outfmt 6 -num_threads 32 -evalue 1e-10 -max_target_seqs 1 -show_gis","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]}]}