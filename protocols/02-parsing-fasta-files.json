{"id":22541,"title":"02: Parsing FASTA files","title_html":"02: Parsing FASTA files","image":{"source":"https:\/\/www.protocols.io\/img\/default_protocol.png","placeholder":"https:\/\/www.protocols.io\/img\/default_protocol.png"},"doi":"dx.doi.org\/10.17504\/protocols.io.z9mf946","doi_status":2,"uri":"02-parsing-fasta-files-z9mf946","type_id":1,"published_on":1556040509,"version_id":2,"created_on":1556040442,"categories":null,"creator":{"name":"Frank O. Aylward","affiliation":"Virginia Tech","username":"frank-aylward","link":null,"image":{"source":"https:\/\/s3.amazonaws.com\/pr-journal\/v39jtte.png","placeholder":"https:\/\/s3.amazonaws.com\/pr-journal\/v39jtte.png"},"badges":[{"id":4,"image":{"source":"\/img\/badges\/gold.svg","placeholder":"\/img\/badges\/gold.svg"},"name":"Gold power author!"}],"research_interests":null},"journal":null,"journal_name":null,"journal_link":null,"public":1,"has_versions":1,"link":null,"total_collections":0,"number_of_steps":13,"authors":[{"name":"Frank Aylward","affiliation":"Virginia Tech","username":"frank-aylward","link":null,"image":{"source":"https:\/\/s3.amazonaws.com\/pr-journal\/v39jtte.png","placeholder":"https:\/\/s3.amazonaws.com\/pr-journal\/v39jtte.png"},"badges":[],"research_interests":null}],"versions":[],"groups":[],"has_subprotocols":0,"is_subprotocol":0,"is_bookmarked":0,"forks_count":{"private":0,"public":0},"access":{"can_view":1,"can_remove":0,"can_add":0,"can_edit":0,"can_publish":0,"can_get_doi":0,"can_share":1,"can_move":1,"can_move_outside":1,"can_transfer":1,"can_download":1,"is_locked":0},"steps":[{"id":733385,"guid":"E3DF105B14DD4A78A82B2753F2FC95A0","previous_id":null,"previous_guid":null,"modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"78C96F09B3A541C7A74EDC34E08AC6B0","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"CD50BBDB9FA24CE19F2C1481CC07B79A","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Today we will be looking at the genome of Yersinia pestis, which can be found on NCBI at this location<\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">ftp:\/\/ftp.ncbi.nlm.nih.gov\/genomes\/all\/GCA\/000\/009\/065\/GCA_000009065.1_ASM906v1<\/span><\/a><\/div><div class = \"text-block\">Copy this URL into your browser and take a look at the files. These are publicly-available files that are made available from the National Center for Biotechnology Information (NCBI). <\/div><div class = \"text-block\">Note that many of the files are in a compressed .gz format. <\/div><div class = \"text-block\">.fna files are Fasta Nucleic Acid (chromosome or gene sequences)<\/div><div class = \"text-block\">.faa files are Fasta Amino Acid   (protein sequences)<\/div><div class = \"text-block\">Today we will be most interested in the gene and chromosome files.<\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":733386,"guid":"E2E906136D0F494C9DE03A306859E722","previous_id":733385,"previous_guid":"E3DF105B14DD4A78A82B2753F2FC95A0","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"F96AE166C63F42D1A5CAEC40E6C5A695","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"E80775CC4B8A4DFC900F1113A4682971","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">To get started let's download the main genome FASTA file for Yersinia Pestis CO92<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">wget <\/span><\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">ftp:\/\/ftp.ncbi.nlm.nih.gov\/genomes\/all\/GCA\/000\/009\/065\/GCA_000009065.1_ASM906v1\/GCA_000009065.1_ASM906v1_cds_from_genomic.fna.gz<\/span><\/a><\/div><div class = \"text-block\">This command uses the common Unix utility \"wget\", which will download a file directy to the folder in which you are located. After doing this you should see the .fna.gz file in your folder. You can check this with the \"ls\" command. <\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":"#A492FF"},{"id":733387,"guid":"8C1863853F5A4DDEB064D55AA07B11CB","previous_id":733386,"previous_guid":"E2E906136D0F494C9DE03A306859E722","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"941D85FF43354CB1B6AE4F03C78DD20F","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"93C5C0586F544800BBF60FBAEE082EA2","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Because this file is compressed, we must first uncompress it with the \"gunzip\" command (another common Unix utility). <\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">gunzip GCA_000009065.1_ASM906v1_cds_from_genomic.fna.gz<\/span><\/div><div class = \"text-block\">After this you should see the exact same file, only without the .gz ending. You can check this with the \"ls\" command. <\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":"#A492FF"},{"id":733388,"guid":"35B4007692A7434983119C2E1D939A8C","previous_id":733387,"previous_guid":"8C1863853F5A4DDEB064D55AA07B11CB","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"BF7B662C214D42479A70DCCD0A2160D5","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"C61466DC8C504F7FB6F032826B42D3C0","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Now to start analyzing this FASTA file we first want to check on the formatting. <\/div><div class = \"text-block\">Sometimes genome files can be quite large, so we don't want to open the entire file with a text editor. Instead we can just check the first and last few lines to see what the format looks like. For this we can use the \"head\" and \"tail\" Unix commands. <\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">head<\/span><span style = \"font-weight:bold;font-weight:bold;\"> <\/span><span style = \"font-weight:bold;\">GCA_000009065.1_ASM906v1_cds_from_genomic.fna<\/span><\/div><div class = \"text-block\">and<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">tail GCA_000009065.1_ASM906v1_cds_from_genomic.fna<\/span><\/div><div class = \"text-block\">You should see a pretty typical FASTA format. Header lines start with a \">\" and provide names and descriptions, and subsequent lines have the actual sequence information (in this case ATGCs since the sequence is DNA). <\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":"#A492FF"},{"id":733389,"guid":"7F4EE01405044124AA7E43736AF3638C","previous_id":733388,"previous_guid":"35B4007692A7434983119C2E1D939A8C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"6A8AFF9A77704A8781A981658ED2C018","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"AEEA2BAD788E4BD3B6E5AE0AC17DEBE2","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Now that we have confirmed this is a typical FASTA file, we can start analyzing it with the \"seqkit\" tool. <\/div><div class = \"text-block\">The home page for seqkit with instructions for use is here: <\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/github.com\/shenwei356\/seqkit<\/span><\/a><\/div><div class = \"text-block\">You can also get a list of instructions by typing:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">seqkit --help <\/span><\/div><div class = \"text-block\">seqkit is a very versatile tools and it has a large number of sub-commands. We will primarily be using the \"stats\" and \"fx2tab\" commands, so check out the help menu for those with:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">seqkit stats --help<\/span><\/div><div class = \"text-block\">and <\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">seqkit fx2tab --help<\/span><\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":"#A492FF"},{"id":733390,"guid":"85FBB833961F4EF588AE53EFAB47C7ED","previous_id":733389,"previous_guid":"7F4EE01405044124AA7E43736AF3638C","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"4393320F282E46F58547F2D79AFCDCA1","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"99F5CF20647C40EA84B02FD3FFF59AB8","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Now let's get some basic stats about the genes with the \"stats\" command. <\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">seqkit stats GCA_000009065.1_ASM906v1_cds_from_genomic.fna<\/span><\/div><div class = \"text-block\">How does the total length of the protein-coding genes compare to the total length of the whole genome?<\/div><div class = \"text-block\">What is the range of gene lengths?<\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":"#A492FF"},{"id":733391,"guid":"4888A3AEBE3B407BA8115337299A771A","previous_id":733390,"previous_guid":"85FBB833961F4EF588AE53EFAB47C7ED","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"8B00C8DF83CA4007AF169516FAA1A1A0","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"945B0B7A1A46465DB42E0B5E09AE598C","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Let's look at some stats from individual genes using the \"fx2tab\" command:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">seqkit fx2tab -a -i -g -l -n GCA_000009065.1_ASM906v1_cds_from_genomic.fna | head<\/span><\/div><div class = \"text-block\">Note that we are piping the command to the \"head\" command here, so that only the first 10 lines are shown. Otherwise thousands of entries would flood our terminal, which is always difficult to interpret (and may cause it to crash). <\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":"#A492FF"},{"id":733392,"guid":"F7C2E672E70B4B3FAB279F3048931C33","previous_id":733391,"previous_guid":"4888A3AEBE3B407BA8115337299A771A","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"03207B3212E44A5C8F5C8E76E573B33E","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"17D32F221AEB4CE1B9EA6DDEBB40D85B","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Now let's try to sort the genes based on their length, so that we can find the names of the longest and shortest genes:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">seqkit fx2tab -a -i -g -l -n GCA_000009065.1_ASM906v1_cds_from_genomic.fna | sort -r -n -k 2,2 | head<\/span><\/div><div class = \"text-block\">This should return the longest 10 genes. The \"sort\" command uses several flags. <\/div><div class = \"text-block\">-r indicates a reverse sort (default is from low to high. <\/div><div class = \"text-block\">-n indicates a numeric sort (default is alphabetical). <\/div><div class = \"text-block\">-k denotes the columns to sort by. The \"2,2\" means we are sorting only by the second column. Note that all whitespace counts as a single tab here, so the second column is the length (it would be the 4th if we exported the results to a file). <\/div><div class = \"text-block\">We can do the same with \"tail\" instead of head to find the names of the shortest genes. <\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":"#A492FF"},{"id":733393,"guid":"0995CA6C9E6E4461B58116491A69EC49","previous_id":733392,"previous_guid":"F7C2E672E70B4B3FAB279F3048931C33","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"A8E942B263F043A9AB0D9A70B2B01A23","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"FDC95B3C14F64F2A8D881774025CBC0C","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">We can use the same logic as above to find the genes with the highest and lowest %GC content. For this we need to sort by the third column. <\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">seqkit fx2tab -H -a -i -g -l -n GCA_000009065.1_ASM906v1_cds_from_genomic.fna | sort -rn -k 3,3 | head <\/span><\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":"#A492FF"},{"id":733394,"guid":"06E8103C3AD9465792309153CBA00547","previous_id":733396,"previous_guid":"26E63354C769449EA3C1D988F8B7FA6B","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"ED81E80AB0034AFC9C860C06C693D5BC","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"E89B4B6C29B14BEAB1C32181B3BF4A9C","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Now let's say we want to retrieve the actual DNA sequence of the gene with the highest %GC content. We can do this by using a \"seqkit fx2tab\" command and piping the results to a \"grep\" command. <\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">seqkit fx2tab -H -a -i -g -l GCA_000009065.1_ASM906v1_cds_from_genomic.fna | head -n 1<\/span><\/div><div class = \"text-block\">Note that we did not use the \"-n\" flag in the seqkit fx2tab command, since this time we wanted the sequence (before we just wanted the statistics). <\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":"#A492FF"},{"id":733395,"guid":"015F51FFCB1246FFB68BE76195EC4104","previous_id":733394,"previous_guid":"06E8103C3AD9465792309153CBA00547","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"927AACF03B654D89A014965C898C30D0","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"A0A5D6F4896140ECBADB6A732CA3073B","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">We can also search the actual gene sequences to find certain motifs with the \"locate\" subcommand. <\/div><div class = \"text-block\">Lets see how many genes have a string of 11 G's:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">seqkit locate -p \"GGGGGGGGGGG\" GCA_000009065.1_ASM906v1_cds_from_genomic.fna<\/span><\/div><div class = \"text-block\">Note that some genes come up multiple times, since they have multiple matches (in this case, genes with a very high GC content will come up several times). <\/div><div class = \"text-block\">To return only one line per gene, we can pipe the result to a \"sort\" command using the \"-u\" option, to specify we only want unique matches.  <\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">seqkit locate -p \"GGGGGGGGGGG\" GCA_000009065.1_ASM906v1_cds_from_genomic.fna | sort -u -k 1,1<\/span><\/div><div class = \"text-block\">Note that we still have to use the -k 1,1 flag for sort, since we only want to sort by the first column. <\/div><div class = \"text-block\">Now let's do the same, but allow for one mismatch:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">seqkit locate -m 1 -p \"GGGGGGGGGG\" GCA_000009065.1_ASM906v1_cds_from_genomic.fna | sort -u -k1,1<\/span><\/div><div class = \"text-block\">Note that we get many more matches when allowing for even just a single mismatch, since that mismatch can occur anywhere on the sequence. | <\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":"#A492FF"},{"id":733396,"guid":"26E63354C769449EA3C1D988F8B7FA6B","previous_id":733393,"previous_guid":"0995CA6C9E6E4461B58116491A69EC49","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"67896C7C545B47C0A87C592714CDDFB0","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"679C24FA86EA46F4B37F38487C2D70F2","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">If we want to do something more complex and find the average GC content of the genes, we can pipe the result to \"datamash\" a nice program for simple math. <\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">seqkit fx2tab -H -a -i -g -l -n GCA_000009065.1_ASM906v1_cds_from_genomic.fna | sort -rn -k 3,3 | datamash mean 5<\/span><\/div><div class = \"text-block\">Datamash needs the operation as the second item in the command (sum, mean, etc) and the column ID as the third item. Note that whitespace is sometimes interpreted strangely by these commands, so here we actually need to use the 5th column (just by looking at the output we would assume %GC would be the third column, and that is how \"sort\" interprets it, but every tool is different). <\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":"#A492FF"},{"id":733397,"guid":"C4DD551E4E2F4EBEB2DAE1B25812989F","previous_id":733395,"previous_guid":"015F51FFCB1246FFB68BE76195EC4104","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"04F5682F921B4968BC76CA75D037613A","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"A2822CDB1D7D42F3BF24592CCE66D012","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Lastly, let's say we want to examine the actual sequences a bit more. Perhaps we are interested in the start codons used by these genes. We can identify them by using the \"subseq\" command. <\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">seqkit subseq -r 1:3 GCA_000009065.1_ASM906v1_cds_from_genomic.fna | grep -v \">\" | head<\/span><\/div><div class = \"text-block\">Here \"-r\" tells the command that we want only the first 3 bases in the sequences returned. The command also returns the FASTA headers, so we can remove them by piping the result to \"grep -v \">\"\", since this will only match lines that do not have the FASTA > header character. <\/div><div class = \"text-block\">If we wanted to get a summary of how often different start codons are used, we can sort and summarize the results with \"sort\" and then \"uniq\". <\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">seqkit subseq -r 1:3 GCA_000009065.1_ASM906v1_cds_from_genomic.fna | grep -v \">\" | sort | uniq -c<\/span><\/div><div class = \"text-block\">Here we can see that although ATG is the canonical and most frequently used start codon, there are actually a variety of different start codons used throughout the genome. <\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":"#A492FF"}],"materials":[],"description":"<div class = \"text-blocks\"><div class = \"text-block\">Week 1<\/div><div class = \"text-block\">Introduction to parsing FASTA files.<\/div><div class = \"text-block\">Commands to be entered into the command line are in bold. <\/div><div class = \"text-block\">Here we will be using various base Unix commands such as head, tail, sort, wget, and others. <\/div><div class = \"text-block\">We will also be using the seqkit tool to process FASTA files. The main page for seqkit is here:<\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/github.com\/shenwei356\/seqkit<\/span><\/a><\/div><\/div>","changed_on":1556040509}