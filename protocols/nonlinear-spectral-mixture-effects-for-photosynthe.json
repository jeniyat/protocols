{"uri":"nonlinear-spectral-mixture-effects-for-photosynthe-ia5cag6","version_id":"3","protocol_name":"Nonlinear Spectral Mixture Effects for Photosynthetic\/Non-photosynthetic Vegetation Cover Estimates of Typical Desert Vegetation in Western China","protocol_name_html":"Nonlinear Spectral Mixture Effects for Photosynthetic\/Non-photosynthetic Vegetation Cover Estimates of Typical Desert Vegetation in Western China","is_prepublished":"0","can_edit":"0","parent_id":"6178","api_version":"1","is_new_mode":"1","last_modified":"1521137537","type_id":"1","link":"https:\/\/doi.org\/10.1371\/journal.pone.0189292","fork_id":"","public_fork_note":null,"number_of_steps":"10","has_versions":"1","first_published_date":"1513361231","publish_date":"2017-12-15 18:07:11","documents":null,"have_protocol_in_step":"0","is_protocol_in_step":"0","vendor_name":"Contributed by users","vendor_link":"https:\/\/www.protocols.io","vendor_logo":"\/img\/vendors\/1.png","mod_mins":"-45","mod_secs":"1","description":"","is_bookmarked":"0","can_reassign":"1","before_start":"","has_guidelines":"0","materials":[],"warning":"","version_class":"6178","public":"1","is_owner":"1","is_original_owner":"1","created_on":"1496569001","protocol_affiliation":"","affiliation":null,"doi":"dx.doi.org\/10.17504\/protocols.io.ia5cag6","doi_status":"2","changed_fork_steps":null,"profile_url":"x2z2a443r2","protocol_img":"https:\/\/www.protocols.io\/img\/default_protocol.png","profile_image":"\/img\/avatars\/018.png","full_name":"Cuicui JI","created_by":"Cuicui JI","private_link":null,"original_img":"1","username":"cuicui-ji","is_retracted":"0","retraction_reason":null,"plos_id":"10.1371\/journal.pone.0189292","manuscript_citation":"Ji C,  Jia Y,  Gao Z,  Wei H,  Li X (2017) Nonlinear spectral mixture effects for photosynthetic\/non-photosynthetic vegetation cover estimates of typical desert vegetation in western China. PLoS ONE  12(12): e0189292. doi: <a target=\"_blank\" href=\"https:\/\/dx.doi.org\/10.1371\/journal.pone.0189292\">10.1371\/journal.pone.0189292<\/a> ","journal_name":"PLOS One","is_donations_disabled":"0","is_donations_disabled_by_user":"9","item_record_id":249177,"fork_info":[],"compare_forks":[],"protocols":[],"groups":[],"number_of_shared_runs":[],"ownership_history":[],"keywords":"","transfer_to_user":[],"sub_transfer":false,"is_transfer_pending":false,"number_of_bookmarks":"0","collections":[],"tags":[],"archived":0,"sub_authors":[],"sub_protocols_number":0,"can_edit_shared":0,"shared_runs":[],"is_shared_run":0,"is_shared":1,"banner":null,"contact_badges":[{"badge_id":"2","badge_image":"\/img\/badges\/bronze.svg","badge_description":"Author!"},{"badge_id":"5","badge_image":"\/img\/badges\/earlyadopter.svg","badge_description":"Early adopter"}],"number_of_comments":0,"is_locked":0,"is_locked_by":false,"authors":"","authors_list":[],"user":{"profile_image":"\/img\/avatars\/018.png","username":"cuicui-ji","full_name":"Cuicui JI","created_by":"Cuicui JI"},"access":{"can_view":"1","can_remove":"0","can_add":"0","can_edit":0,"can_publish":0,"can_get_doi":0,"can_share":"0","can_move":"1","can_transfer":"1","can_download":"1","is_locked":"0"},"is_contact_suspended":0,"guidelines":"","status_id":"1","is_research":null,"status_info":null,"steps":[{"id":"556907","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"468E43B7CE654132B4EACF588AA07328","previous_guid":null,"previous_id":"0","last_modified":"1496569929","components":[{"component_id":"919502","previous_id":0,"original_id":"0","guid":"98ADD9A9C7684E1C9E05414F2510FE79","previous_guid":null,"component_type_id":"1","data_id":"0","data":"<p>\u00a0In order to remove the effects of endmember variability, the experimental setup was designed so that endmembers were allowed to vary among plots. For each of the experimental plots, plot-specific bare soil (BS), shadow, PV, and NPV endmembers were defined and used in further analyses. In this research, spectra data for each endmember and canopy mixed spectral were obtained from ground-based field experiments; this involved obtaining specific PV\/NPV\/BS\/shadow endmember spectra in each sample plot so that we could remove the effect of variability among the endmember spectra . Reflectance spectral measurements were acquired on August 25, 2014 (a clear-sky day), within 1 h of local solar noon by using a full-range (350\u20132500 nm) spectroradiometer with a 25\u00b0 ASD (Analytic Spectral Devices, Boulder, CO) Spec Pro Field spectrometer. The reflectance was calibrated by using a white spectral panel (Labsphere Inc., North Sutton, NH). During windless, cloudless, and full sunshine conditions, we collected data throughout a stable time period (10:00\u201314:00) from 20 <em>Nitraria<\/em> plots and 20 <em>Haloxylon<\/em> plots with different ratios of PV to NPV cover, and we measured the canopy spectra and the pure endmembers spectra. We used an orthogonal ruler to determine the center of the plots, and we marked out 1 m diameter circular area to ensure the sample range was consistent. Measurements were taken from nadir at a height of 2.3 m above the earth\u2019s surface, which resulted in a field of view (FOV) or a pixel\/plot diameter of 1 m from which we obtained the mixed spectral data for the fields; meanwhile, we placed the probe above the various typical species endmember surfaces (e.g., <em>Nitraria<\/em>, <em>Haloxylon<\/em>, dry branches, fine sand, shadows) between 0.1 m and 0.02 m so that pure endmember spectra were acquired in each field. In this way, each mixed canopy pixel and the specific pure endmember spectra for the field sites were obtained.<\/p>\n<h2>\u00a0<\/h2>\n<h2>\u00a0<\/h2>\n<h2>\u00a0<\/h2>","order_id":"0","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>\u00a0In order to remove the effects of endmember variability, the experimental setup was designed so that endmembers were allowed to vary among plots. For each of the experimental plots, plot-specific bare soil (BS), shadow, PV, and NPV endmembers were defined and used in further analyses. In this research, spectra data for each endmember and canopy mixed spectral were obtained from ground-based field experiments; this involved obtaining specific PV\/NPV\/BS\/shadow endmember spectra in each sample plot so that we could remove the effect of variability among the endmember spectra . Reflectance spectral measurements were acquired on August 25, 2014 (a clear-sky day), within 1 h of local solar noon by using a full-range (350\u20132500 nm) spectroradiometer with a 25\u00b0 ASD (Analytic Spectral Devices, Boulder, CO) Spec Pro Field spectrometer. The reflectance was calibrated by using a white spectral panel (Labsphere Inc., North Sutton, NH). During windless, cloudless, and full sunshine conditions, we collected data throughout a stable time period (10:00\u201314:00) from 20 <em>Nitraria<\/em> plots and 20 <em>Haloxylon<\/em> plots with different ratios of PV to NPV cover, and we measured the canopy spectra and the pure endmembers spectra. We used an orthogonal ruler to determine the center of the plots, and we marked out 1 m diameter circular area to ensure the sample range was consistent. Measurements were taken from nadir at a height of 2.3 m above the earth\u2019s surface, which resulted in a field of view (FOV) or a pixel\/plot diameter of 1 m from which we obtained the mixed spectral data for the fields; meanwhile, we placed the probe above the various typical species endmember surfaces (e.g., <em>Nitraria<\/em>, <em>Haloxylon<\/em>, dry branches, fine sand, shadows) between 0.1 m and 0.02 m so that pure endmember spectra were acquired in each field. In this way, each mixed canopy pixel and the specific pure endmember spectra for the field sites were obtained.<\/p>\n<h2>\u00a0<\/h2>\n<h2>\u00a0<\/h2>\n<h2>\u00a0<\/h2>"},"is_project":0},{"component_id":"919503","previous_id":"919502","original_id":"0","guid":"BDD33B7FA7CD40E19FA7725953459DF2","previous_guid":"98ADD9A9C7684E1C9E05414F2510FE79","component_type_id":"6","data_id":"0","data":"Spectral Data and Preprocessing","order_id":"1","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Spectral Data and Preprocessing"},"is_project":0}]},{"id":"556908","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"E7A38039B43B433DB292AFF3F878DB2C","previous_guid":"E8D9DEFA49BB4A9481BB980E24879CE4","previous_id":"556909","last_modified":"1496569995","components":[{"component_id":"919504","previous_id":0,"original_id":"0","guid":"7F78FDA0E2DA42DC886A350D6414C45D","previous_guid":null,"component_type_id":"1","data_id":"0","data":"<h2>\u00a0<\/h2>\n<p>In this study, photographs were acquired two times by using a digital camera at each field site, in order to avoid out of focus. The photograph with higher quality will be selected, so that the photograph could be used to get the reference fraction accurately. Information on the ground cover composition of each of the measured mixed pixels was extracted from the digital photographs (positioned at nadir) so that the ground cover fraction distribution could be determined. Two cross rulers were used to mark the FOV while the digital image sensor was used to obtain RGB (red, green, and blue) photographs. According to the training samples for supervised classification, neural network classification (NNC) was applied to classify the digital photos with ENVI 5.3 software[26], and this yielded the 3-EM classes\u00a0and 4-EM classes . The classification results were validated through visual interpretations. The observed endmember cover would not contribute equally to the ASD probe due to the point spread function (PSF) of the ASD sensor. Hence, it was necessary to calibrate the fractional cover.<\/p>\n<p>The PSF is the Gaussian function, , where <em>d <\/em>is the distance from a pixel center (the unit is in meters) and \u03c3 illustrates the instantaneous FOV (IFOV) of a detector, which means that measurements closer to the center of the FOV will contribute more to the mixed reflectance signal, and thus, more weight should be given to the objects in the center. Each binary classified image was convolved with a Gaussian filter (i.e., <em>PSF<\/em> of the ASD sensor) to compute weighted averages of the image. Endmember reference fractions could as such be expressed as a function of their actual contribution to the mixed pixel reflectance. Here, all the actual ground cover fractions were corrected to correspond to the PSF of the ASD sensor. In summary, all the classification images were convolved with a Gaussian filter, and then, the weighted average adjusted fractions of two photographs were taken as the reference fraction for the different endmembers in a plot.<\/p>","order_id":"0","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<h2>\u00a0<\/h2>\n<p>In this study, photographs were acquired two times by using a digital camera at each field site, in order to avoid out of focus. The photograph with higher quality will be selected, so that the photograph could be used to get the reference fraction accurately. Information on the ground cover composition of each of the measured mixed pixels was extracted from the digital photographs (positioned at nadir) so that the ground cover fraction distribution could be determined. Two cross rulers were used to mark the FOV while the digital image sensor was used to obtain RGB (red, green, and blue) photographs. According to the training samples for supervised classification, neural network classification (NNC) was applied to classify the digital photos with ENVI 5.3 software[26], and this yielded the 3-EM classes\u00a0and 4-EM classes . The classification results were validated through visual interpretations. The observed endmember cover would not contribute equally to the ASD probe due to the point spread function (PSF) of the ASD sensor. Hence, it was necessary to calibrate the fractional cover.<\/p>\n<p>The PSF is the Gaussian function, , where <em>d <\/em>is the distance from a pixel center (the unit is in meters) and \u03c3 illustrates the instantaneous FOV (IFOV) of a detector, which means that measurements closer to the center of the FOV will contribute more to the mixed reflectance signal, and thus, more weight should be given to the objects in the center. Each binary classified image was convolved with a Gaussian filter (i.e., <em>PSF<\/em> of the ASD sensor) to compute weighted averages of the image. Endmember reference fractions could as such be expressed as a function of their actual contribution to the mixed pixel reflectance. Here, all the actual ground cover fractions were corrected to correspond to the PSF of the ASD sensor. In summary, all the classification images were convolved with a Gaussian filter, and then, the weighted average adjusted fractions of two photographs were taken as the reference fraction for the different endmembers in a plot.<\/p>"},"is_project":0},{"component_id":"919505","previous_id":"919504","original_id":"0","guid":"1086DB6E5BEC49ADA6F7ADAAC8389322","previous_guid":"7F78FDA0E2DA42DC886A350D6414C45D","component_type_id":"6","data_id":"0","data":"Reference Fraction","order_id":"1","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Reference Fraction"},"is_project":0}]},{"id":"556909","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"E8D9DEFA49BB4A9481BB980E24879CE4","previous_guid":"468E43B7CE654132B4EACF588AA07328","previous_id":"556907","last_modified":"1496569995","components":[{"component_id":"919506","previous_id":0,"original_id":"0","guid":"3CB1254E397741E4ABE6D73E94C0CFA2","previous_guid":null,"component_type_id":"1","data_id":"0","data":"<h2>We have constructed the Linear Spectral Mixture Model based on the principles of linear mixtures.the endmember fraction estimates are obtained by the fully constrained least squares (FCLS).<\/h2>\n<p>\u00a0<\/p>\n<h2>\u00a0<\/h2>","order_id":"0","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<h2>We have constructed the Linear Spectral Mixture Model based on the principles of linear mixtures.the endmember fraction estimates are obtained by the fully constrained least squares (FCLS).<\/h2>\n<p>\u00a0<\/p>\n<h2>\u00a0<\/h2>"},"is_project":0},{"component_id":"919507","previous_id":"919506","original_id":"0","guid":"6614B5F38A4E4DA3A143CFF4FED0A874","previous_guid":"3CB1254E397741E4ABE6D73E94C0CFA2","component_type_id":"6","data_id":"0","data":"Linear Spectral Mixture Model","order_id":"1","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Linear Spectral Mixture Model"},"is_project":0}]},{"id":"556911","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"ACC9AD774E92492EB032DA75DF4D3F6B","previous_guid":"E7A38039B43B433DB292AFF3F878DB2C","previous_id":"556908","last_modified":"1496569995","components":[{"component_id":"919510","previous_id":0,"original_id":"0","guid":"65D7C143A2B04A2A8B457BC06DE160A6","previous_guid":null,"component_type_id":"1","data_id":"0","data":"<p>this study proposes the use of a bilinear spectral mixture model (BSMM). Each term accounts for multiple interactions between endmembers and is represented by the cross-product of the interacting endmembers. BSMMs consider multi-order interactions between endmembers j and t (for j,t=1,\u2026,m). The FCLS algorithm is employed to unmixing fj,t and fj. Part of the interaction fraction fj,t should be assigned to each of the contributing physical entities.\u00a0<\/p>","order_id":"0","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>this study proposes the use of a bilinear spectral mixture model (BSMM). Each term accounts for multiple interactions between endmembers and is represented by the cross-product of the interacting endmembers. BSMMs consider multi-order interactions between endmembers j and t (for j,t=1,\u2026,m). The FCLS algorithm is employed to unmixing fj,t and fj. Part of the interaction fraction fj,t should be assigned to each of the contributing physical entities.\u00a0<\/p>"},"is_project":0},{"component_id":"919511","previous_id":"919510","original_id":"0","guid":"18CB167291F544F4808E58B416795F04","previous_guid":"65D7C143A2B04A2A8B457BC06DE160A6","component_type_id":"6","data_id":"0","data":"Bilinear spectral mixture model","order_id":"1","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Bilinear spectral mixture model"},"is_project":0}]},{"id":"556912","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"361728D249CC49C7BFB9653863C0C401","previous_guid":"ACC9AD774E92492EB032DA75DF4D3F6B","previous_id":"556911","last_modified":"1496569441","components":[{"component_id":"919512","previous_id":0,"original_id":"0","guid":"F17B62E9A671478FA31B1226AFB9B5AB","previous_guid":null,"component_type_id":"1","data_id":"0","data":"<p>We\u00a0used two common kernel functions, namely, the radial basis function (RBF) kernel and the polynomial kernel function (PKF).\u00a0<\/p>","order_id":"0","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>We\u00a0used two common kernel functions, namely, the radial basis function (RBF) kernel and the polynomial kernel function (PKF).\u00a0<\/p>"},"is_project":0},{"component_id":"919513","previous_id":"919512","original_id":"0","guid":"166114A781674B8EB346C8D604015D53","previous_guid":"F17B62E9A671478FA31B1226AFB9B5AB","component_type_id":"6","data_id":"0","data":"Kernel Nonlinear Spectral Mixture Model","order_id":"1","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Kernel Nonlinear Spectral Mixture Model"},"is_project":0}]},{"id":"556913","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"745069D172EF4EF8B36E14A11A076842","previous_guid":"361728D249CC49C7BFB9653863C0C401","previous_id":"556912","last_modified":"1496569509","components":[{"component_id":"919514","previous_id":0,"original_id":"0","guid":"E35CCE8A0B1F4CBF9BB779D3BE3D3DF2","previous_guid":null,"component_type_id":"1","data_id":"0","data":"<p>\u00a0 \u00a0 \u00a0The optimal parameters in the RBF and PKF are determined by the minimum model unmixing RMSE.The parameter \u03c3 in the RBF is determined by the gradient descent method,and the parameters of PKF are determined by the Cross validation ,which means that the fitting process\u00a0optimizes\u00a0the model parameters to make the model fit the input data as well as possible.\u00a0<\/p>","order_id":"0","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>\u00a0 \u00a0 \u00a0The optimal parameters in the RBF and PKF are determined by the minimum model unmixing RMSE.The parameter \u03c3 in the RBF is determined by the gradient descent method,and the parameters of PKF are determined by the Cross validation ,which means that the fitting process\u00a0optimizes\u00a0the model parameters to make the model fit the input data as well as possible.\u00a0<\/p>"},"is_project":0},{"component_id":"919515","previous_id":"919514","original_id":"0","guid":"B2CD6AF3DB6F47FB9FD4F01219B62439","previous_guid":"E35CCE8A0B1F4CBF9BB779D3BE3D3DF2","component_type_id":"6","data_id":"0","data":"Parameters of kernel function","order_id":"1","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Parameters of kernel function"},"is_project":0}]},{"id":"556914","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"A28ACEA9B4D04F609758294978315004","previous_guid":"745069D172EF4EF8B36E14A11A076842","previous_id":"556913","last_modified":"1496569613","components":[{"component_id":"919516","previous_id":0,"original_id":"0","guid":"0A42B562E0D5404590A43C47758C0F75","previous_guid":null,"component_type_id":"1","data_id":"0","data":"<p>The KFCLS aims to find the abundance vectors via the objective function.\u00a0A detailed step-by-step implementation of KFCLS is available..<\/p>","order_id":"0","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>The KFCLS aims to find the abundance vectors via the objective function.\u00a0A detailed step-by-step implementation of KFCLS is available..<\/p>"},"is_project":0},{"component_id":"919517","previous_id":"919516","original_id":"0","guid":"32A3C4E27B734E5DA991750E10CA91AD","previous_guid":"0A42B562E0D5404590A43C47758C0F75","component_type_id":"6","data_id":"0","data":"Kernel Nonlinear Spectral Mixture Model unmixing","order_id":"1","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Kernel Nonlinear Spectral Mixture Model unmixing"},"is_project":0}]},{"id":"556915","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"510C3FDD0301474C8F79F42878473497","previous_guid":"F21C4909530D44CBA1B403312C0D225F","previous_id":"557020","last_modified":"1496570071","components":[{"component_id":"919518","previous_id":0,"original_id":"0","guid":"4B8833DCBD104A5AA8B72F8A05800369","previous_guid":null,"component_type_id":"1","data_id":"0","data":"<p>pro BSMM_unmixing_414<br \/> COMPILE_OPT idl2<br \/> envi, \/restore_base_save_files<\/p>\n<p><br \/> ;\uff1b********************************************************************************************************************************<br \/> ;\uff1b********************************************************************************************************************************<br \/> emMixNB=1;3EM:from 0to5 (0\u8868\u793a\u7ebf\u6027\u7684\uff1b1 \u8868\u793a\u6709\u4e00\u7ec4\u7aef\u5143\u6df7\u5408\uff1b 2 \u6709 2\u7ec4\u7aef\u5143\u8fed\u4ee3\uff1b3 \u67093\u7ec4\u7aef\u5143\u8fed\u4ee3 \uff1b4 \u67094\u7ec4\u7aef\u5143\u8fed\u4ee3 \uff1b5 \u6709\u4e94\u7ec4\u7aef\u5143\u6df7\u5408)<br \/> ;4EM:from 0to8(0\u8868\u793a\u7ebf\u6027\u7684\uff1b1 \u8868\u793a\u6709\u4e00\u7ec4\u7aef\u5143\u6df7\u5408\uff1b 2 \u6709 2\u7ec4\u7aef\u5143\u8fed\u4ee3\uff1b3 \u67093\u7ec4\u7aef\u5143\u8fed\u4ee3 \uff1b4 \u67094\u7ec4\u7aef\u5143\u8fed\u4ee3 \uff1b5 \u6709\u4e94\u7ec4\u7aef\u5143\u6df7\u5408 ..........8 \u6709\u4e94\u7ec4\u7aef\u5143\u6df7\u5408)<br \/> em_num=4; 3\u8868\u793a3\u7aef\u5143\u6a21\u578b\uff1b4\u8868\u793a4\u7aef\u5143\u6a21\u578b<br \/> ; kernel=0<br \/> fcls_method=2 ; 1:jinying's ;NCLS Reference:\"Fully Constrained Least Squares Linear Spectral Mixture Analysis Method for Material Quantification in Hyperspectral Imagery\"<br \/> ;2:jicc's NCLS Reference:\"Constrained Subpixel Target Detection for Remotely Sensed Imagery\"<br \/> <br \/>; m_num=10 ;\u9700\u8981\u4fee\u6539 ,\u8bf7\u8f93\u5165method\u65b9\u6cd5\u7ec4\u5408\u6570\u76ee<br \/>; em_num=3 ;\u8bf7\u8f93\u5165\u7eaf\u7aef\u5143\u6570\u76ee<br \/>; mixem_num=5 ;\u975e\u7ebf\u6027\u7eaf\u7aef\u5143+\u6df7\u5408\u7aef\u5143\u6570\u76ee<br \/>; band_num=1653 ;\u8bf7\u8f93\u5165\u6ce2\u6bb5\u6570\u76ee<br \/>; sample_num=20<br \/> ;\uff1b********************************************************************************************************************************<br \/> ;\uff1b********************************************************************************************************************************<\/p>\n<p>;\u5f00\u59cb\u8bbe\u7f6e\u8def\u5f84\uff0c\u8bfb\u53d6txt(n\u5217\uff0cn\u884c)<br \/> txtname2='D:\\hyperion_paper\\data_idl\\ss_data\\SS_pixcel.txt' ;\u8f93\u5165\u6df7\u5408\u50cf\u5143\u53cd\u5c04\u7387,\u5168\u90e8\u6837\u672c\u6df7\u5408\u7aef\u5143\u6570\u636e\uff0c\u591a\u5c11\u6837\u672c\u591a\u5c11\u5217\uff0c\u4f8b\u5982\u767d\u523a\u4e3a20\u5217<br \/> <br \/> if file_test(txtname2)then begin<br \/> nLines2=file_lines(txtname2) ;\u83b7\u53d6\u884c<br \/> tmp2=''<br \/> ; \u6253\u5f00\u6587\u4ef6<br \/> openr,lun2,txtname2,\/get_lun<br \/> while(~EOF(lun2))do begin<br \/> readf,lun2,tmp2 ;\u83b7\u53d6\u7b2c\u4e00\u884c<br \/> ;print,tmp2<br \/> ;help,tmp2<br \/> var2=strsplit(tmp2,\/extract) ;\u62c6\u5206\u7b2c\u4e00\u884c\u83b7\u53d6\u5217\u6570<br \/> rowNum=N_elements(var2)<br \/> vararr2=fltarr(rowNum,nLines2-1) ;\u5b9a\u4e49\u6570\u7ec4(n\uff0cn-1)<br \/> readf,lun2,vararr2<br \/> vararr2=[[var2],[vararr2]] ;\u91cd\u65b0\u7ec4\u5408\u6570\u7ec4(n\uff0cn-1)+\u7b2c\u4e00\u884c=\uff08n,n\uff09 over!<br \/> band_num=N_elements(vararr2[0,*])<br \/> pixels_group=reform(TRANSPOSE(vararr2),band_num,rowNum)<br \/>; pixels=reform(TRANSPOSE(vararr2),band_num,1) \uff1b\u53ea\u6709\u4e00\u4e2a\u6837\u672c\u65f6\u91c7\u7528<br \/> endwhile<br \/> endif<br \/> txtname1='D:\\hyperion_paper\\data_idl\\ss_data\\4EM_SS_EM_2.txt' ;\u8f93\u5165\u6570\u636e\u4e3aPV,SOIL,NPV......\u53cd\u5c04\u7387\uff0c\u6839\u636e\uff08\u7aef\u5143\u6570\u91cf*\u6837\u672c\u6570\u91cf\uff09\u51b3\u5b9a\u591a\u5c11\u5217 <br \/> ;ss\u987a\u5e8f\u4e3aPV npv BS shadow<br \/> if file_test(txtname1)then begin<br \/> nLines1=file_lines(txtname1) ;\u83b7\u53d6\u884c<br \/> tmp1=''<br \/> ; \u6253\u5f00\u6587\u4ef6<br \/> openr,lun,txtname1,\/get_lun<br \/> while(~EOF(lun))do begin<br \/> readf,lun,tmp1 ;\u83b7\u53d6\u7b2c\u4e00\u884c<br \/> ;print,tmp1<br \/> ;help,tmp<br \/> var1=strsplit(tmp1,\/extract) ;\u62c6\u5206\u7b2c\u4e00\u884c\u83b7\u53d6\u5217\u6570<br \/> rowNum1=N_elements(var1)<br \/> vararr1=fltarr(rowNum1,nLines1-1) ;\u5b9a\u4e49\u6570\u7ec4(n\uff0cn-1)<br \/> readf,lun,vararr1<br \/> vararr1=[[var1],[vararr1]] ;\u91cd\u65b0\u7ec4\u5408\u6570\u7ec4(n\uff0cn-1)+\u7b2c\u4e00\u884c=\uff08n,n\uff09 over!<br \/> endwhile<br \/> endif<br \/>; em_num=N_elements(vararr1[*,0])<br \/> <br \/>; txtname4='D:\\hyperion_paper\\data_idl\\bc_data\\RMSE_PERCENT\\ttttttttt.txt'<br \/>txtname4='D:\\hyperion_paper\\data_idl\\bc_data\\\u9065\u611f\u5b66\u62a5\\bc_4em_bsmm.txt'<br \/>openw,lun4,txtname4,\/get_lun,\/append ;\/append\u8fde\u7eed\u5199\u5165\u51fd\u6570<br \/>printf,lun4,'PV NPV BS (SHADOW) model_RMSE model_rmse(%)' <br \/>printf,lun4,em_num,'EM','+',emMixNB<\/p>\n<p>;print fraction continue to check the accuracy of fraction<br \/>txtname5='D:\\hyperion_paper\\data_idl\\ss_data\\ss_1020_gauss\\mix_pixel\\ss_4em_bsmm_pix.txt'<br \/>openw,lun5,txtname5,\/get_lun,\/append ;\/append\u8fde\u7eed\u5199\u5165\u51fd\u6570<\/p>\n<p>case em_num of<br \/> 3:begin<br \/> case emMixNB of<br \/> 0:m_num=1<br \/> 1:m_num=5<br \/> 2:m_num=10<br \/> 3:m_num=10<br \/> 4:m_num=5<br \/> 5:m_num=1<br \/> endcase<br \/> end<br \/> 4:begin<br \/> case emMixNB of<br \/> 0:m_num=1<br \/> 1:m_num=8<br \/> 2:m_num=28<br \/> 3:m_num=56<br \/> 4:m_num=70<br \/> 5:m_num=56 <br \/> 6:m_num=28<br \/> 7:m_num=8<br \/> 8:m_num=1<br \/> endcase<br \/> end<br \/> endcase<\/p>\n<p>result_group=fltarr(em_num+2,m_num,rowNum)<br \/> g=0<\/p>\n<p><br \/> <br \/> ;\u4e00\u7ec4\u7ec4\u7684\u8bfb\u53d6\u6837\u672c\u6570\u636e\uff0c\u4e00\u4e2a\u5faa\u73af\u4e3a\u4e00\u4e2a\u6837\u672c\u6570\u636e<br \/> for sm=0,rowNum-1 do begin <br \/> <br \/>;openw,lun4,txtname4,\/get_lun,\/append ;\/append\u8fde\u7eed\u5199\u5165\u51fd\u6570<br \/> case em_num of <br \/> 3:begin<br \/> ;3EM<br \/> pixels=reform((TRANSPOSE(pixels_group))[sm,*],band_num,1)<br \/> <br \/> pv1=vararr1[sm*em_num+0,*] ;\u83b7\u53d6\u7b2c\u4e00\u5217<br \/> bs1=vararr1[sm*em_num+1,*] ;\u83b7\u53d6\u7b2c\u4e8c\u5217<br \/> npv1=vararr1[sm*em_num+2,*]<br \/> pvpv=TRANSPOSE(vararr1[sm*em_num+0,*]*vararr1[sm*em_num+0,*])<br \/> npvnpv=TRANSPOSE(vararr1[sm*em_num+2,*]*vararr1[sm*em_num+2,*])<br \/> pvbs=TRANSPOSE(vararr1[sm*em_num+0,*]*vararr1[sm*em_num+1,*])<br \/> pvnpv=TRANSPOSE(vararr1[sm*em_num+0,*]*vararr1[sm*em_num+2,*])<br \/> bsnpv=TRANSPOSE(vararr1[sm*em_num+1,*]*vararr1[sm*em_num+2,*])<\/p>\n<p>;\uff1b******************************************************************************************************<br \/> case emMixNB of<br \/> 0:begin<br \/> ;3EM+0 1\u7ec4<br \/> m_num=1<br \/> ;mixem_num=3<br \/> em=transpose([pv1,bs1,npv1])<br \/>;printf,lun4,'3em+0'<br \/> end<br \/> 1:begin<br \/> ;3em+1em 5\u7ec4<br \/> m_num=5<br \/> ; mixem_num=4<\/p>\n<p>vararr71=[[transpose([pv1,bs1,npv1])],[pvpv]]<br \/> vararr72=[[transpose([pv1,bs1,npv1])],[npvnpv]]<br \/> vararr73=[[transpose([pv1,bs1,npv1])],[pvbs]]<br \/> vararr74=[[transpose([pv1,bs1,npv1])],[pvnpv]]<br \/> vararr75=[[transpose([pv1,bs1,npv1])],[bsnpv]]<br \/> em=[[vararr71],[vararr72],[vararr73],[vararr74],[vararr75]]<br \/>;printf,lun4,'3em+1' <br \/> end<br \/> ;\uff1b******************************************************************************************************<br \/> 2:begin<br \/> m_num=10<br \/> ; mixem_num=5<br \/> ;3em+2em 10\u7ec4<br \/> vararr71=[[transpose([pv1,bs1,npv1])],[pvpv],[npvnpv]]<br \/> vararr72=[[transpose([pv1,bs1,npv1])],[pvpv],[bsnpv]]<br \/> vararr73=[[transpose([pv1,bs1,npv1])],[pvpv],[pvbs]]<br \/> vararr74=[[transpose([pv1,bs1,npv1])],[pvpv],[pvnpv]]<br \/> vararr75=[[transpose([pv1,bs1,npv1])],[pvnpv],[bsnpv]]<br \/> vararr76=[[transpose([pv1,bs1,npv1])],[pvnpv],[pvbs]]<br \/> vararr77=[[transpose([pv1,bs1,npv1])],[bsnpv],[pvbs]]<br \/> vararr78=[[transpose([pv1,bs1,npv1])],[npvnpv],[pvnpv]]<br \/> vararr79=[[transpose([pv1,bs1,npv1])],[npvnpv],[bsnpv]]<br \/> vararr710=[[transpose([pv1,bs1,npv1])],[npvnpv],[pvbs]]<br \/> em=[[vararr71],[vararr72],[vararr73],[vararr74],[vararr75],[vararr76],[vararr77],[vararr78],[vararr79],[vararr710]]<br \/>;printf,lun4,'3em+2'<br \/> end<br \/> ;************************************************************************************************************************<br \/> ;3em+3em 10\u7ec4<br \/> 3:begin<br \/> m_num=10<br \/> ; mixem_num=6<br \/> vararr71=[[transpose([pv1,bs1,npv1])],[pvpv],[npvnpv],[pvnpv]]<br \/> vararr72=[[transpose([pv1,bs1,npv1])],[pvpv],[npvnpv],[bsnpv]]<br \/> vararr73=[[transpose([pv1,bs1,npv1])],[pvpv],[npvnpv],[pvbs]]<br \/> vararr74=[[transpose([pv1,bs1,npv1])],[pvpv],[pvnpv],[bsnpv]]<br \/> vararr75=[[transpose([pv1,bs1,npv1])],[pvpv],[pvnpv],[pvbs]]<br \/> vararr76=[[transpose([pv1,bs1,npv1])],[pvpv],[bsnpv],[pvbs]]<br \/> vararr77=[[transpose([pv1,bs1,npv1])],[npvnpv],[pvnpv],[bsnpv]]<br \/> vararr78=[[transpose([pv1,bs1,npv1])],[npvnpv],[pvnpv],[pvbs]]<br \/> vararr79=[[transpose([pv1,bs1,npv1])],[npvnpv],[bsnpv],[pvbs]]<br \/> vararr710=[[transpose([pv1,bs1,npv1])],[pvnpv],[bsnpv],[pvbs]]<br \/> em=[[vararr71],[vararr72],[vararr73],[vararr74],[vararr75],[vararr76],[vararr77],[vararr78],[vararr79],[vararr710]]<br \/>;printf,lun4,'3em+3'<br \/> end<br \/> ;************************************************************************************************************************<br \/> ;3em+4em 5\u7ec4<br \/> 4:begin<br \/> m_num=5<br \/> ; mixem_num=7<br \/> vararr71=[[transpose([pv1,bs1,npv1])],[pvpv],[npvnpv],[pvnpv],[bsnpv]]<br \/> vararr72=[[transpose([pv1,bs1,npv1])],[pvpv],[npvnpv],[pvnpv],[pvbs]]<br \/> vararr73=[[transpose([pv1,bs1,npv1])],[pvpv],[npvnpv],[bsnpv],[pvbs]]<br \/> vararr74=[[transpose([pv1,bs1,npv1])],[pvpv],[pvnpv],[bsnpv],[pvbs]]<br \/> vararr75=[[transpose([pv1,bs1,npv1])],[npvnpv],[pvnpv],[bsnpv],[pvbs]]<br \/> em=[[vararr71],[vararr72],[vararr73],[vararr74],[vararr75]]<br \/>;printf,lun4,'3em+4'<br \/> end<br \/> ;******************************************************************************************************************************************************<br \/> 5:begin<br \/> ;3em+5em 1\u7ec4<br \/> m_num=1<br \/> ; mixem_num=8<br \/> vararr71=[[transpose([pv1,bs1,npv1])],[pvpv],[npvnpv],[pvnpv],[bsnpv],[pvbs]] ;3\u7aef\u5143<br \/> em=[vararr71]<br \/>;printf,lun4,'3em+5'<br \/> end<br \/> ;******************************************************************************************************************************************************<br \/> endcase <br \/> <br \/> end<br \/> 4:begin<br \/> ;4EM<br \/>; pixels=TRANSPOSE((TRANSPOSE(pixels_group))[sm,*])<br \/> pixels=reform((TRANSPOSE(pixels_group))[sm,*],band_num,1)<br \/> pv1=vararr1[sm*em_num+0,*] ;\u83b7\u53d6\u7b2c\u4e00\u5217<br \/> bs1=vararr1[sm*em_num+1,*] ;\u83b7\u53d6\u7b2c\u4e8c\u5217<br \/> npv1=vararr1[sm*em_num+2,*]<br \/> shadow1=vararr1[sm*em_num+3,*]<br \/> pp=TRANSPOSE(vararr1[sm*em_num+0,*]*vararr1[sm*em_num+0,*])<br \/> nn=TRANSPOSE(vararr1[sm*em_num+2,*]*vararr1[sm*em_num+2,*])<br \/> pb=TRANSPOSE(vararr1[sm*em_num+0,*]*vararr1[sm*em_num+1,*])<br \/> pn=TRANSPOSE(vararr1[sm*em_num+0,*]*vararr1[sm*em_num+2,*])<br \/> ps=TRANSPOSE(vararr1[sm*em_num+0,*]*vararr1[sm*em_num+3,*])<br \/> bn=TRANSPOSE(vararr1[sm*em_num+1,*]*vararr1[sm*em_num+2,*])<br \/> bs=TRANSPOSE(vararr1[sm*em_num+1,*]*vararr1[sm*em_num+3,*])<br \/> ns=TRANSPOSE(vararr1[sm*em_num+2,*]*vararr1[sm*em_num+3,*])<\/p>\n<p><br \/> ; 4EM<br \/> case emMixNB of<\/p>\n<p>0:begin<br \/> m_num=1<br \/> em=transpose([pv1,bs1,npv1,shadow1])<br \/>;printf,lun4,'4em+0'<br \/> END<br \/> ; 4+1EM<br \/> 1:begin<br \/> m_num=8<br \/> vararr71=[[transpose([pv1,bs1,npv1,shadow1])],[pp]]<br \/> vararr72=[[transpose([pv1,bs1,npv1,shadow1])],[nn]]<br \/> vararr73=[[transpose([pv1,bs1,npv1,shadow1])],[pb]]<br \/> vararr74=[[transpose([pv1,bs1,npv1,shadow1])],[pn]]<br \/> vararr75=[[transpose([pv1,bs1,npv1,shadow1])],[ps]]<br \/> vararr76=[[transpose([pv1,bs1,npv1,shadow1])],[bn]]<br \/> vararr77=[[transpose([pv1,bs1,npv1,shadow1])],[bs]]<br \/> vararr78=[[transpose([pv1,bs1,npv1,shadow1])],[ns]]<br \/> em=[[vararr71],[vararr72],[vararr73],[vararr74],[vararr75],[vararr76],[vararr77],[vararr78]]<br \/>;printf,lun4,'4em+1'<br \/> END<br \/> ; 4+2EM<br \/> 2:begin<br \/> m_num=28<br \/> vararr71=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn]]<br \/> vararr72=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb]]<br \/> vararr73=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn]]<br \/> vararr74=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[ps]]<br \/> vararr75=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[bn]]<br \/> vararr76=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[bs]]<br \/> vararr77=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[ns]]<br \/> vararr78=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb]]<br \/> vararr79=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn]]<br \/> vararr80=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[ps]]<br \/> vararr81=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[bn]]<br \/> vararr82=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[bs]]<br \/> vararr83=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[ns]]<br \/> vararr84=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn]]<br \/> vararr85=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[ps]]<br \/> vararr86=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[bn]]<br \/> vararr87=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[bs]]<br \/> vararr88=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[ns]]<br \/> vararr89=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[ps]]<br \/> vararr90=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[bn]]<br \/> vararr91=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[bs]]<br \/> vararr92=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[ns]]<br \/> vararr93=[[transpose([pv1,bs1,npv1,shadow1])],[ps],[bn]]<br \/> vararr94=[[transpose([pv1,bs1,npv1,shadow1])],[ps],[bs]]<br \/> vararr95=[[transpose([pv1,bs1,npv1,shadow1])],[ps],[ns]]<br \/> vararr96=[[transpose([pv1,bs1,npv1,shadow1])],[bn],[bs]]<br \/> vararr97=[[transpose([pv1,bs1,npv1,shadow1])],[bn],[ns]]<br \/> vararr98=[[transpose([pv1,bs1,npv1,shadow1])],[bs],[ns]]<br \/> em=[[vararr71],[vararr72],[vararr73],[vararr74],[vararr75],[vararr76],[vararr77],[vararr78],[vararr79],[vararr80],$<br \/> [vararr81],[vararr82],[vararr83],[vararr84],[vararr85],[vararr86],[vararr87],[vararr88],[vararr89],[vararr90],$<br \/> [vararr91],[vararr92],[vararr93],[vararr94],[vararr95],[vararr96],[vararr97],[vararr98]]<br \/>;printf,lun4,'4em+2'<br \/> END<br \/> ; 4+3EM<br \/> 3:begin<br \/> m_num=56<br \/> vararr21=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb]]<br \/> vararr22=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn]]<br \/> vararr23=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[ps]]<br \/> vararr24=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[bn]]<br \/> vararr25=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[bs]]<br \/> vararr26=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[ns]]<br \/> vararr27=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn]]<br \/> vararr28=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[ps]]<br \/> vararr29=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[bn]]<br \/> vararr30=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[bs]]<br \/> vararr31=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[ns]]<br \/> vararr32=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[ps]]<br \/> vararr33=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[bn]]<br \/> vararr34=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[bs]]<br \/> vararr35=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[ns]]<br \/> vararr36=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[ps],[bn]]<br \/> vararr37=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[ps],[bs]]<br \/> vararr38=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[ps],[ns]]<br \/> vararr39=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[bn],[bs]]<br \/> vararr40=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[bn],[ns]]<br \/> vararr41=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[bs],[ns]]<br \/> vararr42=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn]]<br \/> vararr43=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[ps]]<br \/> vararr44=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[bn]]<br \/> vararr45=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[bs]]<br \/> vararr46=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[ns]]<br \/> vararr47=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[ps]]<br \/> vararr48=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[bn]]<br \/> vararr49=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[bs]]<br \/> vararr50=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[ns]]<br \/> vararr51=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[ps],[bn]]<br \/> vararr52=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[ps],[bs]]<br \/> vararr53=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[ps],[ns]]<br \/> vararr54=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[bn],[bs]]<br \/> vararr55=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[bn],[ns]]<br \/> vararr56=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[bs],[ns]]<br \/> vararr57=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[ps]]<br \/> vararr58=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[bn]]<br \/> vararr59=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[bs]]<br \/> vararr60=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[ns]]<br \/> vararr61=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[ps],[bn]]<br \/> vararr62=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[ps],[bs]]<br \/> vararr63=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[ps],[ns]]<br \/> vararr64=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[bn],[bs]]<br \/> vararr65=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[bn],[ns]]<br \/> vararr66=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[bs],[ns]]<br \/> vararr67=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[ps],[bn]]<br \/> vararr68=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[ps],[bs]]<br \/> vararr69=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[ps],[ns]]<br \/> vararr70=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[bn],[bs]]<br \/> vararr71=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[bn],[ns]]<br \/> vararr72=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[bs],[ns]]<br \/> vararr73=[[transpose([pv1,bs1,npv1,shadow1])],[ps],[bn],[bs]]<br \/> vararr74=[[transpose([pv1,bs1,npv1,shadow1])],[ps],[bn],[ns]]<br \/> vararr75=[[transpose([pv1,bs1,npv1,shadow1])],[ps],[bs],[ns]]<br \/> vararr76=[[transpose([pv1,bs1,npv1,shadow1])],[bn],[bs],[ns]]<br \/> em=[[vararr21],[vararr22],[vararr23],[vararr24],[vararr25],[vararr26],[vararr27],[vararr28],[vararr29],[vararr30],$<br \/> [vararr31],[vararr32],[vararr33],[vararr34],[vararr35],[vararr36],[vararr37],[vararr38],[vararr39],[vararr40],$<br \/> [vararr41],[vararr42],[vararr43],[vararr44],[vararr45],[vararr46],[vararr47],[vararr48],[vararr49],[vararr50],$<br \/> [vararr51],[vararr52],[vararr53],[vararr54],[vararr55],[vararr56],[vararr57],[vararr58],[vararr59],[vararr60],$<br \/> [vararr61],[vararr62],[vararr63],[vararr64],[vararr65],[vararr66],[vararr67],[vararr68],[vararr69],[vararr70],$<br \/> [vararr71],[vararr72],[vararr73],[vararr74],[vararr75],[vararr76]]<br \/>;printf,lun4,'4em+3'<br \/> END<br \/> ;4+4EM<br \/> 4:begin<br \/> m_num=70<br \/> vararr21=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn]]<br \/> vararr22=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[ps]]<br \/> vararr23=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[bn]]<br \/> vararr24=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[bs]]<br \/> vararr25=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[ns]]<br \/> vararr26=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[ps]]<br \/> vararr27=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[bn]]<br \/> vararr28=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[bs]]<br \/> vararr29=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[ns]]<br \/> vararr30=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[ps],[bn]]<br \/> vararr31=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[ps],[bs]]<br \/> vararr32=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[ps],[ns]]<br \/> vararr33=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[bn],[bs]]<br \/> vararr34=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[bn],[ns]]<br \/> vararr35=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[bs],[ns]]<br \/> vararr36=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[ps]]<br \/> vararr37=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[bn]]<br \/> vararr38=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[bs]]<br \/> vararr39=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[ns]]<br \/> vararr40=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[ps],[bn]]<br \/> vararr41=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[ps],[bs]]<br \/> vararr42=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[ps],[ns]]<br \/> vararr43=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[bn],[bs]]<br \/> vararr44=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[bn],[ns]]<br \/> vararr45=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[bs],[ns]]<br \/> vararr46=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[ps],[bn]]<br \/> vararr47=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[ps],[bs]]<br \/> vararr48=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[ps],[ns]]<br \/> vararr49=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[bn],[bs]]<br \/> vararr50=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[bn],[ns]]<br \/> vararr51=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[bs],[ns]]<br \/> vararr52=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[ps],[bn],[bs]]<br \/> vararr53=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[ps],[bn],[ns]]<br \/> vararr54=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[ps],[bs],[ns]]<br \/> vararr55=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[bn],[bs],[ns]]<br \/> vararr56=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[ps]]<br \/> vararr57=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[bn]]<br \/> vararr58=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[bs]]<br \/> vararr59=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[ns]]<br \/> vararr60=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[ps],[bn]]<br \/> vararr61=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[ps],[bs]]<br \/> vararr62=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[ps],[ns]]<br \/> vararr63=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[bn],[bs]]<br \/> vararr64=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[bn],[ns]]<br \/> vararr65=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[bs],[ns]]<br \/> vararr66=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[ps],[bn]]<br \/> vararr67=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[ps],[bs]]<br \/> vararr68=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[ps],[ns]]<br \/> vararr69=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[bn],[bs]]<br \/> vararr70=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[bn],[ns]]<br \/> vararr71=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[bs],[ns]]<br \/> vararr72=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[ps],[bn],[bs]]<br \/> vararr73=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[ps],[bn],[ns]]<br \/> vararr74=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[ps],[bs],[ns]]<br \/> vararr75=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[bn],[bs],[ns]]<br \/> vararr76=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[ps],[bn]]<br \/> vararr77=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[ps],[bs]]<br \/> vararr78=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[ps],[ns]]<br \/> vararr79=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[bn],[bs]]<br \/> vararr80=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[bn],[ns]]<br \/> vararr81=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[bs],[ns]]<br \/> vararr82=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[ps],[bn],[bs]]<br \/> vararr83=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[ps],[bn],[ns]]<br \/> vararr84=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[ps],[bs],[ns]]<br \/> vararr85=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[bn],[bs],[ns]]<br \/> vararr86=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[ps],[bn],[bs]]<br \/> vararr87=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[ps],[bn],[ns]]<br \/> vararr88=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[ps],[bs],[ns]]<br \/> vararr89=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[bn],[bs],[ns]]<br \/> vararr90=[[transpose([pv1,bs1,npv1,shadow1])],[ps],[bn],[bs],[ns]]<br \/> em=[[vararr21],[vararr22],[vararr23],[vararr24],[vararr25],[vararr26],[vararr27],[vararr28],[vararr29],[vararr30],$<br \/> [vararr31],[vararr32],[vararr33],[vararr34],[vararr35],[vararr36],[vararr37],[vararr38],[vararr39],[vararr40],$<br \/> [vararr41],[vararr42],[vararr43],[vararr44],[vararr45],[vararr46],[vararr47],[vararr48],[vararr49],[vararr50],$<br \/> [vararr51],[vararr52],[vararr53],[vararr54],[vararr55],[vararr56],[vararr57],[vararr58],[vararr59],[vararr60],$<br \/> [vararr61],[vararr62],[vararr63],[vararr64],[vararr65],[vararr66],[vararr67],[vararr68],[vararr69],[vararr70],$<br \/> [vararr71],[vararr72],[vararr73],[vararr74],[vararr75],[vararr76],[vararr77],[vararr78],[vararr79],[vararr80],$<br \/> [vararr81],[vararr82],[vararr83],[vararr84],[vararr85],[vararr86],[vararr87],[vararr88],[vararr89],[vararr90]]<br \/>;printf,lun4,'4em+4'<br \/> END<br \/> ;4+5EM<br \/> 5:BEGIN<br \/> m_num=56<br \/> vararr21=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[ps],[bn],[bs],[ns]]<br \/> vararr22=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[ps],[bn],[bs],[ns]]<br \/> vararr23=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[bn],[bs],[ns]]<br \/> vararr24=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[ps],[bs],[ns]]<br \/> vararr25=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[ps],[bn],[ns]]<br \/> vararr26=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[ps],[bn],[bs]]<br \/> vararr27=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[ps],[bn],[bs],[ns]]<br \/> vararr28=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[bn],[bs],[ns]]<br \/> vararr29=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[ps],[bs],[ns]]<br \/> vararr30=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[ps],[bn],[ns]]<br \/> vararr31=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[ps],[bn],[bs]]<br \/> vararr32=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[bn],[bs],[ns]]<br \/> vararr33=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[ps],[bs],[ns]]<br \/> vararr34=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[ps],[bn],[ns]]<br \/> vararr35=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[ps],[bn],[bs]]<br \/> vararr36=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[bs],[ns]]<br \/> vararr37=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[bn],[ns]]<br \/> vararr38=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[bn],[bs]]<br \/> vararr39=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[ps],[ns]]<br \/> vararr40=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[ps],[bs]]<br \/> vararr41=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[ps],[bn]]<br \/> vararr42=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[ps],[bn],[bs],[ns]]<br \/> vararr43=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[bn],[bs],[ns]]<br \/> vararr44=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[ps],[bs],[ns]]<br \/> vararr45=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[ps],[bn],[ns]]<br \/> vararr46=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[ps],[bn],[bs]]<br \/> vararr47=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[bn],[bs],[ns]]<br \/> vararr48=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[ps],[bs],[ns]]<br \/> vararr49=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[ps],[bn],[ns]]<br \/> vararr50=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[ps],[bn],[bs]]<br \/> vararr51=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[bs],[ns]]<br \/> vararr52=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[bn],[ns]]<br \/> vararr53=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[bn],[bs]]<br \/> vararr54=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[ps],[ns]]<br \/> vararr55=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[ps],[bs]]<br \/> vararr56=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[ps],[bn]]<br \/> vararr57=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[bn],[bs],[ns]]<br \/> vararr58=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[ps],[bs],[ns]]<br \/> vararr59=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[ps],[bn],[ns]]<br \/> vararr60=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[ps],[bn],[bs]]<br \/> vararr61=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[bs],[ns]]<br \/> vararr62=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[bn],[ns]]<br \/> vararr63=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[bn],[bs]]<br \/> vararr64=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[ps],[ns]]<br \/> vararr65=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[ps],[bs]]<br \/> vararr66=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[ps],[bn]]<br \/> vararr67=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[bs],[ns]]<br \/> vararr68=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[bn],[ns]]<br \/> vararr69=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[bn],[bs]]<br \/> vararr70=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[ps],[ns]]<br \/> vararr71=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[ps],[bs]]<br \/> vararr72=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[ps],[bn]]<br \/> vararr73=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[ns]]<br \/> vararr74=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[bs]]<br \/> vararr75=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[bn]]<br \/> vararr76=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[ps]]<br \/> em=[[vararr21],[vararr22],[vararr23],[vararr24],[vararr25],[vararr26],[vararr27],[vararr28],[vararr29],[vararr30],$<br \/> [vararr31],[vararr32],[vararr33],[vararr34],[vararr35],[vararr36],[vararr37],[vararr38],[vararr39],[vararr40],$<br \/> [vararr41],[vararr42],[vararr43],[vararr44],[vararr45],[vararr46],[vararr47],[vararr48],[vararr49],[vararr50],$<br \/> [vararr51],[vararr52],[vararr53],[vararr54],[vararr55],[vararr56],[vararr57],[vararr58],[vararr59],[vararr60],$<br \/> [vararr61],[vararr62],[vararr63],[vararr64],[vararr65],[vararr66],[vararr67],[vararr68],[vararr69],[vararr70],$<br \/> [vararr71],[vararr72],[vararr73],[vararr74],[vararr75],[vararr76]]<br \/>;printf,lun4,'4em+5'<br \/> END<br \/> ;4+6EM<br \/> 6:BEGIN<br \/> m_num=28<br \/> vararr71=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[ps],[bn]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr72=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[ps],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr73=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[ps],[bs]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr74=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[bn],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr75=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[bn],[bs]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr76=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr77=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[ps],[bn],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr78=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[ps],[bn],[bs]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr79=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[ps],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr80=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[bn],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr81=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[ps],[bn],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr82=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[bn],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr83=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[ps],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr84=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[ps],[bn],[bs]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr85=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[ps],[bn],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr86=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[ps],[bn],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr87=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[ps],[bn],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr88=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[bn],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr89=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[ps],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr90=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[ps],[bn],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr91=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[ps],[bn],[bs]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr92=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[ps],[bn],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr93=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[ps],[bn],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr94=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[ps],[bn],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr95=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[bn],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr96=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[ps],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr97=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[ps],[bn],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr98=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[ps],[bn],[bs]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> em=[[vararr71],[vararr72],[vararr73],[vararr74],[vararr75],[vararr76],[vararr77],[vararr78],[vararr79],[vararr80],$<br \/> [vararr81],[vararr82],[vararr83],[vararr84],[vararr85],[vararr86],[vararr87],[vararr88],[vararr89],[vararr90],$<br \/> [vararr91],[vararr92],[vararr93],[vararr94],[vararr95],[vararr96],[vararr97],[vararr98]]<br \/>;printf,lun4,'4em+6'<br \/> END<br \/> ;4+7EM<br \/> 7:BEGIN<br \/> m_num=8<br \/> vararr71=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[ps],[bn],[bs],[ns]] ;4+7\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr72=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[ps],[bn],[bs],[ns]] ;4+7\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr73=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[ps],[bn],[bs],[ns]] ;4+7\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr74=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[ps],[bn],[bs],[ns]] ;4+7\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr75=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[bn],[bs],[ns]] ;4+7\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr76=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[ps],[bs],[ns]] ;4+7\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr77=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[ps],[bn],[ns]] ;4+7\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr78=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[ps],[bn],[bs]] ;4+7\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> em=[[vararr71],[vararr72],[vararr73],[vararr74],[vararr75],[vararr76],[vararr77],[vararr78]]<br \/>;printf,lun4,'4em+7'<br \/> END<br \/> ;4+8EM 1\u7ec4\u5b9e\u9a8c<br \/> 8:BEGIN<br \/> m_num=1<br \/> vararr12=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[ps],[bn],[bs],[ns]] ;4+8\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> em=[vararr12]<br \/>;printf,lun4,'4em+8'<br \/> END<\/p>\n<p>;***********************************************************************************************************<\/p>\n<p>endcase<br \/> <br \/> end <br \/>endcase<br \/> <br \/> ; ;**************************************************************************************************************************************************<\/p>\n<p>;\u9650\u5236\u4e3a1\u7684\uff0c\u975e\u8d1f\u8ba1\u7b97\uff0c\u6240\u6709\u7aef\u5143\u7684\u4e30\u5ea6\u7ed3\u679c\u53caRMSE<br \/> n_num=N_elements(em[*,0])<br \/> nr_num=N_elements(em[0,*])<br \/> mixem_num=nr_num\/m_num<br \/> result_a=fltarr(m_num,mixem_num)<br \/> rmse_a=fltarr(m_num)<br \/> Error_per=fltarr(m_num)<br \/> pre_pixPer=fltarr(m_num,n_num)<br \/>; <br \/> for nn=0,m_num-1 do begin<br \/> case fcls_method of ;<br \/> 1:begin ;NCLS Reference:Fully Constrained Least Squares Linear Spectral Mixture Analysis Method for Material Quantification in Hyperspectral Imagery<br \/> FCLS_ncls_Heinz,em[*,(nn*mixem_num):(nn*mixem_num+mixem_num-1)],pixels,nb,result=result,rmse=rmse,R_Error3=R_Error3,pre_pix=pre_pix ;\u9650\u5236\u52a0\u548c\u4e3a1\uff0c\u5e76\u975e\u8d1f<br \/> end<br \/> 2:begin ;NCLS Reference: Constrained Subpixel Target Detection for Remotely Sensed Imagery<br \/> FCLS_ncls_Chang_Heinz,em[*,(nn*mixem_num):(nn*mixem_num+mixem_num-1)],pixels,nb,result=result,rmse=rmse,R_Error3=R_Error3,pre_pix=pre_pix ;\u9650\u5236\u52a0\u548c\u4e3a1\uff0c\u5e76\u975e\u8d1f <br \/> ; KFCLS_ncls_Chang_Heinz,em[*,(nn*mixem_num):(nn*mixem_num+mixem_num-1)],pixels,nb,kernel,result=result,rmse=rmse,R_Error3=R_Error3,pre_pix=pre_pix ;\u9650\u5236\u52a0\u548c\u4e3a1\uff0c\u5e76\u975e\u8d1f <br \/> end<br \/> endcase<br \/> result_a[nn,*]=result<br \/> rmse_a[nn,*]=rmse<br \/> Error_per[nn,*]=R_Error3<br \/> pre_pixPer[nn,*]=pre_pix<br \/> <br \/> <br \/> <br \/> endfor<br \/> ;\u8f93\u51fa\u5404\u7aef\u5143\u4e30\u5ea6 \u7ed3\u679c\u77e9\u9635\u53ca\u5404\u6a21\u578b\u9488\u5bf9\u4e00\u4e2a\u6837\u672c\u7684rmse\u77e9\u9635<br \/> resultall=reform(transpose(result_a),mixem_num,m_num)<br \/> rmseall=transpose(rmse_a)<\/p>\n<p>;\u5c06\u6df7\u5408\u50cf\u5143\u4e30\u5ea6\u5206\u914d\u5230\u5404\u7eaf\u51c0\u50cf\u5143\u4e2d<br \/> dims_R = SIZE(resultall, \/dimensions)<br \/> r = dims_R[0] ;\u5217\u6570<br \/> t=dims_R[1] ;\u884c\u6570<\/p>\n<p>case em_num of<br \/> 3:begin <br \/> if r eq 3 then begin<br \/> resultall_sub=resultall[0:(r-1),*]<br \/> resultfraction=resultall_sub<br \/>; realresult=[[resultall], rmseall,transpose(Error_per)] <br \/> endif else begin<br \/> resultall_sub=resultall[em_num:(r-1),*]<br \/> Sum_other=total(resultall_sub,1)<br \/> PV_re1=resultall[0,*]\/(1-sum_other)<br \/> BS_re1=resultall[1,*]\/(1-sum_other)<br \/> NPV_re1=resultall[2,*]\/(1-sum_other)<br \/> ;\u8f93\u51fa\u7ed3\u679c\u4e3a\u4e30\u5ea6 PV BS NPV RMSE<br \/> resultfraction=[PV_re1,BS_re1,NPV_re1]<\/p>\n<p>; idx = WHERE((resultfraction LT 0) and (resultfraction ge -0.0001))<br \/>; resultfraction[idx]=0<br \/>; realresult=[[resultfraction],rmseall,transpose([Error_per])]<br \/> endelse<br \/> end<br \/> 4:begin<br \/> if r eq 4 then begin<br \/> resultall_sub=resultall[0:(r-1),*]<br \/> resultfraction=resultall_sub<br \/>; realresult=[[resultall],rmseall,transpose(Error_per)] <br \/> endif else begin<br \/> resultall_sub=resultall[em_num:(r-1),*]<br \/> Sum_other=total(resultall_sub,1)<br \/> PV_re1=resultall[0,*]\/(1-sum_other)<br \/> BS_re1=resultall[1,*]\/(1-sum_other)<br \/> NPV_re1=resultall[2,*]\/(1-sum_other)<br \/> SHADOW_re1=resultall[3,*]\/(1-sum_other)<br \/> ;\u8f93\u51fa\u7ed3\u679c\u4e3a\u4e30\u5ea6 PV BS NPV SHADOW RMSE<br \/> resultfraction=[PV_re1,BS_re1,NPV_re1,SHADOW_re1]<br \/> endelse<br \/> end<br \/> endcase <br \/> <br \/> idx = WHERE((resultfraction[*,*] LT 0.000001) and (resultfraction[*,*] ge -0.00001))<br \/>if min(idx) ne -1 then begin<br \/> resultfraction[idx]=0<br \/>endif<br \/> realresult=[[resultfraction],rmseall,transpose([Error_per])]<br \/> result_group[*,*,g]=realresult<\/p>\n<p>g++<br \/>;print,result<br \/>; print,resultfraction <br \/>; print,realresult<br \/> ; print,result_group<br \/>; printf,lun4,realresult<br \/> <br \/>; free_lun,lun4 <br \/> ;\u6587\u4ef6\u8f93\u51fa\u7ed3\u679c \u4e3a15\u300120\u4e2a\u662f\u4e00\u7ec4\u6570\u636e\u7684\u7ed3\u679c\uff0c\u8fd9\u6837\u4e0b\u4e2a\u7a0b\u5e8f\u53ef\u4ee5\u76f4\u63a5\u8c03\u7528TXT\u6587\u672c\uff0c\u6bcf\u95f4\u9694\u4e00\u5b9a\u6570\u91cf\u884c\u4e3a\u4e00\u7ec4\u65b0\u7684\u5b9e\u9a8c\u7ed3\u679c\u6570\u636e<br \/>; txtname5='D:\\hyperion_paper\\data_idl\\bc_data\\RMSE_PERCENT\\nnnnnnnnn.txt'<br \/>; openw,lun5,txtname5,\/get_lun,\/append ;\/append\u8fde\u7eed\u5199\u5165\u51fd\u6570<br \/>printf,lun5,'BSMM mixture pixel' <br \/> printf,lun5,transpose(pre_pixPer),format = '(1653F12)'<br \/>; free_lun,lun5<br \/> <br \/> ENDFOR ;\u4e00\u7ec4\u7ec4\u7684\u8bfb\u53d6\u6837\u672c\u6570\u636e\u8fc7\u7a0b\u7ed3\u675f<br \/> ;\u63d0\u53d6\u51fa\u5404\u7ec4\u6837\u672c\u6570\u636e\u540c\u4e00\u7ec4\u5408\u65b9\u6cd5\u7684\u6240\u6709\u7ed3\u679c\u4e3a\u4e00\u4e2a\u77e9\u9635<br \/> dims_R = SIZE(result_group, \/dimensions)<br \/> r = dims_R[0] ; ;\u5217\u6570<br \/> t=dims_R[1]<br \/> g=dims_R[2] ;\u884c\u6570<br \/> fraction= fltarr(r,g,t)<br \/> for k=0,t-1 do begin<br \/> for i=0, g-1 do begin<br \/> fraction[*,i,k]=result_group[*,k,i] ;\u63d0\u53d6\u51fa\u5404\u7ec4\u6837\u672c\u6570\u636e\u540c\u4e00\u7ec4\u5408\u65b9\u6cd5\u7684\u6240\u6709\u7ed3\u679c\u4e3a\u4e00\u4e2a\u77e9\u9635\uff0c3em\/4EM\u5168\u90e8\u8ba1\u7b97<br \/> endfor<br \/> endfor<\/p>\n<p><br \/> print,\"emMixNB\",emMixNB<br \/> ; print,result_a <br \/>print,fraction<br \/>;printf,lun4,fraction ;the same method with the samples<\/p>\n<p>fraction_check=fltarr(r,g*t)<br \/> <br \/> for k=0,t-1 do begin <br \/> for i=0, g-1 do begin<\/p>\n<p>fraction_check[*,k*g+i]=result_group[*,k,i]<br \/>;print,fraction_check<br \/> endfor<br \/> endfor<br \/>; print,fraction_check<br \/>;printf,lun5,fraction_check <br \/> free_lun,lun4 <br \/> free_lun,lun5<br \/>end<\/p>\n<p>\u00a0<\/p>","order_id":"0","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>pro BSMM_unmixing_414<br \/> COMPILE_OPT idl2<br \/> envi, \/restore_base_save_files<\/p>\n<p><br \/> ;\uff1b********************************************************************************************************************************<br \/> ;\uff1b********************************************************************************************************************************<br \/> emMixNB=1;3EM:from 0to5 (0\u8868\u793a\u7ebf\u6027\u7684\uff1b1 \u8868\u793a\u6709\u4e00\u7ec4\u7aef\u5143\u6df7\u5408\uff1b 2 \u6709 2\u7ec4\u7aef\u5143\u8fed\u4ee3\uff1b3 \u67093\u7ec4\u7aef\u5143\u8fed\u4ee3 \uff1b4 \u67094\u7ec4\u7aef\u5143\u8fed\u4ee3 \uff1b5 \u6709\u4e94\u7ec4\u7aef\u5143\u6df7\u5408)<br \/> ;4EM:from 0to8(0\u8868\u793a\u7ebf\u6027\u7684\uff1b1 \u8868\u793a\u6709\u4e00\u7ec4\u7aef\u5143\u6df7\u5408\uff1b 2 \u6709 2\u7ec4\u7aef\u5143\u8fed\u4ee3\uff1b3 \u67093\u7ec4\u7aef\u5143\u8fed\u4ee3 \uff1b4 \u67094\u7ec4\u7aef\u5143\u8fed\u4ee3 \uff1b5 \u6709\u4e94\u7ec4\u7aef\u5143\u6df7\u5408 ..........8 \u6709\u4e94\u7ec4\u7aef\u5143\u6df7\u5408)<br \/> em_num=4; 3\u8868\u793a3\u7aef\u5143\u6a21\u578b\uff1b4\u8868\u793a4\u7aef\u5143\u6a21\u578b<br \/> ; kernel=0<br \/> fcls_method=2 ; 1:jinying's ;NCLS Reference:\"Fully Constrained Least Squares Linear Spectral Mixture Analysis Method for Material Quantification in Hyperspectral Imagery\"<br \/> ;2:jicc's NCLS Reference:\"Constrained Subpixel Target Detection for Remotely Sensed Imagery\"<br \/> <br \/>; m_num=10 ;\u9700\u8981\u4fee\u6539 ,\u8bf7\u8f93\u5165method\u65b9\u6cd5\u7ec4\u5408\u6570\u76ee<br \/>; em_num=3 ;\u8bf7\u8f93\u5165\u7eaf\u7aef\u5143\u6570\u76ee<br \/>; mixem_num=5 ;\u975e\u7ebf\u6027\u7eaf\u7aef\u5143+\u6df7\u5408\u7aef\u5143\u6570\u76ee<br \/>; band_num=1653 ;\u8bf7\u8f93\u5165\u6ce2\u6bb5\u6570\u76ee<br \/>; sample_num=20<br \/> ;\uff1b********************************************************************************************************************************<br \/> ;\uff1b********************************************************************************************************************************<\/p>\n<p>;\u5f00\u59cb\u8bbe\u7f6e\u8def\u5f84\uff0c\u8bfb\u53d6txt(n\u5217\uff0cn\u884c)<br \/> txtname2='D:\\hyperion_paper\\data_idl\\ss_data\\SS_pixcel.txt' ;\u8f93\u5165\u6df7\u5408\u50cf\u5143\u53cd\u5c04\u7387,\u5168\u90e8\u6837\u672c\u6df7\u5408\u7aef\u5143\u6570\u636e\uff0c\u591a\u5c11\u6837\u672c\u591a\u5c11\u5217\uff0c\u4f8b\u5982\u767d\u523a\u4e3a20\u5217<br \/> <br \/> if file_test(txtname2)then begin<br \/> nLines2=file_lines(txtname2) ;\u83b7\u53d6\u884c<br \/> tmp2=''<br \/> ; \u6253\u5f00\u6587\u4ef6<br \/> openr,lun2,txtname2,\/get_lun<br \/> while(~EOF(lun2))do begin<br \/> readf,lun2,tmp2 ;\u83b7\u53d6\u7b2c\u4e00\u884c<br \/> ;print,tmp2<br \/> ;help,tmp2<br \/> var2=strsplit(tmp2,\/extract) ;\u62c6\u5206\u7b2c\u4e00\u884c\u83b7\u53d6\u5217\u6570<br \/> rowNum=N_elements(var2)<br \/> vararr2=fltarr(rowNum,nLines2-1) ;\u5b9a\u4e49\u6570\u7ec4(n\uff0cn-1)<br \/> readf,lun2,vararr2<br \/> vararr2=[[var2],[vararr2]] ;\u91cd\u65b0\u7ec4\u5408\u6570\u7ec4(n\uff0cn-1)+\u7b2c\u4e00\u884c=\uff08n,n\uff09 over!<br \/> band_num=N_elements(vararr2[0,*])<br \/> pixels_group=reform(TRANSPOSE(vararr2),band_num,rowNum)<br \/>; pixels=reform(TRANSPOSE(vararr2),band_num,1) \uff1b\u53ea\u6709\u4e00\u4e2a\u6837\u672c\u65f6\u91c7\u7528<br \/> endwhile<br \/> endif<br \/> txtname1='D:\\hyperion_paper\\data_idl\\ss_data\\4EM_SS_EM_2.txt' ;\u8f93\u5165\u6570\u636e\u4e3aPV,SOIL,NPV......\u53cd\u5c04\u7387\uff0c\u6839\u636e\uff08\u7aef\u5143\u6570\u91cf*\u6837\u672c\u6570\u91cf\uff09\u51b3\u5b9a\u591a\u5c11\u5217 <br \/> ;ss\u987a\u5e8f\u4e3aPV npv BS shadow<br \/> if file_test(txtname1)then begin<br \/> nLines1=file_lines(txtname1) ;\u83b7\u53d6\u884c<br \/> tmp1=''<br \/> ; \u6253\u5f00\u6587\u4ef6<br \/> openr,lun,txtname1,\/get_lun<br \/> while(~EOF(lun))do begin<br \/> readf,lun,tmp1 ;\u83b7\u53d6\u7b2c\u4e00\u884c<br \/> ;print,tmp1<br \/> ;help,tmp<br \/> var1=strsplit(tmp1,\/extract) ;\u62c6\u5206\u7b2c\u4e00\u884c\u83b7\u53d6\u5217\u6570<br \/> rowNum1=N_elements(var1)<br \/> vararr1=fltarr(rowNum1,nLines1-1) ;\u5b9a\u4e49\u6570\u7ec4(n\uff0cn-1)<br \/> readf,lun,vararr1<br \/> vararr1=[[var1],[vararr1]] ;\u91cd\u65b0\u7ec4\u5408\u6570\u7ec4(n\uff0cn-1)+\u7b2c\u4e00\u884c=\uff08n,n\uff09 over!<br \/> endwhile<br \/> endif<br \/>; em_num=N_elements(vararr1[*,0])<br \/> <br \/>; txtname4='D:\\hyperion_paper\\data_idl\\bc_data\\RMSE_PERCENT\\ttttttttt.txt'<br \/>txtname4='D:\\hyperion_paper\\data_idl\\bc_data\\\u9065\u611f\u5b66\u62a5\\bc_4em_bsmm.txt'<br \/>openw,lun4,txtname4,\/get_lun,\/append ;\/append\u8fde\u7eed\u5199\u5165\u51fd\u6570<br \/>printf,lun4,'PV NPV BS (SHADOW) model_RMSE model_rmse(%)' <br \/>printf,lun4,em_num,'EM','+',emMixNB<\/p>\n<p>;print fraction continue to check the accuracy of fraction<br \/>txtname5='D:\\hyperion_paper\\data_idl\\ss_data\\ss_1020_gauss\\mix_pixel\\ss_4em_bsmm_pix.txt'<br \/>openw,lun5,txtname5,\/get_lun,\/append ;\/append\u8fde\u7eed\u5199\u5165\u51fd\u6570<\/p>\n<p>case em_num of<br \/> 3:begin<br \/> case emMixNB of<br \/> 0:m_num=1<br \/> 1:m_num=5<br \/> 2:m_num=10<br \/> 3:m_num=10<br \/> 4:m_num=5<br \/> 5:m_num=1<br \/> endcase<br \/> end<br \/> 4:begin<br \/> case emMixNB of<br \/> 0:m_num=1<br \/> 1:m_num=8<br \/> 2:m_num=28<br \/> 3:m_num=56<br \/> 4:m_num=70<br \/> 5:m_num=56 <br \/> 6:m_num=28<br \/> 7:m_num=8<br \/> 8:m_num=1<br \/> endcase<br \/> end<br \/> endcase<\/p>\n<p>result_group=fltarr(em_num+2,m_num,rowNum)<br \/> g=0<\/p>\n<p><br \/> <br \/> ;\u4e00\u7ec4\u7ec4\u7684\u8bfb\u53d6\u6837\u672c\u6570\u636e\uff0c\u4e00\u4e2a\u5faa\u73af\u4e3a\u4e00\u4e2a\u6837\u672c\u6570\u636e<br \/> for sm=0,rowNum-1 do begin <br \/> <br \/>;openw,lun4,txtname4,\/get_lun,\/append ;\/append\u8fde\u7eed\u5199\u5165\u51fd\u6570<br \/> case em_num of <br \/> 3:begin<br \/> ;3EM<br \/> pixels=reform((TRANSPOSE(pixels_group))[sm,*],band_num,1)<br \/> <br \/> pv1=vararr1[sm*em_num+0,*] ;\u83b7\u53d6\u7b2c\u4e00\u5217<br \/> bs1=vararr1[sm*em_num+1,*] ;\u83b7\u53d6\u7b2c\u4e8c\u5217<br \/> npv1=vararr1[sm*em_num+2,*]<br \/> pvpv=TRANSPOSE(vararr1[sm*em_num+0,*]*vararr1[sm*em_num+0,*])<br \/> npvnpv=TRANSPOSE(vararr1[sm*em_num+2,*]*vararr1[sm*em_num+2,*])<br \/> pvbs=TRANSPOSE(vararr1[sm*em_num+0,*]*vararr1[sm*em_num+1,*])<br \/> pvnpv=TRANSPOSE(vararr1[sm*em_num+0,*]*vararr1[sm*em_num+2,*])<br \/> bsnpv=TRANSPOSE(vararr1[sm*em_num+1,*]*vararr1[sm*em_num+2,*])<\/p>\n<p>;\uff1b******************************************************************************************************<br \/> case emMixNB of<br \/> 0:begin<br \/> ;3EM+0 1\u7ec4<br \/> m_num=1<br \/> ;mixem_num=3<br \/> em=transpose([pv1,bs1,npv1])<br \/>;printf,lun4,'3em+0'<br \/> end<br \/> 1:begin<br \/> ;3em+1em 5\u7ec4<br \/> m_num=5<br \/> ; mixem_num=4<\/p>\n<p>vararr71=[[transpose([pv1,bs1,npv1])],[pvpv]]<br \/> vararr72=[[transpose([pv1,bs1,npv1])],[npvnpv]]<br \/> vararr73=[[transpose([pv1,bs1,npv1])],[pvbs]]<br \/> vararr74=[[transpose([pv1,bs1,npv1])],[pvnpv]]<br \/> vararr75=[[transpose([pv1,bs1,npv1])],[bsnpv]]<br \/> em=[[vararr71],[vararr72],[vararr73],[vararr74],[vararr75]]<br \/>;printf,lun4,'3em+1' <br \/> end<br \/> ;\uff1b******************************************************************************************************<br \/> 2:begin<br \/> m_num=10<br \/> ; mixem_num=5<br \/> ;3em+2em 10\u7ec4<br \/> vararr71=[[transpose([pv1,bs1,npv1])],[pvpv],[npvnpv]]<br \/> vararr72=[[transpose([pv1,bs1,npv1])],[pvpv],[bsnpv]]<br \/> vararr73=[[transpose([pv1,bs1,npv1])],[pvpv],[pvbs]]<br \/> vararr74=[[transpose([pv1,bs1,npv1])],[pvpv],[pvnpv]]<br \/> vararr75=[[transpose([pv1,bs1,npv1])],[pvnpv],[bsnpv]]<br \/> vararr76=[[transpose([pv1,bs1,npv1])],[pvnpv],[pvbs]]<br \/> vararr77=[[transpose([pv1,bs1,npv1])],[bsnpv],[pvbs]]<br \/> vararr78=[[transpose([pv1,bs1,npv1])],[npvnpv],[pvnpv]]<br \/> vararr79=[[transpose([pv1,bs1,npv1])],[npvnpv],[bsnpv]]<br \/> vararr710=[[transpose([pv1,bs1,npv1])],[npvnpv],[pvbs]]<br \/> em=[[vararr71],[vararr72],[vararr73],[vararr74],[vararr75],[vararr76],[vararr77],[vararr78],[vararr79],[vararr710]]<br \/>;printf,lun4,'3em+2'<br \/> end<br \/> ;************************************************************************************************************************<br \/> ;3em+3em 10\u7ec4<br \/> 3:begin<br \/> m_num=10<br \/> ; mixem_num=6<br \/> vararr71=[[transpose([pv1,bs1,npv1])],[pvpv],[npvnpv],[pvnpv]]<br \/> vararr72=[[transpose([pv1,bs1,npv1])],[pvpv],[npvnpv],[bsnpv]]<br \/> vararr73=[[transpose([pv1,bs1,npv1])],[pvpv],[npvnpv],[pvbs]]<br \/> vararr74=[[transpose([pv1,bs1,npv1])],[pvpv],[pvnpv],[bsnpv]]<br \/> vararr75=[[transpose([pv1,bs1,npv1])],[pvpv],[pvnpv],[pvbs]]<br \/> vararr76=[[transpose([pv1,bs1,npv1])],[pvpv],[bsnpv],[pvbs]]<br \/> vararr77=[[transpose([pv1,bs1,npv1])],[npvnpv],[pvnpv],[bsnpv]]<br \/> vararr78=[[transpose([pv1,bs1,npv1])],[npvnpv],[pvnpv],[pvbs]]<br \/> vararr79=[[transpose([pv1,bs1,npv1])],[npvnpv],[bsnpv],[pvbs]]<br \/> vararr710=[[transpose([pv1,bs1,npv1])],[pvnpv],[bsnpv],[pvbs]]<br \/> em=[[vararr71],[vararr72],[vararr73],[vararr74],[vararr75],[vararr76],[vararr77],[vararr78],[vararr79],[vararr710]]<br \/>;printf,lun4,'3em+3'<br \/> end<br \/> ;************************************************************************************************************************<br \/> ;3em+4em 5\u7ec4<br \/> 4:begin<br \/> m_num=5<br \/> ; mixem_num=7<br \/> vararr71=[[transpose([pv1,bs1,npv1])],[pvpv],[npvnpv],[pvnpv],[bsnpv]]<br \/> vararr72=[[transpose([pv1,bs1,npv1])],[pvpv],[npvnpv],[pvnpv],[pvbs]]<br \/> vararr73=[[transpose([pv1,bs1,npv1])],[pvpv],[npvnpv],[bsnpv],[pvbs]]<br \/> vararr74=[[transpose([pv1,bs1,npv1])],[pvpv],[pvnpv],[bsnpv],[pvbs]]<br \/> vararr75=[[transpose([pv1,bs1,npv1])],[npvnpv],[pvnpv],[bsnpv],[pvbs]]<br \/> em=[[vararr71],[vararr72],[vararr73],[vararr74],[vararr75]]<br \/>;printf,lun4,'3em+4'<br \/> end<br \/> ;******************************************************************************************************************************************************<br \/> 5:begin<br \/> ;3em+5em 1\u7ec4<br \/> m_num=1<br \/> ; mixem_num=8<br \/> vararr71=[[transpose([pv1,bs1,npv1])],[pvpv],[npvnpv],[pvnpv],[bsnpv],[pvbs]] ;3\u7aef\u5143<br \/> em=[vararr71]<br \/>;printf,lun4,'3em+5'<br \/> end<br \/> ;******************************************************************************************************************************************************<br \/> endcase <br \/> <br \/> end<br \/> 4:begin<br \/> ;4EM<br \/>; pixels=TRANSPOSE((TRANSPOSE(pixels_group))[sm,*])<br \/> pixels=reform((TRANSPOSE(pixels_group))[sm,*],band_num,1)<br \/> pv1=vararr1[sm*em_num+0,*] ;\u83b7\u53d6\u7b2c\u4e00\u5217<br \/> bs1=vararr1[sm*em_num+1,*] ;\u83b7\u53d6\u7b2c\u4e8c\u5217<br \/> npv1=vararr1[sm*em_num+2,*]<br \/> shadow1=vararr1[sm*em_num+3,*]<br \/> pp=TRANSPOSE(vararr1[sm*em_num+0,*]*vararr1[sm*em_num+0,*])<br \/> nn=TRANSPOSE(vararr1[sm*em_num+2,*]*vararr1[sm*em_num+2,*])<br \/> pb=TRANSPOSE(vararr1[sm*em_num+0,*]*vararr1[sm*em_num+1,*])<br \/> pn=TRANSPOSE(vararr1[sm*em_num+0,*]*vararr1[sm*em_num+2,*])<br \/> ps=TRANSPOSE(vararr1[sm*em_num+0,*]*vararr1[sm*em_num+3,*])<br \/> bn=TRANSPOSE(vararr1[sm*em_num+1,*]*vararr1[sm*em_num+2,*])<br \/> bs=TRANSPOSE(vararr1[sm*em_num+1,*]*vararr1[sm*em_num+3,*])<br \/> ns=TRANSPOSE(vararr1[sm*em_num+2,*]*vararr1[sm*em_num+3,*])<\/p>\n<p><br \/> ; 4EM<br \/> case emMixNB of<\/p>\n<p>0:begin<br \/> m_num=1<br \/> em=transpose([pv1,bs1,npv1,shadow1])<br \/>;printf,lun4,'4em+0'<br \/> END<br \/> ; 4+1EM<br \/> 1:begin<br \/> m_num=8<br \/> vararr71=[[transpose([pv1,bs1,npv1,shadow1])],[pp]]<br \/> vararr72=[[transpose([pv1,bs1,npv1,shadow1])],[nn]]<br \/> vararr73=[[transpose([pv1,bs1,npv1,shadow1])],[pb]]<br \/> vararr74=[[transpose([pv1,bs1,npv1,shadow1])],[pn]]<br \/> vararr75=[[transpose([pv1,bs1,npv1,shadow1])],[ps]]<br \/> vararr76=[[transpose([pv1,bs1,npv1,shadow1])],[bn]]<br \/> vararr77=[[transpose([pv1,bs1,npv1,shadow1])],[bs]]<br \/> vararr78=[[transpose([pv1,bs1,npv1,shadow1])],[ns]]<br \/> em=[[vararr71],[vararr72],[vararr73],[vararr74],[vararr75],[vararr76],[vararr77],[vararr78]]<br \/>;printf,lun4,'4em+1'<br \/> END<br \/> ; 4+2EM<br \/> 2:begin<br \/> m_num=28<br \/> vararr71=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn]]<br \/> vararr72=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb]]<br \/> vararr73=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn]]<br \/> vararr74=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[ps]]<br \/> vararr75=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[bn]]<br \/> vararr76=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[bs]]<br \/> vararr77=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[ns]]<br \/> vararr78=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb]]<br \/> vararr79=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn]]<br \/> vararr80=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[ps]]<br \/> vararr81=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[bn]]<br \/> vararr82=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[bs]]<br \/> vararr83=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[ns]]<br \/> vararr84=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn]]<br \/> vararr85=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[ps]]<br \/> vararr86=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[bn]]<br \/> vararr87=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[bs]]<br \/> vararr88=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[ns]]<br \/> vararr89=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[ps]]<br \/> vararr90=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[bn]]<br \/> vararr91=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[bs]]<br \/> vararr92=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[ns]]<br \/> vararr93=[[transpose([pv1,bs1,npv1,shadow1])],[ps],[bn]]<br \/> vararr94=[[transpose([pv1,bs1,npv1,shadow1])],[ps],[bs]]<br \/> vararr95=[[transpose([pv1,bs1,npv1,shadow1])],[ps],[ns]]<br \/> vararr96=[[transpose([pv1,bs1,npv1,shadow1])],[bn],[bs]]<br \/> vararr97=[[transpose([pv1,bs1,npv1,shadow1])],[bn],[ns]]<br \/> vararr98=[[transpose([pv1,bs1,npv1,shadow1])],[bs],[ns]]<br \/> em=[[vararr71],[vararr72],[vararr73],[vararr74],[vararr75],[vararr76],[vararr77],[vararr78],[vararr79],[vararr80],$<br \/> [vararr81],[vararr82],[vararr83],[vararr84],[vararr85],[vararr86],[vararr87],[vararr88],[vararr89],[vararr90],$<br \/> [vararr91],[vararr92],[vararr93],[vararr94],[vararr95],[vararr96],[vararr97],[vararr98]]<br \/>;printf,lun4,'4em+2'<br \/> END<br \/> ; 4+3EM<br \/> 3:begin<br \/> m_num=56<br \/> vararr21=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb]]<br \/> vararr22=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn]]<br \/> vararr23=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[ps]]<br \/> vararr24=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[bn]]<br \/> vararr25=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[bs]]<br \/> vararr26=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[ns]]<br \/> vararr27=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn]]<br \/> vararr28=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[ps]]<br \/> vararr29=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[bn]]<br \/> vararr30=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[bs]]<br \/> vararr31=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[ns]]<br \/> vararr32=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[ps]]<br \/> vararr33=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[bn]]<br \/> vararr34=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[bs]]<br \/> vararr35=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[ns]]<br \/> vararr36=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[ps],[bn]]<br \/> vararr37=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[ps],[bs]]<br \/> vararr38=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[ps],[ns]]<br \/> vararr39=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[bn],[bs]]<br \/> vararr40=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[bn],[ns]]<br \/> vararr41=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[bs],[ns]]<br \/> vararr42=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn]]<br \/> vararr43=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[ps]]<br \/> vararr44=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[bn]]<br \/> vararr45=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[bs]]<br \/> vararr46=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[ns]]<br \/> vararr47=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[ps]]<br \/> vararr48=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[bn]]<br \/> vararr49=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[bs]]<br \/> vararr50=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[ns]]<br \/> vararr51=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[ps],[bn]]<br \/> vararr52=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[ps],[bs]]<br \/> vararr53=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[ps],[ns]]<br \/> vararr54=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[bn],[bs]]<br \/> vararr55=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[bn],[ns]]<br \/> vararr56=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[bs],[ns]]<br \/> vararr57=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[ps]]<br \/> vararr58=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[bn]]<br \/> vararr59=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[bs]]<br \/> vararr60=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[ns]]<br \/> vararr61=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[ps],[bn]]<br \/> vararr62=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[ps],[bs]]<br \/> vararr63=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[ps],[ns]]<br \/> vararr64=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[bn],[bs]]<br \/> vararr65=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[bn],[ns]]<br \/> vararr66=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[bs],[ns]]<br \/> vararr67=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[ps],[bn]]<br \/> vararr68=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[ps],[bs]]<br \/> vararr69=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[ps],[ns]]<br \/> vararr70=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[bn],[bs]]<br \/> vararr71=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[bn],[ns]]<br \/> vararr72=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[bs],[ns]]<br \/> vararr73=[[transpose([pv1,bs1,npv1,shadow1])],[ps],[bn],[bs]]<br \/> vararr74=[[transpose([pv1,bs1,npv1,shadow1])],[ps],[bn],[ns]]<br \/> vararr75=[[transpose([pv1,bs1,npv1,shadow1])],[ps],[bs],[ns]]<br \/> vararr76=[[transpose([pv1,bs1,npv1,shadow1])],[bn],[bs],[ns]]<br \/> em=[[vararr21],[vararr22],[vararr23],[vararr24],[vararr25],[vararr26],[vararr27],[vararr28],[vararr29],[vararr30],$<br \/> [vararr31],[vararr32],[vararr33],[vararr34],[vararr35],[vararr36],[vararr37],[vararr38],[vararr39],[vararr40],$<br \/> [vararr41],[vararr42],[vararr43],[vararr44],[vararr45],[vararr46],[vararr47],[vararr48],[vararr49],[vararr50],$<br \/> [vararr51],[vararr52],[vararr53],[vararr54],[vararr55],[vararr56],[vararr57],[vararr58],[vararr59],[vararr60],$<br \/> [vararr61],[vararr62],[vararr63],[vararr64],[vararr65],[vararr66],[vararr67],[vararr68],[vararr69],[vararr70],$<br \/> [vararr71],[vararr72],[vararr73],[vararr74],[vararr75],[vararr76]]<br \/>;printf,lun4,'4em+3'<br \/> END<br \/> ;4+4EM<br \/> 4:begin<br \/> m_num=70<br \/> vararr21=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn]]<br \/> vararr22=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[ps]]<br \/> vararr23=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[bn]]<br \/> vararr24=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[bs]]<br \/> vararr25=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[ns]]<br \/> vararr26=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[ps]]<br \/> vararr27=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[bn]]<br \/> vararr28=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[bs]]<br \/> vararr29=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[ns]]<br \/> vararr30=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[ps],[bn]]<br \/> vararr31=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[ps],[bs]]<br \/> vararr32=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[ps],[ns]]<br \/> vararr33=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[bn],[bs]]<br \/> vararr34=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[bn],[ns]]<br \/> vararr35=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[bs],[ns]]<br \/> vararr36=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[ps]]<br \/> vararr37=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[bn]]<br \/> vararr38=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[bs]]<br \/> vararr39=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[ns]]<br \/> vararr40=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[ps],[bn]]<br \/> vararr41=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[ps],[bs]]<br \/> vararr42=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[ps],[ns]]<br \/> vararr43=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[bn],[bs]]<br \/> vararr44=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[bn],[ns]]<br \/> vararr45=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[bs],[ns]]<br \/> vararr46=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[ps],[bn]]<br \/> vararr47=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[ps],[bs]]<br \/> vararr48=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[ps],[ns]]<br \/> vararr49=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[bn],[bs]]<br \/> vararr50=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[bn],[ns]]<br \/> vararr51=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[bs],[ns]]<br \/> vararr52=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[ps],[bn],[bs]]<br \/> vararr53=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[ps],[bn],[ns]]<br \/> vararr54=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[ps],[bs],[ns]]<br \/> vararr55=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[bn],[bs],[ns]]<br \/> vararr56=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[ps]]<br \/> vararr57=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[bn]]<br \/> vararr58=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[bs]]<br \/> vararr59=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[ns]]<br \/> vararr60=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[ps],[bn]]<br \/> vararr61=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[ps],[bs]]<br \/> vararr62=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[ps],[ns]]<br \/> vararr63=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[bn],[bs]]<br \/> vararr64=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[bn],[ns]]<br \/> vararr65=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[bs],[ns]]<br \/> vararr66=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[ps],[bn]]<br \/> vararr67=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[ps],[bs]]<br \/> vararr68=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[ps],[ns]]<br \/> vararr69=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[bn],[bs]]<br \/> vararr70=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[bn],[ns]]<br \/> vararr71=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[bs],[ns]]<br \/> vararr72=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[ps],[bn],[bs]]<br \/> vararr73=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[ps],[bn],[ns]]<br \/> vararr74=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[ps],[bs],[ns]]<br \/> vararr75=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[bn],[bs],[ns]]<br \/> vararr76=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[ps],[bn]]<br \/> vararr77=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[ps],[bs]]<br \/> vararr78=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[ps],[ns]]<br \/> vararr79=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[bn],[bs]]<br \/> vararr80=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[bn],[ns]]<br \/> vararr81=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[bs],[ns]]<br \/> vararr82=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[ps],[bn],[bs]]<br \/> vararr83=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[ps],[bn],[ns]]<br \/> vararr84=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[ps],[bs],[ns]]<br \/> vararr85=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[bn],[bs],[ns]]<br \/> vararr86=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[ps],[bn],[bs]]<br \/> vararr87=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[ps],[bn],[ns]]<br \/> vararr88=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[ps],[bs],[ns]]<br \/> vararr89=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[bn],[bs],[ns]]<br \/> vararr90=[[transpose([pv1,bs1,npv1,shadow1])],[ps],[bn],[bs],[ns]]<br \/> em=[[vararr21],[vararr22],[vararr23],[vararr24],[vararr25],[vararr26],[vararr27],[vararr28],[vararr29],[vararr30],$<br \/> [vararr31],[vararr32],[vararr33],[vararr34],[vararr35],[vararr36],[vararr37],[vararr38],[vararr39],[vararr40],$<br \/> [vararr41],[vararr42],[vararr43],[vararr44],[vararr45],[vararr46],[vararr47],[vararr48],[vararr49],[vararr50],$<br \/> [vararr51],[vararr52],[vararr53],[vararr54],[vararr55],[vararr56],[vararr57],[vararr58],[vararr59],[vararr60],$<br \/> [vararr61],[vararr62],[vararr63],[vararr64],[vararr65],[vararr66],[vararr67],[vararr68],[vararr69],[vararr70],$<br \/> [vararr71],[vararr72],[vararr73],[vararr74],[vararr75],[vararr76],[vararr77],[vararr78],[vararr79],[vararr80],$<br \/> [vararr81],[vararr82],[vararr83],[vararr84],[vararr85],[vararr86],[vararr87],[vararr88],[vararr89],[vararr90]]<br \/>;printf,lun4,'4em+4'<br \/> END<br \/> ;4+5EM<br \/> 5:BEGIN<br \/> m_num=56<br \/> vararr21=[[transpose([pv1,bs1,npv1,shadow1])],[pn],[ps],[bn],[bs],[ns]]<br \/> vararr22=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[ps],[bn],[bs],[ns]]<br \/> vararr23=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[bn],[bs],[ns]]<br \/> vararr24=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[ps],[bs],[ns]]<br \/> vararr25=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[ps],[bn],[ns]]<br \/> vararr26=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[ps],[bn],[bs]]<br \/> vararr27=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[ps],[bn],[bs],[ns]]<br \/> vararr28=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[bn],[bs],[ns]]<br \/> vararr29=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[ps],[bs],[ns]]<br \/> vararr30=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[ps],[bn],[ns]]<br \/> vararr31=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[ps],[bn],[bs]]<br \/> vararr32=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[bn],[bs],[ns]]<br \/> vararr33=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[ps],[bs],[ns]]<br \/> vararr34=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[ps],[bn],[ns]]<br \/> vararr35=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[ps],[bn],[bs]]<br \/> vararr36=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[bs],[ns]]<br \/> vararr37=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[bn],[ns]]<br \/> vararr38=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[bn],[bs]]<br \/> vararr39=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[ps],[ns]]<br \/> vararr40=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[ps],[bs]]<br \/> vararr41=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[ps],[bn]]<br \/> vararr42=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[ps],[bn],[bs],[ns]]<br \/> vararr43=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[bn],[bs],[ns]]<br \/> vararr44=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[ps],[bs],[ns]]<br \/> vararr45=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[ps],[bn],[ns]]<br \/> vararr46=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[ps],[bn],[bs]]<br \/> vararr47=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[bn],[bs],[ns]]<br \/> vararr48=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[ps],[bs],[ns]]<br \/> vararr49=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[ps],[bn],[ns]]<br \/> vararr50=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[ps],[bn],[bs]]<br \/> vararr51=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[bs],[ns]]<br \/> vararr52=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[bn],[ns]]<br \/> vararr53=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[bn],[bs]]<br \/> vararr54=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[ps],[ns]]<br \/> vararr55=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[ps],[bs]]<br \/> vararr56=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[ps],[bn]]<br \/> vararr57=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[bn],[bs],[ns]]<br \/> vararr58=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[ps],[bs],[ns]]<br \/> vararr59=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[ps],[bn],[ns]]<br \/> vararr60=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[ps],[bn],[bs]]<br \/> vararr61=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[bs],[ns]]<br \/> vararr62=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[bn],[ns]]<br \/> vararr63=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[bn],[bs]]<br \/> vararr64=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[ps],[ns]]<br \/> vararr65=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[ps],[bs]]<br \/> vararr66=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[ps],[bn]]<br \/> vararr67=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[bs],[ns]]<br \/> vararr68=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[bn],[ns]]<br \/> vararr69=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[bn],[bs]]<br \/> vararr70=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[ps],[ns]]<br \/> vararr71=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[ps],[bs]]<br \/> vararr72=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[ps],[bn]]<br \/> vararr73=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[ns]]<br \/> vararr74=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[bs]]<br \/> vararr75=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[bn]]<br \/> vararr76=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[ps]]<br \/> em=[[vararr21],[vararr22],[vararr23],[vararr24],[vararr25],[vararr26],[vararr27],[vararr28],[vararr29],[vararr30],$<br \/> [vararr31],[vararr32],[vararr33],[vararr34],[vararr35],[vararr36],[vararr37],[vararr38],[vararr39],[vararr40],$<br \/> [vararr41],[vararr42],[vararr43],[vararr44],[vararr45],[vararr46],[vararr47],[vararr48],[vararr49],[vararr50],$<br \/> [vararr51],[vararr52],[vararr53],[vararr54],[vararr55],[vararr56],[vararr57],[vararr58],[vararr59],[vararr60],$<br \/> [vararr61],[vararr62],[vararr63],[vararr64],[vararr65],[vararr66],[vararr67],[vararr68],[vararr69],[vararr70],$<br \/> [vararr71],[vararr72],[vararr73],[vararr74],[vararr75],[vararr76]]<br \/>;printf,lun4,'4em+5'<br \/> END<br \/> ;4+6EM<br \/> 6:BEGIN<br \/> m_num=28<br \/> vararr71=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[ps],[bn]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr72=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[ps],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr73=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[ps],[bs]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr74=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[bn],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr75=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[bn],[bs]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr76=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr77=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[ps],[bn],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr78=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[ps],[bn],[bs]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr79=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[ps],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr80=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[bn],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr81=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[ps],[bn],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr82=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[bn],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr83=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[ps],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr84=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[ps],[bn],[bs]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr85=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[ps],[bn],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr86=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pn],[ps],[bn],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr87=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[ps],[bn],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr88=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[bn],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr89=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[ps],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr90=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[ps],[bn],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr91=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[ps],[bn],[bs]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr92=[[transpose([pv1,bs1,npv1,shadow1])],[pb],[pn],[ps],[bn],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr93=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pn],[ps],[bn],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr94=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[ps],[bn],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr95=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[bn],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr96=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[ps],[bs],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr97=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[ps],[bn],[ns]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr98=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[ps],[bn],[bs]] ;4+2\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> em=[[vararr71],[vararr72],[vararr73],[vararr74],[vararr75],[vararr76],[vararr77],[vararr78],[vararr79],[vararr80],$<br \/> [vararr81],[vararr82],[vararr83],[vararr84],[vararr85],[vararr86],[vararr87],[vararr88],[vararr89],[vararr90],$<br \/> [vararr91],[vararr92],[vararr93],[vararr94],[vararr95],[vararr96],[vararr97],[vararr98]]<br \/>;printf,lun4,'4em+6'<br \/> END<br \/> ;4+7EM<br \/> 7:BEGIN<br \/> m_num=8<br \/> vararr71=[[transpose([pv1,bs1,npv1,shadow1])],[nn],[pb],[pn],[ps],[bn],[bs],[ns]] ;4+7\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr72=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[pb],[pn],[ps],[bn],[bs],[ns]] ;4+7\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr73=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pn],[ps],[bn],[bs],[ns]] ;4+7\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr74=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[ps],[bn],[bs],[ns]] ;4+7\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr75=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[bn],[bs],[ns]] ;4+7\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr76=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[ps],[bs],[ns]] ;4+7\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr77=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[ps],[bn],[ns]] ;4+7\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> vararr78=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[ps],[bn],[bs]] ;4+7\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> em=[[vararr71],[vararr72],[vararr73],[vararr74],[vararr75],[vararr76],[vararr77],[vararr78]]<br \/>;printf,lun4,'4em+7'<br \/> END<br \/> ;4+8EM 1\u7ec4\u5b9e\u9a8c<br \/> 8:BEGIN<br \/> m_num=1<br \/> vararr12=[[transpose([pv1,bs1,npv1,shadow1])],[pp],[nn],[pb],[pn],[ps],[bn],[bs],[ns]] ;4+8\u7aef\u5143\uff0c\u5c06\u4e0d\u540c\u7684\u5217\u7ec4\u5408\u6210\u65b0\u7684\u77e9\u9635<br \/> em=[vararr12]<br \/>;printf,lun4,'4em+8'<br \/> END<\/p>\n<p>;***********************************************************************************************************<\/p>\n<p>endcase<br \/> <br \/> end <br \/>endcase<br \/> <br \/> ; ;**************************************************************************************************************************************************<\/p>\n<p>;\u9650\u5236\u4e3a1\u7684\uff0c\u975e\u8d1f\u8ba1\u7b97\uff0c\u6240\u6709\u7aef\u5143\u7684\u4e30\u5ea6\u7ed3\u679c\u53caRMSE<br \/> n_num=N_elements(em[*,0])<br \/> nr_num=N_elements(em[0,*])<br \/> mixem_num=nr_num\/m_num<br \/> result_a=fltarr(m_num,mixem_num)<br \/> rmse_a=fltarr(m_num)<br \/> Error_per=fltarr(m_num)<br \/> pre_pixPer=fltarr(m_num,n_num)<br \/>; <br \/> for nn=0,m_num-1 do begin<br \/> case fcls_method of ;<br \/> 1:begin ;NCLS Reference:Fully Constrained Least Squares Linear Spectral Mixture Analysis Method for Material Quantification in Hyperspectral Imagery<br \/> FCLS_ncls_Heinz,em[*,(nn*mixem_num):(nn*mixem_num+mixem_num-1)],pixels,nb,result=result,rmse=rmse,R_Error3=R_Error3,pre_pix=pre_pix ;\u9650\u5236\u52a0\u548c\u4e3a1\uff0c\u5e76\u975e\u8d1f<br \/> end<br \/> 2:begin ;NCLS Reference: Constrained Subpixel Target Detection for Remotely Sensed Imagery<br \/> FCLS_ncls_Chang_Heinz,em[*,(nn*mixem_num):(nn*mixem_num+mixem_num-1)],pixels,nb,result=result,rmse=rmse,R_Error3=R_Error3,pre_pix=pre_pix ;\u9650\u5236\u52a0\u548c\u4e3a1\uff0c\u5e76\u975e\u8d1f <br \/> ; KFCLS_ncls_Chang_Heinz,em[*,(nn*mixem_num):(nn*mixem_num+mixem_num-1)],pixels,nb,kernel,result=result,rmse=rmse,R_Error3=R_Error3,pre_pix=pre_pix ;\u9650\u5236\u52a0\u548c\u4e3a1\uff0c\u5e76\u975e\u8d1f <br \/> end<br \/> endcase<br \/> result_a[nn,*]=result<br \/> rmse_a[nn,*]=rmse<br \/> Error_per[nn,*]=R_Error3<br \/> pre_pixPer[nn,*]=pre_pix<br \/> <br \/> <br \/> <br \/> endfor<br \/> ;\u8f93\u51fa\u5404\u7aef\u5143\u4e30\u5ea6 \u7ed3\u679c\u77e9\u9635\u53ca\u5404\u6a21\u578b\u9488\u5bf9\u4e00\u4e2a\u6837\u672c\u7684rmse\u77e9\u9635<br \/> resultall=reform(transpose(result_a),mixem_num,m_num)<br \/> rmseall=transpose(rmse_a)<\/p>\n<p>;\u5c06\u6df7\u5408\u50cf\u5143\u4e30\u5ea6\u5206\u914d\u5230\u5404\u7eaf\u51c0\u50cf\u5143\u4e2d<br \/> dims_R = SIZE(resultall, \/dimensions)<br \/> r = dims_R[0] ;\u5217\u6570<br \/> t=dims_R[1] ;\u884c\u6570<\/p>\n<p>case em_num of<br \/> 3:begin <br \/> if r eq 3 then begin<br \/> resultall_sub=resultall[0:(r-1),*]<br \/> resultfraction=resultall_sub<br \/>; realresult=[[resultall], rmseall,transpose(Error_per)] <br \/> endif else begin<br \/> resultall_sub=resultall[em_num:(r-1),*]<br \/> Sum_other=total(resultall_sub,1)<br \/> PV_re1=resultall[0,*]\/(1-sum_other)<br \/> BS_re1=resultall[1,*]\/(1-sum_other)<br \/> NPV_re1=resultall[2,*]\/(1-sum_other)<br \/> ;\u8f93\u51fa\u7ed3\u679c\u4e3a\u4e30\u5ea6 PV BS NPV RMSE<br \/> resultfraction=[PV_re1,BS_re1,NPV_re1]<\/p>\n<p>; idx = WHERE((resultfraction LT 0) and (resultfraction ge -0.0001))<br \/>; resultfraction[idx]=0<br \/>; realresult=[[resultfraction],rmseall,transpose([Error_per])]<br \/> endelse<br \/> end<br \/> 4:begin<br \/> if r eq 4 then begin<br \/> resultall_sub=resultall[0:(r-1),*]<br \/> resultfraction=resultall_sub<br \/>; realresult=[[resultall],rmseall,transpose(Error_per)] <br \/> endif else begin<br \/> resultall_sub=resultall[em_num:(r-1),*]<br \/> Sum_other=total(resultall_sub,1)<br \/> PV_re1=resultall[0,*]\/(1-sum_other)<br \/> BS_re1=resultall[1,*]\/(1-sum_other)<br \/> NPV_re1=resultall[2,*]\/(1-sum_other)<br \/> SHADOW_re1=resultall[3,*]\/(1-sum_other)<br \/> ;\u8f93\u51fa\u7ed3\u679c\u4e3a\u4e30\u5ea6 PV BS NPV SHADOW RMSE<br \/> resultfraction=[PV_re1,BS_re1,NPV_re1,SHADOW_re1]<br \/> endelse<br \/> end<br \/> endcase <br \/> <br \/> idx = WHERE((resultfraction[*,*] LT 0.000001) and (resultfraction[*,*] ge -0.00001))<br \/>if min(idx) ne -1 then begin<br \/> resultfraction[idx]=0<br \/>endif<br \/> realresult=[[resultfraction],rmseall,transpose([Error_per])]<br \/> result_group[*,*,g]=realresult<\/p>\n<p>g++<br \/>;print,result<br \/>; print,resultfraction <br \/>; print,realresult<br \/> ; print,result_group<br \/>; printf,lun4,realresult<br \/> <br \/>; free_lun,lun4 <br \/> ;\u6587\u4ef6\u8f93\u51fa\u7ed3\u679c \u4e3a15\u300120\u4e2a\u662f\u4e00\u7ec4\u6570\u636e\u7684\u7ed3\u679c\uff0c\u8fd9\u6837\u4e0b\u4e2a\u7a0b\u5e8f\u53ef\u4ee5\u76f4\u63a5\u8c03\u7528TXT\u6587\u672c\uff0c\u6bcf\u95f4\u9694\u4e00\u5b9a\u6570\u91cf\u884c\u4e3a\u4e00\u7ec4\u65b0\u7684\u5b9e\u9a8c\u7ed3\u679c\u6570\u636e<br \/>; txtname5='D:\\hyperion_paper\\data_idl\\bc_data\\RMSE_PERCENT\\nnnnnnnnn.txt'<br \/>; openw,lun5,txtname5,\/get_lun,\/append ;\/append\u8fde\u7eed\u5199\u5165\u51fd\u6570<br \/>printf,lun5,'BSMM mixture pixel' <br \/> printf,lun5,transpose(pre_pixPer),format = '(1653F12)'<br \/>; free_lun,lun5<br \/> <br \/> ENDFOR ;\u4e00\u7ec4\u7ec4\u7684\u8bfb\u53d6\u6837\u672c\u6570\u636e\u8fc7\u7a0b\u7ed3\u675f<br \/> ;\u63d0\u53d6\u51fa\u5404\u7ec4\u6837\u672c\u6570\u636e\u540c\u4e00\u7ec4\u5408\u65b9\u6cd5\u7684\u6240\u6709\u7ed3\u679c\u4e3a\u4e00\u4e2a\u77e9\u9635<br \/> dims_R = SIZE(result_group, \/dimensions)<br \/> r = dims_R[0] ; ;\u5217\u6570<br \/> t=dims_R[1]<br \/> g=dims_R[2] ;\u884c\u6570<br \/> fraction= fltarr(r,g,t)<br \/> for k=0,t-1 do begin<br \/> for i=0, g-1 do begin<br \/> fraction[*,i,k]=result_group[*,k,i] ;\u63d0\u53d6\u51fa\u5404\u7ec4\u6837\u672c\u6570\u636e\u540c\u4e00\u7ec4\u5408\u65b9\u6cd5\u7684\u6240\u6709\u7ed3\u679c\u4e3a\u4e00\u4e2a\u77e9\u9635\uff0c3em\/4EM\u5168\u90e8\u8ba1\u7b97<br \/> endfor<br \/> endfor<\/p>\n<p><br \/> print,\"emMixNB\",emMixNB<br \/> ; print,result_a <br \/>print,fraction<br \/>;printf,lun4,fraction ;the same method with the samples<\/p>\n<p>fraction_check=fltarr(r,g*t)<br \/> <br \/> for k=0,t-1 do begin <br \/> for i=0, g-1 do begin<\/p>\n<p>fraction_check[*,k*g+i]=result_group[*,k,i]<br \/>;print,fraction_check<br \/> endfor<br \/> endfor<br \/>; print,fraction_check<br \/>;printf,lun5,fraction_check <br \/> free_lun,lun4 <br \/> free_lun,lun5<br \/>end<\/p>\n<p>\u00a0<\/p>"},"is_project":0},{"component_id":"919519","previous_id":"919518","original_id":"0","guid":"0746D5017A9746E6B1B6A41EBDF508D7","previous_guid":"4B8833DCBD104A5AA8B72F8A05800369","component_type_id":"6","data_id":"0","data":"Bilinea Spectral Mixture Model  unmixiIDL CODE","order_id":"1","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Bilinea Spectral Mixture Model  unmixiIDL CODE"},"is_project":0}]},{"id":"556916","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"818A926DC3B749CFAFC1FD5AC0E28D69","previous_guid":"510C3FDD0301474C8F79F42878473497","previous_id":"556915","last_modified":"1496570091","components":[{"component_id":"919520","previous_id":0,"original_id":"0","guid":"A91F85C5449A4C269792A75697C23071","previous_guid":null,"component_type_id":"1","data_id":"0","data":"<p>pro test_20160314_KFCLS<br \/> COMPILE_OPT idl2<br \/> envi, \/restore_base_save_files<\/p>\n<p><br \/> ;\uff1b********************************************************************************************************************************<br \/> ;\uff1b********************************************************************************************************************************<br \/>; ;\u9700\u8981\u4fee\u6539 ,\u8bf7\u8f93\u5165method\u65b9\u6cd5\u7ec4\u5408\u6570\u76ee<br \/> em_num=3 ;\u8bf7\u8f93\u5165\u7eaf\u7aef\u5143\u6570\u76ee<br \/> kernel=2;0:\u7ebf\u6027\u6838\u51fd\u6570\uff1b1\uff1a'KFCLS_RBF' :,\u5f84\u5411\u57fa\u51fd\u6570\uff1b2\uff1a'KFCLS_PKF' :,\u591a\u9879\u5f0f\u6838\u51fd\u6570\uff1b3: \u795e\u7ecf\u7f51\u7edc\u6838\u51fd\u6570<br \/>; mixem_num=3 ;\u975e\u7ebf\u6027\u7eaf\u7aef\u5143+\u6df7\u5408\u7aef\u5143\u6570\u76ee<br \/>; band_num=4 ;\u8bf7\u8f93\u5165\u6ce2\u6bb5\u6570\u76ee<br \/> ;\uff1b********************************************************************************************************************************<br \/> ;\uff1b********************************************************************************************************************************<\/p>\n<p>;\u5f00\u59cb\u8bbe\u7f6e\u8def\u5f84\uff0c\u8bfb\u53d6txt(n\u5217\uff0cn\u884c)<br \/>txtname2='D:\\hyperion_paper\\data_idl\\bc_data\\BC_PIXCLE.txt';'D:\\hyperion_paper\\data_idl\\bc_data\\BC_PIXCLE.txt' <br \/> <br \/> if file_test(txtname2)then begin<br \/> nLines2=file_lines(txtname2) ;\u83b7\u53d6\u884c<br \/> tmp2=''<br \/> ; \u6253\u5f00\u6587\u4ef6<br \/> openr,lun2,txtname2,\/get_lun<br \/> while(~EOF(lun2))do begin<br \/> readf,lun2,tmp2 ;\u83b7\u53d6\u7b2c\u4e00\u884c<br \/> ; print,tmp2<br \/> ;help,tmp2<br \/> var2=strsplit(tmp2,\/extract) ;\u62c6\u5206\u7b2c\u4e00\u884c\u83b7\u53d6\u5217\u6570<br \/> rowNum=N_elements(var2)<br \/> vararr2=fltarr(rowNum,nLines2-1) ;\u5b9a\u4e49\u6570\u7ec4(n\uff0cn-1)<br \/> readf,lun2,vararr2<br \/> vararr2=[[var2],[vararr2]] ;\u91cd\u65b0\u7ec4\u5408\u6570\u7ec4(n\uff0cn-1)+\u7b2c\u4e00\u884c=\uff08n,n\uff09 over!<br \/> band_num=N_elements(vararr2[0,*])<br \/> pixels_group=reform(TRANSPOSE(vararr2),band_num,rowNum)<br \/> endwhile<br \/> endif<br \/>txtname1='D:\\hyperion_paper\\data_idl\\bc_data\\3EM_BC_EM.txt';'D:\\hyperion_paper\\data_idl\\bc_data\\3EM_BC_EM.txt' ss_data\\4EM_SS_EM_2.txt ;\u8f93\u5165\u6570\u636e\u4e3aPV,SOIL,NPV,\u53cd\u5c04\u7387,\u7aef\u5143\u6570\u636e\uff0c\u6ce2\u6bb5\u6570*\u7aef\u5143\u6570<br \/>; txtname1='D:\\hyperion_paper\\data_idl\\bc_data\\test_baici4_l\\6675_a.txt' ;\u8f93\u5165\u6570\u636e\u4e3aPV,SOIL,NPV,\u53cd\u5c04\u7387<br \/> ; txtname1='D:\\hyperion_paper\\data_idl\\ss_data\\test_ss3_l\\6730_a.txt'<br \/> if file_test(txtname1)then begin<br \/> nLines1=file_lines(txtname1) ;\u83b7\u53d6\u884c<br \/> tmp1=''<br \/> ; \u6253\u5f00\u6587\u4ef6<br \/> openr,lun,txtname1,\/get_lun<br \/> while(~EOF(lun))do begin<br \/> readf,lun,tmp1 ;\u83b7\u53d6\u7b2c\u4e00\u884c<br \/> ;print,tmp1<br \/> ;help,tmp<br \/> var1=strsplit(tmp1,\/extract) ;\u62c6\u5206\u7b2c\u4e00\u884c\u83b7\u53d6\u5217\u6570<br \/> rowNum1=N_elements(var1)<br \/> vararr1=fltarr(rowNum1,nLines1-1) ;\u5b9a\u4e49\u6570\u7ec4(n\uff0cn-1)<br \/> readf,lun,vararr1<br \/> vararr1=[[var1],[vararr1]] ;\u91cd\u65b0\u7ec4\u5408\u6570\u7ec4(n\uff0cn-1)+\u7b2c\u4e00\u884c=\uff08n,n\uff09 over!<br \/> endwhile<br \/> endif<br \/>rmse_aa=0<br \/>;rmse_bb=0<\/p>\n<p>txtname4='D:\\hyperion_paper\\data_idl\\bc_data\\BC_20170511\\BC_3em_kfcls_0516.txt';'D:\\hyperion_paper\\data_idl\\bc_data\\bc_1020_gauss\\pixels_1030\\bc_3em_kfcls_pixel.txt'<br \/>openw,lun3,txtname4,\/get_lun,\/append ;\/append\u8fde\u7eed\u5199\u5165\u51fd\u6570<br \/>printf,lun3,'PV BS NPV (SHADOW) model_RMSE model_rmse(%)'<br \/>;\u767d\u523a\uff0c'PV BS NPV (SHADOW) model_RMSE model_rmse(%)'<br \/>;\u68ad\u68ad 'PV NPV BS (SHADOW) model_RMSE model_rmse(%)'<br \/>;\u767d\u523a\uff0c'PV BS NPV (SHADOW) model_RMSE model_rmse(%)'<br \/>;\u68ad\u68ad 'PV NPV BS (SHADOW) model_RMSE model_rmse(%)'<br \/>IF kernel EQ 0 THEN BEGIN<br \/> printf,lun3,'FCLS_linear',em_num,'EM'<br \/>ENDIF<br \/>IF kernel EQ 1 THEN BEGIN <br \/> printf,lun3,'KFCLS_RBF',em_num,'EM'<br \/> ENDIF<br \/>IF kernel EQ 2 THEN BEGIN <br \/> printf,lun3,'KFCLS_PKF',em_num,'EM' <br \/> ENDIF<br \/> IF kernel EQ 3 THEN BEGIN<br \/> printf,lun3,'FCLS_nnc',em_num,'EM'<br \/> ENDIF<br \/> for sm=0,rowNum-1 do begin <br \/> <br \/> pixels=reform((TRANSPOSE(pixels_group))[sm,*],band_num,1)<br \/> ;\uff1b******************************************************************************************************<br \/> case em_num of<br \/> 3:begin<br \/> pv1=vararr1[sm*em_num+0,*] ;\u83b7\u53d6\u7b2c\u4e00\u5217<br \/> bs1=vararr1[sm*em_num+1,*] ;\u83b7\u53d6\u7b2c\u4e8c\u5217<br \/> npv1=vararr1[sm*em_num+2,*]<br \/> em=transpose([pv1,bs1,npv1])<br \/> ;pixel_lsma_1210,em,pixels,result=result,rmse=rmse ;\u6700\u5c0f\u4e8c\u4e58\u6cd5\uff0c\u6ca1\u6709\u9650\u5236\u6761\u4ef6<br \/> end<br \/> 4:begin<br \/> pv1=vararr1[sm*em_num+0,*] ;\u83b7\u53d6\u7b2c\u4e00\u5217<br \/> bs1=vararr1[sm*em_num+1,*] ;\u83b7\u53d6\u7b2c\u4e8c\u5217<br \/> npv1=vararr1[sm*em_num+2,*]<br \/> shadow1=vararr1[sm*em_num+3,*]<br \/> em=transpose([pv1,bs1,npv1,shadow1])<br \/> end<br \/> endcase<br \/> ;\u9650\u5236\u4e3a1\u7684\uff0c\u975e\u8d1f\u8ba1\u7b97\uff0c\u6240\u6709\u7aef\u5143\u7684\u4e30\u5ea6\u7ed3\u679c\u53caRMSE<br \/> m_num=1<br \/> result_a=fltarr(m_num,em_num)<br \/> rmse_a=fltarr(m_num)<br \/> result_b=fltarr(m_num,em_num)<br \/> rmse_b=fltarr(m_num)<br \/> Error_per=fltarr(m_num)<br \/> estmodel_pix=fltarr(m_num,band_num)<br \/> for nn=0,m_num-1 do begin<br \/>; kernel=1<br \/> ; ;\u9650\u5236\u52a0\u548c\u4e3a1\uff0c\u5e76\u975e\u8d1f<br \/> ; pixel_kfcls_20160314,em,pixels,nb,kernel,result=result,rmse=rmse,R_Error3=R_Error3,pre_pix=pre_pix ;\u9065\u611f\u5b66\u62a5\u91c7\u7528\u7b97\u6cd5<br \/> KFCLS_ncls_Chang_Heinz,em,pixels,nb,kernel,result=result,rmse=rmse,R_Error3=R_Error3,pre_pix=pre_pix<br \/> ; KFCLS_LSOSP_unmixing,em,pixels,kernel,result=result,rmse=rmse<br \/>; FCLS_ncls_Chang_Heinz,em,pixels,nb,result=result,rmse=rmse,R_Error3=R_Error3,pre_pix=pre_pix<br \/> result_a[nn,*]=result<br \/> rmse_a[nn,*]=rmse<br \/> Error_per[nn,*]=R_Error3<br \/> ; for px=0,rowNum-1 do begin <br \/> estmodel_pix[nn,*]=pre_pix<br \/> ; endfor<br \/> ; kernel2=2 <br \/>; pixel_kfcls_20160314,em,pixels,nb,kernel2,result=result,rmse=rmse<br \/>; pixel_fcls_1210,em,pixels,nb,result=result,rmse=rmse,R_Error3=R_Error3,pre_pix=pre_pix<br \/>; result_b=result<br \/>; rmse_b=rmse<br \/>; kernel4=2<br \/>; ; pixel_kfcls_20160314,em[*,(nn*mixem_num):(nn*mixem_num+mixem_num-1)],pixels,nb,kernel2,result=result,rmse=rmse<br \/>; pixel_kfcls_20160314,em,pixels,nb,kernel4,result=result,rmse=rmse<br \/>; result_d=result<br \/>; rmse_d=rmse<br \/>; kernel5=30<br \/>; ; pixel_kfcls_20160314,em[*,(nn*mixem_num):(nn*mixem_num+mixem_num-1)],pixels,nb,kernel2,result=result,rmse=rmse<br \/>; pixel_kfcls_20160314,em,pixels,nb,kernel5,result=result,rmse=rmse<br \/>; result_e=result<br \/>; rmse_e=rmse <br \/> <br \/>; kernel3=1<br \/>; pixel_kfcls_20160314_IGARS,em,pixels,nb,kernel3,result=result,rmse=rmse <br \/>; result_c=result<br \/>; rmse_c=rmse<br \/> endfor<br \/> ;\u8f93\u51fa\u5404\u7aef\u5143\u4e30\u5ea6 \u7ed3\u679c\u77e9\u9635\u53ca\u5404\u6a21\u578b\u9488\u5bf9\u4e00\u4e2a\u6837\u672c\u7684rmse\u77e9\u9635<br \/>; resultall=transpose(result_a)<\/p>\n<p>rmsealla=transpose(rmse_a)<br \/>; rmseallb=transpose(rmse_b)<br \/>; rmseallc=transpose(rmse_c)<br \/>; rmsealld=transpose(rmse_d)<br \/>; rmsealle=transpose(rmse_e)<br \/> ;\u8f93\u51fa\u7ed3\u679c\u4e3a\u4e30\u5ea6 PV BS NPV RMSE<br \/> PRINT,transpose([[result_a],[rmsealla],[Error_per]]);,transpose([[result_b],[rmseallb]]);,$$ ;transpose([[result_c],[rmseallc]]),<br \/> ; transpose([[result_d],[rmsealld]]),transpose([[result_e],[rmsealle]])<br \/> ;PRINT,<\/p>\n<p><br \/> ; writeu,lun,result<br \/> ; printf,lun,'6630' ;\u6539\u540d\u79f0<br \/> ; printf,lun,'PV BS NPV SHADOW RMSE'<br \/> ; printf,lun,t_realresult<br \/> printf,lun3,transpose([[result_a],[rmsealla],[Error_per]]) ;\u9ad8\u65af\u6838\u51fd\u6570\u7ed3\u679c,,<br \/>; printf,lun3,transpose(estmodel_pix),format='(1653f12)' ;\u8f93\u51fa\u7531\u4f30\u7b97\u503c\u8ba1\u7b97\u6240\u5f97\u6a21\u578b\u53cd\u5c04\u7387<br \/>; printf,lun3,transpose([[result_b],[rmseallb]])<br \/>;; printf,lun,transpose([[result_c],[rmseallc]])<br \/> ; printf,lun3,transpose([[result_d],[rmsealld]])<br \/> ; printf,lun3,transpose([[result_e],[rmsealle]])<br \/>rmse_aa=rmse_aa+rmse_a<br \/>;rmse_bb=rmse_bb+rmse_b^2<br \/> <br \/> ;\u6587\u4ef6\u8f93\u51fa\u7ed3\u679c \u4e3a15\u300120\u4e2a\u662f\u4e00\u7ec4\u6570\u636e\u7684\u7ed3\u679c\uff0c\u8fd9\u6837\u4e0b\u4e2a\u7a0b\u5e8f\u53ef\u4ee5\u76f4\u63a5\u8c03\u7528TXT\u6587\u672c\uff0c\u6bcf\u95f4\u9694\u4e00\u5b9a\u6570\u91cf\u884c\u4e3a\u4e00\u7ec4\u65b0\u7684\u5b9e\u9a8c\u7ed3\u679c\u6570\u636e<br \/> endfor<\/p>\n<p>total_rmse_a=total(rmse_aa)\/rowNum<br \/>; total_rmse_b=sqrt(total(rmse_bb)\/rowNum) <br \/> PRINT,total_rmse_a;,total_rmse_b ;RMSE OF MODEL<br \/> free_lun,lun3<br \/>end<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>\n<p>;;;\u57fa\u4e8e\u6838\u51fd\u6570\u7684\u5168\u9650\u5236\u6700\u5c0f\u4e8c\u4e58\u6cd5\u77e9\u9635\u5206\u89e3<br \/>pro pixel_kfcls_20160314,em,pixels,nb,kernel,result=result,rmse=rmse,R_Error3=R_Error3,pre_pix=pre_pix<br \/> ;usage:<br \/> ;pixels:array(npixel,nb),\ufffd\ufffd\u052a\ufffd\ufffd\ufffd\ufffd\ufffd<br \/> ; em:array(n_ems,nb),\ufffd\ufffd\u052a\ufffd\ufffd\ufffd\ufffd\ufffd<br \/> ; nb:\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd<br \/> ;result:array(npixel,n_em),\ufffd\ufffd\u052a\ufffd\ufffd\ufffd\u052a\ufffd\ufffd<br \/> ; rmse:array(npixel)<br \/> COMPILE_OPT idl2<br \/> ;<br \/> M=TRANSPOSE(pixels);(N*nb)<\/p>\n<p>U=TRANSPOSE(em); (n_em*nb)<\/p>\n<p>\u00a0<\/p>\n<p><br \/> IF SIZE(M, \/n_dimensions) NE 2 THEN BEGIN<br \/> mytemp = DIALOG_MESSAGE('U must be 2D data')<br \/> return<br \/> ENDIF<br \/> IF SIZE(U, \/n_dimensions) NE 2 THEN BEGIN<br \/> mytemp = DIALOG_MESSAGE('U must be 2D data')<br \/> return<br \/> ENDIF<\/p>\n<p>dims_U = SIZE(U, \/dimensions)<br \/> dims_M = SIZE(M, \/dimensions)<br \/> ;M \ufffd\ufffd U \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u036c\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd<br \/> ; IF dims_U[1] NE nb THEN BEGIN<br \/> ; mytemp = DIALOG_MESSAGE('The spectral bands of Input endmember is wrong', \/error)<br \/> ; return<br \/> ;ENDIF<br \/> ;IF dims_M[1] NE nb THEN BEGIN<br \/> ; mytemp = DIALOG_MESSAGE('The spectral bands of Input pixels is wrong', \/error)<br \/> ; return<br \/> ;ENDIF<br \/> <br \/> p = dims_M[1] ;\u50cf\u5143\u77e9\u9635\u7684\u884c\u6570<br \/> N = dims_M[0] ;\u50cf\u5143\u77e9\u9635\u7684\u5217\u6570<br \/> q = dims_U[0] ;\u7aef\u5143\u77e9\u9635\u7684\u884c\u6570<br \/> X = FLTARR(N, q) ;\u6c42\u51fa\u77e9\u9635\u7684\u5927\u5c0f<br \/> Mbckp=U<\/p>\n<p>FOR n1=0L,N-1 DO BEGIN<\/p>\n<p>count = q<br \/> done = 0<br \/> ref = INDGEN(q)<\/p>\n<p>r = M[n1,*]<\/p>\n<p>U = Mbckp<\/p>\n<p><br \/> WHILE ~done DO BEGIN<br \/> KWW1=kernel_matrix_kfcls(transpose(U),transpose(U),kernel=kernel);MAKE_ARRAY(q, q, \/INTEGER, VALUE = 1)<br \/> kwv=kernel_matrix_kfcls(transpose(U),transpose(r),kernel=kernel)<\/p>\n<p>; KWW1=KERNEL_GS_F(U,U,kernel)<br \/>; kwv=KERNEL_GS_F(r,U,kernel)<\/p>\n<p>; KWW1=KERNEL_MU_F(U,U)<br \/>; kwv4=KERNEL_MU_F(r,U)<br \/>; Kwv=transpose(kwv4[0,*])<br \/> EME=INV_k(KWW1)<br \/> als_hat =EME##kwv<br \/> ones = INTARR(1,count)<br \/> ones[*,*] = 1<br \/> s = TRANSPOSE(ones)#EME<\/p>\n<p>;\u81ea\u5df1\u5199\u7684\uff0c\u548c\u4e0b\u9762\u91d1\u82f1\u5199\u7684\u7ed3\u679c\u4e0d\u540c\uff0c<br \/>; afcls_hat=als_hat-EME##(kwv-KWW1##als_hat)<br \/> afcls_hat=als_hat-(als_hat#TRANSPOSE(ones)-1)#(INV_k(ones#EME#TRANSPOSE(ones)))#TRANSPOSE(ones)#EME<\/p>\n<p>; \ufffd\ufffd\ufffd\u022b\u03aa\ufffd\ufffd\ufffd\ufffd\u0363\u05b9\ufffd\ufffd<br \/> alpha = FLTARR(1,q)<br \/> IF TOTAL(afcls_hat GT 0) EQ count THEN BEGIN<br \/> alpha[ref] = afcls_hat<br \/> BREAK<br \/> ENDIF<\/p>\n<p>;\ufffd\ufffd\u05b5\u052a\ufffd\u0633\ufffd\ufffd\u0536\ufffd\u04e6\ufffd\ufffds\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u052a\ufffd\ufffd<br \/> ;\ufffd\u04b5\ufffd\ufffd\ufffd\ufffd\ufffdabs(a_ij, s_ij)\ufffd\ufffd \ufffd\ufffdalpha\ufffd\ufffd\ufffd\u01b3\ufffdEntry.<br \/> idx = WHERE(afcls_hat LT 0)<br \/> IF idx[0] LT 0 THEN idx = 0;!null = MIN(afcls_hat, idx)<br \/> afcls_hat[idx] = afcls_hat[idx]\/s[idx]<br \/> maxIdx = (SORT(-ABS(afcls_hat[idx])))[0]<br \/> maxIdx = idx[maxIdx]<br \/> alpha[maxIdx] = 0<br \/> idx_all = INDGEN(1, (SIZE(U, \/dimensions))[0])<br \/> keep = idx_all[WHERE(idx_all NE maxIdx)]<br \/> U = U[keep, *]<br \/> count = count - 1<br \/> IF count EQ 0 THEN BREAK<br \/> ref = ref[keep]<\/p>\n<p>ENDWHILE<\/p>\n<p>X[n1,*] = alpha<\/p>\n<p>endfor<br \/> result=x<br \/> U = Mbckp<br \/> R_Error2 =(x#U-pixels)^2<br \/> RMSE = FLOAT(SQRT(FCLS_MEAN_k(R_Error2, DIMENSION=2)))<\/p>\n<p>R_Error3=mean(abs(X#U-pixels)\/pixels) ;\u8f93\u51fa\u6a21\u578b\u8bef\u5dee\u767e\u5206\u6bd4<br \/> pre_pix=X#U ;\u8f93\u51fa\u4f30\u7b97\u540e\u5404\u6ce2\u6bb5\u53cd\u5c04\u7387\u503c<\/p>\n<p><br \/>end<\/p>\n<p>FUNCTION INV_k, data<\/p>\n<p>;\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd<br \/> COMPILE_OPT idl2<br \/> IF SIZE(data, \/n_dimensions) LT 2 THEN BEGIN<br \/> RETURN, 1\/data<br \/> ENDIF ELSE BEGIN<br \/> RETURN, INVERT(data)<br \/> ENDELSE<\/p>\n<p>END<br \/>FUNCTION FCLS_MEAN_k, X, DIMENSION=dimension, DOUBLE = Double, NAN = nan<\/p>\n<p>COMPILE_OPT idl2, hidden<br \/> ON_ERROR, 2<\/p>\n<p>IF KEYWORD_SET(dimension) THEN BEGIN<br \/> xdims = SIZE(X, \/DIMENSION)<br \/> IF (N_ELEMENTS(dimension) GT 1 || $<br \/> dimension[0] LT 1 || dimension[0] GT N_ELEMENTS(xdims)) THEN BEGIN<br \/> MESSAGE, 'Illegal keyword value for DIMENSION.'<br \/> ENDIF<br \/> IF (KEYWORD_SET(nan)) THEN BEGIN<br \/> nX = TOTAL(~FINITE(x, \/NAN), dimension[0], \/INTEGER)<br \/> ENDIF ELSE BEGIN<br \/> nX = xdims[dimension[0]-1]<br \/> ENDELSE<br \/> RETURN, TOTAL(X, dimension, DOUBLE=double, NAN=nan)\/nX<br \/> ENDIF ELSE BEGIN<br \/> IF (KEYWORD_SET(nan)) THEN BEGIN<br \/> nX = TOTAL(~FINITE(x, \/NAN), \/INTEGER)<br \/> ENDIF ELSE BEGIN<br \/> nX = N_ELEMENTS(x)<br \/> ENDELSE<br \/> RETURN, TOTAL(X, DOUBLE=Double, NAN=nan)\/nX<br \/> ENDELSE<br \/>END<\/p>\n<p>function KERNEL_GS_F,V,W,sigma ;X,Z\u4e3a\u53d8\u91cf\uff0cd\u4e3a\u53c2\u6570<br \/> dims_W= SIZE(W, \/dimensions)<br \/> dims_V= SIZE(V, \/dimensions)<br \/> M=dims_W[0]<br \/> N=dims_v[0]<br \/> VM = FLTARR(M,N)<br \/> for i=0,M-1 DO BEGIN<br \/> for j=0,N-1 DO BEGIN<br \/> VM(i,j)=(NORM(V(j,*)-W(i,*)))^2<br \/> endfor<br \/> endfor<br \/> KVM=EXP(-VM\/(2*(sigma^2)))<br \/> return, KVM<\/p>\n<p>END<\/p>\n<p>function KERNEL_MU_F,V,W ;V,W\u4e3a\u53d8\u91cf,<br \/> ;KVM1=TRANSPOSE(V)##W ;\u7ebf\u6027\u6838\u51fd\u6570<br \/> ; KVM1=TRANSPOSE(V)##W##TRANSPOSE(V)##W ;\u591a\u9879\u5f0f<br \/> KVM1=((TRANSPOSE(V)##W)+1)##(TRANSPOSE(V)##W+1) ;\u591a\u9879\u5f0f\uff0c\u6709\u7684\u6587\u7ae0\u4e2d\u76f4\u63a5\u5e73\u65b9\uff0c\u6709\u7684\u662f4\u4e2a\u77e9\u9635\u76f8\u4e58\uff0c\u4e0d\u786e\u5b9a\u54ea\u79cd\u662f\u5bf9\u7684\u4e86<\/p>\n<p>return,KVM1<br \/>END<\/p>\n<p>function kernel_matrix_kfcls,G1,G2,KERNEL=kernel,GMA=gma,NSCALE=nscale,DEGREE=degree,BIAS=bias<br \/> if n_params() eq 1 then G2 = G1<br \/> if n_elements(nscale) eq 0 then nscale = 1.0<br \/> if n_elements(kernel) eq 0 then kernel = 1<br \/> if n_elements(degree) eq 0 then degree = 2<br \/> if n_elements(bias) eq 0 then bias = 1.0<br \/> case kernel of<br \/> 0: begin;;\u7ebf\u6027\u6838\u51fd\u6570<br \/> gma = 0.0<br \/> return, G1##transpose(G2)<br \/> end<br \/> 1: begin ;\u9ad8\u65af\u6838\u51fd\u6570<br \/> m = n_elements(G1[0,*])<br \/> n = n_elements(G2[0,*])<br \/> K = transpose([total(G1^2,1)])##(intarr(n)+1)<br \/> K = K + transpose(intarr(m)+1)##total(G2^2,1)<br \/> K = K - 2*G1##transpose(G2)<br \/> if n_elements(gma) eq 0 then begin<br \/> scale=60 ;\u76ee\u524d\u8bc1\u660e\u662f\u6700\u4f18\u7684 4EM \u752860\u6700\u597d\uff0c3EM\u752820\u6700\u597d<br \/>; scale = total(sqrt(abs(K)))\/(m^2-m+0.00001)+0.0001<br \/>; nscale=50<br \/> gma = 1\/(2*(nscale*scale)^2)<br \/> endif<br \/> return, exp(-gma*K)<br \/> end<br \/> 2: begin ;\u591a\u9879\u5f0f\u6838\u51fd\u6570<br \/> if n_elements(gma) eq 0 then gma=1.0\/n_elements(G1[*,0])<br \/> return, (gma*G1##transpose(G2)+bias)^2;##(gma*G1##transpose(G2)+bias);^degree<br \/> end<br \/> 3: begin;\u795e\u7ecf\u7f51\u7edc\u6838\u51fd\u6570<br \/> K = G1##transpose(G2)<br \/> if n_elements(gma) eq 0 then gma = 1\/mean(abs(K))<br \/> return, tanh(gma*K+bias)<br \/> end<br \/> endcase<br \/>end<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>","order_id":"0","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>pro test_20160314_KFCLS<br \/> COMPILE_OPT idl2<br \/> envi, \/restore_base_save_files<\/p>\n<p><br \/> ;\uff1b********************************************************************************************************************************<br \/> ;\uff1b********************************************************************************************************************************<br \/>; ;\u9700\u8981\u4fee\u6539 ,\u8bf7\u8f93\u5165method\u65b9\u6cd5\u7ec4\u5408\u6570\u76ee<br \/> em_num=3 ;\u8bf7\u8f93\u5165\u7eaf\u7aef\u5143\u6570\u76ee<br \/> kernel=2;0:\u7ebf\u6027\u6838\u51fd\u6570\uff1b1\uff1a'KFCLS_RBF' :,\u5f84\u5411\u57fa\u51fd\u6570\uff1b2\uff1a'KFCLS_PKF' :,\u591a\u9879\u5f0f\u6838\u51fd\u6570\uff1b3: \u795e\u7ecf\u7f51\u7edc\u6838\u51fd\u6570<br \/>; mixem_num=3 ;\u975e\u7ebf\u6027\u7eaf\u7aef\u5143+\u6df7\u5408\u7aef\u5143\u6570\u76ee<br \/>; band_num=4 ;\u8bf7\u8f93\u5165\u6ce2\u6bb5\u6570\u76ee<br \/> ;\uff1b********************************************************************************************************************************<br \/> ;\uff1b********************************************************************************************************************************<\/p>\n<p>;\u5f00\u59cb\u8bbe\u7f6e\u8def\u5f84\uff0c\u8bfb\u53d6txt(n\u5217\uff0cn\u884c)<br \/>txtname2='D:\\hyperion_paper\\data_idl\\bc_data\\BC_PIXCLE.txt';'D:\\hyperion_paper\\data_idl\\bc_data\\BC_PIXCLE.txt' <br \/> <br \/> if file_test(txtname2)then begin<br \/> nLines2=file_lines(txtname2) ;\u83b7\u53d6\u884c<br \/> tmp2=''<br \/> ; \u6253\u5f00\u6587\u4ef6<br \/> openr,lun2,txtname2,\/get_lun<br \/> while(~EOF(lun2))do begin<br \/> readf,lun2,tmp2 ;\u83b7\u53d6\u7b2c\u4e00\u884c<br \/> ; print,tmp2<br \/> ;help,tmp2<br \/> var2=strsplit(tmp2,\/extract) ;\u62c6\u5206\u7b2c\u4e00\u884c\u83b7\u53d6\u5217\u6570<br \/> rowNum=N_elements(var2)<br \/> vararr2=fltarr(rowNum,nLines2-1) ;\u5b9a\u4e49\u6570\u7ec4(n\uff0cn-1)<br \/> readf,lun2,vararr2<br \/> vararr2=[[var2],[vararr2]] ;\u91cd\u65b0\u7ec4\u5408\u6570\u7ec4(n\uff0cn-1)+\u7b2c\u4e00\u884c=\uff08n,n\uff09 over!<br \/> band_num=N_elements(vararr2[0,*])<br \/> pixels_group=reform(TRANSPOSE(vararr2),band_num,rowNum)<br \/> endwhile<br \/> endif<br \/>txtname1='D:\\hyperion_paper\\data_idl\\bc_data\\3EM_BC_EM.txt';'D:\\hyperion_paper\\data_idl\\bc_data\\3EM_BC_EM.txt' ss_data\\4EM_SS_EM_2.txt ;\u8f93\u5165\u6570\u636e\u4e3aPV,SOIL,NPV,\u53cd\u5c04\u7387,\u7aef\u5143\u6570\u636e\uff0c\u6ce2\u6bb5\u6570*\u7aef\u5143\u6570<br \/>; txtname1='D:\\hyperion_paper\\data_idl\\bc_data\\test_baici4_l\\6675_a.txt' ;\u8f93\u5165\u6570\u636e\u4e3aPV,SOIL,NPV,\u53cd\u5c04\u7387<br \/> ; txtname1='D:\\hyperion_paper\\data_idl\\ss_data\\test_ss3_l\\6730_a.txt'<br \/> if file_test(txtname1)then begin<br \/> nLines1=file_lines(txtname1) ;\u83b7\u53d6\u884c<br \/> tmp1=''<br \/> ; \u6253\u5f00\u6587\u4ef6<br \/> openr,lun,txtname1,\/get_lun<br \/> while(~EOF(lun))do begin<br \/> readf,lun,tmp1 ;\u83b7\u53d6\u7b2c\u4e00\u884c<br \/> ;print,tmp1<br \/> ;help,tmp<br \/> var1=strsplit(tmp1,\/extract) ;\u62c6\u5206\u7b2c\u4e00\u884c\u83b7\u53d6\u5217\u6570<br \/> rowNum1=N_elements(var1)<br \/> vararr1=fltarr(rowNum1,nLines1-1) ;\u5b9a\u4e49\u6570\u7ec4(n\uff0cn-1)<br \/> readf,lun,vararr1<br \/> vararr1=[[var1],[vararr1]] ;\u91cd\u65b0\u7ec4\u5408\u6570\u7ec4(n\uff0cn-1)+\u7b2c\u4e00\u884c=\uff08n,n\uff09 over!<br \/> endwhile<br \/> endif<br \/>rmse_aa=0<br \/>;rmse_bb=0<\/p>\n<p>txtname4='D:\\hyperion_paper\\data_idl\\bc_data\\BC_20170511\\BC_3em_kfcls_0516.txt';'D:\\hyperion_paper\\data_idl\\bc_data\\bc_1020_gauss\\pixels_1030\\bc_3em_kfcls_pixel.txt'<br \/>openw,lun3,txtname4,\/get_lun,\/append ;\/append\u8fde\u7eed\u5199\u5165\u51fd\u6570<br \/>printf,lun3,'PV BS NPV (SHADOW) model_RMSE model_rmse(%)'<br \/>;\u767d\u523a\uff0c'PV BS NPV (SHADOW) model_RMSE model_rmse(%)'<br \/>;\u68ad\u68ad 'PV NPV BS (SHADOW) model_RMSE model_rmse(%)'<br \/>;\u767d\u523a\uff0c'PV BS NPV (SHADOW) model_RMSE model_rmse(%)'<br \/>;\u68ad\u68ad 'PV NPV BS (SHADOW) model_RMSE model_rmse(%)'<br \/>IF kernel EQ 0 THEN BEGIN<br \/> printf,lun3,'FCLS_linear',em_num,'EM'<br \/>ENDIF<br \/>IF kernel EQ 1 THEN BEGIN <br \/> printf,lun3,'KFCLS_RBF',em_num,'EM'<br \/> ENDIF<br \/>IF kernel EQ 2 THEN BEGIN <br \/> printf,lun3,'KFCLS_PKF',em_num,'EM' <br \/> ENDIF<br \/> IF kernel EQ 3 THEN BEGIN<br \/> printf,lun3,'FCLS_nnc',em_num,'EM'<br \/> ENDIF<br \/> for sm=0,rowNum-1 do begin <br \/> <br \/> pixels=reform((TRANSPOSE(pixels_group))[sm,*],band_num,1)<br \/> ;\uff1b******************************************************************************************************<br \/> case em_num of<br \/> 3:begin<br \/> pv1=vararr1[sm*em_num+0,*] ;\u83b7\u53d6\u7b2c\u4e00\u5217<br \/> bs1=vararr1[sm*em_num+1,*] ;\u83b7\u53d6\u7b2c\u4e8c\u5217<br \/> npv1=vararr1[sm*em_num+2,*]<br \/> em=transpose([pv1,bs1,npv1])<br \/> ;pixel_lsma_1210,em,pixels,result=result,rmse=rmse ;\u6700\u5c0f\u4e8c\u4e58\u6cd5\uff0c\u6ca1\u6709\u9650\u5236\u6761\u4ef6<br \/> end<br \/> 4:begin<br \/> pv1=vararr1[sm*em_num+0,*] ;\u83b7\u53d6\u7b2c\u4e00\u5217<br \/> bs1=vararr1[sm*em_num+1,*] ;\u83b7\u53d6\u7b2c\u4e8c\u5217<br \/> npv1=vararr1[sm*em_num+2,*]<br \/> shadow1=vararr1[sm*em_num+3,*]<br \/> em=transpose([pv1,bs1,npv1,shadow1])<br \/> end<br \/> endcase<br \/> ;\u9650\u5236\u4e3a1\u7684\uff0c\u975e\u8d1f\u8ba1\u7b97\uff0c\u6240\u6709\u7aef\u5143\u7684\u4e30\u5ea6\u7ed3\u679c\u53caRMSE<br \/> m_num=1<br \/> result_a=fltarr(m_num,em_num)<br \/> rmse_a=fltarr(m_num)<br \/> result_b=fltarr(m_num,em_num)<br \/> rmse_b=fltarr(m_num)<br \/> Error_per=fltarr(m_num)<br \/> estmodel_pix=fltarr(m_num,band_num)<br \/> for nn=0,m_num-1 do begin<br \/>; kernel=1<br \/> ; ;\u9650\u5236\u52a0\u548c\u4e3a1\uff0c\u5e76\u975e\u8d1f<br \/> ; pixel_kfcls_20160314,em,pixels,nb,kernel,result=result,rmse=rmse,R_Error3=R_Error3,pre_pix=pre_pix ;\u9065\u611f\u5b66\u62a5\u91c7\u7528\u7b97\u6cd5<br \/> KFCLS_ncls_Chang_Heinz,em,pixels,nb,kernel,result=result,rmse=rmse,R_Error3=R_Error3,pre_pix=pre_pix<br \/> ; KFCLS_LSOSP_unmixing,em,pixels,kernel,result=result,rmse=rmse<br \/>; FCLS_ncls_Chang_Heinz,em,pixels,nb,result=result,rmse=rmse,R_Error3=R_Error3,pre_pix=pre_pix<br \/> result_a[nn,*]=result<br \/> rmse_a[nn,*]=rmse<br \/> Error_per[nn,*]=R_Error3<br \/> ; for px=0,rowNum-1 do begin <br \/> estmodel_pix[nn,*]=pre_pix<br \/> ; endfor<br \/> ; kernel2=2 <br \/>; pixel_kfcls_20160314,em,pixels,nb,kernel2,result=result,rmse=rmse<br \/>; pixel_fcls_1210,em,pixels,nb,result=result,rmse=rmse,R_Error3=R_Error3,pre_pix=pre_pix<br \/>; result_b=result<br \/>; rmse_b=rmse<br \/>; kernel4=2<br \/>; ; pixel_kfcls_20160314,em[*,(nn*mixem_num):(nn*mixem_num+mixem_num-1)],pixels,nb,kernel2,result=result,rmse=rmse<br \/>; pixel_kfcls_20160314,em,pixels,nb,kernel4,result=result,rmse=rmse<br \/>; result_d=result<br \/>; rmse_d=rmse<br \/>; kernel5=30<br \/>; ; pixel_kfcls_20160314,em[*,(nn*mixem_num):(nn*mixem_num+mixem_num-1)],pixels,nb,kernel2,result=result,rmse=rmse<br \/>; pixel_kfcls_20160314,em,pixels,nb,kernel5,result=result,rmse=rmse<br \/>; result_e=result<br \/>; rmse_e=rmse <br \/> <br \/>; kernel3=1<br \/>; pixel_kfcls_20160314_IGARS,em,pixels,nb,kernel3,result=result,rmse=rmse <br \/>; result_c=result<br \/>; rmse_c=rmse<br \/> endfor<br \/> ;\u8f93\u51fa\u5404\u7aef\u5143\u4e30\u5ea6 \u7ed3\u679c\u77e9\u9635\u53ca\u5404\u6a21\u578b\u9488\u5bf9\u4e00\u4e2a\u6837\u672c\u7684rmse\u77e9\u9635<br \/>; resultall=transpose(result_a)<\/p>\n<p>rmsealla=transpose(rmse_a)<br \/>; rmseallb=transpose(rmse_b)<br \/>; rmseallc=transpose(rmse_c)<br \/>; rmsealld=transpose(rmse_d)<br \/>; rmsealle=transpose(rmse_e)<br \/> ;\u8f93\u51fa\u7ed3\u679c\u4e3a\u4e30\u5ea6 PV BS NPV RMSE<br \/> PRINT,transpose([[result_a],[rmsealla],[Error_per]]);,transpose([[result_b],[rmseallb]]);,$$ ;transpose([[result_c],[rmseallc]]),<br \/> ; transpose([[result_d],[rmsealld]]),transpose([[result_e],[rmsealle]])<br \/> ;PRINT,<\/p>\n<p><br \/> ; writeu,lun,result<br \/> ; printf,lun,'6630' ;\u6539\u540d\u79f0<br \/> ; printf,lun,'PV BS NPV SHADOW RMSE'<br \/> ; printf,lun,t_realresult<br \/> printf,lun3,transpose([[result_a],[rmsealla],[Error_per]]) ;\u9ad8\u65af\u6838\u51fd\u6570\u7ed3\u679c,,<br \/>; printf,lun3,transpose(estmodel_pix),format='(1653f12)' ;\u8f93\u51fa\u7531\u4f30\u7b97\u503c\u8ba1\u7b97\u6240\u5f97\u6a21\u578b\u53cd\u5c04\u7387<br \/>; printf,lun3,transpose([[result_b],[rmseallb]])<br \/>;; printf,lun,transpose([[result_c],[rmseallc]])<br \/> ; printf,lun3,transpose([[result_d],[rmsealld]])<br \/> ; printf,lun3,transpose([[result_e],[rmsealle]])<br \/>rmse_aa=rmse_aa+rmse_a<br \/>;rmse_bb=rmse_bb+rmse_b^2<br \/> <br \/> ;\u6587\u4ef6\u8f93\u51fa\u7ed3\u679c \u4e3a15\u300120\u4e2a\u662f\u4e00\u7ec4\u6570\u636e\u7684\u7ed3\u679c\uff0c\u8fd9\u6837\u4e0b\u4e2a\u7a0b\u5e8f\u53ef\u4ee5\u76f4\u63a5\u8c03\u7528TXT\u6587\u672c\uff0c\u6bcf\u95f4\u9694\u4e00\u5b9a\u6570\u91cf\u884c\u4e3a\u4e00\u7ec4\u65b0\u7684\u5b9e\u9a8c\u7ed3\u679c\u6570\u636e<br \/> endfor<\/p>\n<p>total_rmse_a=total(rmse_aa)\/rowNum<br \/>; total_rmse_b=sqrt(total(rmse_bb)\/rowNum) <br \/> PRINT,total_rmse_a;,total_rmse_b ;RMSE OF MODEL<br \/> free_lun,lun3<br \/>end<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>\n<p>;;;\u57fa\u4e8e\u6838\u51fd\u6570\u7684\u5168\u9650\u5236\u6700\u5c0f\u4e8c\u4e58\u6cd5\u77e9\u9635\u5206\u89e3<br \/>pro pixel_kfcls_20160314,em,pixels,nb,kernel,result=result,rmse=rmse,R_Error3=R_Error3,pre_pix=pre_pix<br \/> ;usage:<br \/> ;pixels:array(npixel,nb),\ufffd\ufffd\u052a\ufffd\ufffd\ufffd\ufffd\ufffd<br \/> ; em:array(n_ems,nb),\ufffd\ufffd\u052a\ufffd\ufffd\ufffd\ufffd\ufffd<br \/> ; nb:\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd<br \/> ;result:array(npixel,n_em),\ufffd\ufffd\u052a\ufffd\ufffd\ufffd\u052a\ufffd\ufffd<br \/> ; rmse:array(npixel)<br \/> COMPILE_OPT idl2<br \/> ;<br \/> M=TRANSPOSE(pixels);(N*nb)<\/p>\n<p>U=TRANSPOSE(em); (n_em*nb)<\/p>\n<p>\u00a0<\/p>\n<p><br \/> IF SIZE(M, \/n_dimensions) NE 2 THEN BEGIN<br \/> mytemp = DIALOG_MESSAGE('U must be 2D data')<br \/> return<br \/> ENDIF<br \/> IF SIZE(U, \/n_dimensions) NE 2 THEN BEGIN<br \/> mytemp = DIALOG_MESSAGE('U must be 2D data')<br \/> return<br \/> ENDIF<\/p>\n<p>dims_U = SIZE(U, \/dimensions)<br \/> dims_M = SIZE(M, \/dimensions)<br \/> ;M \ufffd\ufffd U \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u036c\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd<br \/> ; IF dims_U[1] NE nb THEN BEGIN<br \/> ; mytemp = DIALOG_MESSAGE('The spectral bands of Input endmember is wrong', \/error)<br \/> ; return<br \/> ;ENDIF<br \/> ;IF dims_M[1] NE nb THEN BEGIN<br \/> ; mytemp = DIALOG_MESSAGE('The spectral bands of Input pixels is wrong', \/error)<br \/> ; return<br \/> ;ENDIF<br \/> <br \/> p = dims_M[1] ;\u50cf\u5143\u77e9\u9635\u7684\u884c\u6570<br \/> N = dims_M[0] ;\u50cf\u5143\u77e9\u9635\u7684\u5217\u6570<br \/> q = dims_U[0] ;\u7aef\u5143\u77e9\u9635\u7684\u884c\u6570<br \/> X = FLTARR(N, q) ;\u6c42\u51fa\u77e9\u9635\u7684\u5927\u5c0f<br \/> Mbckp=U<\/p>\n<p>FOR n1=0L,N-1 DO BEGIN<\/p>\n<p>count = q<br \/> done = 0<br \/> ref = INDGEN(q)<\/p>\n<p>r = M[n1,*]<\/p>\n<p>U = Mbckp<\/p>\n<p><br \/> WHILE ~done DO BEGIN<br \/> KWW1=kernel_matrix_kfcls(transpose(U),transpose(U),kernel=kernel);MAKE_ARRAY(q, q, \/INTEGER, VALUE = 1)<br \/> kwv=kernel_matrix_kfcls(transpose(U),transpose(r),kernel=kernel)<\/p>\n<p>; KWW1=KERNEL_GS_F(U,U,kernel)<br \/>; kwv=KERNEL_GS_F(r,U,kernel)<\/p>\n<p>; KWW1=KERNEL_MU_F(U,U)<br \/>; kwv4=KERNEL_MU_F(r,U)<br \/>; Kwv=transpose(kwv4[0,*])<br \/> EME=INV_k(KWW1)<br \/> als_hat =EME##kwv<br \/> ones = INTARR(1,count)<br \/> ones[*,*] = 1<br \/> s = TRANSPOSE(ones)#EME<\/p>\n<p>;\u81ea\u5df1\u5199\u7684\uff0c\u548c\u4e0b\u9762\u91d1\u82f1\u5199\u7684\u7ed3\u679c\u4e0d\u540c\uff0c<br \/>; afcls_hat=als_hat-EME##(kwv-KWW1##als_hat)<br \/> afcls_hat=als_hat-(als_hat#TRANSPOSE(ones)-1)#(INV_k(ones#EME#TRANSPOSE(ones)))#TRANSPOSE(ones)#EME<\/p>\n<p>; \ufffd\ufffd\ufffd\u022b\u03aa\ufffd\ufffd\ufffd\ufffd\u0363\u05b9\ufffd\ufffd<br \/> alpha = FLTARR(1,q)<br \/> IF TOTAL(afcls_hat GT 0) EQ count THEN BEGIN<br \/> alpha[ref] = afcls_hat<br \/> BREAK<br \/> ENDIF<\/p>\n<p>;\ufffd\ufffd\u05b5\u052a\ufffd\u0633\ufffd\ufffd\u0536\ufffd\u04e6\ufffd\ufffds\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u052a\ufffd\ufffd<br \/> ;\ufffd\u04b5\ufffd\ufffd\ufffd\ufffd\ufffdabs(a_ij, s_ij)\ufffd\ufffd \ufffd\ufffdalpha\ufffd\ufffd\ufffd\u01b3\ufffdEntry.<br \/> idx = WHERE(afcls_hat LT 0)<br \/> IF idx[0] LT 0 THEN idx = 0;!null = MIN(afcls_hat, idx)<br \/> afcls_hat[idx] = afcls_hat[idx]\/s[idx]<br \/> maxIdx = (SORT(-ABS(afcls_hat[idx])))[0]<br \/> maxIdx = idx[maxIdx]<br \/> alpha[maxIdx] = 0<br \/> idx_all = INDGEN(1, (SIZE(U, \/dimensions))[0])<br \/> keep = idx_all[WHERE(idx_all NE maxIdx)]<br \/> U = U[keep, *]<br \/> count = count - 1<br \/> IF count EQ 0 THEN BREAK<br \/> ref = ref[keep]<\/p>\n<p>ENDWHILE<\/p>\n<p>X[n1,*] = alpha<\/p>\n<p>endfor<br \/> result=x<br \/> U = Mbckp<br \/> R_Error2 =(x#U-pixels)^2<br \/> RMSE = FLOAT(SQRT(FCLS_MEAN_k(R_Error2, DIMENSION=2)))<\/p>\n<p>R_Error3=mean(abs(X#U-pixels)\/pixels) ;\u8f93\u51fa\u6a21\u578b\u8bef\u5dee\u767e\u5206\u6bd4<br \/> pre_pix=X#U ;\u8f93\u51fa\u4f30\u7b97\u540e\u5404\u6ce2\u6bb5\u53cd\u5c04\u7387\u503c<\/p>\n<p><br \/>end<\/p>\n<p>FUNCTION INV_k, data<\/p>\n<p>;\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd<br \/> COMPILE_OPT idl2<br \/> IF SIZE(data, \/n_dimensions) LT 2 THEN BEGIN<br \/> RETURN, 1\/data<br \/> ENDIF ELSE BEGIN<br \/> RETURN, INVERT(data)<br \/> ENDELSE<\/p>\n<p>END<br \/>FUNCTION FCLS_MEAN_k, X, DIMENSION=dimension, DOUBLE = Double, NAN = nan<\/p>\n<p>COMPILE_OPT idl2, hidden<br \/> ON_ERROR, 2<\/p>\n<p>IF KEYWORD_SET(dimension) THEN BEGIN<br \/> xdims = SIZE(X, \/DIMENSION)<br \/> IF (N_ELEMENTS(dimension) GT 1 || $<br \/> dimension[0] LT 1 || dimension[0] GT N_ELEMENTS(xdims)) THEN BEGIN<br \/> MESSAGE, 'Illegal keyword value for DIMENSION.'<br \/> ENDIF<br \/> IF (KEYWORD_SET(nan)) THEN BEGIN<br \/> nX = TOTAL(~FINITE(x, \/NAN), dimension[0], \/INTEGER)<br \/> ENDIF ELSE BEGIN<br \/> nX = xdims[dimension[0]-1]<br \/> ENDELSE<br \/> RETURN, TOTAL(X, dimension, DOUBLE=double, NAN=nan)\/nX<br \/> ENDIF ELSE BEGIN<br \/> IF (KEYWORD_SET(nan)) THEN BEGIN<br \/> nX = TOTAL(~FINITE(x, \/NAN), \/INTEGER)<br \/> ENDIF ELSE BEGIN<br \/> nX = N_ELEMENTS(x)<br \/> ENDELSE<br \/> RETURN, TOTAL(X, DOUBLE=Double, NAN=nan)\/nX<br \/> ENDELSE<br \/>END<\/p>\n<p>function KERNEL_GS_F,V,W,sigma ;X,Z\u4e3a\u53d8\u91cf\uff0cd\u4e3a\u53c2\u6570<br \/> dims_W= SIZE(W, \/dimensions)<br \/> dims_V= SIZE(V, \/dimensions)<br \/> M=dims_W[0]<br \/> N=dims_v[0]<br \/> VM = FLTARR(M,N)<br \/> for i=0,M-1 DO BEGIN<br \/> for j=0,N-1 DO BEGIN<br \/> VM(i,j)=(NORM(V(j,*)-W(i,*)))^2<br \/> endfor<br \/> endfor<br \/> KVM=EXP(-VM\/(2*(sigma^2)))<br \/> return, KVM<\/p>\n<p>END<\/p>\n<p>function KERNEL_MU_F,V,W ;V,W\u4e3a\u53d8\u91cf,<br \/> ;KVM1=TRANSPOSE(V)##W ;\u7ebf\u6027\u6838\u51fd\u6570<br \/> ; KVM1=TRANSPOSE(V)##W##TRANSPOSE(V)##W ;\u591a\u9879\u5f0f<br \/> KVM1=((TRANSPOSE(V)##W)+1)##(TRANSPOSE(V)##W+1) ;\u591a\u9879\u5f0f\uff0c\u6709\u7684\u6587\u7ae0\u4e2d\u76f4\u63a5\u5e73\u65b9\uff0c\u6709\u7684\u662f4\u4e2a\u77e9\u9635\u76f8\u4e58\uff0c\u4e0d\u786e\u5b9a\u54ea\u79cd\u662f\u5bf9\u7684\u4e86<\/p>\n<p>return,KVM1<br \/>END<\/p>\n<p>function kernel_matrix_kfcls,G1,G2,KERNEL=kernel,GMA=gma,NSCALE=nscale,DEGREE=degree,BIAS=bias<br \/> if n_params() eq 1 then G2 = G1<br \/> if n_elements(nscale) eq 0 then nscale = 1.0<br \/> if n_elements(kernel) eq 0 then kernel = 1<br \/> if n_elements(degree) eq 0 then degree = 2<br \/> if n_elements(bias) eq 0 then bias = 1.0<br \/> case kernel of<br \/> 0: begin;;\u7ebf\u6027\u6838\u51fd\u6570<br \/> gma = 0.0<br \/> return, G1##transpose(G2)<br \/> end<br \/> 1: begin ;\u9ad8\u65af\u6838\u51fd\u6570<br \/> m = n_elements(G1[0,*])<br \/> n = n_elements(G2[0,*])<br \/> K = transpose([total(G1^2,1)])##(intarr(n)+1)<br \/> K = K + transpose(intarr(m)+1)##total(G2^2,1)<br \/> K = K - 2*G1##transpose(G2)<br \/> if n_elements(gma) eq 0 then begin<br \/> scale=60 ;\u76ee\u524d\u8bc1\u660e\u662f\u6700\u4f18\u7684 4EM \u752860\u6700\u597d\uff0c3EM\u752820\u6700\u597d<br \/>; scale = total(sqrt(abs(K)))\/(m^2-m+0.00001)+0.0001<br \/>; nscale=50<br \/> gma = 1\/(2*(nscale*scale)^2)<br \/> endif<br \/> return, exp(-gma*K)<br \/> end<br \/> 2: begin ;\u591a\u9879\u5f0f\u6838\u51fd\u6570<br \/> if n_elements(gma) eq 0 then gma=1.0\/n_elements(G1[*,0])<br \/> return, (gma*G1##transpose(G2)+bias)^2;##(gma*G1##transpose(G2)+bias);^degree<br \/> end<br \/> 3: begin;\u795e\u7ecf\u7f51\u7edc\u6838\u51fd\u6570<br \/> K = G1##transpose(G2)<br \/> if n_elements(gma) eq 0 then gma = 1\/mean(abs(K))<br \/> return, tanh(gma*K+bias)<br \/> end<br \/> endcase<br \/>end<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>"},"is_project":0},{"component_id":"919521","previous_id":"919520","original_id":"0","guid":"B58CF66AF5ED45E783A0D3B6436313D7","previous_guid":"A91F85C5449A4C269792A75697C23071","component_type_id":"6","data_id":"0","data":"Linear and  Kernel Nonlinear Spectral Mixture Model  unmixing  IDL  CODE","order_id":"1","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Linear and  Kernel Nonlinear Spectral Mixture Model  unmixing  IDL  CODE"},"is_project":0}]},{"id":"557020","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"F21C4909530D44CBA1B403312C0D225F","previous_guid":"A28ACEA9B4D04F609758294978315004","previous_id":"556914","last_modified":"1496569801","components":[{"component_id":"919728","previous_id":0,"original_id":"0","guid":"31ADF913F72D42E896849FA04E32BAB2","previous_guid":null,"component_type_id":"1","data_id":"0","data":"<p>In cases where accurate ground reference data are available, the quality of the sub-pixel abundance estimates can be assessed more reliably by checking the discrepancy between the estimated and reference endmember fractions. The spectral mixture model fit was checked by using the unmixing error of the spectral mixture model, the PV\/NPV\/BS\/shadow ground validation RMSE , the R2 , and the Relative RMSE (RRMSE) . The use of the RMSE of the spectral mixture model is mainly aimed at validating the accuracy of the model in unmixing the mixture spectral. The RMSE of endmembers was calculated to quantify the difference between the measured fraction and estimated fraction for the fields. RRMSE is a measure of the deviation rate with percent as the unit, and values closer to zero are indicative of a better fit.\u00a0<\/p>","order_id":"0","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>In cases where accurate ground reference data are available, the quality of the sub-pixel abundance estimates can be assessed more reliably by checking the discrepancy between the estimated and reference endmember fractions. The spectral mixture model fit was checked by using the unmixing error of the spectral mixture model, the PV\/NPV\/BS\/shadow ground validation RMSE , the R2 , and the Relative RMSE (RRMSE) . The use of the RMSE of the spectral mixture model is mainly aimed at validating the accuracy of the model in unmixing the mixture spectral. The RMSE of endmembers was calculated to quantify the difference between the measured fraction and estimated fraction for the fields. RRMSE is a measure of the deviation rate with percent as the unit, and values closer to zero are indicative of a better fit.\u00a0<\/p>"},"is_project":0},{"component_id":"919727","previous_id":"919728","original_id":"0","guid":"349AE71EF5C9496194EBA0C66A996D6B","previous_guid":"31ADF913F72D42E896849FA04E32BAB2","component_type_id":"6","data_id":"0","data":"Evaluate unmixing  Accuracy","order_id":"1","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Evaluate unmixing  Accuracy"},"is_project":0}]}]}