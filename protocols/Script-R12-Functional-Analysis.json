{"uri":"Script-R12-Functional-Analysis-ejibcke","version_id":"0","protocol_name":"Script R12: Functional Analysis","protocol_name_html":"Script R12: Functional Analysis","is_prepublished":"0","can_edit":"0","parent_id":null,"api_version":"2","is_new_mode":"1","last_modified":"1510247633","type_id":"1","link":"http:\/\/mbio.asm.org\/content\/6\/5\/e01578-15.full","fork_id":"","public_fork_note":"","number_of_steps":"18","has_versions":"0","first_published_date":"1457616442","publish_date":"2016-03-11 03:00:15","documents":"null","have_protocol_in_step":"0","is_protocol_in_step":"0","vendor_name":"Contributed by users","vendor_link":"https:\/\/www.protocols.io","vendor_logo":"\/img\/vendors\/1.png","mod_mins":"-45","mod_secs":"1","description":"<p>This protocol\u00a0outlines the analysis used to plot KEGG functional annotation.<\/p>","is_bookmarked":"0","can_reassign":"1","before_start":"Supplemental information available at:<br \/><br \/><a href=\"https:\/\/figshare.com\/articles\/The_Human_Skin_dsDNA_Virome_Topographical_and_Temporal_Diversity_Genetic_Enrichment_and_Dynamic_Associations_with_the_Host_Microbiome\/1281248\" target=\"_blank\">https:\/\/figshare.com\/articles\/The_Human_Skin_dsDNA_Virome_Topographical_and_Temporal_Diversity_Genetic_Enrichment_and_Dynamic_Associations_with_the_Host_Microbiome\/1281248<\/a>","has_guidelines":"1","materials":[],"warning":"","version_class":"2378","public":"1","is_owner":"1","is_original_owner":"1","created_on":"1455653422","protocol_affiliation":"DEPARTMENT OF DERMATOLOGY UNIVERSITY OF PENNSYLVANIA","affiliation":"Merck Research Labs","doi":"dx.doi.org\/10.17504\/protocols.io.ejibcke","doi_status":"2","changed_fork_steps":null,"profile_url":"Geoffrey-w2y254v2q2","protocol_img":"https:\/\/www.protocols.io\/img\/default_protocol.png","profile_image":"https:\/\/s3.amazonaws.com\/pr-journal\/cpedy2n.jpg","full_name":"Geoffrey Hannigan","created_by":"Geoffrey Hannigan","private_link":"CA813D539F9F780A95E4B983C75C278F","original_img":"1","username":"geoffrey-hannigan","is_retracted":"0","retraction_reason":null,"plos_id":null,"manuscript_citation":null,"journal_name":null,"is_donations_disabled":"0","is_donations_disabled_by_user":"9","item_record_id":226793,"fork_info":[],"compare_forks":[],"protocols":[],"groups":[{"group_id":"45","group_uri":"verve-net","group_name":"VERVE Net","group_logo":"https:\/\/s3.amazonaws.com\/pr-journal\/cdqcwwe.png","requested_uid":null,"request_flag":null,"my_request":"1"},{"group_id":"138","group_uri":"club-grice","group_name":"Club Grice","group_logo":"https:\/\/s3.amazonaws.com\/pr-journal\/cp7dzme.png","requested_uid":null,"request_flag":null,"my_request":"1"}],"number_of_shared_runs":[],"ownership_history":[],"keywords":"","transfer_to_user":[],"sub_transfer":false,"is_transfer_pending":false,"number_of_bookmarks":"0","collections":[{"protocol_name":"The Human Skin dsDNA Virome: Topographical and Temporal Diversity, Genetic Enrichment, and its Dynamic Associations with the Host Microbiome","protocol_name_html":"The Human Skin dsDNA Virome: Topographical and Temporal Diversity, Genetic Enrichment, and its Dynamic Associations with the Host Microbiome","uri":"The-Human-Skin-dsDNA-Virome-Topographical-and-Temp-ekubcww","username":"geoffrey-hannigan","profile_image":"https:\/\/s3.amazonaws.com\/pr-journal\/cpedy2n.jpg","protocol_img":"https:\/\/www.protocols.io\/img\/default_protocol.png","full_name":"Geoffrey Hannigan"}],"tags":[],"archived":0,"sub_authors":[],"sub_protocols_number":0,"can_edit_shared":0,"shared_runs":[],"is_shared_run":0,"is_shared":1,"banner":null,"contact_badges":[{"badge_id":"4","badge_image":"\/img\/badges\/gold.svg","badge_description":"Gold power author!"},{"badge_id":"5","badge_image":"\/img\/badges\/earlyadopter.svg","badge_description":"Early adopter"},{"badge_id":"6","badge_image":"\/img\/badges\/socialbutterfly.svg","badge_description":"Social butterfly"}],"number_of_comments":0,"is_locked":0,"is_locked_by":false,"authors":"HANNIGAN GD, GRICE EA, ET AL.","authors_list":[{"name":"HANNIGAN GD","affiliation":"DEPARTMENT OF DERMATOLOGY UNIVERSITY OF PENNSYLVANIA","username":null,"profile_image":null},{"name":" GRICE EA","affiliation":"DEPARTMENT OF DERMATOLOGY UNIVERSITY OF PENNSYLVANIA","username":null,"profile_image":null},{"name":" ET AL.","affiliation":"DEPARTMENT OF DERMATOLOGY UNIVERSITY OF PENNSYLVANIA","username":null,"profile_image":null}],"user":{"profile_image":"https:\/\/s3.amazonaws.com\/pr-journal\/cpedy2n.jpg","username":"geoffrey-hannigan","full_name":"Geoffrey Hannigan","created_by":"Geoffrey Hannigan"},"access":{"can_view":"1","can_remove":"0","can_add":"0","can_edit":0,"can_publish":0,"can_get_doi":0,"can_share":"0","can_move":"1","can_transfer":"1","can_download":"1","is_locked":"0"},"is_contact_suspended":0,"guidelines":"<span class=\"identifier\">sessionInfo<\/span><span class=\"paren\">(<\/span><span class=\"paren\">)<br \/><br \/>## R version 3.2.0 (2015-04-16) <br \/>## Platform: x86_64-apple-darwin13.4.0 (64-bit) <br \/>## Running under: OS X 10.10.4 (Yosemite) <br \/>## ## locale: <br \/>## [1] en_US.UTF-8\/en_US.UTF-8\/en_US.UTF-8\/C\/en_US.UTF-8\/en_US.UTF-8 <br \/>## <br \/>## attached base packages: <br \/>## [1] stats graphics grDevices utils datasets methods base <br \/>## <br \/>## loaded via a namespace (and not attached): <br \/>## [1] magrittr_1.5 \u00a0 \u00a0formatR_1.2 \u00a0 \u00a0tools_3.2.0 \u00a0 \u00a0htmltools_0.2.6 <br \/>## [5] yaml_2.1.13 \u00a0 \u00a0stringi_0.4-1 \u00a0 \u00a0rmarkdown_0.7 \u00a0 \u00a0knitr_1.10.5 <br \/>## [9] stringr_1.0.0 \u00a0 \u00a0digest_0.6.8 \u00a0 \u00a0evaluate_0.7<\/span>","status_id":"1","is_research":"1","status_info":null,"steps":[{"id":"142854","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"CDE7F8530461404EBB4282657733C30C","previous_guid":null,"previous_id":"0","last_modified":"1502718729","components":[{"component_id":"978114","previous_id":0,"original_id":"0","guid":"FEB77DFBF44F4E158FB0DC5A32AE8D84","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"150808","previous_id":"978114","original_id":"0","guid":"A8FCC6DFD2A14203BF419E0AB055E954","previous_guid":"FEB77DFBF44F4E158FB0DC5A32AE8D84","component_type_id":"1","data_id":"0","data":"Load the required libraries.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Load the required libraries."},"is_project":0},{"component_id":"150834","previous_id":"150808","original_id":"0","guid":"3226DE71CF56428083E36F93EE60CDCC","previous_guid":"A8FCC6DFD2A14203BF419E0AB055E954","component_type_id":"15","data_id":"924","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"library(\"plyr\")\npackageVersion(\"plyr\")\n\nlibrary(\"gplots\")\n\npackageVersion(\"gplots\")","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0},{"component_id":"150876","previous_id":"150834","original_id":"0","guid":"F56F7B2A66344499ADE92FCE9120D56E","previous_guid":"3226DE71CF56428083E36F93EE60CDCC","component_type_id":"17","data_id":"195","data":"<pre><code>## [1] '1.8.2'<\/code><\/pre>\n<pre class=\"r\">\u00a0<\/pre>","order_id":"3","name":"Expected result","data_by_id":"1","type_id":"17","source_data":{"result":"<pre><code>## [1] '1.8.2'<\/code><\/pre>\n<pre class=\"r\">\u00a0<\/pre>"},"is_project":0},{"component_id":"150877","previous_id":"150876","original_id":"0","guid":"1629204F3FB342708E48653856F149E1","previous_guid":"F56F7B2A66344499ADE92FCE9120D56E","component_type_id":"17","data_id":"196","data":"## <br \/>## Attaching package: 'gplots' <br \/>## <br \/>## The following object is masked from 'package:stats': <br \/>## <br \/>## lowess","order_id":"4","name":"Expected result","data_by_id":"1","type_id":"17","source_data":{"result":"## <br \/>## Attaching package: 'gplots' <br \/>## <br \/>## The following object is masked from 'package:stats': <br \/>## <br \/>## lowess"},"is_project":0},{"component_id":"150878","previous_id":"150877","original_id":"0","guid":"053A9C205A5449B7B06F8EC29495370A","previous_guid":"1629204F3FB342708E48653856F149E1","component_type_id":"17","data_id":"197","data":"<pre><code>## [1] '2.17.0'<\/code><\/pre>\n<pre class=\"r\">\u00a0<\/pre>","order_id":"5","name":"Expected result","data_by_id":"1","type_id":"17","source_data":{"result":"<pre><code>## [1] '2.17.0'<\/code><\/pre>\n<pre class=\"r\">\u00a0<\/pre>"},"is_project":0}]},{"id":"142866","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"DD4ACCE0A8AA4D9D9A16142E6880B94B","previous_guid":"CDE7F8530461404EBB4282657733C30C","previous_id":"142854","last_modified":"1502718729","components":[{"component_id":"978115","previous_id":0,"original_id":"0","guid":"E5B6DCAA224844089C8CEACFFB345EC8","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"150839","previous_id":"978115","original_id":"0","guid":"08C102DF1CAC481180BD149916CC5574","previous_guid":"E5B6DCAA224844089C8CEACFFB345EC8","component_type_id":"1","data_id":"0","data":"Read in the metadata.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Read in the metadata."},"is_project":0},{"component_id":"150840","previous_id":"150839","original_id":"0","guid":"572D62A7F9E74D30868F6E9C0D60E2A0","previous_guid":"08C102DF1CAC481180BD149916CC5574","component_type_id":"15","data_id":"925","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"metadata<-read.delim(\"..\/..\/IntermediateOutput\/Mapping_files\/SkinMet_and_Virome_001_metadata.tsv\")\nmetadata$NexteraXT_SampleID<-as.character(metadata$NexteraXT_SampleID)\nmetadata$NexteraXT_Virome_SampleID<-as.character(metadata$NexteraXT_Virome_SampleID)\nmetadata<-metadata[,c(\"NexteraXT_SampleID\", \"NexteraXT_Virome_SampleID\", \"SubjectID\", \"TimePoint\", \"Site_Symbol\")]\nmetadata<-subset(metadata, metadata$NexteraXT_SampleID != \"NA\")\nmetadata<-subset(metadata, metadata$NexteraXT_Virome_SampleID != \"NA\")\nmetadata<-subset(metadata, metadata$TimePoint != 1)\nmetadata<-subset(metadata, !(metadata$SubjectID %in% c(2,3,9,11)))\nmetadata<-subset(metadata, !(metadata$Site_Symbol %in% c(\"Neg\", \"Vf\", \"Ba\", \"Ph\")))","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"142867","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"E0A8353692DC457197FFA19FB773D841","previous_guid":"DD4ACCE0A8AA4D9D9A16142E6880B94B","previous_id":"142866","last_modified":"1502718729","components":[{"component_id":"978116","previous_id":0,"original_id":"0","guid":"4B4E4E23DDB542B1A9300BD1DF01DB57","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"150841","previous_id":"978116","original_id":"0","guid":"98CD14E70F334E41BF97505F918D5468","previous_guid":"4B4E4E23DDB542B1A9300BD1DF01DB57","component_type_id":"1","data_id":"0","data":"Import the tab delimited file containing the output from HUMAnN.\u00a0Read in the data for the whole metagenome and standardize sample ID's.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Import the tab delimited file containing the output from HUMAnN.\u00a0Read in the data for the whole metagenome and standardize sample ID's."},"is_project":0},{"component_id":"150842","previous_id":"150841","original_id":"0","guid":"9699DCDBE6F742EE883AA81E69C0A55E","previous_guid":"98CD14E70F334E41BF97505F918D5468","component_type_id":"26","data_id":"10299","data":"","order_id":"2","name":"Note","data_by_id":"1","type_id":"26","source_data":{"annotation_id":"10299","thread_id":"10299","id":"10299","thread_title":"Annotation on step 3 of Script R12: Functional Analysis","uri":"annotation-on-step-3-of-script-r12-functional-analysis","thread_uri":"annotation-on-step-3-of-script-r12-functional-analysis","step_id":"142867","protocol_uri":"Script-R12-Functional-Analysis-ejibcke","protocol_name":"Script R12: Functional Analysis","protocol_name_html":"Script R12: Functional Analysis","annotation":"This file was generated using the shell script &lt;&gt;.","thread_text":"This file was generated using the shell script &lt;&gt;.","body":"This file was generated using the shell script &lt;&gt;.","is_private":"0","public_protocol":"1","can_edit":0,"can_delete":"0","show_name":"0","created_date":"1455654778","created_on":"1455654778","modified_on":"1457538480","last_updated":"1457538480","profile_image":"https:\/\/s3.amazonaws.com\/pr-journal\/cpedy2n.jpg","full_name":"Geoffrey Hannigan","affiliation":"Merck Research Labs","username":"geoffrey-hannigan","email":"hanni035@d.umn.edu","pa_useranme":"geoffrey-hannigan","comments":[]},"is_project":0},{"component_id":"150843","previous_id":"150842","original_id":"0","guid":"400B5DEEA5244BB384002B9F2986AFA0","previous_guid":"9699DCDBE6F742EE883AA81E69C0A55E","component_type_id":"15","data_id":"926","data":null,"order_id":"3","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"mpm.s<-read.delim(\"..\/..\/IntermediateOutput\/KEGG_humann\/04b-hit-keg-mpm-cop-nul-nve-nve-skinmet.txt\")\ncolnames(mpm.s)<-gsub(colnames(mpm.s),pattern=\"_R1_trimmed_subsampled_blastx\",replacement=\"\")\ncolnames(mpm.s)<-gsub(colnames(mpm.s),pattern=\".hit.keg.mpm.cop.nul.nve.nve\",replacement=\"\")","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"142868","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"86414BF5230147949885BADFD7AD99B6","previous_guid":"E0A8353692DC457197FFA19FB773D841","previous_id":"142867","last_modified":"1502718729","components":[{"component_id":"978117","previous_id":0,"original_id":"0","guid":"6B5DA66BCAF54C83A85E661CE39B8152","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"150844","previous_id":"978117","original_id":"0","guid":"3EB54F1595014961BA8FA90D0740349D","previous_guid":"6B5DA66BCAF54C83A85E661CE39B8152","component_type_id":"1","data_id":"0","data":"Read in data for the virome and standardize sample ID's.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Read in data for the virome and standardize sample ID's."},"is_project":0},{"component_id":"150845","previous_id":"150844","original_id":"0","guid":"BA7457BA05FE4AEC92C6F1CD6A07C911","previous_guid":"3EB54F1595014961BA8FA90D0740349D","component_type_id":"15","data_id":"927","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"mpm.v<-read.delim(\"..\/..\/IntermediateOutput\/KEGG_humann\/04b-hit-keg-mpm-cop-nul-nve-nve-virome.txt\")\ncolnames(mpm.v)<-gsub(colnames(mpm.v),pattern=\"_R1_blastx\",replacement=\"\")\ncolnames(mpm.v)<-gsub(colnames(mpm.v),pattern=\".hit.keg.mpm.cop.nul.nve.nve\",replacement=\"\")","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"142869","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"6C36EE11D5EF4A7A9B465F448CD0FECE","previous_guid":"86414BF5230147949885BADFD7AD99B6","previous_id":"142868","last_modified":"1502718729","components":[{"component_id":"978118","previous_id":0,"original_id":"0","guid":"F200965E7B0B4DA4917290A2AF5A1E39","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"150846","previous_id":"978118","original_id":"0","guid":"119F642EC0D84A81BC9532906198EE09","previous_guid":"F200965E7B0B4DA4917290A2AF5A1E39","component_type_id":"1","data_id":"0","data":"The data has information in the first 17 rows that we are not going to use. It needs to be formatted for downstream analysis. The last column is also a mock community sample, which we need to remove.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"The data has information in the first 17 rows that we are not going to use. It needs to be formatted for downstream analysis. The last column is also a mock community sample, which we need to remove."},"is_project":0},{"component_id":"150847","previous_id":"150846","original_id":"0","guid":"B60CDEF2A12B47268F1050BB672EA9FF","previous_guid":"119F642EC0D84A81BC9532906198EE09","component_type_id":"15","data_id":"928","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"#remove unnecessary information\nmpm.s<-mpm.s[-c(1:17),-ncol(mpm.s)]\nmpm.v<-mpm.v[-c(1:17),-ncol(mpm.v)]","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"142870","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"DA3F57E8CE58406C9E1CC39EBC1078A8","previous_guid":"6C36EE11D5EF4A7A9B465F448CD0FECE","previous_id":"142869","last_modified":"1502718729","components":[{"component_id":"978119","previous_id":0,"original_id":"0","guid":"CF399E5117BB4CDE83DE3EBE7E07D4C2","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"150848","previous_id":"978119","original_id":"0","guid":"7793F2B1BA6C4281AE8BE9F9AD39106A","previous_guid":"CF399E5117BB4CDE83DE3EBE7E07D4C2","component_type_id":"1","data_id":"0","data":"Keep only paired samples.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Keep only paired samples."},"is_project":0},{"component_id":"150849","previous_id":"150848","original_id":"0","guid":"74B50030290545169D2E2DDB564E18D0","previous_guid":"7793F2B1BA6C4281AE8BE9F9AD39106A","component_type_id":"15","data_id":"929","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"metadata<-subset(metadata, metadata$NexteraXT_SampleID %in% colnames(mpm.s))\nmetadata<-subset(metadata, metadata$NexteraXT_Virome_SampleID %in% colnames(mpm.v))\nmpm.s<-mpm.s[, colnames(mpm.s) %in% c(metadata$NexteraXT_SampleID, \"ID\",\"NAME\")]\nmpm.v<-mpm.v[, colnames(mpm.v) %in% c(metadata$NexteraXT_Virome_SampleID, \"ID\",\"NAME\")]","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"142871","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"94A088C38502456B9184AA1BFFB054B4","previous_guid":"DA3F57E8CE58406C9E1CC39EBC1078A8","previous_id":"142870","last_modified":"1502718729","components":[{"component_id":"978120","previous_id":0,"original_id":"0","guid":"1543FB3513A0466095F6E4BE5E6A5199","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"150850","previous_id":"978120","original_id":"0","guid":"278FFD339ADE47A388F2B9832E756D9D","previous_guid":"1543FB3513A0466095F6E4BE5E6A5199","component_type_id":"1","data_id":"0","data":"Merge whole metagenome and virome output.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Merge whole metagenome and virome output."},"is_project":0},{"component_id":"150851","previous_id":"150850","original_id":"0","guid":"9945830BE1814A6CAC51FCF015E0C0D2","previous_guid":"278FFD339ADE47A388F2B9832E756D9D","component_type_id":"15","data_id":"930","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"mpm<-merge(mpm.s, mpm.v, by=c(\"ID\",\"NAME\"))","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"142872","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"D2D3EFE393184E6BBFF5A48ABBC5E432","previous_guid":"94A088C38502456B9184AA1BFFB054B4","previous_id":"142871","last_modified":"1502718729","components":[{"component_id":"978121","previous_id":0,"original_id":"0","guid":"1E262B3FA3E94F1587F0DF5D856627B5","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"150852","previous_id":"978121","original_id":"0","guid":"0794E1CA777540148B76C71CC3B144B1","previous_guid":"1E262B3FA3E94F1587F0DF5D856627B5","component_type_id":"1","data_id":"0","data":"Looking at the KEGG modules, we see they are very specific. We want to categorize them at a higher level.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Looking at the KEGG modules, we see they are very specific. We want to categorize them at a higher level."},"is_project":0}]},{"id":"142873","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"F500077AF681419A83ED96395E0A25E6","previous_guid":"D2D3EFE393184E6BBFF5A48ABBC5E432","previous_id":"142872","last_modified":"1502718729","components":[{"component_id":"978122","previous_id":0,"original_id":"0","guid":"A08AD198CC994C6C8664FBF68CA11371","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"150853","previous_id":"978122","original_id":"0","guid":"3D4F7CA56C1F4EEBB8723AC936DE6F6F","previous_guid":"A08AD198CC994C6C8664FBF68CA11371","component_type_id":"1","data_id":"0","data":"Read in the level information.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Read in the level information."},"is_project":0},{"component_id":"150854","previous_id":"150853","original_id":"0","guid":"DE51E9AF0F4E4B60844E58B691F3034F","previous_guid":"3D4F7CA56C1F4EEBB8723AC936DE6F6F","component_type_id":"26","data_id":"10300","data":"","order_id":"2","name":"Note","data_by_id":"1","type_id":"26","source_data":{"annotation_id":"10300","thread_id":"10300","id":"10300","thread_title":"Annotation on step 9 of Script R12: Functional Analysis","uri":"annotation-on-step-9-of-script-r12-functional-analysis","thread_uri":"annotation-on-step-9-of-script-r12-functional-analysis","step_id":"142873","protocol_uri":"Script-R12-Functional-Analysis-ejibcke","protocol_name":"Script R12: Functional Analysis","protocol_name_html":"Script R12: Functional Analysis","annotation":"I originally downloaed this information from http:\/\/www.genome.jp\/kegg-bin\/ and clicked \"Download htext\". This gave me the file ko00002.keg which I parsed to get level C information.","thread_text":"I originally downloaed this information from http:\/\/www.genome.jp\/kegg-bin\/ and clicked \"Download htext\". This gave me the file ko00002.keg which I parsed to get level C information.","body":"I originally downloaed this information from http:\/\/www.genome.jp\/kegg-bin\/ and clicked \"Download htext\". This gave me the file ko00002.keg which I parsed to get level C information.","is_private":"0","public_protocol":"1","can_edit":0,"can_delete":"0","show_name":"0","created_date":"1455654778","created_on":"1455654778","modified_on":"1457538480","last_updated":"1457538480","profile_image":"https:\/\/s3.amazonaws.com\/pr-journal\/cpedy2n.jpg","full_name":"Geoffrey Hannigan","affiliation":"Merck Research Labs","username":"geoffrey-hannigan","email":"hanni035@d.umn.edu","pa_useranme":"geoffrey-hannigan","comments":[]},"is_project":0},{"component_id":"150855","previous_id":"150854","original_id":"0","guid":"60BEDC6A586A43E89104D7530D217FFC","previous_guid":"DE51E9AF0F4E4B60844E58B691F3034F","component_type_id":"15","data_id":"931","data":null,"order_id":"3","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"factor(mpm$NAME[1:5])\n\nmpm_levelC <- read.delim(\"~\/Club_Grice\/reference\/mpm_levelC.txt\",header=F,colClasses=c(\"character\", \"character\"))\ncolnames(mpm_levelC)=c('C','ID')\nmpm_labs<-mpm[,c(1,2)]\nmpm_levels<-merge(mpm_levelC,mpm_labs)","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0},{"component_id":"150856","previous_id":"150855","original_id":"0","guid":"0B97BAE5F7B24F3D9D9D07EE986A7745","previous_guid":"60BEDC6A586A43E89104D7530D217FFC","component_type_id":"17","data_id":"193","data":"## [1] M00001: Glycolysis (Embden-Meyerhof pathway), glucose =&gt; pyruvate <br \/>## [2] M00002: Glycolysis, core module involving three-carbon compounds <br \/>## [3] M00003: Gluconeogenesis, oxaloacetate =&gt; fructose-6P <br \/>## [4] M00004: Pentose phosphate pathway (Pentose phosphate cycle) <br \/>## [5] M00006: Pentose phosphate pathway, oxidative phase, glucose 6P =&gt; ribulose 5P <br \/>## 5 Levels: M00001: Glycolysis (Embden-Meyerhof pathway), glucose =&gt; pyruvate ...","order_id":"4","name":"Expected result","data_by_id":"1","type_id":"17","source_data":{"result":"## [1] M00001: Glycolysis (Embden-Meyerhof pathway), glucose =&gt; pyruvate <br \/>## [2] M00002: Glycolysis, core module involving three-carbon compounds <br \/>## [3] M00003: Gluconeogenesis, oxaloacetate =&gt; fructose-6P <br \/>## [4] M00004: Pentose phosphate pathway (Pentose phosphate cycle) <br \/>## [5] M00006: Pentose phosphate pathway, oxidative phase, glucose 6P =&gt; ribulose 5P <br \/>## 5 Levels: M00001: Glycolysis (Embden-Meyerhof pathway), glucose =&gt; pyruvate ..."},"is_project":0}]},{"id":"142874","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"4BABE093B43E4C3FB4DC0BB05C088073","previous_guid":"F500077AF681419A83ED96395E0A25E6","previous_id":"142873","last_modified":"1502718730","components":[{"component_id":"978123","previous_id":0,"original_id":"0","guid":"5D20A699D5824F9BB53642380D0EDE75","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"150857","previous_id":"978123","original_id":"0","guid":"93F36BE32DFA4475B1BCB8FE4F9A29E0","previous_guid":"5D20A699D5824F9BB53642380D0EDE75","component_type_id":"1","data_id":"0","data":"Aggregate modules that are in the same higher level.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Aggregate modules that are in the same higher level."},"is_project":0},{"component_id":"150858","previous_id":"150857","original_id":"0","guid":"62F99DCCD9B442F0941DBF2902D57EBF","previous_guid":"93F36BE32DFA4475B1BCB8FE4F9A29E0","component_type_id":"15","data_id":"932","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"mpm_levs<-merge(mpm_levels, mpm, by=c(\"NAME\",\"ID\"))\nmpm_levs$ID<-NULL\nmpm_levs$NAME<-NULL\nmpm_levs[]<-lapply(mpm_levs,function(x) type.convert(as.character(x)))\nmpm_agg<-aggregate(mpm_levs[,-1], by=list(mpm_levs$C), FUN=sum)\nrow.names(mpm_agg)<-mpm_agg$Group.1\nmpm_agg$Group.1<-NULL","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"142875","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"A0AD815ACFB7421895CF06C478973FD2","previous_guid":"4BABE093B43E4C3FB4DC0BB05C088073","previous_id":"142874","last_modified":"1502718730","components":[{"component_id":"978124","previous_id":0,"original_id":"0","guid":"24B5656EFB6F4F598868444525445CD3","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"150859","previous_id":"978124","original_id":"0","guid":"02E3645DFDEE4B3E8A1A736EA71AC747","previous_guid":"24B5656EFB6F4F598868444525445CD3","component_type_id":"1","data_id":"0","data":"Transpose matrix so that the rows are samples and columns are KEGG module levels.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Transpose matrix so that the rows are samples and columns are KEGG module levels."},"is_project":0},{"component_id":"150860","previous_id":"150859","original_id":"0","guid":"259A1D42711D4E0DA4274411B45EE5D6","previous_guid":"02E3645DFDEE4B3E8A1A736EA71AC747","component_type_id":"15","data_id":"933","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"mpmheat<-t(mpm_agg)","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"142876","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"3C2E1A752B0B40CF928461FA40AB94FC","previous_guid":"A0AD815ACFB7421895CF06C478973FD2","previous_id":"142875","last_modified":"1502718730","components":[{"component_id":"978125","previous_id":0,"original_id":"0","guid":"ABC04EB662B24D77902A96A2682FAEE0","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"150861","previous_id":"978125","original_id":"0","guid":"E87E38F765A24F3D8F5ADD7EE8ED104D","previous_guid":"ABC04EB662B24D77902A96A2682FAEE0","component_type_id":"1","data_id":"0","data":"Now that we have categorized the KEGG modules, we want to compare them between the whole metagenome and the virome. We need to format our data frames so that the metagenome and virome samples are in the same order and then do pairwise comparisons. Finally, we want to calculate the log fold change between the metagenome and virome for each KEGG category that is significantly different.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Now that we have categorized the KEGG modules, we want to compare them between the whole metagenome and the virome. We need to format our data frames so that the metagenome and virome samples are in the same order and then do pairwise comparisons. Finally, we want to calculate the log fold change between the metagenome and virome for each KEGG category that is significantly different."},"is_project":0}]},{"id":"142877","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"F03AAD2292494309A6DCE3D6D1B0EB4F","previous_guid":"3C2E1A752B0B40CF928461FA40AB94FC","previous_id":"142876","last_modified":"1502718730","components":[{"component_id":"978126","previous_id":0,"original_id":"0","guid":"C56E291477A9486BA116C29E074D7E0C","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"150862","previous_id":"978126","original_id":"0","guid":"E1C21D09223D443CB31EC0C2F06D5FF9","previous_guid":"C56E291477A9486BA116C29E074D7E0C","component_type_id":"1","data_id":"0","data":"Order the skin metagenome samples.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Order the skin metagenome samples."},"is_project":0},{"component_id":"150863","previous_id":"150862","original_id":"0","guid":"3C9DBDAEDF624741B7CA91DAF0BB906B","previous_guid":"E1C21D09223D443CB31EC0C2F06D5FF9","component_type_id":"15","data_id":"934","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"mpmheat.s<-merge(metadata[,c(\"NexteraXT_SampleID\",\"SubjectID\",\"TimePoint\",\"Site_Symbol\")],mpmheat, by.y=\"row.names\", by.x=\"NexteraXT_SampleID\")\nmpmheat.s<-mpmheat.s[order(mpmheat.s[c(\"SubjectID\", \"TimePoint\",\"Site_Symbol\"),]),]\ncolnames(mpmheat.s)[1]<-c(\"SampleID\")\nrow.names(mpmheat.s)<-mpmheat.s$SampleID\nmpmheat.s$SampleID<-NULL\nmpmheat.s$TimePoint<-NULL\nmpmheat.s$SubjectID<-NULL\nmpmheat.s$Site_Symbol<-NULL","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"142878","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"AE97B9950896458491AAF594B7220081","previous_guid":"F03AAD2292494309A6DCE3D6D1B0EB4F","previous_id":"142877","last_modified":"1502718730","components":[{"component_id":"978127","previous_id":0,"original_id":"0","guid":"348A2F2263814AB08A459280667E3EDE","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"150864","previous_id":"978127","original_id":"0","guid":"18FCAD5EF471488FA92AE7CE8968F34F","previous_guid":"348A2F2263814AB08A459280667E3EDE","component_type_id":"1","data_id":"0","data":"Order the virome samples.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Order the virome samples."},"is_project":0},{"component_id":"150865","previous_id":"150864","original_id":"0","guid":"C888D680C1344C96A9B353F6DCDF399E","previous_guid":"18FCAD5EF471488FA92AE7CE8968F34F","component_type_id":"15","data_id":"935","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"mpmheat.v<-merge(metadata[,c(\"NexteraXT_Virome_SampleID\",\"SubjectID\",\"TimePoint\",\"Site_Symbol\")],mpmheat, by.y=\"row.names\", by.x=\"NexteraXT_Virome_SampleID\")\nmpmheat.v<-mpmheat.v[order(mpmheat.v[c(\"SubjectID\", \"TimePoint\",\"Site_Symbol\"),]),]\ncolnames(mpmheat.v)[1]<-c(\"SampleID\")\nrow.names(mpmheat.v)<-mpmheat.v$SampleID\nmpmheat.v$SampleID<-NULL\nmpmheat.v$TimePoint<-NULL\nmpmheat.v$SubjectID<-NULL\nmpmheat.v$Site_Symbol<-NULL","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"142879","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"465176259DBF4A50A55CC5DF914F1C17","previous_guid":"AE97B9950896458491AAF594B7220081","previous_id":"142878","last_modified":"1502718730","components":[{"component_id":"978128","previous_id":0,"original_id":"0","guid":"969C243491414AF5B955BA64E7EE7844","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"150866","previous_id":"978128","original_id":"0","guid":"099C065600944CC195C828ACEBDF3874","previous_guid":"969C243491414AF5B955BA64E7EE7844","component_type_id":"1","data_id":"0","data":"Do a wilcoxon to determine which modules are significantly different between skinmet and virome samples.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Do a wilcoxon to determine which modules are significantly different between skinmet and virome samples."},"is_project":0},{"component_id":"150867","previous_id":"150866","original_id":"0","guid":"19CAE3C88B3D4F7A872DA0BED3213613","previous_guid":"099C065600944CC195C828ACEBDF3874","component_type_id":"26","data_id":"10301","data":"","order_id":"2","name":"Note","data_by_id":"1","type_id":"26","source_data":{"annotation_id":"10301","thread_id":"10301","id":"10301","thread_title":"Annotation on step 15 of Script R12: Functional Analysis","uri":"annotation-on-step-15-of-script-r12-functional-analysis","thread_uri":"annotation-on-step-15-of-script-r12-functional-analysis","step_id":"142879","protocol_uri":"Script-R12-Functional-Analysis-ejibcke","protocol_name":"Script R12: Functional Analysis","protocol_name_html":"Script R12: Functional Analysis","annotation":"Note this will throw warnings-- some of the modules are almost all 0's which is not optimal when running a wilcoxon. However this does seem to pick up the major differences.","thread_text":"Note this will throw warnings-- some of the modules are almost all 0's which is not optimal when running a wilcoxon. However this does seem to pick up the major differences.","body":"Note this will throw warnings-- some of the modules are almost all 0's which is not optimal when running a wilcoxon. However this does seem to pick up the major differences.","is_private":"0","public_protocol":"1","can_edit":0,"can_delete":"0","show_name":"0","created_date":"1455654778","created_on":"1455654778","modified_on":"1457538480","last_updated":"1457538480","profile_image":"https:\/\/s3.amazonaws.com\/pr-journal\/cpedy2n.jpg","full_name":"Geoffrey Hannigan","affiliation":"Merck Research Labs","username":"geoffrey-hannigan","email":"hanni035@d.umn.edu","pa_useranme":"geoffrey-hannigan","comments":[]},"is_project":0},{"component_id":"150868","previous_id":"150867","original_id":"0","guid":"E5687AAD6BC0498D972F368A07523ADC","previous_guid":"19CAE3C88B3D4F7A872DA0BED3213613","component_type_id":"15","data_id":"936","data":null,"order_id":"3","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"wil.test.out<-vector()\nfor( i in 1:ncol(mpmheat.s) ) {\n  wil<-wilcox.test(x=as.numeric(mpmheat.s[,i]),y=as.numeric(mpmheat.v[,i]),p.adj=c(\"fdr\"), paired=TRUE)\n  wil.test.out<-c(wil.test.out, wil$p.value)\n}\nwil.test.out.mat<-as.matrix(wil.test.out)\nrow.names(wil.test.out.mat)<-colnames(mpmheat.s)\nkeep<-subset(wil.test.out.mat, wil.test.out.mat[,1] < 0.05)","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"142880","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"3B1D6BD645AA409AA3BF1AAFE9BA6D6E","previous_guid":"465176259DBF4A50A55CC5DF914F1C17","previous_id":"142879","last_modified":"1502718730","components":[{"component_id":"978129","previous_id":0,"original_id":"0","guid":"7EC6C3A2C4CA410AADF3376B0860BA39","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"150869","previous_id":"978129","original_id":"0","guid":"1A032D92E66C4E53B7242C7807165DF3","previous_guid":"7EC6C3A2C4CA410AADF3376B0860BA39","component_type_id":"1","data_id":"0","data":"Add a small number to the relative abundances so that you can log transform them.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Add a small number to the relative abundances so that you can log transform them."},"is_project":0},{"component_id":"150870","previous_id":"150869","original_id":"0","guid":"ABA4723B9B9C4D619AF0D1F6B861000E","previous_guid":"1A032D92E66C4E53B7242C7807165DF3","component_type_id":"15","data_id":"937","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"c<-1e-25\nmet<-mpmheat.s+c\nvir<-mpmheat.v+c","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"142881","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"4AE7929C93B040F597355B26B8E3249F","previous_guid":"3B1D6BD645AA409AA3BF1AAFE9BA6D6E","previous_id":"142880","last_modified":"1502718730","components":[{"component_id":"978130","previous_id":0,"original_id":"0","guid":"82C4C260810A49189ED34BB62AFA8D04","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"150871","previous_id":"978130","original_id":"0","guid":"B179A40AC6864595BBD79CF4AAB5D67B","previous_guid":"82C4C260810A49189ED34BB62AFA8D04","component_type_id":"1","data_id":"0","data":"Calculate the log fold change.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Calculate the log fold change."},"is_project":0},{"component_id":"150872","previous_id":"150871","original_id":"0","guid":"52679FEAE9654CF58C49D55E69D4701D","previous_guid":"B179A40AC6864595BBD79CF4AAB5D67B","component_type_id":"15","data_id":"938","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"delta<-log2(met\/vir)\ndelta.k<-delta[,colnames(delta) %in% row.names(keep)]","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0}]},{"id":"142882","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"D7E5BB4517A74B0B931933423E1F920E","previous_guid":"4AE7929C93B040F597355B26B8E3249F","previous_id":"142881","last_modified":"1502718730","components":[{"component_id":"978131","previous_id":0,"original_id":"0","guid":"A01C8F2D10FD464F91A684C107A0A1DB","previous_guid":null,"component_type_id":"6","data_id":null,"data":null,"order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":null},"is_project":0},{"component_id":"150873","previous_id":"978131","original_id":"0","guid":"CE180B0B9FA64EA6A688C861138CD096","previous_guid":"A01C8F2D10FD464F91A684C107A0A1DB","component_type_id":"1","data_id":"0","data":"Finally, lets plot a heatmap to visualize the differences. Green indicates enrichment in the whole metagenome while red indicates enrichment in the virome.","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"Finally, lets plot a heatmap to visualize the differences. Green indicates enrichment in the whole metagenome while red indicates enrichment in the virome."},"is_project":0},{"component_id":"150874","previous_id":"150873","original_id":"0","guid":"917FD72CC6C6422CB356201A190527CD","previous_guid":"CE180B0B9FA64EA6A688C861138CD096","component_type_id":"15","data_id":"939","data":null,"order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"heatmap.2(as.matrix(t(delta.k)),notecol=\"black\", density.info=\"none\", trace=\"none\",dendrogram=\"row\",col=redgreen(1275),margins=c(2,30))","description":"","os_name":"","os_version":"","can_edit":"0"},"is_project":0},{"component_id":"150875","previous_id":"150874","original_id":"0","guid":"8A356A3D8740468C8909029BC32E98BB","previous_guid":"917FD72CC6C6422CB356201A190527CD","component_type_id":"17","data_id":"194","data":"<img id=\"s-mce-img\" class=\"s-mce-img\" src=\"https:\/\/s3.amazonaws.com\/pr-journal\/chsc2w6.png\" alt=\"\" data-src=\"https:\/\/s3.amazonaws.com\/pr-journal\/chrc2w6.png\" data-ofn=\"r12_heatmap.png\" \/>","order_id":"3","name":"Expected result","data_by_id":"1","type_id":"17","source_data":{"result":"<img id=\"s-mce-img\" class=\"s-mce-img\" src=\"https:\/\/s3.amazonaws.com\/pr-journal\/chsc2w6.png\" alt=\"\" data-src=\"https:\/\/s3.amazonaws.com\/pr-journal\/chrc2w6.png\" data-ofn=\"r12_heatmap.png\" \/>"},"is_project":0}]}]}