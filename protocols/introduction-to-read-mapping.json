{"uri":"introduction-to-read-mapping-piadkae","version_id":"1","protocol_name":"Introduction to read mapping","protocol_name_html":"Introduction to read mapping","is_prepublished":"0","can_edit":"0","parent_id":"11510","api_version":"1","is_new_mode":"0","last_modified":"1523977962","type_id":"1","link":null,"fork_id":"","public_fork_note":"","number_of_steps":"6","has_versions":"1","first_published_date":"1523977962","publish_date":"2018-04-17 15:12:42","documents":null,"have_protocol_in_step":"0","is_protocol_in_step":"0","vendor_name":"Contributed by users","vendor_link":"https:\/\/www.protocols.io","vendor_logo":"\/img\/vendors\/1.png","mod_mins":"-45","mod_secs":"1","description":"<p>This is an example of a simple read mapping workflow. It is designed to be performed via the command line on an Ubuntu 16.06 OS. <\/p>\n<p>\u00a0<\/p>\n<p>After completing this tutorial you should:<\/p>\n<p>1) Have a practical understanding of how read mapping analyses are performed in the command line.<\/p>\n<p>2) Understand the basics of how to process SAM and BAM files.<\/p>\n<p>3) Be able to calculate depth of coverage of a contig\/scaffold\/chromosome in a query read dataset.<\/p>","is_bookmarked":"0","can_reassign":"1","before_start":null,"has_guidelines":"0","materials":[],"warning":null,"version_class":"11510","public":"1","is_owner":"1","is_original_owner":"1","created_on":"1523972856","protocol_affiliation":"Virginia Tech","affiliation":"Virginia Tech","doi":"dx.doi.org\/10.17504\/protocols.io.piadkae","doi_status":"2","changed_fork_steps":null,"profile_url":"FrankAylward-y22344v2x2","protocol_img":"https:\/\/www.protocols.io\/img\/default_protocol.png","profile_image":"https:\/\/s3.amazonaws.com\/pr-journal\/v39jtte.png","full_name":"Frank Aylward","created_by":"Frank Aylward","private_link":"D029AFFA2E73CC1CBC2F31736FE8027A","original_img":"1","username":"frank-aylward","is_retracted":"0","retraction_reason":null,"plos_id":null,"manuscript_citation":null,"journal_name":null,"is_donations_disabled":"0","is_donations_disabled_by_user":"9","item_record_id":304699,"fork_info":[],"compare_forks":[],"protocols":[],"groups":[],"number_of_shared_runs":[],"ownership_history":[],"keywords":"","transfer_to_user":[],"sub_transfer":false,"is_transfer_pending":false,"number_of_bookmarks":"0","collections":[],"tags":[{"tag_id":"117","tag_name":" bioinformatics"},{"tag_id":"131","tag_name":" metagenomics"},{"tag_id":"510","tag_name":"Genomics"}],"archived":0,"sub_authors":[],"sub_protocols_number":0,"can_edit_shared":0,"shared_runs":[],"is_shared_run":0,"is_shared":1,"banner":null,"contact_badges":[{"badge_id":"4","badge_image":"\/img\/badges\/gold.svg","badge_description":"Gold power author!"}],"number_of_comments":0,"is_locked":0,"is_locked_by":false,"authors":"Frank Aylward","authors_list":[{"name":"Frank Aylward","affiliation":"Virginia Tech","username":null,"profile_image":null}],"user":{"profile_image":"https:\/\/s3.amazonaws.com\/pr-journal\/v39jtte.png","username":"frank-aylward","full_name":"Frank Aylward","created_by":"Frank Aylward"},"access":{"can_view":"1","can_remove":"0","can_add":"0","can_edit":0,"can_publish":0,"can_get_doi":0,"can_share":"0","can_move":"1","can_transfer":"1","can_download":"1","is_locked":"0"},"is_contact_suspended":0,"guidelines":null,"status_id":"2","is_research":"1","status_info":"We are still developing and optimizing this protocol","steps":[{"id":"622338","is_changed":1,"original_id":"621772","is_skipped":"0","is_checked":"0","guid":"57E43A1EB06A47F29BE0D171317B159F","previous_guid":null,"previous_id":null,"last_modified":"1523972992","components":[{"component_id":"1092167","previous_id":0,"original_id":"1090812","guid":"7BE085D002F442C0A7F1CEA6C40CC1DD","previous_guid":null,"component_type_id":"1","data_id":null,"data":"<p>First ensure that the following tools are installed and are in your PATH:<\/p>\n<p>\u00a0<\/p>\n<p>Bowtie 2 version 2.2.6<\/p>\n<p>samtools\u00a0Version: 0.1.19-96b5f2294a<\/p>\n<p>bedtools v2.25.0<\/p>\n<p>\u00a0<\/p>\n<p>In the unix command line you can do this by typing \"bowtie2\", \"samtools\", and \"bedtools\" in the command line followed by the enter key.<\/p>\n<p>The exact versions for bowtie2 and bedtools may not be critical, but try to get the same version of samtools since the command entries are different between different versions of that tool.\u00a0 <\/p>","order_id":"0","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>First ensure that the following tools are installed and are in your PATH:<\/p>\n<p>\u00a0<\/p>\n<p>Bowtie 2 version 2.2.6<\/p>\n<p>samtools\u00a0Version: 0.1.19-96b5f2294a<\/p>\n<p>bedtools v2.25.0<\/p>\n<p>\u00a0<\/p>\n<p>In the unix command line you can do this by typing \"bowtie2\", \"samtools\", and \"bedtools\" in the command line followed by the enter key.<\/p>\n<p>The exact versions for bowtie2 and bedtools may not be critical, but try to get the same version of samtools since the command entries are different between different versions of that tool.\u00a0 <\/p>"},"is_project":0},{"component_id":"1092168","previous_id":"1092167","original_id":"1090813","guid":"39C42B52EBFA411A9B1A68F208176015","previous_guid":"7BE085D002F442C0A7F1CEA6C40CC1DD","component_type_id":"6","data_id":null,"data":"Ensure the appropriate tools are installed","order_id":"1","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Ensure the appropriate tools are installed"},"is_project":0}],"available_protocols":["11510","12550"]},{"id":"622339","is_changed":1,"original_id":"621773","is_skipped":"0","is_checked":"0","guid":"20808586A5AF42AE819EBC12C8987DC2","previous_guid":"57E43A1EB06A47F29BE0D171317B159F","previous_id":"622338","last_modified":"1523972882","components":[{"component_id":"1092169","previous_id":0,"original_id":"1090814","guid":"B7456135DD2E4CEF951FAA07585D7F95","previous_guid":null,"component_type_id":"1","data_id":null,"data":"<p>First we need to get a reference genome to map reads against. We'll download the genome of Marinimicrobia UBA2153 here.\u00a0<\/p>\n<p>\u00a0<\/p>\n<p>Download using the unix command wget:<\/p>\n<p>wget ftp:\/\/ftp.ncbi.nlm.nih.gov\/genomes\/all\/GCA\/002\/328\/885\/GCA_002328885.1_ASM232888v1\/GCA_002328885.1_ASM232888v1_genomic.fna.gz<\/p>\n<p>\u00a0<\/p>\n<p>And since the fasta file is compressed we will use the Unix tool gunzip to decompress it:<br \/>gunzip GCA_002328885.1_ASM232888v1_genomic.fna.gz<\/p>","order_id":"0","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>First we need to get a reference genome to map reads against. We'll download the genome of Marinimicrobia UBA2153 here.\u00a0<\/p>\n<p>\u00a0<\/p>\n<p>Download using the unix command wget:<\/p>\n<p>wget ftp:\/\/ftp.ncbi.nlm.nih.gov\/genomes\/all\/GCA\/002\/328\/885\/GCA_002328885.1_ASM232888v1\/GCA_002328885.1_ASM232888v1_genomic.fna.gz<\/p>\n<p>\u00a0<\/p>\n<p>And since the fasta file is compressed we will use the Unix tool gunzip to decompress it:<br \/>gunzip GCA_002328885.1_ASM232888v1_genomic.fna.gz<\/p>"},"is_project":0},{"component_id":"1092170","previous_id":"1092169","original_id":"1090815","guid":"F5932382B3594AD49E79FC31B58630F4","previous_guid":"B7456135DD2E4CEF951FAA07585D7F95","component_type_id":"6","data_id":null,"data":"First we need to get a reference genome. In this case we will be working with a bacterium called Marinimicrobial UBA2153","order_id":"1","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"First we need to get a reference genome. In this case we will be working with a bacterium called Marinimicrobial UBA2153"},"is_project":0}],"available_protocols":["11510","12550"]},{"id":"622340","is_changed":1,"original_id":"622334","is_skipped":"0","is_checked":"0","guid":"A93B23AD5264450896FFC1D5629C1B0F","previous_guid":"20808586A5AF42AE819EBC12C8987DC2","previous_id":"622339","last_modified":"1523972873","components":[{"component_id":"1092171","previous_id":0,"original_id":"1092159","guid":"47081321828441D9BC58C50931BA3779","previous_guid":null,"component_type_id":"6","data_id":null,"data":"Build bowtie2 reference","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Build bowtie2 reference"},"is_project":0},{"component_id":"1092172","previous_id":"1092171","original_id":"1092158","guid":"4B491F1F1B0941919D7042B9AFE965E8","previous_guid":"47081321828441D9BC58C50931BA3779","component_type_id":"1","data_id":null,"data":"<p>To use the read mapping tool bowtie2 we will need to first index the fasta file. This can be done using the command bowtie2-build. It will create several index files with different suffixes and the prefix that we give in the command after the fasta file (in this case UBA2153).<\/p>\n<p>\u00a0<\/p>\n<p>bowtie2-build GCA_002328885.1_ASM232888v1_genomic.fna UBA2153<\/p>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>To use the read mapping tool bowtie2 we will need to first index the fasta file. This can be done using the command bowtie2-build. It will create several index files with different suffixes and the prefix that we give in the command after the fasta file (in this case UBA2153).<\/p>\n<p>\u00a0<\/p>\n<p>bowtie2-build GCA_002328885.1_ASM232888v1_genomic.fna UBA2153<\/p>"},"is_project":0}],"available_protocols":["11510","12550"]},{"id":"622341","is_changed":1,"original_id":"622335","is_skipped":"0","is_checked":"0","guid":"422D73CD5E014812A8DAAA52FD46DBD5","previous_guid":"A93B23AD5264450896FFC1D5629C1B0F","previous_id":"622340","last_modified":"1523973089","components":[{"component_id":"1092173","previous_id":0,"original_id":"1092161","guid":"FA8B408A7F364CEBA47D96C0BC5475AE","previous_guid":null,"component_type_id":"6","data_id":null,"data":"Get the reads for mapping","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Get the reads for mapping"},"is_project":0},{"component_id":"1092174","previous_id":"1092173","original_id":"1092160","guid":"2FDE7EC5123D494CB0B869A21DA3455C","previous_guid":"FA8B408A7F364CEBA47D96C0BC5475AE","component_type_id":"1","data_id":null,"data":"<p>Now we need to get the reads that we will use for mapping. We are going to download raw Illumina reads straight from the NCBI Sequence Read Archive (SRA) using the sra-toolkit. Since the sequence files are quite large we are only going to download a few to start with- in this case 10000. <\/p>\n<p>\u00a0<\/p>\n<p>fastq-dump -X 10000 --split-3 SRR5322088<\/p>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>Now we need to get the reads that we will use for mapping. We are going to download raw Illumina reads straight from the NCBI Sequence Read Archive (SRA) using the sra-toolkit. Since the sequence files are quite large we are only going to download a few to start with- in this case 10000. <\/p>\n<p>\u00a0<\/p>\n<p>fastq-dump -X 10000 --split-3 SRR5322088<\/p>"},"is_project":0}],"available_protocols":["11510","12550"]},{"id":"622342","is_changed":1,"original_id":"622336","is_skipped":"0","is_checked":"0","guid":"27C9F23207A64B65B98A8C37C09BFF54","previous_guid":"422D73CD5E014812A8DAAA52FD46DBD5","previous_id":"622341","last_modified":"1523972856","components":[{"component_id":"1092175","previous_id":0,"original_id":"1092163","guid":"985B3D6618CC4034BBE557970DF8E94A","previous_guid":null,"component_type_id":"6","data_id":null,"data":"Map the reads with bowtie2","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Map the reads with bowtie2"},"is_project":0},{"component_id":"1092176","previous_id":"1092175","original_id":"1092162","guid":"51032525E6744645982E663FCEC2B530","previous_guid":"985B3D6618CC4034BBE557970DF8E94A","component_type_id":"1","data_id":null,"data":"<p>bowtie2 -1 SRR5322088_1.fastq -2 SRR5322088_2.fastq -x UBA2153 -S mapping_output.SAM<\/p>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>bowtie2 -1 SRR5322088_1.fastq -2 SRR5322088_2.fastq -x UBA2153 -S mapping_output.SAM<\/p>"},"is_project":0}],"available_protocols":["12550"]},{"id":"622343","is_changed":1,"original_id":"622337","is_skipped":"0","is_checked":"0","guid":"91EE70C612B54A259157098BB2BD389A","previous_guid":"27C9F23207A64B65B98A8C37C09BFF54","previous_id":"622342","last_modified":"1523973136","components":[{"component_id":"1092177","previous_id":0,"original_id":"1092165","guid":"46B6BB3EF9324BF39A99FD7C9596C890","previous_guid":null,"component_type_id":"6","data_id":null,"data":"Now process the SAM file created by bowtie2 with samtools ","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Now process the SAM file created by bowtie2 with samtools "},"is_project":0},{"component_id":"1092178","previous_id":"1092177","original_id":"1092164","guid":"BC23298A2F354AF5975997954FEC754B","previous_guid":"46B6BB3EF9324BF39A99FD7C9596C890","component_type_id":"1","data_id":null,"data":"<p>samtools view -bS -F 4 mapping_output.SAM &gt; mapping_output.bam<br \/>samtools sort mapping_output.bam mapping_output.sort<br \/>samtools index mapping_output.sort.bam<br \/>samtools idxstats mapping_output.sort.bam<\/p>\n<p>\u00a0<\/p>\n<p>The output of this last file should be a table with the number of reads that were found to have mapped to each reference sequence.<\/p>\n<p>\u00a0<\/p>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>samtools view -bS -F 4 mapping_output.SAM &gt; mapping_output.bam<br \/>samtools sort mapping_output.bam mapping_output.sort<br \/>samtools index mapping_output.sort.bam<br \/>samtools idxstats mapping_output.sort.bam<\/p>\n<p>\u00a0<\/p>\n<p>The output of this last file should be a table with the number of reads that were found to have mapped to each reference sequence.<\/p>\n<p>\u00a0<\/p>"},"is_project":0}],"available_protocols":["11510","12550"]}]}