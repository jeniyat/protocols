{"uri":"introduction-to-read-mapping-pgwdjxe","version_id":"0","protocol_name":"Introduction to read mapping","protocol_name_html":"Introduction to read mapping","is_prepublished":"0","can_edit":"0","parent_id":null,"api_version":"1","is_new_mode":"0","last_modified":"1523972736","type_id":"1","link":null,"fork_id":"","public_fork_note":"","number_of_steps":"6","has_versions":"1","first_published_date":"1523972736","publish_date":"2018-04-17 13:45:36","documents":null,"have_protocol_in_step":"0","is_protocol_in_step":"0","vendor_name":"Contributed by users","vendor_link":"https:\/\/www.protocols.io","vendor_logo":"\/img\/vendors\/1.png","mod_mins":"-45","mod_secs":"1","description":"<p>This is an example of a simple read mapping workflow. It is designed to be performed via the command line on an Ubuntu 16.06 OS. <\/p>\n<p>\u00a0<\/p>\n<p>After completing this tutorial you should:<\/p>\n<p>1) Have a practical understanding of how read mapping analyses are performed in the command line.<\/p>\n<p>2) Understand the basics of how to process SAM and BAM files.<\/p>\n<p>3) Be able to calculate depth of coverage of a contig\/scaffold\/chromosome in a query read dataset.<\/p>","is_bookmarked":"0","can_reassign":"1","before_start":null,"has_guidelines":"0","materials":[],"warning":null,"version_class":"11510","public":"1","is_owner":"1","is_original_owner":"1","created_on":"1523736681","protocol_affiliation":"Virginia Tech","affiliation":"Virginia Tech","doi":"dx.doi.org\/10.17504\/protocols.io.pgwdjxe","doi_status":"2","changed_fork_steps":null,"profile_url":"FrankAylward-y22344v2x2","protocol_img":"https:\/\/www.protocols.io\/img\/default_protocol.png","profile_image":"https:\/\/s3.amazonaws.com\/pr-journal\/v39jtte.png","full_name":"Frank Aylward","created_by":"Frank Aylward","private_link":"D8FF6AE38C1B7F8996352131E1EC735B","original_img":"1","username":"frank-aylward","is_retracted":"0","retraction_reason":null,"plos_id":null,"manuscript_citation":null,"journal_name":null,"is_donations_disabled":"0","is_donations_disabled_by_user":"9","item_record_id":304022,"fork_info":[],"compare_forks":[],"protocols":[],"groups":[],"number_of_shared_runs":[],"ownership_history":[],"keywords":"","transfer_to_user":[],"sub_transfer":false,"is_transfer_pending":false,"number_of_bookmarks":"0","collections":[],"tags":[{"tag_id":"117","tag_name":" bioinformatics"},{"tag_id":"131","tag_name":" metagenomics"},{"tag_id":"510","tag_name":"Genomics"}],"archived":0,"sub_authors":[],"sub_protocols_number":0,"can_edit_shared":0,"shared_runs":[],"is_shared_run":0,"is_shared":1,"banner":null,"contact_badges":[{"badge_id":"4","badge_image":"\/img\/badges\/gold.svg","badge_description":"Gold power author!"}],"number_of_comments":0,"is_locked":0,"is_locked_by":false,"authors":"Frank Aylward","authors_list":[{"name":"Frank Aylward","affiliation":"Virginia Tech","username":null,"profile_image":null}],"user":{"profile_image":"https:\/\/s3.amazonaws.com\/pr-journal\/v39jtte.png","username":"frank-aylward","full_name":"Frank Aylward","created_by":"Frank Aylward"},"access":{"can_view":"1","can_remove":"0","can_add":"0","can_edit":0,"can_publish":0,"can_get_doi":0,"can_share":"0","can_move":"1","can_transfer":"1","can_download":"1","is_locked":"0"},"is_contact_suspended":0,"guidelines":null,"status_id":"2","is_research":"1","status_info":"We are still developing and optimizing this protocol","steps":[{"id":"621772","is_changed":1,"original_id":"0","is_skipped":"0","is_checked":"0","guid":"E2A9A9957DBE4413B4673435C0829431","previous_guid":null,"previous_id":"0","last_modified":"1523972221","components":[{"component_id":"1090812","previous_id":0,"original_id":"0","guid":"BEBFF368F2B9403F941460781F1B95EF","previous_guid":null,"component_type_id":"1","data_id":null,"data":"<p>First ensure that the following tools are installed and are in your PATH:<\/p>\n<p>\u00a0<\/p>\n<p>Bowtie 2 version 2.2.6<\/p>\n<p>samtools\u00a0Version: 0.1.19-96b5f2294a<\/p>\n<p>bedtools v2.25.0<\/p>\n<p>\u00a0<\/p>\n<p>The exact versions may not be critical, but those used in designing this tutorial are listed for completeness.<\/p>\n<p>\u00a0<\/p>","order_id":"0","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>First ensure that the following tools are installed and are in your PATH:<\/p>\n<p>\u00a0<\/p>\n<p>Bowtie 2 version 2.2.6<\/p>\n<p>samtools\u00a0Version: 0.1.19-96b5f2294a<\/p>\n<p>bedtools v2.25.0<\/p>\n<p>\u00a0<\/p>\n<p>The exact versions may not be critical, but those used in designing this tutorial are listed for completeness.<\/p>\n<p>\u00a0<\/p>"},"is_project":0},{"component_id":"1090813","previous_id":"1090812","original_id":"0","guid":"ECB3992544B94C2BB64C97616B539729","previous_guid":"BEBFF368F2B9403F941460781F1B95EF","component_type_id":"6","data_id":"0","data":"Ensure the appropriate tools are installed","order_id":"1","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Ensure the appropriate tools are installed"},"is_project":0}],"available_protocols":["11554"]},{"id":"621773","is_changed":1,"original_id":"0","is_skipped":"0","is_checked":"0","guid":"DC9668E22BD2446B9439FA38BBF423FE","previous_guid":"E2A9A9957DBE4413B4673435C0829431","previous_id":"621772","last_modified":"1523972417","components":[{"component_id":"1090814","previous_id":0,"original_id":"0","guid":"EBAB88B8AA214903BDE7FFF63D455EBD","previous_guid":null,"component_type_id":"1","data_id":null,"data":"<p>First we need to get a reference genome to map reads against. We'll download the genome of Marinimicrobia UBA2153 here.\u00a0<\/p>\n<p>\u00a0<\/p>\n<p>Download using the unix command wget:<\/p>\n<p>wget ftp:\/\/ftp.ncbi.nlm.nih.gov\/genomes\/all\/GCA\/002\/328\/885\/GCA_002328885.1_ASM232888v1\/GCA_002328885.1_ASM232888v1_genomic.fna.gz<\/p>\n<p>\u00a0<\/p>\n<p>And since the fasta file is compressed we will use the Unix tool gunzip to decompress it:<br \/>gunzip GCA_002328885.1_ASM232888v1_genomic.fna.gz<\/p>","order_id":"0","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>First we need to get a reference genome to map reads against. We'll download the genome of Marinimicrobia UBA2153 here.\u00a0<\/p>\n<p>\u00a0<\/p>\n<p>Download using the unix command wget:<\/p>\n<p>wget ftp:\/\/ftp.ncbi.nlm.nih.gov\/genomes\/all\/GCA\/002\/328\/885\/GCA_002328885.1_ASM232888v1\/GCA_002328885.1_ASM232888v1_genomic.fna.gz<\/p>\n<p>\u00a0<\/p>\n<p>And since the fasta file is compressed we will use the Unix tool gunzip to decompress it:<br \/>gunzip GCA_002328885.1_ASM232888v1_genomic.fna.gz<\/p>"},"is_project":0},{"component_id":"1090815","previous_id":"1090814","original_id":"0","guid":"4151ACB3E5F0433783779DA5560E2C4F","previous_guid":"EBAB88B8AA214903BDE7FFF63D455EBD","component_type_id":"6","data_id":"0","data":"First we need to get a reference genome. In this case we will be working with a bacterium called Marinimicrobial UBA","order_id":"1","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"First we need to get a reference genome. In this case we will be working with a bacterium called Marinimicrobial UBA"},"is_project":0}],"available_protocols":["11554"]},{"id":"622334","is_changed":1,"original_id":"0","is_skipped":"0","is_checked":"0","guid":"7E45C44FE54F42BA9FD71516083AAB47","previous_guid":"DC9668E22BD2446B9439FA38BBF423FE","previous_id":"621773","last_modified":"1523972522","components":[{"component_id":"1092159","previous_id":0,"original_id":"0","guid":"C56FFC0D3A014424B7C8660F8791CDA3","previous_guid":null,"component_type_id":"6","data_id":"0","data":"Build bowtie2 reference","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Build bowtie2 reference"},"is_project":0},{"component_id":"1092158","previous_id":"1092159","original_id":"0","guid":"7BFA87B4B3FB4EA49D370861CD218C3D","previous_guid":"C56FFC0D3A014424B7C8660F8791CDA3","component_type_id":"1","data_id":null,"data":"<p>To use the read mapping tool bowtie2 we will need to first index the fasta file. This can be done using the command bowtie2-build. It will create several index files with different suffixes and the prefix that we give in the command after the fasta file (in this case UBA2153).<\/p>\n<p>\u00a0<\/p>\n<p>bowtie2-build GCA_002328885.1_ASM232888v1_genomic.fna UBA2153<\/p>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>To use the read mapping tool bowtie2 we will need to first index the fasta file. This can be done using the command bowtie2-build. It will create several index files with different suffixes and the prefix that we give in the command after the fasta file (in this case UBA2153).<\/p>\n<p>\u00a0<\/p>\n<p>bowtie2-build GCA_002328885.1_ASM232888v1_genomic.fna UBA2153<\/p>"},"is_project":0}],"available_protocols":["11554"]},{"id":"622335","is_changed":1,"original_id":"0","is_skipped":"0","is_checked":"0","guid":"23256E6812B2482C97EA729A421EE1BC","previous_guid":"7E45C44FE54F42BA9FD71516083AAB47","previous_id":"622334","last_modified":"1523972557","components":[{"component_id":"1092161","previous_id":0,"original_id":"0","guid":"EEADBEA1852043D6952DCAED1527DFEF","previous_guid":null,"component_type_id":"6","data_id":"0","data":"Get the reads for mapping","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Get the reads for mapping"},"is_project":0},{"component_id":"1092160","previous_id":"1092161","original_id":"0","guid":"2EC4B0D513054767805779418F7F65C1","previous_guid":"EEADBEA1852043D6952DCAED1527DFEF","component_type_id":"1","data_id":null,"data":"<p>Now we need to get the reads that we will use for mapping.\u00a0<\/p>\n<p>\u00a0<\/p>\n<p>fastq-dump -X 1000000 --gzip --split-3 SRR5322088<\/p>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>Now we need to get the reads that we will use for mapping.\u00a0<\/p>\n<p>\u00a0<\/p>\n<p>fastq-dump -X 1000000 --gzip --split-3 SRR5322088<\/p>"},"is_project":0}],"available_protocols":["11554"]},{"id":"622336","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"B95498621CD8471DB147036FEF737750","previous_guid":"23256E6812B2482C97EA729A421EE1BC","previous_id":"622335","last_modified":"1523972580","components":[{"component_id":"1092163","previous_id":0,"original_id":"0","guid":"591CD5637F6E488B83A937EB0B3CD8B5","previous_guid":null,"component_type_id":"6","data_id":"0","data":"Map the reads with bowtie2","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Map the reads with bowtie2"},"is_project":0},{"component_id":"1092162","previous_id":"1092163","original_id":"0","guid":"9159A63A611840F39D71D829268466DE","previous_guid":"591CD5637F6E488B83A937EB0B3CD8B5","component_type_id":"1","data_id":null,"data":"<p>bowtie2 -1 SRR5322088_1.fastq -2 SRR5322088_2.fastq -x UBA2153 -S mapping_output.SAM<\/p>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>bowtie2 -1 SRR5322088_1.fastq -2 SRR5322088_2.fastq -x UBA2153 -S mapping_output.SAM<\/p>"},"is_project":0}]},{"id":"622337","is_changed":1,"original_id":"0","is_skipped":"0","is_checked":"0","guid":"3E21ADED235C4B08B8572BC60A352022","previous_guid":"B95498621CD8471DB147036FEF737750","previous_id":"622336","last_modified":"1523972608","components":[{"component_id":"1092165","previous_id":0,"original_id":"0","guid":"FC5E5F18EA6E42FEBC6B6115BA64D2B3","previous_guid":null,"component_type_id":"6","data_id":"0","data":"Now process the SAM file created by bowtie2 with samtools ","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Now process the SAM file created by bowtie2 with samtools "},"is_project":0},{"component_id":"1092164","previous_id":"1092165","original_id":"0","guid":"81B873F92D314B3CB6EBB0D21ED18E3A","previous_guid":"FC5E5F18EA6E42FEBC6B6115BA64D2B3","component_type_id":"1","data_id":null,"data":"<p>samtools view -bS -F 4 mapping_output.SAM &gt; mapping_output.bam<br \/>samtools sort mapping_output.bam mapping_output.sort<br \/>samtools index mapping_output.sort.bam<br \/>samtools idxstats mapping_output.sort.bam<\/p>\n<p>\u00a0<\/p>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>samtools view -bS -F 4 mapping_output.SAM &gt; mapping_output.bam<br \/>samtools sort mapping_output.bam mapping_output.sort<br \/>samtools index mapping_output.sort.bam<br \/>samtools idxstats mapping_output.sort.bam<\/p>\n<p>\u00a0<\/p>"},"is_project":0}],"available_protocols":["11554"]}]}