{"uri":"uchange-structural-neuroimaging-pipeline-kfvctn6","version_id":"1","protocol_name":"UCHANGE structural neuroimaging pipeline","protocol_name_html":"UCHANGE structural neuroimaging pipeline","is_prepublished":"0","can_edit":"0","parent_id":"2685","api_version":"1","is_new_mode":"0","last_modified":"1526577767","type_id":"1","link":"","fork_id":"","public_fork_note":"","number_of_steps":"16","has_versions":"1","first_published_date":"1526577767","publish_date":"2018-05-17 17:22:47","documents":"\"\\\"null\\\"\"","have_protocol_in_step":"0","is_protocol_in_step":"0","vendor_name":"Contributed by users","vendor_link":"https:\/\/www.protocols.io","vendor_logo":"\/img\/vendors\/1.png","mod_mins":"-41","mod_secs":"2","description":"","is_bookmarked":"0","can_reassign":"1","before_start":"<span style=\"text-decoration: underline;\"><strong>Input Files<\/strong><\/span><br \/><br \/>You must have the appropriate input files in the displayed directory structure:<br \/><br \/><em>Multi-parametric mapping (MPM) input files:<\/em><br \/>\n<ul>\n<li><strong>R1.nii.gz<\/strong> -- 3D NIFTI image containing longitudinal relaxation rate (R1) values in MPM subject space<\/li>\n<li><strong>R2s.nii.gz<\/strong> -- 3D NIFTI image containing transverse relaxation rate (R2s) values in MPM subject space<\/li>\n<li><strong>MT.nii.gz<\/strong> -- 3D NIFTI image containing magnetisation transfer (MT) values in MPM subject space<\/li>\n<li><strong>A.nii.gz<\/strong> -- 3D NIFTI image containing proton density (A) values in MPM subject space<\/li>\n<li><strong>PDw.nii.gz<\/strong> -- 3D NIFTI image containing proton density weighted (PDw) values in MPM subject space<\/li>\n<\/ul>\n<strong><br \/><\/strong><em>Diffusion weighted imaging (DWI) imaging input files:<\/em><br \/>\n<ul>\n<li><strong>dti.nii.gz<\/strong> -- 4D NIFTI image containing 63 diffusion weighted acquisition and 6 non-weighted acquistions (total N=69) in DTI subject space<\/li>\n<li><strong>bvals<\/strong> -- text file containing one row of 69 values representing the diffusion weightings for the 69 volumes in <strong>dti.nii.gz<\/strong><\/li>\n<li><strong>bvecs<\/strong> -- text file containing three rows of 69 values representing the x, y, and z components of the diffusion directions for the 69 volumes in <strong>dti.nii.gz<\/strong><\/li>\n<\/ul>\n<br \/><br \/><span style=\"text-decoration: underline;\"><strong>Software Installations<\/strong><\/span><br \/><br \/>You must also have the following software libraries installed:<br \/>\n<ul>\n<li><strong>Freesurfer<\/strong>: <a href=\"https:\/\/surfer.nmr.mgh.harvard.edu\/fswiki\/DownloadAndInstall\" target=\"_blank\">https:\/\/surfer.nmr.mgh.harvard.edu\/fswiki\/DownloadAndInstall<\/a><\/li>\n<li><strong>FSL<\/strong>: <a href=\"http:\/\/fsl.fmrib.ox.ac.uk\/fsl\/fslwiki\/FslInstallation\" target=\"_blank\">http:\/\/fsl.fmrib.ox.ac.uk\/fsl\/fslwiki\/FslInstallation<\/a><\/li>\n<li><strong>Anaconda<\/strong>: <a href=\"https:\/\/www.continuum.io\/downloads\" target=\"_blank\">https:\/\/www.continuum.io\/downloads<\/a><\/li>\n<\/ul>\n<br \/>From within <strong>Anaconda<\/strong> install the following python packages:<br \/>\n<ul>\n<li><a href=\"http:\/\/www.vtk.org\/VTK\/resources\/software.html#latestcand\" target=\"_blank\">VTK<\/a> by typing <code>conda install vtk<\/code><\/li>\n<li><a href=\"http:\/\/mayavi.sourceforge.net\/install.html\" target=\"_blank\">Mayavi<\/a> by typing <code>conda install mayavi<\/code><\/li>\n<li><a href=\"http:\/\/nipy.sourceforge.net\/nibabel\/installation.html#installation\" target=\"_blank\">Nibabel<\/a> by typing <code>pip install nibabel<\/code><\/li>\n<li><a href=\"http:\/\/pysurfer.github.io\/install.html\" target=\"_blank\">pysurfer<\/a> by typing <code>pip install pysurfer<\/code><\/li>\n<\/ul>","has_guidelines":"0","materials":[],"warning":"","version_class":"2685","public":"1","is_owner":"1","is_original_owner":"1","created_on":"1508916595","protocol_affiliation":"Brain Mapping Unit, Department of Psychiatry, University of Cambridge","affiliation":"Brain Mapping Unit, Department of Psychiatry, University of Cambridge ","doi":"dx.doi.org\/10.17504\/protocols.io.kfvctn6","doi_status":"2","changed_fork_steps":null,"profile_url":"Kirstie-y20364y2","protocol_img":"https:\/\/s3.amazonaws.com\/pr-journal\/c637fm.png","profile_image":"https:\/\/s3.amazonaws.com\/pr-journal\/c6w7fm.jpg","full_name":"Kirstie Whitaker","created_by":"Kirstie Whitaker","private_link":"657873DEDA7B92E54DA50BBB0E0E20F4","original_img":"1","username":"kirstie-whitaker","is_retracted":"0","retraction_reason":null,"plos_id":null,"manuscript_citation":null,"journal_name":null,"is_donations_disabled":"0","is_donations_disabled_by_user":"9","item_record_id":209938,"fork_info":[],"compare_forks":[],"protocols":[],"groups":[],"number_of_shared_runs":[],"ownership_history":[],"keywords":"","transfer_to_user":[],"sub_transfer":false,"is_transfer_pending":false,"number_of_bookmarks":"0","collections":[],"tags":[],"archived":0,"sub_authors":[],"sub_protocols_number":0,"can_edit_shared":0,"shared_runs":[],"is_shared_run":0,"is_shared":1,"banner":null,"contact_badges":[{"badge_id":"1","badge_image":"\/img\/ambassador.svg","badge_description":"Ambassador"},{"badge_id":"2","badge_image":"\/img\/badges\/bronze.svg","badge_description":"Author!"},{"badge_id":"5","badge_image":"\/img\/badges\/earlyadopter.svg","badge_description":"Early adopter"}],"number_of_comments":0,"big_protocol_img":"https:\/\/s3.amazonaws.com\/pr-journal\/c627fm.png","big_protocol_img_ofn":"parcellation_308_random_matched_hemis_rh_pial_classic_lateral.png","is_locked":0,"is_locked_by":false,"authors":"Kirstie Whitaker","authors_list":[{"name":"Kirstie Whitaker","affiliation":"Brain Mapping Unit, Department of Psychiatry, University of Cambridge","username":null,"profile_image":null}],"user":{"profile_image":"https:\/\/s3.amazonaws.com\/pr-journal\/c6w7fm.jpg","username":"kirstie-whitaker","full_name":"Kirstie Whitaker","created_by":"Kirstie Whitaker"},"access":{"can_view":"1","can_remove":"0","can_add":"0","can_edit":0,"can_publish":0,"can_get_doi":0,"can_share":"0","can_move":"1","can_transfer":"1","can_download":"1","is_locked":"0"},"is_contact_suspended":0,"guidelines":"","status_id":"2","is_research":"1","status_info":"We are still developing and optimizing this protocol","steps":[{"id":"592044","is_changed":"0","original_id":"148568","is_skipped":"0","is_checked":"0","guid":"DBFAADEE41C942B0B6EEF87BAE8E4FB4","previous_guid":null,"previous_id":null,"last_modified":"1515405701","components":[{"component_id":"1015499","previous_id":0,"original_id":"980473","guid":"EAF4635AD15E4D2D9022FA62AFD0ABCE","previous_guid":null,"component_type_id":"6","data_id":null,"data":"Check or complete software installation","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Check or complete software installation"},"is_project":0},{"component_id":"1015500","previous_id":"1015499","original_id":"161446","guid":"AAB822D48997413FB8E0D5FF46BF9D32","previous_guid":"EAF4635AD15E4D2D9022FA62AFD0ABCE","component_type_id":"1","data_id":null,"data":"<p>You must have the following software libraries installed:<\/p>\n<ul>\n<li><strong>Freesurfer<\/strong>: <a href=\"https:\/\/surfer.nmr.mgh.harvard.edu\/fswiki\/DownloadAndInstall\" target=\"_blank\">https:\/\/surfer.nmr.mgh.harvard.edu\/fswiki\/DownloadAndInstall<\/a><\/li>\n<li><strong>FSL<\/strong>: <a href=\"http:\/\/fsl.fmrib.ox.ac.uk\/fsl\/fslwiki\/FslInstallation\" target=\"_blank\">http:\/\/fsl.fmrib.ox.ac.uk\/fsl\/fslwiki\/FslInstallation<\/a><\/li>\n<li><strong>Anaconda<\/strong>: <a href=\"https:\/\/www.continuum.io\/downloads\" target=\"_blank\">https:\/\/www.continuum.io\/downloads<\/a><\/li>\n<\/ul>\n<p>\u00a0<\/p>\n<p>You'll also need a copy of the UCHANGE_ProcessingPipeline code from GitHub:\u00a0<a href=\"https:\/\/github.com\/KirstieJane\/UCHANGE_ProcessingPipeline\" target=\"_blank\">https:\/\/github.com\/KirstieJane\/UCHANGE_ProcessingPipeline.<\/a><\/p>\n<ul>\n<li>You can download the latest version by clicking <strong>Clone or Download <\/strong>and then <strong>Download Zip<\/strong>.<\/li>\n<li>Unzip the folder contents and save them somewhere close to where you're working.<\/li>\n<\/ul>\n<p>\u00a0<\/p>\n<p>From within <strong>Anaconda<\/strong> install the following python packages following the command below:<\/p>\n<ul>\n<li><a href=\"http:\/\/www.vtk.org\/VTK\/resources\/software.html#latestcand\" target=\"_blank\">VTK<\/a><\/li>\n<li><a href=\"http:\/\/mayavi.sourceforge.net\/install.html\" target=\"_blank\">Mayavi<\/a><\/li>\n<li><a href=\"http:\/\/nipy.sourceforge.net\/nibabel\/installation.html#installation\" target=\"_blank\">Nibabel<\/a> <code><\/code><\/li>\n<li><a href=\"http:\/\/pysurfer.github.io\/install.html\" target=\"_blank\">pysurfer<\/a><\/li>\n<\/ul>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>You must have the following software libraries installed:<\/p>\n<ul>\n<li><strong>Freesurfer<\/strong>: <a href=\"https:\/\/surfer.nmr.mgh.harvard.edu\/fswiki\/DownloadAndInstall\" target=\"_blank\">https:\/\/surfer.nmr.mgh.harvard.edu\/fswiki\/DownloadAndInstall<\/a><\/li>\n<li><strong>FSL<\/strong>: <a href=\"http:\/\/fsl.fmrib.ox.ac.uk\/fsl\/fslwiki\/FslInstallation\" target=\"_blank\">http:\/\/fsl.fmrib.ox.ac.uk\/fsl\/fslwiki\/FslInstallation<\/a><\/li>\n<li><strong>Anaconda<\/strong>: <a href=\"https:\/\/www.continuum.io\/downloads\" target=\"_blank\">https:\/\/www.continuum.io\/downloads<\/a><\/li>\n<\/ul>\n<p>\u00a0<\/p>\n<p>You'll also need a copy of the UCHANGE_ProcessingPipeline code from GitHub:\u00a0<a href=\"https:\/\/github.com\/KirstieJane\/UCHANGE_ProcessingPipeline\" target=\"_blank\">https:\/\/github.com\/KirstieJane\/UCHANGE_ProcessingPipeline.<\/a><\/p>\n<ul>\n<li>You can download the latest version by clicking <strong>Clone or Download <\/strong>and then <strong>Download Zip<\/strong>.<\/li>\n<li>Unzip the folder contents and save them somewhere close to where you're working.<\/li>\n<\/ul>\n<p>\u00a0<\/p>\n<p>From within <strong>Anaconda<\/strong> install the following python packages following the command below:<\/p>\n<ul>\n<li><a href=\"http:\/\/www.vtk.org\/VTK\/resources\/software.html#latestcand\" target=\"_blank\">VTK<\/a><\/li>\n<li><a href=\"http:\/\/mayavi.sourceforge.net\/install.html\" target=\"_blank\">Mayavi<\/a><\/li>\n<li><a href=\"http:\/\/nipy.sourceforge.net\/nibabel\/installation.html#installation\" target=\"_blank\">Nibabel<\/a> <code><\/code><\/li>\n<li><a href=\"http:\/\/pysurfer.github.io\/install.html\" target=\"_blank\">pysurfer<\/a><\/li>\n<\/ul>"},"is_project":0},{"component_id":"1015501","previous_id":"1015500","original_id":"163815","guid":"129F110279344235A4FAA8668D0880B8","previous_guid":"AAB822D48997413FB8E0D5FF46BF9D32","component_type_id":"15","data_id":"2588","data":"","order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"conda install vtk\nconda install mayavi\npip install nibabel\npip install pysurfer","description":"Install the required python packages after installing Anaconda.","os_name":"Linux","os_version":"","can_edit":"1"},"is_project":0}]},{"id":"592045","is_changed":"0","original_id":"148582","is_skipped":"0","is_checked":"0","guid":"4C1E464958144728A2F658AD55C9FF53","previous_guid":"BD40D3C6EDAD40C3A34E2BA7EE739412","previous_id":"592047","last_modified":"1508916896","components":[{"component_id":"1015502","previous_id":0,"original_id":"980484","guid":"F4B0E52951C449C191E6BEBC516FA360","previous_guid":null,"component_type_id":"6","data_id":null,"data":"Set up directory structure","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Set up directory structure"},"is_project":0},{"component_id":"1015503","previous_id":"1015502","original_id":"161466","guid":"09FA33E7CBF243DE997C756D1C50649C","previous_guid":"F4B0E52951C449C191E6BEBC516FA360","component_type_id":"1","data_id":null,"data":"<p>You must have the appropriate input files in the displayed directory structure:<br \/><img id=\"s-mce-img\" class=\"s-mce-img\" src=\"https:\/\/s3.amazonaws.com\/pr-journal\/c657fm.png\" width=\"108\" height=\"474\" data-src=\"https:\/\/s3.amazonaws.com\/pr-journal\/c647fm.png\" data-ofn=\"MakeDirTrees.png\" \/><\/p>\n<p>\u00a0<\/p>\n<p>Inside <strong>SUB_DATA<\/strong> are directories named with the subject IDs.<\/p>\n<p>\u00a0<\/p>\n<p>Inside each subject directory is one for the high resolution structural scans (either <strong>MPM<\/strong> or <strong>MPRAGE<\/strong>) and one for the DTI data (<strong>DTI<\/strong>).<\/p>\n<p>\u00a0<\/p>\n<p>Within each of these folders are folders for the timepoint (occasion) such as (<strong>baseline<\/strong>, <strong>6_month<\/strong>, <strong>1st_follow_up<\/strong>, <strong>T1_AP<\/strong> etc).<\/p>\n<p>\u00a0<\/p>\n<p>Then within the occasion folder are the input files as described below:<\/p>\n<p>\u00a0<\/p>\n<p><em>Multi-parametric mapping (MPM) input files:<\/em><\/p>\n<ul>\n<li><strong>R1.nii.gz<\/strong> -- 3D NIFTI image containing longitudinal relaxation rate (R1) values in MPM subject space<\/li>\n<li><strong>R2s.nii.gz<\/strong> -- 3D NIFTI image containing transverse relaxation rate (R2s) values in MPM subject space<\/li>\n<li><strong>MT.nii.gz<\/strong> -- 3D NIFTI image containing magnetisation transfer (MT) values in MPM subject space<\/li>\n<li><strong>A.nii.gz<\/strong> -- 3D NIFTI image containing proton density (A) values in MPM subject space<\/li>\n<li><strong>PDw.nii.gz<\/strong> -- 3D NIFTI image containing proton density weighted (PDw) values in MPM subject space<\/li>\n<\/ul>\n<p>\u00a0<\/p>\n<p>OR, if you don't have MPM files:<\/p>\n<p><em>Highres MPRAGE input file:<\/em><\/p>\n<ul>\n<li><strong>highres.nii.gz<\/strong> -- 3D NIFTI image containing T1 weighted values in MPRAGE subject space<\/li>\n<\/ul>\n<p><strong><br \/><\/strong><em>Diffusion weighted imaging (DWI) imaging input files:<\/em><\/p>\n<ul>\n<li><strong>dti.nii.gz<\/strong> -- 4D NIFTI image containing 63 diffusion weighted acquisition and 6 non-weighted acquistions (total N=69) in DTI subject space<\/li>\n<li><strong>bvals<\/strong> -- text file containing one row of 69 values representing the diffusion weightings for the 69 volumes in <strong>dti.nii.gz<\/strong><\/li>\n<li><strong>bvecs<\/strong> -- text file containing three rows of 69 values representing the x, y, and z components of the diffusion directions for the 69 volumes in <strong>dti.nii.gz<\/strong><\/li>\n<\/ul>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>You must have the appropriate input files in the displayed directory structure:<br \/><img id=\"s-mce-img\" class=\"s-mce-img\" src=\"https:\/\/s3.amazonaws.com\/pr-journal\/c657fm.png\" width=\"108\" height=\"474\" data-src=\"https:\/\/s3.amazonaws.com\/pr-journal\/c647fm.png\" data-ofn=\"MakeDirTrees.png\" \/><\/p>\n<p>\u00a0<\/p>\n<p>Inside <strong>SUB_DATA<\/strong> are directories named with the subject IDs.<\/p>\n<p>\u00a0<\/p>\n<p>Inside each subject directory is one for the high resolution structural scans (either <strong>MPM<\/strong> or <strong>MPRAGE<\/strong>) and one for the DTI data (<strong>DTI<\/strong>).<\/p>\n<p>\u00a0<\/p>\n<p>Within each of these folders are folders for the timepoint (occasion) such as (<strong>baseline<\/strong>, <strong>6_month<\/strong>, <strong>1st_follow_up<\/strong>, <strong>T1_AP<\/strong> etc).<\/p>\n<p>\u00a0<\/p>\n<p>Then within the occasion folder are the input files as described below:<\/p>\n<p>\u00a0<\/p>\n<p><em>Multi-parametric mapping (MPM) input files:<\/em><\/p>\n<ul>\n<li><strong>R1.nii.gz<\/strong> -- 3D NIFTI image containing longitudinal relaxation rate (R1) values in MPM subject space<\/li>\n<li><strong>R2s.nii.gz<\/strong> -- 3D NIFTI image containing transverse relaxation rate (R2s) values in MPM subject space<\/li>\n<li><strong>MT.nii.gz<\/strong> -- 3D NIFTI image containing magnetisation transfer (MT) values in MPM subject space<\/li>\n<li><strong>A.nii.gz<\/strong> -- 3D NIFTI image containing proton density (A) values in MPM subject space<\/li>\n<li><strong>PDw.nii.gz<\/strong> -- 3D NIFTI image containing proton density weighted (PDw) values in MPM subject space<\/li>\n<\/ul>\n<p>\u00a0<\/p>\n<p>OR, if you don't have MPM files:<\/p>\n<p><em>Highres MPRAGE input file:<\/em><\/p>\n<ul>\n<li><strong>highres.nii.gz<\/strong> -- 3D NIFTI image containing T1 weighted values in MPRAGE subject space<\/li>\n<\/ul>\n<p><strong><br \/><\/strong><em>Diffusion weighted imaging (DWI) imaging input files:<\/em><\/p>\n<ul>\n<li><strong>dti.nii.gz<\/strong> -- 4D NIFTI image containing 63 diffusion weighted acquisition and 6 non-weighted acquistions (total N=69) in DTI subject space<\/li>\n<li><strong>bvals<\/strong> -- text file containing one row of 69 values representing the diffusion weightings for the 69 volumes in <strong>dti.nii.gz<\/strong><\/li>\n<li><strong>bvecs<\/strong> -- text file containing three rows of 69 values representing the x, y, and z components of the diffusion directions for the 69 volumes in <strong>dti.nii.gz<\/strong><\/li>\n<\/ul>"},"is_project":0}]},{"id":"592046","is_changed":"0","original_id":"148585","is_skipped":"0","is_checked":"0","guid":"0919741B81A74D8599F9CD4A4C90B119","previous_guid":"B7B06E11DA504F46B2D945DFA520D92A","previous_id":"592048","last_modified":"1516005939","components":[{"component_id":"1015504","previous_id":0,"original_id":"980485","guid":"106ECB40691E4A289F86718A5A9B03E9","previous_guid":null,"component_type_id":"6","data_id":null,"data":"Mask background and brain extract MPM images","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Mask background and brain extract MPM images"},"is_project":0},{"component_id":"1015505","previous_id":"1015504","original_id":"161469","guid":"D4494AEE86634CEF94DE1812D959FD98","previous_guid":"106ECB40691E4A289F86718A5A9B03E9","component_type_id":"1","data_id":null,"data":"<p><span style=\"text-decoration: underline;\"><strong>NOTE: You can skip this step if you only have MPRAGE data (as highres.nii.gz).<\/strong><\/span><\/p>\n<p>\u00a0<\/p>\n<p>The multi-parametric mapping (MPM) images have been calculated from the three acquisitions with different relaxation parameters and two fields maps. The models used to fit the data together make sense in the brain, but create very variable (noisy) values outside of the head. The first step is to brain and head extract the proton density weighted image (<strong>PDw.nii.gz<\/strong>) and apply these masks to the quantitative MPM images. Note that the &lt;MPM&gt;_brain.nii.gz files that are output have been eroded by 3 voxels from the original output of FSL's bet command.<br \/><br \/>The commands are contained in the <strong>NSPN_mpm_bet_mask.sh <\/strong>script.<\/p>\n<p>\u00a0<\/p>\n<p>Example usage: <strong>NSPN_mpm_bet_mask.sh SUB_DATA\/12345\/MPM\/baseline\/PDw.nii.gz<\/strong><br \/><br \/>Specifically it runs:<\/p>\n<ul>\n<li><strong>fslreorient2std<\/strong> to make sure all MPM files are in FSL's standard alignment and saved in .nii.gz format<\/li>\n<li><strong>bet<\/strong> with the <strong>-A<\/strong> option on the PDw.nii.gz image to create the head and brain masks<strong><br \/><\/strong><\/li>\n<li><strong>fslmaths<\/strong> with the <strong>-ero<\/strong> option to erode the brain mask by 3mm<\/li>\n<li><strong>fslmaths<\/strong> with the <strong>-bin -mul<\/strong> options to apply the brain and head masks to the R1, R2s, MT and A mpm images<\/li>\n<\/ul>\n<p>\u00a0<\/p>\n<p>You can find the code in the UCHANGE_ProcessingPipeline github repository <a href=\"https:\/\/github.com\/KirstieJane\/UCHANGE_ProcessingPipeline\/blob\/master\/NSPN_mpm_bet_mask.sh\" target=\"_blank\">here<\/a>.<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>\n<p>USAGE: NSPN_mpm_bet_mask.sh &lt;pdw_file&gt;<\/p>\n<p>\u00a0<\/p>\n<p>DESCRIPTION: This code conducts a brain and head extraction of the PDw image to which the quantitative multiparametric mapping (MPM) images have been aligned. It then uses the head mask to set all voxels outside of the head to zero for the quantitative MPM images and uses the brain mask to create brain extracted versions of the MPM images (where all voxels outside of the brain have been set to zero).<\/p>\n<p>\u00a0<\/p>\n<p>INPUTS:<\/p>\n<ul>\n<li><strong>pdw_file<\/strong> : Proton density weighted file to which the MPM quantitative maps are aligned.<\/li>\n<\/ul>\n<p>\u00a0<\/p>\n<p>EXPECTS: The following files should be in the same directory as the input file:<\/p>\n<ul>\n<li>R1.nii.gz<\/li>\n<li>MT.nii.gz<\/li>\n<li>R2s.nii.gz<\/li>\n<li>A.nii.gz<\/li>\n<\/ul>\n<p>\u00a0<\/p>\n<p>OUTPUTS: The following output files are in the same directory as the input file. Additionally a sub-directory called <strong>PDw_bet<\/strong> is created and contains all the files created by FSL's bet command.<\/p>\n<ul>\n<li><strong>R1_head.nii.gz<\/strong><\/li>\n<li><strong>R1_brain.nii.gz<\/strong><\/li>\n<li><strong>R2s_head.nii.gz<\/strong><\/li>\n<li><strong>R2s_brain.nii.gz<\/strong><\/li>\n<li><strong>MT_head.nii.gz<\/strong><\/li>\n<li><strong>MT_brain.nii.gz<\/strong><\/li>\n<li><strong>A_head.nii.gz<\/strong><\/li>\n<li><strong>A_brain.nii.gz<\/strong><\/li>\n<\/ul>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p><span style=\"text-decoration: underline;\"><strong>NOTE: You can skip this step if you only have MPRAGE data (as highres.nii.gz).<\/strong><\/span><\/p>\n<p>\u00a0<\/p>\n<p>The multi-parametric mapping (MPM) images have been calculated from the three acquisitions with different relaxation parameters and two fields maps. The models used to fit the data together make sense in the brain, but create very variable (noisy) values outside of the head. The first step is to brain and head extract the proton density weighted image (<strong>PDw.nii.gz<\/strong>) and apply these masks to the quantitative MPM images. Note that the &lt;MPM&gt;_brain.nii.gz files that are output have been eroded by 3 voxels from the original output of FSL's bet command.<br \/><br \/>The commands are contained in the <strong>NSPN_mpm_bet_mask.sh <\/strong>script.<\/p>\n<p>\u00a0<\/p>\n<p>Example usage: <strong>NSPN_mpm_bet_mask.sh SUB_DATA\/12345\/MPM\/baseline\/PDw.nii.gz<\/strong><br \/><br \/>Specifically it runs:<\/p>\n<ul>\n<li><strong>fslreorient2std<\/strong> to make sure all MPM files are in FSL's standard alignment and saved in .nii.gz format<\/li>\n<li><strong>bet<\/strong> with the <strong>-A<\/strong> option on the PDw.nii.gz image to create the head and brain masks<strong><br \/><\/strong><\/li>\n<li><strong>fslmaths<\/strong> with the <strong>-ero<\/strong> option to erode the brain mask by 3mm<\/li>\n<li><strong>fslmaths<\/strong> with the <strong>-bin -mul<\/strong> options to apply the brain and head masks to the R1, R2s, MT and A mpm images<\/li>\n<\/ul>\n<p>\u00a0<\/p>\n<p>You can find the code in the UCHANGE_ProcessingPipeline github repository <a href=\"https:\/\/github.com\/KirstieJane\/UCHANGE_ProcessingPipeline\/blob\/master\/NSPN_mpm_bet_mask.sh\" target=\"_blank\">here<\/a>.<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>\n<p>USAGE: NSPN_mpm_bet_mask.sh &lt;pdw_file&gt;<\/p>\n<p>\u00a0<\/p>\n<p>DESCRIPTION: This code conducts a brain and head extraction of the PDw image to which the quantitative multiparametric mapping (MPM) images have been aligned. It then uses the head mask to set all voxels outside of the head to zero for the quantitative MPM images and uses the brain mask to create brain extracted versions of the MPM images (where all voxels outside of the brain have been set to zero).<\/p>\n<p>\u00a0<\/p>\n<p>INPUTS:<\/p>\n<ul>\n<li><strong>pdw_file<\/strong> : Proton density weighted file to which the MPM quantitative maps are aligned.<\/li>\n<\/ul>\n<p>\u00a0<\/p>\n<p>EXPECTS: The following files should be in the same directory as the input file:<\/p>\n<ul>\n<li>R1.nii.gz<\/li>\n<li>MT.nii.gz<\/li>\n<li>R2s.nii.gz<\/li>\n<li>A.nii.gz<\/li>\n<\/ul>\n<p>\u00a0<\/p>\n<p>OUTPUTS: The following output files are in the same directory as the input file. Additionally a sub-directory called <strong>PDw_bet<\/strong> is created and contains all the files created by FSL's bet command.<\/p>\n<ul>\n<li><strong>R1_head.nii.gz<\/strong><\/li>\n<li><strong>R1_brain.nii.gz<\/strong><\/li>\n<li><strong>R2s_head.nii.gz<\/strong><\/li>\n<li><strong>R2s_brain.nii.gz<\/strong><\/li>\n<li><strong>MT_head.nii.gz<\/strong><\/li>\n<li><strong>MT_brain.nii.gz<\/strong><\/li>\n<li><strong>A_head.nii.gz<\/strong><\/li>\n<li><strong>A_brain.nii.gz<\/strong><\/li>\n<\/ul>"},"is_project":0}]},{"id":"592047","is_changed":"0","original_id":"149899","is_skipped":"0","is_checked":"0","guid":"BD40D3C6EDAD40C3A34E2BA7EE739412","previous_guid":"DBFAADEE41C942B0B6EEF87BAE8E4FB4","previous_id":"592044","last_modified":"1508916890","components":[{"component_id":"1015506","previous_id":0,"original_id":"980739","guid":"2D6C8F68AE2E4F3B98BDB52A7009D356","previous_guid":null,"component_type_id":"6","data_id":null,"data":"Set up your .bashrc file","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Set up your .bashrc file"},"is_project":0},{"component_id":"1015507","previous_id":"1015506","original_id":"163817","guid":"1495B12A2A854490A491A259F8709B44","previous_guid":"2D6C8F68AE2E4F3B98BDB52A7009D356","component_type_id":"1","data_id":null,"data":"<p>NOTE: This step has been removed from the public version of this protocol as it gives away information about the setup of our local computing cluster. The comments have been left in, so please consult your local sys admin to help you set up this step.<\/p>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>NOTE: This step has been removed from the public version of this protocol as it gives away information about the setup of our local computing cluster. The comments have been left in, so please consult your local sys admin to help you set up this step.<\/p>"},"is_project":0},{"component_id":"1015508","previous_id":"1015507","original_id":"163818","guid":"EFE71E065F0742578F9BDC98C851B819","previous_guid":"1495B12A2A854490A491A259F8709B44","component_type_id":"15","data_id":"2589","data":"","order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"# .bashrc\n\n# Source global definitions\nif [ -f \/etc\/bashrc ]; then\n\t. \/etc\/bashrc\nfi\n\n# User specific aliases and functions\n\n#-------------------------------------\n# Define the DRIVERS directory location\ndrivers_dir= ##INSERT PATH TO YOUR LOCAL INSTALLATIONS\n\n#-------------------------------------\n# Edited on July 15th\n# By Kirstie Whitaker\n# kw401@cam.ac.uk\n\nFSLDIR=${drivers_dir}\/FSL_5_0_9\/fsl\/\nFSL_DIR=${drivers_dir}\/FSL_5_0_9\/fsl\/\n. ${FSLDIR}\/etc\/fslconf\/fsl.sh\nPATH=${FSLDIR}\/bin:${PATH}\nexport FSLDIR\nexport PATH\n\n#----------------------------------------\n# Set up Matlab\nmodule load matlab\/r2014a\n\n#----------------------------------------\n# Set up Freesurfer\ndata_dir=$HOME\nexport SUBJECTS_DIR=${data_dir}\n\nexport FREESURFER_HOME=${drivers_dir}\/FREESURFER_DEV\/freesurfer\nsource $FREESURFER_HOME\/SetUpFreeSurfer.sh\n\n#----------------------------------------\n# added by Anaconda2 4.0.0 installer\nexport PATH= ### THIS SHOULD BE ADDED AUTOMATICALLY","description":"","os_name":"","os_version":"","can_edit":"1"},"is_project":0}]},{"id":"592048","is_changed":"0","original_id":"149912","is_skipped":"0","is_checked":"0","guid":"B7B06E11DA504F46B2D945DFA520D92A","previous_guid":"4C1E464958144728A2F658AD55C9FF53","previous_id":"592045","last_modified":"1508916902","components":[{"component_id":"1015509","previous_id":0,"original_id":"980740","guid":"ED645E4BB09945E1ADEFE61F572C879C","previous_guid":null,"component_type_id":"6","data_id":null,"data":"Put the fsaverageSubP folder in the SUB_DATA directory","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Put the fsaverageSubP folder in the SUB_DATA directory"},"is_project":0},{"component_id":"1015510","previous_id":"1015509","original_id":"163849","guid":"DCAFFD02F8524972B6E48D3A991BE63A","previous_guid":"ED645E4BB09945E1ADEFE61F572C879C","component_type_id":"1","data_id":null,"data":"<p>The fsaverageSubP directory contains the 308 parcellation and needs to be in the SUB_DATA directory in order to map the parcellation to individual subject space.<br \/><br \/>Copy the fsaverageSubP folder from the FS_SUBJECTS directory in the UCHANGE_ProcessingPipeline GitHub repository into the SUB_DATA directory.<\/p>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>The fsaverageSubP directory contains the 308 parcellation and needs to be in the SUB_DATA directory in order to map the parcellation to individual subject space.<br \/><br \/>Copy the fsaverageSubP folder from the FS_SUBJECTS directory in the UCHANGE_ProcessingPipeline GitHub repository into the SUB_DATA directory.<\/p>"},"is_project":0}]},{"id":"592049","is_changed":"0","original_id":"151777","is_skipped":"0","is_checked":"0","guid":"FBFC6A8943A24E799E51258EDCA8DC05","previous_guid":"3DF5A9B7E13B4568A95A0F7848C78A95","previous_id":"602993","last_modified":"1516008061","components":[{"component_id":"1015511","previous_id":0,"original_id":"981143","guid":"F779464A421842CF875F8A70ADCDD433","previous_guid":null,"component_type_id":"6","data_id":null,"data":"Run Freesurfer's Recon-all command","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Run Freesurfer's Recon-all command"},"is_project":0},{"component_id":"1015512","previous_id":"1015511","original_id":"167648","guid":"8A724C32CB1848AA89E6728A1C84FE18","previous_guid":"F779464A421842CF875F8A70ADCDD433","component_type_id":"1","data_id":null,"data":"<p>Next step is to run Recon-all.<\/p>\n<p>\u00a0<\/p>\n<p>If you have MPM data then you need to do this in a couple of steps because we want to apply our own brain extraction masks. The commands are in <strong>NSPN_Reconall_MPM.sh<\/strong>.<\/p>\n<p>\u00a0<\/p>\n<p>You can see the commands in the template file: <strong>FSv6_reconall_MPM_TEMPLATE.sh<\/strong>.<\/p>\n<p>\u00a0<\/p>\n<p>If you only have an MPRAGE scan then you can just run <strong>NSPN_Reconall_MPRAGE.sh<\/strong>.<\/p>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>Next step is to run Recon-all.<\/p>\n<p>\u00a0<\/p>\n<p>If you have MPM data then you need to do this in a couple of steps because we want to apply our own brain extraction masks. The commands are in <strong>NSPN_Reconall_MPM.sh<\/strong>.<\/p>\n<p>\u00a0<\/p>\n<p>You can see the commands in the template file: <strong>FSv6_reconall_MPM_TEMPLATE.sh<\/strong>.<\/p>\n<p>\u00a0<\/p>\n<p>If you only have an MPRAGE scan then you can just run <strong>NSPN_Reconall_MPRAGE.sh<\/strong>.<\/p>"},"is_project":0}]},{"id":"592050","is_changed":"0","original_id":"151778","is_skipped":"0","is_checked":"0","guid":"8A204D6ADAD246F09C47BDDBE7513B41","previous_guid":"FBFC6A8943A24E799E51258EDCA8DC05","previous_id":"592049","last_modified":"1508916834","components":[{"component_id":"1015513","previous_id":0,"original_id":"981144","guid":"863C7EC8C8E148AA9D96C43C11FC8D8F","previous_guid":null,"component_type_id":"6","data_id":null,"data":"Quality control","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Quality control"},"is_project":0},{"component_id":"1015514","previous_id":"1015513","original_id":"167649","guid":"32596D132D8D4F6C8C176BADAE400122","previous_guid":"863C7EC8C8E148AA9D96C43C11FC8D8F","component_type_id":"1","data_id":null,"data":"<p>DO YOUR QC CHECKS!! Everything else beyond this point is dependent on having accurate surfaces!<\/p>\n<p>\u00a0<\/p>\n<p>This step needs some documentation, but there's some useful notes at https:\/\/github.com\/KirstieJane\/NSPN_MRIProcessing\/wiki\/Freesurfer-Edits-%28BCNI%29<\/p>\n<p>\u00a0<\/p>\n<p>You need to be on one of the graphics nodes (eg: login-gfx1)<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>\n<p>1. Claim your participant (for this scan occasion) in the google doc.<\/p>\n<p>\u00a0<\/p>\n<p>2. Open up the scan information in freeview using the command below. Remember to first set your nspn_id and occ variables.<\/p>\n<p>\u00a0<\/p>\n<p>3. Make any necessary edits to the <strong>wm.mgz<\/strong> file and add control points to the file <strong>tmp\/control.dat<\/strong>.<\/p>\n<p>\u00a0<\/p>\n<p>4. Add your subject ID to a text file, called, for example, sublist_fsEdits_KW_20160715 and saved in your home directory.<\/p>\n<p>\u00a0<\/p>\n<p>5. Repeat steps 1-4 for any additional participants that you're processing in this batch.<\/p>\n<p>\u00a0<\/p>\n<p>6. Submit all edits using the following command:<\/p>\n<p><strong>\/scratch\/bmu-nspn\/SCRIPTS\/LoopCommandOverSubjects.sh ${data_dir} ${sublist} \/scratch\/bmu-nspn\/TEMPLATE_SCRIPTS\/dev_reconallEdits_TEMPLATE.sh 2100<\/strong><\/p>\n<p>\u00a0<\/p>\n<p>7. Update the google doc with this information.<\/p>\n<p>\u00a0<\/p>\n<p>Have a cup of tea and relax. Your edits will be complete in approximately 20 hours time.<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>\n<p><br \/>\u00a0<\/p>\n<p>AND you need to put vglrun infront of the freeview command!<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>DO YOUR QC CHECKS!! Everything else beyond this point is dependent on having accurate surfaces!<\/p>\n<p>\u00a0<\/p>\n<p>This step needs some documentation, but there's some useful notes at https:\/\/github.com\/KirstieJane\/NSPN_MRIProcessing\/wiki\/Freesurfer-Edits-%28BCNI%29<\/p>\n<p>\u00a0<\/p>\n<p>You need to be on one of the graphics nodes (eg: login-gfx1)<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>\n<p>1. Claim your participant (for this scan occasion) in the google doc.<\/p>\n<p>\u00a0<\/p>\n<p>2. Open up the scan information in freeview using the command below. Remember to first set your nspn_id and occ variables.<\/p>\n<p>\u00a0<\/p>\n<p>3. Make any necessary edits to the <strong>wm.mgz<\/strong> file and add control points to the file <strong>tmp\/control.dat<\/strong>.<\/p>\n<p>\u00a0<\/p>\n<p>4. Add your subject ID to a text file, called, for example, sublist_fsEdits_KW_20160715 and saved in your home directory.<\/p>\n<p>\u00a0<\/p>\n<p>5. Repeat steps 1-4 for any additional participants that you're processing in this batch.<\/p>\n<p>\u00a0<\/p>\n<p>6. Submit all edits using the following command:<\/p>\n<p><strong>\/scratch\/bmu-nspn\/SCRIPTS\/LoopCommandOverSubjects.sh ${data_dir} ${sublist} \/scratch\/bmu-nspn\/TEMPLATE_SCRIPTS\/dev_reconallEdits_TEMPLATE.sh 2100<\/strong><\/p>\n<p>\u00a0<\/p>\n<p>7. Update the google doc with this information.<\/p>\n<p>\u00a0<\/p>\n<p>Have a cup of tea and relax. Your edits will be complete in approximately 20 hours time.<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>\n<p><br \/>\u00a0<\/p>\n<p>AND you need to put vglrun infront of the freeview command!<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>"},"is_project":0},{"component_id":"1015515","previous_id":"1015514","original_id":"178115","guid":"0853B39E55154F6586A403C083875FCF","previous_guid":"32596D132D8D4F6C8C176BADAE400122","component_type_id":"15","data_id":"2590","data":"","order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"# Set up some variables\ndata_dir=\/scratch\/bmu-nspn\/UCHANGE # Change this to fit your needs\nsublist=\/home\/kw401\/sublist_fsEdits_KW_20160715 # Change this to fit your needs\n\nsub=12345 # Change this for each subject you're checking\nocc=baseline # Change this as needed\n\n# Open up the surfaces\n# You should be able to just copy and paste this command once you've set the variable above\nSUBJECTS_DIR=${data_dir}\/SUB_DATA\/${sub}\/SURFER\/${occ}\/\nvglrun freeview -v ${SUBJECTS_DIR}\/mri\/T1.mgz \\\n            ${SUBJECTS_DIR}\/mri\/brainmask.mgz \\\n            ${SUBJECTS_DIR}\/mri\/wm.mgz:colormap=heat:opacity=0.4 \\\n         -f ${SUBJECTS_DIR}\/surf\/lh.white:edgecolor=yellow \\\n            ${SUBJECTS_DIR}\/surf\/lh.pial:edgecolor=red \\\n            ${SUBJECTS_DIR}\/surf\/rh.white:edgecolor=yellow \\\n            ${SUBJECTS_DIR}\/surf\/rh.pial:edgecolor=red \\\n            ${SUBJECTS_DIR}\/surf\/lh.inflated:visible=0 \\\n            ${SUBJECTS_DIR}\/surf\/rh.inflated:visible=0 \\\n         -c ${SUBJECTS_DIR}\/tmp\/control.dat","description":"You may get an error when loading up the files in freeview if the tmp\/control.dat file doesn't exist. If this is true (eg, on your first editing pass) then just say ok and ignore the error, otherwise take a look to see if the file has been named incorrectly!","os_name":"","os_version":"","can_edit":"1"},"is_project":0}]},{"id":"592051","is_changed":"0","original_id":"151779","is_skipped":"0","is_checked":"0","guid":"00272E3F68C34A34980BA29151A9DE4F","previous_guid":"8A204D6ADAD246F09C47BDDBE7513B41","previous_id":"592050","last_modified":"1516007683","components":[{"component_id":"1015516","previous_id":0,"original_id":"981145","guid":"49F0E46D57154AA597A9B604EE0A0991","previous_guid":null,"component_type_id":"6","data_id":null,"data":"Run Freesurfer's Trac-all","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Run Freesurfer's Trac-all"},"is_project":0},{"component_id":"1015517","previous_id":"1015516","original_id":"167650","guid":"36363EB532014BEDB3CCF32CCB3101E0","previous_guid":"49F0E46D57154AA597A9B604EE0A0991","component_type_id":"1","data_id":null,"data":"<p>This has a side effect of processing the DTI data for you so you can extract values later on :)<\/p>\n<p>\u00a0<\/p>\n<p>DTI files <strong>dti.nii.gz<\/strong>, <strong>bvals<\/strong> and <strong>bvecs_orig<\/strong> must exist in the DTI directory structure defined above.<\/p>\n<p>\u00a0<\/p>\n<p>The main freesurfer command you're using is <strong>trac-all<\/strong> and the whole processing loop steps are in <a href=\"https:\/\/github.com\/KirstieJane\/UCHANGE_ProcessingPipeline\/blob\/master\/NSPN_Tracall.sh\" target=\"_blank\"><strong>NSPN_Tracall.sh<\/strong><\/a>.<\/p>\n<p>\u00a0<\/p>\n<p>Note that this command takes quite a long time (around 24 hours of processing).<\/p>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>This has a side effect of processing the DTI data for you so you can extract values later on :)<\/p>\n<p>\u00a0<\/p>\n<p>DTI files <strong>dti.nii.gz<\/strong>, <strong>bvals<\/strong> and <strong>bvecs_orig<\/strong> must exist in the DTI directory structure defined above.<\/p>\n<p>\u00a0<\/p>\n<p>The main freesurfer command you're using is <strong>trac-all<\/strong> and the whole processing loop steps are in <a href=\"https:\/\/github.com\/KirstieJane\/UCHANGE_ProcessingPipeline\/blob\/master\/NSPN_Tracall.sh\" target=\"_blank\"><strong>NSPN_Tracall.sh<\/strong><\/a>.<\/p>\n<p>\u00a0<\/p>\n<p>Note that this command takes quite a long time (around 24 hours of processing).<\/p>"},"is_project":0},{"component_id":"1015518","previous_id":"1015517","original_id":"1014140","guid":"1BA7FF6EFF58490EA730A4D57A3ED6D7","previous_guid":"36363EB532014BEDB3CCF32CCB3101E0","component_type_id":"13","data_id":"16531","data":"","order_id":"2","name":"Comment","data_by_id":"1","type_id":"13","source_data":{"annotation_id":"16531","thread_id":"16531","id":"16531","thread_title":"Annotation on step 8 of UCHANGE structural neuroimaging pipeline","uri":"annotation-on-step-8-of-uchange-structural-neuroimaging","thread_uri":"annotation-on-step-8-of-uchange-structural-neuroimaging","step_id":"151779","protocol_uri":"uchange-structural-neuroimaging-pipeline-eu5bey6","protocol_name":"UCHANGE structural neuroimaging pipeline","protocol_name_html":"UCHANGE structural neuroimaging pipeline","annotation":"<p>Might be worth commenting that this takes quite a long time? (I think it took over a day per subject for me)<\/p>","thread_text":"<p>Might be worth commenting that this takes quite a long time? (I think it took over a day per subject for me)<\/p>","body":"<p>Might be worth commenting that this takes quite a long time? (I think it took over a day per subject for me)<\/p>","is_private":"0","public_protocol":"1","can_edit":0,"can_delete":"0","show_name":"1","created_date":"1508494855","created_on":"1508494855","modified_on":null,"last_updated":null,"profile_image":"\/img\/avatars\/014.png","full_name":"Sarah Morgan","affiliation":null,"username":"sarah-morgan","email":"kw401@cam.ac.uk","pa_useranme":"kirstie-whitaker","comments":[{"comment_type":"1","profile_image":"\/img\/avatars\/014.png","affiliation":null,"full_name":"Sarah Morgan","name":"Sarah Morgan","username":"sarah-morgan","comment_text":"<p>And pointing to https:\/\/github.com\/KirstieJane\/UCHANGE_ProcessingPipeline\/blob\/master\/NSPN_Tracall.sh<\/p>","body":"<p>And pointing to https:\/\/github.com\/KirstieJane\/UCHANGE_ProcessingPipeline\/blob\/master\/NSPN_Tracall.sh<\/p>","anonymously":"0","parent_comment_id":"0","parent_id":"0","comment_id":"2816","id":"2816","created_on":"1508497824","modified_on":null,"comment_rating":null,"can_edit":0,"can_remove":0,"is_private":"0","can_delete":0},{"comment_type":"1","profile_image":"https:\/\/s3.amazonaws.com\/pr-journal\/c6w7fm.jpg","affiliation":"Brain Mapping Unit, Department of Psychiatry, University of Cambridge ","full_name":"Kirstie Whitaker","name":"Kirstie Whitaker","username":"kirstie-whitaker","comment_text":"<p>DONE! Thank you Sarah!<\/p>","body":"<p>DONE! Thank you Sarah!<\/p>","anonymously":"0","parent_comment_id":"2816","parent_id":"2816","comment_id":"2939","id":"2939","created_on":"1516007584","modified_on":null,"comment_rating":null,"can_edit":0,"can_remove":0,"is_private":"0","can_delete":0}]},"is_project":0}]},{"id":"592052","is_changed":"0","original_id":"151780","is_skipped":"0","is_checked":"0","guid":"A2B73E2FEE09439D93DA1CACE3DA164F","previous_guid":"00272E3F68C34A34980BA29151A9DE4F","previous_id":"592051","last_modified":"1508916858","components":[{"component_id":"1015519","previous_id":0,"original_id":"981146","guid":"C6DEA93FC6EB43DBA255D2B639F39FD1","previous_guid":null,"component_type_id":"6","data_id":null,"data":"Parcellate brain","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Parcellate brain"},"is_project":0},{"component_id":"1015520","previous_id":"1015519","original_id":"167651","guid":"C8C0266F43FB4543B70979BACCB22706","previous_guid":"C6DEA93FC6EB43DBA255D2B639F39FD1","component_type_id":"1","data_id":null,"data":"<p>Run NSPN_Parcellation_PostEdits.sh.<\/p>\n<p>\u00a0<\/p>\n<p>This step is part of the <strong>dev_ParcAndExtract_TEMPLATE.sh<\/strong> template script.<\/p>\n<p>\u00a0<\/p>\n<p>You can find the code in the UCHANGE_ProcessingPipeline github repository <a href=\"https:\/\/github.com\/KirstieJane\/UCHANGE_ProcessingPipeline\/blob\/master\/NSPN_Parcellation_PostEdits.sh\" target=\"_blank\">here<\/a>.<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>\n<p>USAGE: <strong>NSPN_Parcellation_PostEdits.sh &lt;study_dir&gt; &lt;sub&gt; &lt;occ&gt;<\/strong><\/p>\n<p>\u00a0<\/p>\n<p>DESCRIPTION: This code creates the 308 parcellation for each person in their freesurfer space, and should be applied after recon-all edits have been completed.<\/p>\n<p>\u00a0<\/p>\n<p>INPUTS:<\/p>\n<ul>\n<li><strong>study_dir<\/strong>: The directory containing the SUB_DATA folder which itself contains directories named by sub_id.<\/li>\n<li><strong>sub_id<\/strong>: Subject ID. These folders should be inside SUB_DATA and themselves contain directories called SURFER and MPM.<\/li>\n<li><strong>occ<\/strong>: The scan occasion. One of baseline, 6_month, 1st_follow_up, CBSU, UCL, WBIC, t1 and t2. This directory contains the output of recon-all and is found inside the subject's SURFER directory.<\/li>\n<\/ul>\n<p>\u00a0<\/p>\n<p>EXPECTS:<\/p>\n<ul>\n<li>All the output files from recon-all should exist in the relavent occasion directory in the subject's SURFER directory.<\/li>\n<li>All quality control editing should have been conducted.<\/li>\n<li>The fsaverageSubP directory containing the standard space parcellation should exist inside the SUB_DATA directory.<\/li>\n<\/ul>\n<p>\u00a0<\/p>\n<p>OUTPUTS: The following files are created inside the relavent occasion directory in the subject's SURFER directory:<\/p>\n<ul>\n<li><strong>parcellation\/500.aparc.nii.gz<\/strong><\/li>\n<li><strong>label\/lh.500.aparc.annot<\/strong><\/li>\n<li><strong>label\/rh.500.aparc.annot<\/strong><\/li>\n<\/ul>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>Run NSPN_Parcellation_PostEdits.sh.<\/p>\n<p>\u00a0<\/p>\n<p>This step is part of the <strong>dev_ParcAndExtract_TEMPLATE.sh<\/strong> template script.<\/p>\n<p>\u00a0<\/p>\n<p>You can find the code in the UCHANGE_ProcessingPipeline github repository <a href=\"https:\/\/github.com\/KirstieJane\/UCHANGE_ProcessingPipeline\/blob\/master\/NSPN_Parcellation_PostEdits.sh\" target=\"_blank\">here<\/a>.<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>\n<p>USAGE: <strong>NSPN_Parcellation_PostEdits.sh &lt;study_dir&gt; &lt;sub&gt; &lt;occ&gt;<\/strong><\/p>\n<p>\u00a0<\/p>\n<p>DESCRIPTION: This code creates the 308 parcellation for each person in their freesurfer space, and should be applied after recon-all edits have been completed.<\/p>\n<p>\u00a0<\/p>\n<p>INPUTS:<\/p>\n<ul>\n<li><strong>study_dir<\/strong>: The directory containing the SUB_DATA folder which itself contains directories named by sub_id.<\/li>\n<li><strong>sub_id<\/strong>: Subject ID. These folders should be inside SUB_DATA and themselves contain directories called SURFER and MPM.<\/li>\n<li><strong>occ<\/strong>: The scan occasion. One of baseline, 6_month, 1st_follow_up, CBSU, UCL, WBIC, t1 and t2. This directory contains the output of recon-all and is found inside the subject's SURFER directory.<\/li>\n<\/ul>\n<p>\u00a0<\/p>\n<p>EXPECTS:<\/p>\n<ul>\n<li>All the output files from recon-all should exist in the relavent occasion directory in the subject's SURFER directory.<\/li>\n<li>All quality control editing should have been conducted.<\/li>\n<li>The fsaverageSubP directory containing the standard space parcellation should exist inside the SUB_DATA directory.<\/li>\n<\/ul>\n<p>\u00a0<\/p>\n<p>OUTPUTS: The following files are created inside the relavent occasion directory in the subject's SURFER directory:<\/p>\n<ul>\n<li><strong>parcellation\/500.aparc.nii.gz<\/strong><\/li>\n<li><strong>label\/lh.500.aparc.annot<\/strong><\/li>\n<li><strong>label\/rh.500.aparc.annot<\/strong><\/li>\n<\/ul>"},"is_project":0}]},{"id":"592053","is_changed":"0","original_id":"151781","is_skipped":"0","is_checked":"0","guid":"0B5709013C5140F8911FD89F9A585462","previous_guid":"EAA5B020CED54F548FEDF7DB70956285","previous_id":"592056","last_modified":"1508916596","components":[{"component_id":"1015521","previous_id":0,"original_id":"167652","guid":"9C5A4D64AF3446B897A688390D64D0C8","previous_guid":null,"component_type_id":"1","data_id":null,"data":"<p>Run NSPN_ResampleSurfaces.sh<br \/>\u00a0<\/p>\n<p>This step is part of the <strong>dev_ParcAndExtract_TEMPLATE.sh<\/strong> template script.<\/p>\n<p>\u00a0<\/p>\n<p>You can find the code in the UCHANGE_ProcessingPipeline github repository <a href=\"https:\/\/github.com\/KirstieJane\/UCHANGE_ProcessingPipeline\/blob\/master\/NSPN_Parcellation_PostEdits.sh\" target=\"_blank\">here<\/a>.<\/p>\n<p>\u00a0<\/p>\n<p>You need to sample the surfaces at 10% depths from the grey\/white matter boundary (0%) to the pial surface (100%). Note that when we present the data we'll use a more intutive cortical depth where the pial surface will be 0% and the grey\/white matter boundary will be 100%, but the reason we code it this way around when creating the data is because Freesurfer measures all distances FROM the grey\/white matter boundary.<\/p>\n<p>\u00a0<\/p>\n<p>This code will also sample 20 different surfaces projecting at 0.1mm steps into white matter from the grey\/white matter boundary.<\/p>\n<p>\u00a0<\/p>\n<p>[DOCUMENTATION INCOMPLETE]<\/p>","order_id":"0","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>Run NSPN_ResampleSurfaces.sh<br \/>\u00a0<\/p>\n<p>This step is part of the <strong>dev_ParcAndExtract_TEMPLATE.sh<\/strong> template script.<\/p>\n<p>\u00a0<\/p>\n<p>You can find the code in the UCHANGE_ProcessingPipeline github repository <a href=\"https:\/\/github.com\/KirstieJane\/UCHANGE_ProcessingPipeline\/blob\/master\/NSPN_Parcellation_PostEdits.sh\" target=\"_blank\">here<\/a>.<\/p>\n<p>\u00a0<\/p>\n<p>You need to sample the surfaces at 10% depths from the grey\/white matter boundary (0%) to the pial surface (100%). Note that when we present the data we'll use a more intutive cortical depth where the pial surface will be 0% and the grey\/white matter boundary will be 100%, but the reason we code it this way around when creating the data is because Freesurfer measures all distances FROM the grey\/white matter boundary.<\/p>\n<p>\u00a0<\/p>\n<p>This code will also sample 20 different surfaces projecting at 0.1mm steps into white matter from the grey\/white matter boundary.<\/p>\n<p>\u00a0<\/p>\n<p>[DOCUMENTATION INCOMPLETE]<\/p>"},"is_project":0},{"component_id":"1015522","previous_id":"1015521","original_id":"783067","guid":"9A064B070051447AB46F1C0A256679B1","previous_guid":"9C5A4D64AF3446B897A688390D64D0C8","component_type_id":"6","data_id":null,"data":"Resample surfaces","order_id":"1","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Resample surfaces"},"is_project":0}]},{"id":"592054","is_changed":"0","original_id":"151782","is_skipped":"0","is_checked":"0","guid":"A81CBB6838AF4874B50B24B40DFAA384","previous_guid":"F5A4238411EA4F408083D84E55326644","previous_id":"592055","last_modified":"1515152602","components":[{"component_id":"1015523","previous_id":0,"original_id":"167653","guid":"7D034EBB4C95453CA4ABBC95F87A327F","previous_guid":null,"component_type_id":"1","data_id":null,"data":"<p>Run NSPN_ExtractRois.sh<br \/><br \/><\/p>\n<p>This step is part of the <strong>dev_ParcAndExtract_TEMPLATE.sh<\/strong> template script.<\/p>\n<p>\u00a0<\/p>\n<p>You can find the code in the UCHANGE_ProcessingPipeline github repository <a href=\"https:\/\/github.com\/KirstieJane\/UCHANGE_ProcessingPipeline\/blob\/master\/NSPN_Parcellation_PostEdits.sh\" target=\"_blank\">here<\/a>.<\/p>\n<p>\u00a0<\/p>\n<p>[DOCUMENTATION INCOMPLETE]<\/p>\n<p>\u00a0<\/p>\n<p>This is an important step as it is the one that pulls out the regional values for the different measures for a bunch of segmentations and parcellations.<\/p>\n<p>\u00a0<\/p>\n<p>Segmentations:<\/p>\n<ul>\n<li>wmparc<\/li>\n<li>aseg<\/li>\n<li>lobesStrict<\/li>\n<\/ul>\n<p>Parcellations:<\/p>\n<ul>\n<li>aparc<\/li>\n<li>500.aparc<\/li>\n<li>lobesStrict<\/li>\n<li>HCP<\/li>\n<li>Yeo2011_7Networks_N1000<\/li>\n<\/ul>\n<p>\u00a0<\/p>\n<p>Importantly the parcellations are extracted at multiple different depths: in 10% increments from the grey\/white matter surface (0%) to the pial surface (100%) and in 0.1mm steps from the grey\/white matter boundary to 2mm in to white matter.<\/p>\n<p>\u00a0<\/p>\n<p>USAGE: <strong>NSPN_ExtractRois.sh<\/strong> &lt;study_dir&gt; &lt;sub&gt; &lt;occ&gt;<\/p>\n<p>\u00a0<\/p>","order_id":"0","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>Run NSPN_ExtractRois.sh<br \/><br \/><\/p>\n<p>This step is part of the <strong>dev_ParcAndExtract_TEMPLATE.sh<\/strong> template script.<\/p>\n<p>\u00a0<\/p>\n<p>You can find the code in the UCHANGE_ProcessingPipeline github repository <a href=\"https:\/\/github.com\/KirstieJane\/UCHANGE_ProcessingPipeline\/blob\/master\/NSPN_Parcellation_PostEdits.sh\" target=\"_blank\">here<\/a>.<\/p>\n<p>\u00a0<\/p>\n<p>[DOCUMENTATION INCOMPLETE]<\/p>\n<p>\u00a0<\/p>\n<p>This is an important step as it is the one that pulls out the regional values for the different measures for a bunch of segmentations and parcellations.<\/p>\n<p>\u00a0<\/p>\n<p>Segmentations:<\/p>\n<ul>\n<li>wmparc<\/li>\n<li>aseg<\/li>\n<li>lobesStrict<\/li>\n<\/ul>\n<p>Parcellations:<\/p>\n<ul>\n<li>aparc<\/li>\n<li>500.aparc<\/li>\n<li>lobesStrict<\/li>\n<li>HCP<\/li>\n<li>Yeo2011_7Networks_N1000<\/li>\n<\/ul>\n<p>\u00a0<\/p>\n<p>Importantly the parcellations are extracted at multiple different depths: in 10% increments from the grey\/white matter surface (0%) to the pial surface (100%) and in 0.1mm steps from the grey\/white matter boundary to 2mm in to white matter.<\/p>\n<p>\u00a0<\/p>\n<p>USAGE: <strong>NSPN_ExtractRois.sh<\/strong> &lt;study_dir&gt; &lt;sub&gt; &lt;occ&gt;<\/p>\n<p>\u00a0<\/p>"},"is_project":0},{"component_id":"1015524","previous_id":"1015523","original_id":"783122","guid":"92CB326A5A6E45C0A34FF6148ACFEE72","previous_guid":"7D034EBB4C95453CA4ABBC95F87A327F","component_type_id":"6","data_id":null,"data":"Extract ROIs","order_id":"1","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Extract ROIs"},"is_project":0},{"component_id":"1015525","previous_id":"1015524","original_id":"1014143","guid":"F31987F84D044BA4B635415BFB5B9AEE","previous_guid":"92CB326A5A6E45C0A34FF6148ACFEE72","component_type_id":"26","data_id":"16534","data":"","order_id":"2","name":"Note","data_by_id":"1","type_id":"26","source_data":{"annotation_id":"16534","thread_id":"16534","id":"16534","thread_title":"Annotation on step 13 of UCHANGE structural neuroimaging pipeline","uri":"annotation-on-step-13-of-uchange-structural-neuroimaging","thread_uri":"annotation-on-step-13-of-uchange-structural-neuroimaging","step_id":"151782","protocol_uri":"uchange-structural-neuroimaging-pipeline-eu5bey6","protocol_name":"UCHANGE structural neuroimaging pipeline","protocol_name_html":"UCHANGE structural neuroimaging pipeline","annotation":"<div>Link is incorrect, should be: https:\/\/github.com\/KirstieJane\/UCHANGE_ProcessingPipeline\/blob\/master\/NSPN_ExtractRois.sh<\/div>\n<div>\u00a0<\/div>\n<div>INPUTS:<br \/>study_dir : The directory containing the SUB_DATA folder which itself contains directories named by sub_id.<br \/>sub_id\u00a0\u00a0\u00a0 : Subject ID. These folders should be inside SUB_DATA and themselves contain directories called SURFER and MPM.<br \/>occ\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 : The scan occasion. One of baseline, CBSU, UCL and WBIC. This directory contains the output of recon-all and is found inside the subject's SURFER directory.<\/div>\n<div>\u00a0<\/div>\n<div>EXPECTS:<br \/>Recon-all, trac-all and quality control edits must have been completed.<br \/>NSPN_TransformQuantitativeMaps.sh, NSPN_Parcellation.sh, NSPN_AssignLobes.sh and NSPN_ResampleSurfaces.sh must also have been completed.<\/div>\n<div>\u00a0<\/div>\n<div>OUTPUTS:<br \/>Statistics from all segmentations and parcellations for all MPM and DTI measures along with the standard Freesurfer morphological measures, in the directory ${sub_id}\/SURFER\/${occ}\/stats.<\/div>\n<div>\u00a0<\/div>\n<div>(Are there any other outputs Kirstie?)<\/div>","thread_text":"<div>Link is incorrect, should be: https:\/\/github.com\/KirstieJane\/UCHANGE_ProcessingPipeline\/blob\/master\/NSPN_ExtractRois.sh<\/div>\n<div>\u00a0<\/div>\n<div>INPUTS:<br \/>study_dir : The directory containing the SUB_DATA folder which itself contains directories named by sub_id.<br \/>sub_id\u00a0\u00a0\u00a0 : Subject ID. These folders should be inside SUB_DATA and themselves contain directories called SURFER and MPM.<br \/>occ\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 : The scan occasion. One of baseline, CBSU, UCL and WBIC. This directory contains the output of recon-all and is found inside the subject's SURFER directory.<\/div>\n<div>\u00a0<\/div>\n<div>EXPECTS:<br \/>Recon-all, trac-all and quality control edits must have been completed.<br \/>NSPN_TransformQuantitativeMaps.sh, NSPN_Parcellation.sh, NSPN_AssignLobes.sh and NSPN_ResampleSurfaces.sh must also have been completed.<\/div>\n<div>\u00a0<\/div>\n<div>OUTPUTS:<br \/>Statistics from all segmentations and parcellations for all MPM and DTI measures along with the standard Freesurfer morphological measures, in the directory ${sub_id}\/SURFER\/${occ}\/stats.<\/div>\n<div>\u00a0<\/div>\n<div>(Are there any other outputs Kirstie?)<\/div>","body":"<div>Link is incorrect, should be: https:\/\/github.com\/KirstieJane\/UCHANGE_ProcessingPipeline\/blob\/master\/NSPN_ExtractRois.sh<\/div>\n<div>\u00a0<\/div>\n<div>INPUTS:<br \/>study_dir : The directory containing the SUB_DATA folder which itself contains directories named by sub_id.<br \/>sub_id\u00a0\u00a0\u00a0 : Subject ID. These folders should be inside SUB_DATA and themselves contain directories called SURFER and MPM.<br \/>occ\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 : The scan occasion. One of baseline, CBSU, UCL and WBIC. This directory contains the output of recon-all and is found inside the subject's SURFER directory.<\/div>\n<div>\u00a0<\/div>\n<div>EXPECTS:<br \/>Recon-all, trac-all and quality control edits must have been completed.<br \/>NSPN_TransformQuantitativeMaps.sh, NSPN_Parcellation.sh, NSPN_AssignLobes.sh and NSPN_ResampleSurfaces.sh must also have been completed.<\/div>\n<div>\u00a0<\/div>\n<div>OUTPUTS:<br \/>Statistics from all segmentations and parcellations for all MPM and DTI measures along with the standard Freesurfer morphological measures, in the directory ${sub_id}\/SURFER\/${occ}\/stats.<\/div>\n<div>\u00a0<\/div>\n<div>(Are there any other outputs Kirstie?)<\/div>","is_private":"0","public_protocol":"1","can_edit":0,"can_delete":"0","show_name":"1","created_date":"1508497736","created_on":"1508497736","modified_on":null,"last_updated":null,"profile_image":"\/img\/avatars\/014.png","full_name":"Sarah Morgan","affiliation":null,"username":"sarah-morgan","email":"kw401@cam.ac.uk","pa_useranme":"kirstie-whitaker","comments":[]},"is_project":0}]},{"id":"592055","is_changed":"0","original_id":"152037","is_skipped":"0","is_checked":"0","guid":"F5A4238411EA4F408083D84E55326644","previous_guid":"0B5709013C5140F8911FD89F9A585462","previous_id":"592053","last_modified":"1508916596","components":[{"component_id":"1015526","previous_id":0,"original_id":"168114","guid":"6C487F23F6004B11BE947B5351C7831E","previous_guid":null,"component_type_id":"1","data_id":null,"data":"<p>Run NSPN_TransformQuantitativeMaps.sh<br \/>\u00a0<\/p>\n<p>This step is part of the <strong>dev_ParcAndExtract_TEMPLATE.sh<\/strong> template script.<\/p>\n<p>\u00a0<\/p>\n<p>You can find the code in the UCHANGE_ProcessingPipeline github repository <a href=\"https:\/\/github.com\/KirstieJane\/UCHANGE_ProcessingPipeline\/blob\/master\/NSPN_Parcellation_PostEdits.sh\" target=\"_blank\">here<\/a>.<\/p>\n<p>\u00a0<\/p>\n<p>[DOCUMENTATION INCOMPLETE]<\/p>","order_id":"0","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>Run NSPN_TransformQuantitativeMaps.sh<br \/>\u00a0<\/p>\n<p>This step is part of the <strong>dev_ParcAndExtract_TEMPLATE.sh<\/strong> template script.<\/p>\n<p>\u00a0<\/p>\n<p>You can find the code in the UCHANGE_ProcessingPipeline github repository <a href=\"https:\/\/github.com\/KirstieJane\/UCHANGE_ProcessingPipeline\/blob\/master\/NSPN_Parcellation_PostEdits.sh\" target=\"_blank\">here<\/a>.<\/p>\n<p>\u00a0<\/p>\n<p>[DOCUMENTATION INCOMPLETE]<\/p>"},"is_project":0},{"component_id":"1015527","previous_id":"1015526","original_id":"783085","guid":"3429EBCE559F43D6916DE847397ACEBB","previous_guid":"6C487F23F6004B11BE947B5351C7831E","component_type_id":"6","data_id":null,"data":"Transform Quantitative Maps to freesurfer space","order_id":"1","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Transform Quantitative Maps to freesurfer space"},"is_project":0},{"component_id":"1015528","previous_id":"1015527","original_id":"1014142","guid":"D39AAA13996A40299BA896AE89BCE9F8","previous_guid":"3429EBCE559F43D6916DE847397ACEBB","component_type_id":"26","data_id":"16533","data":"","order_id":"2","name":"Note","data_by_id":"1","type_id":"26","source_data":{"annotation_id":"16533","thread_id":"16533","id":"16533","thread_title":"Annotation on step 12 of UCHANGE structural neuroimaging pipeline","uri":"annotation-on-step-12-of-uchange-structural-neuroimaging","thread_uri":"annotation-on-step-12-of-uchange-structural-neuroimaging","step_id":"152037","protocol_uri":"uchange-structural-neuroimaging-pipeline-eu5bey6","protocol_name":"UCHANGE structural neuroimaging pipeline","protocol_name_html":"UCHANGE structural neuroimaging pipeline","annotation":"<div>Link is incorrect, should be: https:\/\/github.com\/KirstieJane\/UCHANGE_ProcessingPipeline\/blob\/master\/NSPN_TransformQuantitativeMaps.sh<\/div>\n<div>\u00a0<\/div>\n<div>USAGE: NSPN_TransformQuantitativeMaps.sh &lt;study_dir&gt; &lt;sub&gt; &lt;occ&gt;<\/div>\n<div>\u00a0<\/div>\n<div>DESCRIPTION: This code takes the freesurfer directories and their fellow MPM directories and transforms the MPM and DTI measures so they are all in the same space.<\/div>\n<div>\u00a0<\/div>\n<div>INPUTS:<\/div>\n<div>\u00a0<\/div>\n<div>- study_dir : The directory containing the SUB_DATA folder which itself contains directories named by sub_id. <br \/>- sub_id\u00a0\u00a0\u00a0 : Subject ID. These folders should be inside SUB_DATA and themselves contain directories called SURFER and MPM. <br \/>- occ\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 : The scan occasion. One of baseline, CBSU, UCL and WBIC. This directory contains the output of recon-all and is found inside the subject's SURFER directory.<\/div>\n<div>\u00a0<\/div>\n<div>EXPECTS:<\/div>\n<div>\u00a0<\/div>\n<div>Recon-all, trac-all and quality control edits must have been completed. NSPN_mpm_bet_mask.sh must also have been completed and the MPM directory should be inside the subject's directory at the same level as the SURFER dir.<\/div>\n<div>\u00a0<\/div>\n<div>OUTPUTS:<\/div>\n<div>\u00a0<\/div>\n<div>At the end the ${sub_id}SURFER\/${occ}\/mri directory will contain:<\/div>\n<div>\u00a0<\/div>\n<div>A.mgz\u00a0\u00a0\u00a0 MT.mgz\u00a0 R1.mgz\u00a0 R2s.mgz <br \/>FA.mgz\u00a0\u00a0 L1.mgz\u00a0 L23.mgz MD.mgz\u00a0 MO.mgz<\/div>","thread_text":"<div>Link is incorrect, should be: https:\/\/github.com\/KirstieJane\/UCHANGE_ProcessingPipeline\/blob\/master\/NSPN_TransformQuantitativeMaps.sh<\/div>\n<div>\u00a0<\/div>\n<div>USAGE: NSPN_TransformQuantitativeMaps.sh &lt;study_dir&gt; &lt;sub&gt; &lt;occ&gt;<\/div>\n<div>\u00a0<\/div>\n<div>DESCRIPTION: This code takes the freesurfer directories and their fellow MPM directories and transforms the MPM and DTI measures so they are all in the same space.<\/div>\n<div>\u00a0<\/div>\n<div>INPUTS:<\/div>\n<div>\u00a0<\/div>\n<div>- study_dir : The directory containing the SUB_DATA folder which itself contains directories named by sub_id. <br \/>- sub_id\u00a0\u00a0\u00a0 : Subject ID. These folders should be inside SUB_DATA and themselves contain directories called SURFER and MPM. <br \/>- occ\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 : The scan occasion. One of baseline, CBSU, UCL and WBIC. This directory contains the output of recon-all and is found inside the subject's SURFER directory.<\/div>\n<div>\u00a0<\/div>\n<div>EXPECTS:<\/div>\n<div>\u00a0<\/div>\n<div>Recon-all, trac-all and quality control edits must have been completed. NSPN_mpm_bet_mask.sh must also have been completed and the MPM directory should be inside the subject's directory at the same level as the SURFER dir.<\/div>\n<div>\u00a0<\/div>\n<div>OUTPUTS:<\/div>\n<div>\u00a0<\/div>\n<div>At the end the ${sub_id}SURFER\/${occ}\/mri directory will contain:<\/div>\n<div>\u00a0<\/div>\n<div>A.mgz\u00a0\u00a0\u00a0 MT.mgz\u00a0 R1.mgz\u00a0 R2s.mgz <br \/>FA.mgz\u00a0\u00a0 L1.mgz\u00a0 L23.mgz MD.mgz\u00a0 MO.mgz<\/div>","body":"<div>Link is incorrect, should be: https:\/\/github.com\/KirstieJane\/UCHANGE_ProcessingPipeline\/blob\/master\/NSPN_TransformQuantitativeMaps.sh<\/div>\n<div>\u00a0<\/div>\n<div>USAGE: NSPN_TransformQuantitativeMaps.sh &lt;study_dir&gt; &lt;sub&gt; &lt;occ&gt;<\/div>\n<div>\u00a0<\/div>\n<div>DESCRIPTION: This code takes the freesurfer directories and their fellow MPM directories and transforms the MPM and DTI measures so they are all in the same space.<\/div>\n<div>\u00a0<\/div>\n<div>INPUTS:<\/div>\n<div>\u00a0<\/div>\n<div>- study_dir : The directory containing the SUB_DATA folder which itself contains directories named by sub_id. <br \/>- sub_id\u00a0\u00a0\u00a0 : Subject ID. These folders should be inside SUB_DATA and themselves contain directories called SURFER and MPM. <br \/>- occ\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 : The scan occasion. One of baseline, CBSU, UCL and WBIC. This directory contains the output of recon-all and is found inside the subject's SURFER directory.<\/div>\n<div>\u00a0<\/div>\n<div>EXPECTS:<\/div>\n<div>\u00a0<\/div>\n<div>Recon-all, trac-all and quality control edits must have been completed. NSPN_mpm_bet_mask.sh must also have been completed and the MPM directory should be inside the subject's directory at the same level as the SURFER dir.<\/div>\n<div>\u00a0<\/div>\n<div>OUTPUTS:<\/div>\n<div>\u00a0<\/div>\n<div>At the end the ${sub_id}SURFER\/${occ}\/mri directory will contain:<\/div>\n<div>\u00a0<\/div>\n<div>A.mgz\u00a0\u00a0\u00a0 MT.mgz\u00a0 R1.mgz\u00a0 R2s.mgz <br \/>FA.mgz\u00a0\u00a0 L1.mgz\u00a0 L23.mgz MD.mgz\u00a0 MO.mgz<\/div>","is_private":"0","public_protocol":"1","can_edit":0,"can_delete":"0","show_name":"1","created_date":"1508495502","created_on":"1508495502","modified_on":null,"last_updated":null,"profile_image":"\/img\/avatars\/014.png","full_name":"Sarah Morgan","affiliation":null,"username":"sarah-morgan","email":"kw401@cam.ac.uk","pa_useranme":"kirstie-whitaker","comments":[]},"is_project":0}]},{"id":"592056","is_changed":"0","original_id":"152167","is_skipped":"0","is_checked":"0","guid":"EAA5B020CED54F548FEDF7DB70956285","previous_guid":"A2B73E2FEE09439D93DA1CACE3DA164F","previous_id":"592052","last_modified":"1508916596","components":[{"component_id":"1015529","previous_id":0,"original_id":"168385","guid":"4ADD98B9843B4531A81D75FAC2C1E8F1","previous_guid":null,"component_type_id":"1","data_id":null,"data":"<p>Run NSPN_AssignLobes.sh<\/p>\n<p>\u00a0<\/p>\n<p>This step is part of the <strong>dev_ParcAndExtract_TEMPLATE.sh<\/strong> template script.<\/p>\n<p>\u00a0<\/p>\n<p>You can find the code in the UCHANGE_ProcessingPipeline github repository <a href=\"https:\/\/github.com\/KirstieJane\/UCHANGE_ProcessingPipeline\/blob\/master\/NSPN_Parcellation_PostEdits.sh\" target=\"_blank\">here<\/a>.<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>\n<p>Just a little bit of code to assign regions to lobes.<\/p>\n<p>\u00a0<\/p>\n<p>[DOCUMENTATION INCOMPLETE]<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>","order_id":"0","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>Run NSPN_AssignLobes.sh<\/p>\n<p>\u00a0<\/p>\n<p>This step is part of the <strong>dev_ParcAndExtract_TEMPLATE.sh<\/strong> template script.<\/p>\n<p>\u00a0<\/p>\n<p>You can find the code in the UCHANGE_ProcessingPipeline github repository <a href=\"https:\/\/github.com\/KirstieJane\/UCHANGE_ProcessingPipeline\/blob\/master\/NSPN_Parcellation_PostEdits.sh\" target=\"_blank\">here<\/a>.<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>\n<p>Just a little bit of code to assign regions to lobes.<\/p>\n<p>\u00a0<\/p>\n<p>[DOCUMENTATION INCOMPLETE]<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>"},"is_project":0},{"component_id":"1015530","previous_id":"1015529","original_id":"783078","guid":"84DF0827313441F5A2AC07A8627422BE","previous_guid":"4ADD98B9843B4531A81D75FAC2C1E8F1","component_type_id":"6","data_id":null,"data":"Assign lobes","order_id":"1","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Assign lobes"},"is_project":0},{"component_id":"1015531","previous_id":"1015530","original_id":"1014141","guid":"D0D8E0E4613E431495B454D8616C962D","previous_guid":"84DF0827313441F5A2AC07A8627422BE","component_type_id":"26","data_id":"16532","data":"","order_id":"2","name":"Note","data_by_id":"1","type_id":"26","source_data":{"annotation_id":"16532","thread_id":"16532","id":"16532","thread_title":"Annotation on step 10 of UCHANGE structural neuroimaging pipeline","uri":"annotation-on-step-10-of-uchange-structural-neuroimaging","thread_uri":"annotation-on-step-10-of-uchange-structural-neuroimaging","step_id":"152167","protocol_uri":"uchange-structural-neuroimaging-pipeline-eu5bey6","protocol_name":"UCHANGE structural neuroimaging pipeline","protocol_name_html":"UCHANGE structural neuroimaging pipeline","annotation":"<p>I didn't do this bit (or the next) so I can't really comment. Might be worth saying when you need to run them though? (and when you don't)<\/p>","thread_text":"<p>I didn't do this bit (or the next) so I can't really comment. Might be worth saying when you need to run them though? (and when you don't)<\/p>","body":"<p>I didn't do this bit (or the next) so I can't really comment. Might be worth saying when you need to run them though? (and when you don't)<\/p>","is_private":"0","public_protocol":"1","can_edit":0,"can_delete":"0","show_name":"1","created_date":"1508495050","created_on":"1508495050","modified_on":null,"last_updated":null,"profile_image":"\/img\/avatars\/014.png","full_name":"Sarah Morgan","affiliation":null,"username":"sarah-morgan","email":"kw401@cam.ac.uk","pa_useranme":"kirstie-whitaker","comments":[]},"is_project":0}]},{"id":"592057","is_changed":"0","original_id":"346485","is_skipped":"0","is_checked":"0","guid":"C4221EA4E6E94A7D9FB151E14792801A","previous_guid":"A81CBB6838AF4874B50B24B40DFAA384","previous_id":"592054","last_modified":"1508916596","components":[{"component_id":"1015532","previous_id":0,"original_id":"527573","guid":"D0C2C99653284DE1BF664F68D90F66C0","previous_guid":null,"component_type_id":"1","data_id":null,"data":"<p>This step looks for the output of NSPN_ExtractRois.sh for all scans in each subject's directory and then combines that information together in the FS_ROIS folder within the study directory (&lt;study_dir&gt;).<\/p>\n<p>\u00a0<\/p>\n<p>Run NSPN_Report_ROIstats_Allsubs.sh &lt;study_dir&gt;<\/p>\n<p>\u00a0<\/p>\n<p>Note that &lt;study_dir&gt; expects to find SUB_DATA within it and then the standard NSPN directory structure.<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>","order_id":"0","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>This step looks for the output of NSPN_ExtractRois.sh for all scans in each subject's directory and then combines that information together in the FS_ROIS folder within the study directory (&lt;study_dir&gt;).<\/p>\n<p>\u00a0<\/p>\n<p>Run NSPN_Report_ROIstats_Allsubs.sh &lt;study_dir&gt;<\/p>\n<p>\u00a0<\/p>\n<p>Note that &lt;study_dir&gt; expects to find SUB_DATA within it and then the standard NSPN directory structure.<\/p>\n<p>\u00a0<\/p>\n<p>\u00a0<\/p>"},"is_project":0},{"component_id":"1015533","previous_id":"1015532","original_id":"527560","guid":"F0ED0941AE87456782A10843B908E5A9","previous_guid":"D0C2C99653284DE1BF664F68D90F66C0","component_type_id":"6","data_id":null,"data":"Combine all subject's extracted data into one directory","order_id":"1","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Combine all subject's extracted data into one directory"},"is_project":0}]},{"id":"601485","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"B7AF17E08F874F85A839E1DF997A2CB0","previous_guid":"C4221EA4E6E94A7D9FB151E14792801A","previous_id":"592057","last_modified":"1515152739","components":[{"component_id":"1038821","previous_id":0,"original_id":"0","guid":"F50B87C3814A493DB1A5DC821A8AD3DC","previous_guid":null,"component_type_id":"1","data_id":null,"data":"","order_id":"0","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":""},"is_project":0},{"component_id":"1038822","previous_id":"1038821","original_id":"0","guid":"3A4FEEA9143147EFA174C0E7A646A8AA","previous_guid":"F50B87C3814A493DB1A5DC821A8AD3DC","component_type_id":"6","data_id":"0","data":"Combine this data with a behavioural data file","order_id":"1","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Combine this data with a behavioural data file"},"is_project":0}]},{"id":"602993","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"3DF5A9B7E13B4568A95A0F7848C78A95","previous_guid":"0919741B81A74D8599F9CD4A4C90B119","previous_id":"592046","last_modified":"1516006634","components":[{"component_id":"1042821","previous_id":0,"original_id":"0","guid":"D8B8AF0443174A6F845EE4C18662A60B","previous_guid":null,"component_type_id":"6","data_id":"0","data":"Test MPM processing step","order_id":"0","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Test MPM processing step"},"is_project":0},{"component_id":"1042820","previous_id":"1042821","original_id":"0","guid":"E6A50EEE90F84424AE591E111C5E4549","previous_guid":"D8B8AF0443174A6F845EE4C18662A60B","component_type_id":"1","data_id":null,"data":"<p>Check the number of MPM files that exist by running the <strong>report-code\/report-0-number-mpm-files.py<\/strong> script.<\/p>\n<p>\u00a0<\/p>\n<p>It creates two output files in a folder called <strong>data-check-reports<\/strong> which is inside <strong>data_dir<\/strong> named with the date and time.<\/p>\n<p>\u00a0<\/p>\n<p>For example:<\/p>\n<ul>\n<li><strong>SubjectInfo-0-NumberMPMfiles-20180115-0845.csv<\/strong><\/li>\n<li><strong>Summary-0-NumberMPMfiles-20180115-0845.md<\/strong><\/li>\n<\/ul>","order_id":"1","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>Check the number of MPM files that exist by running the <strong>report-code\/report-0-number-mpm-files.py<\/strong> script.<\/p>\n<p>\u00a0<\/p>\n<p>It creates two output files in a folder called <strong>data-check-reports<\/strong> which is inside <strong>data_dir<\/strong> named with the date and time.<\/p>\n<p>\u00a0<\/p>\n<p>For example:<\/p>\n<ul>\n<li><strong>SubjectInfo-0-NumberMPMfiles-20180115-0845.csv<\/strong><\/li>\n<li><strong>Summary-0-NumberMPMfiles-20180115-0845.md<\/strong><\/li>\n<\/ul>"},"is_project":0},{"component_id":"1042822","previous_id":"1042820","original_id":"0","guid":"8A5ED01EAAAF4D3280BA8A8A248A960D","previous_guid":"E6A50EEE90F84424AE591E111C5E4549","component_type_id":"15","data_id":"3023","data":"","order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"UCHANGE_ProcessingPipeline\/report-code\/report-0-number-mpm-files.py ${data_dir}","description":"Write out the summary reports for this step","os_name":"","os_version":"","can_edit":"1"},"is_project":0}]}]}