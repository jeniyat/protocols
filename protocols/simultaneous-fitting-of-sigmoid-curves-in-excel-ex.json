{"id":28929,"title":"Simultaneous fitting of sigmoid curves in Excel (Excel Solver Add-in)","title_html":"<p>Simultaneous fitting of sigmoid curves in Excel (Excel Solver Add-in)<\/p>","image":{"source":"https:\/\/s3.amazonaws.com\/protocols-files\/public\/d20ed504fb0f6635fe60fd6759ba62a1df67d4edbceffaf6c5bc1e500cc3b4cf\/bsqb9iy6.png","placeholder":"https:\/\/s3.amazonaws.com\/protocols-files\/public\/d20ed504fb0f6635fe60fd6759ba62a1df67d4edbceffaf6c5bc1e500cc3b4cf\/bsqb9iy6.png"},"doi":"dx.doi.org\/10.17504\/protocols.io.8g9htz6","doi_status":2,"uri":"simultaneous-fitting-of-sigmoid-curves-in-excel-ex-8g9htz6","type_id":1,"published_on":1571538799,"parent_protocols":[],"parent_collections":[],"version_id":0,"created_on":1571534273,"categories":null,"creator":{"name":"Kenji Ohgane","affiliation":"Institute for Quantitative Biosciences, the University of Tokyo","affiliations":[{"affiliation":"Institute for Quantitative Biosciences, the University of Tokyo","url":"","is_default":1}],"username":"kenji-ohgane","link":null,"image":{"source":"\/img\/avatars\/011.png","placeholder":"\/img\/avatars\/011.png"},"badges":[{"id":2,"image":{"source":"\/img\/badges\/bronze.svg","placeholder":"\/img\/badges\/bronze.svg"},"name":"Author"}],"research_interests":null,"blocked_by_you":false,"blocked_you":false},"journal":null,"journal_name":null,"journal_link":null,"article_citation":null,"public":1,"has_versions":0,"link":null,"total_collections":0,"number_of_steps":10,"authors":[{"name":"Kenji Ohgane","affiliation":"Institute for Quantitative Biosciences, the University of Tokyo","affiliations":[],"username":"kenji-ohgane","link":null,"image":{"source":"\/img\/avatars\/011.png","placeholder":"\/img\/avatars\/011.png"},"badges":[],"research_interests":null,"blocked_by_you":false,"blocked_you":false}],"versions":[],"groups":[],"has_subprotocols":0,"is_subprotocol":0,"is_bookmarked":0,"can_be_copied":1,"can_remove_fork":1,"forks_count":{"private":0,"public":0},"access":{"can_view":1,"can_remove":0,"can_add":0,"can_edit":0,"can_publish":0,"can_get_doi":0,"can_share":1,"can_move":1,"can_move_outside":1,"can_transfer":1,"can_download":1,"is_locked":0},"guid":"4FD59A80F2D711E9B0738B904AAFE4C3","steps":[{"id":829931,"guid":"0D138980F2D911E9B0738B904AAFE4C3","previous_id":null,"previous_guid":null,"modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"7EA4A32BEEA4466787391B7033708B26","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"050FC29FB68A4154BFA62C545C770072","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Download the following excel file.<\/div><div class = \"text-block\">The file contains a sheet set up for simultaneous sigmoidal fitting with two set of example data, for which you can test the fitting procedure.<\/div><\/div>"}},{"id":1054725,"guid":"D7E34C90F2DE11E9B0738B904AAFE4C3","order_id":2,"type_id":23,"title":"file","source":{"source":"https:\/\/s3.amazonaws.com\/protocols-files\/public\/d20ed504fb0f6635fe60fd6759ba62a1df67d4edbceffaf6c5bc1e500cc3b4cf\/bsqm9iy6.xlsx","placeholder":"\/img\/extensions\/xlsx.png","original_name":"ExcelSolver_SimultaneousFitting.xlsx"}}],"cases":[],"data":null,"section":null,"section_color":"","critical":null,"critical_id":null,"duration":0},{"id":829932,"guid":"2C4BA210F2D911E9B0738B904AAFE4C3","previous_id":829931,"previous_guid":"0D138980F2D911E9B0738B904AAFE4C3","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"37727FBF7B564C3EA7AB7DDC487D01D0","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"44154445668742E88CD211A4500E5EEB","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Open the excel file, and enter your data set in the two set of \"x\" and \"y\" columns. Delete unnecessary data.<\/div><\/div>"}},{"id":1054725,"guid":"BB6864A1BF9341FBA4EE6919DEDD1A66","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\">The data in the \"x\" column should be in decreasing or increasing order. Otherwise, the plot will not be correctly displayed.<\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":" ","affiliation":"","affiliations":[],"username":"","link":null,"image":{"source":"","placeholder":""},"badges":[],"research_interests":null,"blocked_by_you":false,"blocked_you":false},"comments":[]}},{"id":1054726,"guid":"836C7C600AFD452C94F27846FA064885","order_id":3,"type_id":17,"title":"result","source":{"body":"<div class = \"text-blocks\"><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/d20ed504fb0f6635fe60fd6759ba62a1df67d4edbceffaf6c5bc1e500cc3b4cf\/bsqe9iy6.png\" \/><\/div><\/div>"}}],"cases":[],"data":null,"section":null,"section_color":"","critical":null,"critical_id":null,"duration":0},{"id":829933,"guid":"7A9EE710F2D911E9B0738B904AAFE4C3","previous_id":829932,"previous_guid":"2C4BA210F2D911E9B0738B904AAFE4C3","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"EEBEA2BC2D0040C58696341A630DEFBA","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"6294B79628DE4E268636C42916B17722","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Guess initial parameters for the sigmoids (minimum, max, n, and ec_50), which can be easily guessed from the plot, and enter the estimated initial values into the cells (B2, B3, B4, and B5 for the first data set, and K2, K3, K4, and K5 for the second data set).<\/div><\/div>"}},{"id":1054725,"guid":"36AD1B5459544805A167D6CA70932E77","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\">Note that these cells for parameters are \"named cells\". So you can reference these cells from within equations by using \"=min\" (first data set) or \"=min_\" (second data set), where an underbar denotes parameters for the second data set. If you want to modify the equation for the curves, please modify equations within the cells in the \"ycalc\" columns.<\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":" ","affiliation":"","affiliations":[],"username":"","link":null,"image":{"source":"","placeholder":""},"badges":[],"research_interests":null,"blocked_by_you":false,"blocked_you":false},"comments":[]}}],"cases":[],"data":null,"section":null,"section_color":"","critical":null,"critical_id":null,"duration":0},{"id":829934,"guid":"08C129E0F2DA11E9B0738B904AAFE4C3","previous_id":829933,"previous_guid":"7A9EE710F2D911E9B0738B904AAFE4C3","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"7A99B1EC785E44BB8BF52DBCBA269B92","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"61DC6C72985C457FAB768F6A07BD87C0","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Start the Excel Solver add-in from Tool > Solver on the menu bar.<\/div><\/div>"}},{"id":1054725,"guid":"1BCEF0CE6FF04DB2BCC0538E622CC0E1","order_id":2,"type_id":17,"title":"result","source":{"body":"<div class = \"text-blocks\"><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/d20ed504fb0f6635fe60fd6759ba62a1df67d4edbceffaf6c5bc1e500cc3b4cf\/bsqp9iy6.png\" \/><\/div><\/div>"}}],"cases":[],"data":null,"section":null,"section_color":"","critical":null,"critical_id":null,"duration":0},{"id":829935,"guid":"3715AAF0F2DA11E9B0738B904AAFE4C3","previous_id":829934,"previous_guid":"08C129E0F2DA11E9B0738B904AAFE4C3","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"CDC26B9721D14FBCB3543120D0E23C4D","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"EF82E71FD0F047F8B32FA3F5D438B1F2","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Set \"Objective \/ Target cells\" to \"$B$8\", which contains the sum of SSR (Sum of Squared Residuals) calculated for the two data sets.<\/div><\/div>"}},{"id":1054725,"guid":"AF63F1D81399456DB5782FDC5907E1EA","order_id":2,"type_id":17,"title":"result","source":{"body":"<div class = \"text-blocks\"><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/d20ed504fb0f6635fe60fd6759ba62a1df67d4edbceffaf6c5bc1e500cc3b4cf\/bsqn9iy6.png\" \/><\/div><\/div>"}}],"cases":[],"data":null,"section":null,"section_color":"","critical":null,"critical_id":null,"duration":0},{"id":829936,"guid":"38EA6AF0F2DA11E9B0738B904AAFE4C3","previous_id":829935,"previous_guid":"3715AAF0F2DA11E9B0738B904AAFE4C3","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"E3F94B2A3CEB411A89298A444616DE00","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"E606861E86E94077886EED66228E9E56","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Set \"equall to\" section to \"Value of 0\".<\/div><\/div>"}},{"id":1054725,"guid":"C28267DE6EC44F188CC6C7736BA3027C","order_id":2,"type_id":26,"title":"notes","source":{"id":0,"parent_id":0,"uri":"","title":"","body":"<div class = \"text-blocks\"><div class = \"text-block\">This results in a warning saying \"unable to find solution\", but you can ignore it.<\/div><\/div>","created_on":0,"changed_on":0,"creator":{"name":" ","affiliation":"","affiliations":[],"username":"","link":null,"image":{"source":"","placeholder":""},"badges":[],"research_interests":null,"blocked_by_you":false,"blocked_you":false},"comments":[]}}],"cases":[],"data":null,"section":null,"section_color":"","critical":null,"critical_id":null,"duration":0},{"id":829937,"guid":"3CED2E80F2DA11E9B0738B904AAFE4C3","previous_id":829936,"previous_guid":"38EA6AF0F2DA11E9B0738B904AAFE4C3","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"0D8223EC0C5045F9A35AC331C0B4488D","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"22B4F1FD264E40A880CCC071918A9654","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Set \"Changing variable cells\" to the cells that contains initial values for the two sigmoid curves (\"$B$2:$B$5, $K$2:$K$5\").<\/div><\/div>"}}],"cases":[],"data":null,"section":null,"section_color":"","critical":null,"critical_id":null,"duration":0},{"id":829938,"guid":"8A050D50F2DA11E9B0738B904AAFE4C3","previous_id":829937,"previous_guid":"3CED2E80F2DA11E9B0738B904AAFE4C3","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"1650C70B21BC4CE4AA1516DD477E37B9","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"F08D80CAFB8B4BC39E6ED7C7E4BF4330","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Add constraints.<\/div><div class = \"text-block\">(1) We recommend to add \"ec_50 >= 0.000001\" etc., to avoid EC50 becoming negative values or zero.<\/div><div class = \"text-block\">(2) In this example, we fit two sigmoid curves that share minimum and maximum values against the pair of data set. So add two constraints as shown in the figure (\"min = min_\" and \"max=max_\").<\/div><\/div>"}},{"id":1054725,"guid":"DD537641020643DF88FE89959A8C2109","order_id":2,"type_id":17,"title":"result","source":{"body":"<div class = \"text-blocks\"><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/d20ed504fb0f6635fe60fd6759ba62a1df67d4edbceffaf6c5bc1e500cc3b4cf\/bsqg9iy6.png\" \/><\/div><\/div>"}}],"cases":[],"data":null,"section":null,"section_color":"","critical":null,"critical_id":null,"duration":0},{"id":829939,"guid":"0A6A2980F2DB11E9B0738B904AAFE4C3","previous_id":829938,"previous_guid":"8A050D50F2DA11E9B0738B904AAFE4C3","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"B8432C5DAF85455A8E313158918FE0F0","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"A82ED0FB3D1042AAB225807A81804667","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Confirm that \"Assume non-negative\" is unchecked, and click \"Solve\" to run the Solver.<\/div><div class = \"text-block\">Close the Solver window when the calculation finished. Then you can get fitted parameters and a curve overlaid over the raw data points. Check if the sigmoid curve is reasonably fitted over the data.<\/div><\/div>"}},{"id":1054725,"guid":"7B2A6E540B054B3BA2ADD4E0D6D261F7","order_id":2,"type_id":17,"title":"result","source":{"body":"<div class = \"text-blocks\"><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/d20ed504fb0f6635fe60fd6759ba62a1df67d4edbceffaf6c5bc1e500cc3b4cf\/bsqh9iy6.png\" \/><\/div><\/div>"}}],"cases":[],"data":null,"section":null,"section_color":"","critical":null,"critical_id":null,"duration":0},{"id":829940,"guid":"59C604E0F2DB11E9B0738B904AAFE4C3","previous_id":829939,"previous_guid":"0A6A2980F2DB11E9B0738B904AAFE4C3","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"5065646526E54D44B0FF6222B5DDEB10","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"65CAEB505377463C89E4FEA8EAC13F78","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Then you can get fitted parameters and curves overlaid over the raw data points. Check if the sigmoid curve is reasonably fitted over the data.<\/div><\/div>"}},{"id":1054725,"guid":"0A8024A811244E7B89A4F59BDA912263","order_id":2,"type_id":17,"title":"result","source":{"body":"<div class = \"text-blocks\"><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/d20ed504fb0f6635fe60fd6759ba62a1df67d4edbceffaf6c5bc1e500cc3b4cf\/bsqj9iy6.png\" \/><\/div><\/div>"}},{"id":1054726,"guid":"28B3E5B2C4A94AFBB5EDB56C35E6C4FF","order_id":3,"type_id":17,"title":"result","source":{"body":"<div class = \"text-blocks\"><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/protocols-files\/public\/d20ed504fb0f6635fe60fd6759ba62a1df67d4edbceffaf6c5bc1e500cc3b4cf\/bsqk9iy6.png\" \/><\/div><\/div>"}}],"cases":[],"data":null,"section":null,"section_color":"","critical":null,"critical_id":null,"duration":0}],"document":null,"materials":[],"description":"<div class = \"text-blocks\"><div class = \"text-block\"><span>Sometimes it is desirable to fit sigmoid curves with shared parameters against several data sets. Such simultaneous fitting procedure is available in most of the specialized statistical softwares (R, Prism etc.), but also possible with Excel. Here, this protocol explains how to perform simultaneous fitting using Excel Solver plug-in against a pair of data set. For more basic protocol to fit sigmoid curve, see Kenji Ohgane (2019) Sigmoid fitting in Excel (Excel Solver Add-In). <\/span><span style = \"font-weight:bold;\">protocols.io <\/span><a href=\"https:\/\/dx.doi.org\/10.17504\/protocols.io.78ihrue\" style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">dx.doi.org\/10.17504\/protocols.io.78ihrue<\/span><\/a><span>. See Gerdi Kemmer & Sandro Keller (2010) <\/span><span style = \"font-weight:bold;\">Nat. Protocols<\/span><span> 5: 267\u2013281 for  more detail on the use of Excel Solver in nonlinear least square fitting.<\/span><\/div><\/div>","changed_on":1571538799}