{"id":22349,"title":"SYSB3036 W11: Transcriptomic Analyses","title_html":"SYSB3036 W11: Transcriptomic Analyses","image":{"source":"https:\/\/www.protocols.io\/img\/default_protocol.png","placeholder":"https:\/\/www.protocols.io\/img\/default_protocol.png"},"doi":"dx.doi.org\/10.17504\/protocols.io.z3mf8k6","doi_status":2,"uri":"sysb3036-w11-transcriptomic-analyses-z3mf8k6","type_id":1,"published_on":1555360590,"version_id":0,"created_on":1555358776,"categories":null,"creator":{"name":"Frank O. . Aylward","affiliation":"Virginia Tech","username":"frank-aylward","link":null,"image":{"source":"https:\/\/s3.amazonaws.com\/pr-journal\/v39jtte.png","placeholder":"https:\/\/s3.amazonaws.com\/pr-journal\/v39jtte.png"},"badges":[{"id":4,"image":{"source":"\/img\/badges\/gold.svg","placeholder":"\/img\/badges\/gold.svg"},"name":"Gold power author!"}],"research_interests":null},"journal":null,"journal_name":null,"journal_link":null,"public":1,"has_versions":0,"link":null,"total_collections":0,"number_of_steps":9,"authors":[{"name":"Frank O. . Aylward","affiliation":"Virginia Tech","username":"frank-aylward","link":null,"image":{"source":"https:\/\/s3.amazonaws.com\/pr-journal\/v39jtte.png","placeholder":"https:\/\/s3.amazonaws.com\/pr-journal\/v39jtte.png"},"badges":[],"research_interests":null}],"versions":[],"groups":[],"has_subprotocols":0,"is_subprotocol":0,"is_bookmarked":0,"forks_count":{"private":0,"public":0},"access":{"can_view":1,"can_remove":0,"can_add":0,"can_edit":0,"can_publish":0,"can_get_doi":0,"can_share":1,"can_move":1,"can_move_outside":1,"can_transfer":1,"can_download":1,"is_locked":0},"steps":[{"id":730871,"guid":"EBCF4A505FB911E98191DFAA7707DB4D","previous_id":null,"previous_guid":null,"modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"0247E7EB94AA44D19DA0B2E4BD296209","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"36EB1DE8577C45C291BC3879C8D17D4E","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">First let's get the data from GitHub and move inside the new folder we download:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">git clone <\/span><\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/github.com\/faylward\/transcriptomics_tutorial<\/span><\/a><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">cd transcriptomics_tutorial<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">ls<\/span><\/div><div class = \"text-block\">You should see two files: \"homework_rnaseq_data.txt\" and counts <- as.matrix(read.table(file=\"homework_rnaseq_data.txt\", sep=\"\\t\", header=T, row.names=1))\". We will be using the second one for the tutorial today. <\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":730872,"guid":"36F2AC205FBA11E98191DFAA7707DB4D","previous_id":730871,"previous_guid":"EBCF4A505FB911E98191DFAA7707DB4D","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"98296A9EC56A47E4AC6DFF386AB96F8F","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"4AF154D0CFDF4692BAB088862C21375F","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">For the rest of the tutorial we will be working in the R console, so move to that and read in the \"test_rnaseq_data.txt\" file. <\/div><div class = \"text-block\">This file is a transcriptomic data matrix with Samples as columns and Genes as rows. The values indicate the abundance of different genes in different samples, as determined by a read-mapping analysis (as we went over last week). <\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">counts <- as.matrix(read.table(\"week11\/transcriptomics_tutorial\/test_rnaseq_data.txt\", sep=\"\\t\", header=T, row.names=1))<\/span><\/div><div class = \"text-block\">Note that you will need to make sure the full path to the file is given, not just the file name. <\/div><div class = \"text-block\">Note that we are also using the \"as.matrix\" command, since we want R to know this is a numeric matrix of numbers. <\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":730873,"guid":"C52C03F05FBB11E98191DFAA7707DB4D","previous_id":730872,"previous_guid":"36F2AC205FBA11E98191DFAA7707DB4D","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"93C3D9D5C2644A3D915543D6CF9E6758","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"A9CF48C32C684C05ADCD8D483E613F76","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">To get the general size of the new matrix we just loaded we can use \"dim\":<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">dim(counts)<\/span><\/div><div class = \"text-block\">and for the first few lines:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">head(counts)<\/span><\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":730874,"guid":"EF0EFA105FBB11E98191DFAA7707DB4D","previous_id":730879,"previous_guid":"CC1B1C905FBC11E98191DFAA7707DB4D","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"232659FFBD1B4DF58DBDDEEE1D3155F7","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"EA06571982B44B81A6139CAECC6033F4","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">One useful thing we can visualize in these tables is the Rank Abundance Distribution. This tells us how abundant the different genes are when we order them from most-least abundant. The shape of this curve can help us see the discrepency between the abundance of the different genes, which is often quite severe. <\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">rankAbundance <- sort(rowSums(counts), decreasing=T)<\/span><\/div><div class = \"text-block\">Here we are creating one vector which contains the summed abundance of all rows. To plot this we can use:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">plot(rankAbundance, type=\"l\")<\/span><\/div><div class = \"text-block\">Typically this shows quite a dropoff after the first few genes.  To get the standard deviation we can use:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">sd(rankAbundance)<\/span><\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":730875,"guid":"874F1CB05FBC11E98191DFAA7707DB4D","previous_id":730874,"previous_guid":"EF0EFA105FBB11E98191DFAA7707DB4D","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"8ED852CB52DF431EBC2EBF564984A35D","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"8D5D42C8ABEF4FE484C233AF61B99150","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">We can also get an idea of the gene abundance distribution by making a histogram:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">hist(rankAbundance, breaks=20, col=\"blue\")<\/span><\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":730876,"guid":"9E2BED005FBC11E98191DFAA7707DB4D","previous_id":730875,"previous_guid":"874F1CB05FBC11E98191DFAA7707DB4D","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"D26BAA75240A472C83CB4C97B1602BCB","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"CC1933D69A644CBBB90DD665F0A9FF6B","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Now as it turns out analyzing raw counts can be problematic. The abundance between the different gene expression values varies greatly between genes, and this can compromise downstream statistical analyses and visualization. So we will want to transform our data so it can be more useful. One common approach is to log-transform the data, so we will do that here. <\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">log <- as.matrix(log10(counts+1))<\/span><\/div><div class = \"text-block\">Note that we need to add 1 first, since log10(0) is undefined. These added values are called \"pseudocounts\". <\/div><div class = \"text-block\">After this we can do the same things we did above with the regular count table. <\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">rankAbundance <- sort(rowSums(log), decreasing=T)<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">sd(rankAbundance)<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">plot(rankAbundance, type=\"l\")<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">hist(rankAbundance, breaks=20, col=\"blue\")<\/span><\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":730877,"guid":"A893F5305FBC11E98191DFAA7707DB4D","previous_id":730876,"previous_guid":"9E2BED005FBC11E98191DFAA7707DB4D","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"B8A3459DB9BA4BD9864CC1E57B74BA57","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"FA788C27DE7849C187E792D1332375DE","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Next we will want to visualize the data with clustering and a heatmap. For this we will need to R packages, \"gplots\" and \"RColorBrewer\", which you will need to install in your workspace. <\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">install.packages(\"gplots\")<\/span><\/div><div class = \"text-block\">and <\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">install.packages(\"RColorBrewer\")<\/span><\/div><div class = \"text-block\">and then load the packages:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">library(gplots)<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">library(RColorBrewer)<\/span><\/div><div class = \"text-block\">Now with RColorBrewer we can choose a color palette to use when plotting a heatmap:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">palette = brewer.pal(9, \"GnBu\")<\/span><\/div><div class = \"text-block\">And then we can plot the heatmap:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">heatmap.2(counts, trace=\"none\", col=palette)<\/span><\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":730878,"guid":"B41EAB705FBC11E98191DFAA7707DB4D","previous_id":730877,"previous_guid":"A893F5305FBC11E98191DFAA7707DB4D","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"EEF6C3906E864D1A971F57E014CE83AA","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"67C205B520FA46F4A4134F9FF98FB11C","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">And we can do the same for the log-transformed data:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">heatmap.2(log, trace=\"none\", col=palette)<\/span><\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":730879,"guid":"CC1B1C905FBC11E98191DFAA7707DB4D","previous_id":730873,"previous_guid":"C52C03F05FBB11E98191DFAA7707DB4D","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"CAAD813439C149ADBEBF3C2146F5F2B6","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"6B858717D4B94A3E9B8B7BAAE7FF27ED","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">In this particular dataset the samples belong to different time-points, so we are measuring changes in gene expression over time. Samples were taken every 4 hours over the course of 3 days in a microbial community. <\/div><div class = \"text-block\">To get an idea of how the gene  expression changes over time, we can plot individual genes:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">plot(counts[\"Gene1\",], type=\"l\", lwd=2, axes=F, xlab=NA)<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">axis(1, at=c(1:25), colnames(counts), las=2)<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">axis(2)<\/span><\/div><div class = \"text-block\">Note that many genes appear to have a periodic gene expression pattern that peaks once every 24 hours (a \"diel cycle\"). <\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":null}],"materials":[],"description":null,"changed_on":1555360590}