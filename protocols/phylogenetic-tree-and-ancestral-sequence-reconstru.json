{"id":27121,"title":"Phylogenetic tree and ancestral sequence reconstruction","title_html":"<p>Phylogenetic tree and ancestral sequence reconstruction<\/p>","image":{"source":"https:\/\/www.protocols.io\/img\/default_protocol.png","placeholder":"https:\/\/www.protocols.io\/img\/default_protocol.png"},"doi":"dx.doi.org\/10.17504\/protocols.io.6qrhdv6","doi_status":2,"uri":"phylogenetic-tree-and-ancestral-sequence-reconstru-6qrhdv6","type_id":1,"published_on":1580843320,"parent_protocols":[],"parent_collections":[],"version_id":0,"created_on":1566421499,"categories":null,"creator":{"name":"Matthew Kellom","affiliation":"University of California, Santa Barbara","affiliations":[{"affiliation":"University of California, Santa Barbara","url":null,"is_default":1}],"username":"matthew-kellom","link":null,"image":{"source":"\/img\/avatars\/006.png","placeholder":"\/img\/avatars\/006.png"},"badges":[{"id":2,"image":{"source":"\/img\/badges\/bronze.svg","placeholder":"\/img\/badges\/bronze.svg"},"name":"Author"}],"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"journal":null,"journal_name":null,"journal_link":null,"article_citation":null,"public":1,"has_versions":false,"link":null,"total_collections":0,"number_of_steps":12,"authors":[{"name":"Matthew Kellom","affiliation":"University of California, Santa Barbara","affiliations":[],"username":"matthew-kellom","link":null,"image":{"source":"\/img\/avatars\/006.png","placeholder":"\/img\/avatars\/006.png"},"badges":[],"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false}],"versions":[],"groups":[{"id":434,"uri":"santoro-lab-ucsb","title":"Santoro Lab @ UCSB","image":{"source":"https:\/\/s3.amazonaws.com\/pr-journal\/mgtgvcw.jpg","placeholder":"https:\/\/s3.amazonaws.com\/pr-journal\/mgtgvcw.jpg"},"tech_support":{"email":null,"phone":null,"hide_contact":0,"use_email":0,"url":null},"is_member":1,"request":{"id":434,"uri":"santoro-lab-ucsb","title":"Santoro Lab @ UCSB","image":{"source":"https:\/\/s3.amazonaws.com\/pr-journal\/mgtgvcw.jpg","placeholder":"https:\/\/s3.amazonaws.com\/pr-journal\/mgtgvcw.jpg"},"tech_support":{"email":null,"phone":null,"hide_contact":0,"use_email":0,"url":null},"is_member":1,"description":null,"research_interests":null,"website":null,"location":null,"affiliation":null,"status":{"is_visible":true,"access_level":0},"stats":{"files":[],"total_members":0,"total_followers":0,"total_child_groups":0,"total_parent_groups":0,"has_collaborations":0},"user_status":{"is_member":true,"is_confirmed":true,"is_invited":false,"is_owner":false,"is_admin":false,"is_following":false},"join_link":null,"token":null,"owner":{"name":" ","affiliation":null,"affiliations":[],"username":null,"link":null,"image":{"source":null,"placeholder":null},"badges":[],"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"is_protocol_requested":0,"is_group_requested":0,"is_my":false,"is_request":false,"is_confirmed":1,"is_declined":0,"requester":{"name":" ","affiliation":null,"affiliation_url":null,"username":null,"link":null},"protocol":{"id":0,"title":"Phylogenetic tree and ancestral sequence reconstruction","title_html":"Phylogenetic tree and ancestral sequence reconstruction","image":{"source":null,"placeholder":null},"doi":null,"doi_status":0,"uri":"phylogenetic-tree-and-ancestral-sequence-reconstru-6qrhdv6","type_id":1,"published_on":null,"stats":{"number_of_views":0,"number_of_steps":0,"number_of_bookmarks":0,"number_of_comments":0,"number_of_exports":0,"number_of_runs":0,"number_of_votes":0,"is_voted":0},"parent_protocols":[],"parent_collections":[]},"created_on":1580843319,"resolve_on":0,"resolved_user":{"name":" ","affiliation":null,"affiliations":[],"username":null,"link":null,"image":{"source":null,"placeholder":null},"badges":[],"research_interests":null,"blocked_by_you":false,"blocked_you":false,"hide_following":false},"shared":false}}],"has_subprotocols":0,"is_subprotocol":0,"is_bookmarked":0,"can_be_copied":1,"can_remove_fork":1,"forks_count":{"private":0,"public":0},"access":{"can_view":1,"can_remove":0,"can_add":0,"can_edit":0,"can_publish":0,"can_get_doi":0,"can_share":1,"can_move":1,"can_move_outside":1,"can_transfer":1,"can_download":1,"is_locked":0},"guid":"4BC19F10C45711E993BCB768C9730A90","state_version_id":922,"steps":[{"id":802179,"guid":"4BC28970C45711E993BCB768C9730A90","previous_id":null,"previous_guid":null,"modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"7B56649B58214360AE8D437DA8E1BD73","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"8BB940BE49DD4EBDAA2AA4CA1820D8A1","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Obtain protein-coding metagenome FASTA files.<\/div><\/div>"}}],"cases":[],"data":null,"section":null,"section_color":"","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":802181,"guid":"A5BD8290C45711E993BCB768C9730A90","previous_id":802179,"previous_guid":"4BC28970C45711E993BCB768C9730A90","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"DBC0D833BBEE49E199A47490D7107AD2","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"D6F2F84B56A042F3A06C4BD1BF2ED429","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Obtain a set of amino acid sequences that are known\/trusted target homologs (Uniprot works well for this). <\/div><\/div>"}}],"cases":[],"data":null,"section":null,"section_color":"","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":802197,"guid":"379679E0C45A11E993BCB768C9730A90","previous_id":802181,"previous_guid":"A5BD8290C45711E993BCB768C9730A90","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"89DFFEEF21E845E1A59EBDD1BBFBCA02","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"18F4DA02ED8A414DAC2BB7FFCAAE1E2E","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Use DIAMOND (blastx can also be used but will be slower for large datasets) to search for target hits from within the metagenome sequences. Recommend an e-value cutoff of at least 1e-20.<\/div><\/div>"}}],"cases":[],"data":null,"section":null,"section_color":"","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":802218,"guid":"DC27D2E0C46111E993BCB768C9730A90","previous_id":802197,"previous_guid":"379679E0C45A11E993BCB768C9730A90","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"46234331043F46DAB6D74C15B8E551CB","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"9C785BB643EE40B98C900239DF14593F","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Translate protein-coding target hits to amino acid sequences with TranslatorX.<\/div><\/div>"}}],"cases":[],"data":null,"section":null,"section_color":"","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":802219,"guid":"ED4B07E0C46111E993BCB768C9730A90","previous_id":802218,"previous_guid":"DC27D2E0C46111E993BCB768C9730A90","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"9C1B0818FFE0469990C048A76542EE8C","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"346500E5FF1648BF92E297B9D5796B1F","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Use DIAMOND (or BLAST) to annotate hits against a local copy of the NCBI nr database.<\/div><\/div>"}}],"cases":[],"data":null,"section":null,"section_color":"","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":802220,"guid":"45FEB3F0C46211E993BCB768C9730A90","previous_id":802219,"previous_guid":"ED4B07E0C46111E993BCB768C9730A90","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"C8EAED6F2C57469E9E983E86078D672D","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"76BB84B75A084630AD42AF3D594CF251","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Choose taxa of interest, and select sequences of appropriate length for the protein from the metagenome hits.<\/div><\/div>"}}],"cases":[],"data":null,"section":null,"section_color":"","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":802858,"guid":"38361C90C51B11E983675D8AE9302D59","previous_id":802220,"previous_guid":"45FEB3F0C46211E993BCB768C9730A90","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"71D3E58BE4EE44CA9157CF9BD07AC91C","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"75D4E79A90854EE98C37C049153D1087","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Align the collected sequences and closely related complete outgroup sequence(s) with MAFFT. Recommend settings of --maxiterate 1000 --localpair<\/div><\/div>"}}],"cases":[],"data":null,"section":null,"section_color":"","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":802866,"guid":"F80AAA10C51E11E983675D8AE9302D59","previous_id":802858,"previous_guid":"38361C90C51B11E983675D8AE9302D59","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"C04B25570D5E450CA58F4F6E94057CFB","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"FB0F458C5C9A4B4B92609E39EBBC3D79","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Make tree with RAxML. Recommend settings -f a -k -m PROTGAMMAAUTO<\/div><div class = \"text-block\">Inspect the tree to see if it makes sense. If a node looks out of place, consult the alignment and figure out why and if you want to keep it in the dataset.<\/div><\/div>"}}],"cases":[],"data":null,"section":null,"section_color":"","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":802867,"guid":"177B10B0C51F11E983675D8AE9302D59","previous_id":802866,"previous_guid":"F80AAA10C51E11E983675D8AE9302D59","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"79B5B27A22AA4EC3B72ABA51915CEFD0","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"0B2D7008E08846A78299B829F052E800","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Check RAxML amino acid substition model and branch support with IQTree. Recommend settings -m TEST -nt AUTO -alrt 10000<\/div><\/div>"}}],"cases":[],"data":null,"section":null,"section_color":"","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":802868,"guid":"52478E30C51F11E983675D8AE9302D59","previous_id":802867,"previous_guid":"177B10B0C51F11E983675D8AE9302D59","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"CBF11EF02AF7407DBF1A5E025026C817","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"2B5D3CF7C74C41BFAB875CB8DE6457B3","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Branch support with MR Bayes. Will need to create a nexus and mbatch file. Recommend mbatch settings:<\/div><div class = \"text-block\">lset nst=6 rates invgamma;<\/div><div class = \"text-block\">prset aamodelpr=fixed(lg); (The model choice here should match the model that RAxML and IQTree select.<\/div><div class = \"text-block\">mcmcp ngen=1000000 nruns=2 nchains=4 samplefreq=100 printfreq=10000 relburnin=yes burninfrac=0.25;<\/div><div class = \"text-block\">mcmc;<\/div><div class = \"text-block\">sumt;<\/div><div class = \"text-block\">sump;<\/div><\/div>"}}],"cases":[],"data":null,"section":null,"section_color":"","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":802869,"guid":"0DD3A3F0C52011E983675D8AE9302D59","previous_id":802868,"previous_guid":"52478E30C51F11E983675D8AE9302D59","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"EAFC95506C9E4A50B4CD646C39168374","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"54E36FC218ED4651B9CFCAA6F1749761","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Submit the MAFFT alignment and RAxML best_tree to the FastML web portal (http:\/\/fastml.tau.ac.il\/). You can use the local version of this but I found it easier to just use the web portal. Be sure to select Amino Acids and the correct model from the tree building.  Use Gamma Distribution and Maximum Liklihood. Deselect Optimize Branch Lengths and joint reconstruction.<\/div><\/div>"}}],"cases":[],"data":null,"section":null,"section_color":"","section_duration":0,"critical":null,"critical_id":null,"duration":0},{"id":802870,"guid":"8619E4A0C52011E983675D8AE9302D59","previous_id":802869,"previous_guid":"0DD3A3F0C52011E983675D8AE9302D59","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"0F924FC786AE45A9ABC3A1894C1E45FE","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"A32E63A468224CDD81C108D5ABFA6FCD","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Obtain the 25 most probable ancestral sequences at the nodes of interest from the FastML results page and visualize the tree results in FigTree.<\/div><\/div>"}}],"cases":[],"data":null,"section":null,"section_color":"","section_duration":0,"critical":null,"critical_id":null,"duration":0}],"document":null,"materials":[],"description":"<div class = \"text-blocks\"><div class = \"text-block\">Protocol for the alignment, tree building, and ancestral sequence reconstruction of metagenomic protein coding sequences.<\/div><\/div>","changed_on":1580843320}