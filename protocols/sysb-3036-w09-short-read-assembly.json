{"id":18290,"title":"SYSB 3036 W09: Short Read Assembly","title_html":"SYSB 3036 W09: Short Read Assembly","image":{"source":"https:\/\/www.protocols.io\/img\/default_protocol.png","placeholder":"https:\/\/www.protocols.io\/img\/default_protocol.png"},"doi":"dx.doi.org\/10.17504\/protocols.io.v4se8we","doi_status":2,"uri":"sysb-3036-w09-short-read-assembly-v4se8we","type_id":1,"published_on":1553021433,"version_id":0,"created_on":1543891363,"categories":null,"creator":{"name":"Frank Aylward","affiliation":"Virginia Tech","username":"frank-aylward","link":null,"image":{"source":"https:\/\/s3.amazonaws.com\/pr-journal\/v39jtte.png","placeholder":"https:\/\/s3.amazonaws.com\/pr-journal\/v39jtte.png"},"badges":[{"id":4,"image":{"source":"\/img\/badges\/gold.svg","placeholder":"\/img\/badges\/gold.svg"},"name":"Gold power author!"}],"research_interests":null},"journal":null,"journal_name":null,"journal_link":null,"public":1,"has_versions":0,"link":null,"total_collections":0,"number_of_steps":6,"authors":[{"name":"Frank Aylward","affiliation":"Virginia Tech","username":"frank-aylward","link":null,"image":{"source":"https:\/\/s3.amazonaws.com\/pr-journal\/v39jtte.png","placeholder":"https:\/\/s3.amazonaws.com\/pr-journal\/v39jtte.png"},"badges":[],"research_interests":null}],"versions":[],"groups":[],"has_subprotocols":0,"is_subprotocol":0,"is_bookmarked":0,"forks_count":{"private":0,"public":0},"steps":[{"id":690304,"guid":"C7805060FE6411E8AEFDFD66CEB330C4","previous_id":null,"previous_guid":null,"modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"041C4ECB2C4243E9B8D82E00CB699380","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"F16EEBC6B4C54406BBA1F9B60C4DF14D","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">First we need to download the raw read data, which will be in FASTQ format. This is how the data looks when it comes right off of a sequencer.<\/div><div class = \"text-block\">Raw sequencing read data is quite large and can be unwieldy, so that's why we need the sra-toolkit to download it. This tool is designed to interface with the NCBI Sequence Read Archive to get the data. We can use the fastq-dump sub-command in the sra-toolkit: <\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">fastq-dump -X 10000 --split-3 SRR6764339<\/span><\/div><div class = \"text-block\">A few things about this command:<\/div><div class = \"text-block\">- The purpose of this command is to download FASTQ files of raw sequencing reads that belong to a specific genome project, and in this case SRR6764339 corresponds to the Staphylococcus phage we want to analyze. FASTQ files are similar to FASTA files, but in addition to sequence information they also contain quality score information. This is because the sequencer is not always 100% confident in the bases that it calls, and we want to be able to discern between low-quality and high-quality sequence for our downstream analysis. <\/div><div class = \"text-block\">-Here \"-X 1000\" specifies that we only want 1000 reads. This is quite a small number, but it will suffice for what we need. <\/div><div class = \"text-block\">-The \"--split-3\" flag specifies that we want the reads split into three files- one for forward reads, one for reverse reads, and one for unpaired reads. These reads come from an Illumina sequencing project, and Illumina reads typically are \"paired-end\", meaning that a single DNA fragment was sequenced from both ends. It is useful to know if two sequence reads were from the same DNA fragment, so this information is retained in the FASTQ files. <\/div><div class = \"text-block\">After this runs you should see two new files, SRR6764339_1.fastq and SRR6764339_2.fasta. All the reads are paired, so there is no unpaired read file. <\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":690305,"guid":"F4369550FE6511E8AEFDFD66CEB330C4","previous_id":690304,"previous_guid":"C7805060FE6411E8AEFDFD66CEB330C4","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"0BDD2E4FBAA8419C8FDE3AD31BDCE5F0","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"C630314FABE44FF7B6F6647D06D77EA9","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Now that we have the raw sequence reads we can assemble with SPAdes. <\/div><div class = \"text-block\">Before we start with SPAdes we need to update our PATH so we can see the program. I have installed the tool on my personal partition and you need to enter into a few commands so that your terminal knows where everything is located. <\/div><div class = \"text-block\">The code for this is:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">PATH=$PATH:\/home\/faylward\/SPAdes-3.13.0-Linux\/bin<\/span><\/div><div class = \"text-block\">and then:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">export PATH<\/span><\/div><div class = \"text-block\">After this we can take a look at how to run SPAdes.<\/div><div class = \"text-block\">First let's take a look at the SPAdes options: <\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">spades.py<\/span><\/div><div class = \"text-block\">Check out the options and think about what kind of input command we might want. <\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":690306,"guid":"2A7E26F0FE6611E8AEFDFD66CEB330C4","previous_id":690305,"previous_guid":"F4369550FE6511E8AEFDFD66CEB330C4","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"393E5700561E400A82A000A9ABAA0743","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"8AD8A9A06640481580CE0060F4D2296F","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Let's get started with a simple command. <\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">spades.py -1 SRR6764339_1.fastq -2 SRR6764339_2.fastq -o phage_17 -k 17 &> log.txt<\/span><\/div><div class = \"text-block\">-Here we are specifying the two FASTQ input files with the -1 and -2 flags.<\/div><div class = \"text-block\">-We specify an output folder that we want the results to go into using the \"-o\" flag. <\/div><div class = \"text-block\">-We can specify the k-mer length that we want to use for de Bruijn graph construction with the -k flag. SPAdes usually tries a variety of k-mers and settles on the best one, but here we will use only 21 for demonstration purposes. <\/div><div class = \"text-block\">- I put \"&> log.txt\" to capture the standard output and standard error streams into the log.txt file. This isn't necessary, but it makes sure we can go back at the log file later. <\/div><div class = \"text-block\">You can take a quick look in the log.txt file if you want to see what SPAdes was saying while it was running. <\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">more log.txt<\/span><\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":690307,"guid":"D7A0D080FE6611E8AEFDFD66CEB330C4","previous_id":690306,"previous_guid":"2A7E26F0FE6611E8AEFDFD66CEB330C4","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"2ED222F0BC114AE094E99DBBAEFB6A7D","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"B1D58F7CB7564B518B60BB0F95DF94BB","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Now let's navigate into the phage_21 folder and see what the output files look like. <\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">cd phage_17<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">ls -lh<\/span><\/div><div class = \"text-block\">You should see a variety of files that SPAdes created. The important ones we want to look at here are \"scaffolds.fasta\" and \"assembly_graph.fastg\". <\/div><div class = \"text-block\">The scaffolds that were assembled are in the scaffolds.fasta file. Let's take a look with seqkit:<\/div><div class = \"text-block\">You should see 20 or so scaffolds that range in size from ~15 nt to ~60,000 nt. Scaffolds smaller than 1,000 nt are not that useful, but at least we have a few large ones. Not that bad for a first-pass assembly, especially considering we are only using 10,000 reads. What we would really like is a complete genome. <\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":690308,"guid":"E9A8B8D0FE6911E8AEFDFD66CEB330C4","previous_id":690307,"previous_guid":"D7A0D080FE6611E8AEFDFD66CEB330C4","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"112D08CCA1684CDF90C7527401E42001","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"623B60A59E184D05B465C07A525AB571","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">The other interesting file that spades created is the assembly_graph.fastg file. The G in FASTG stands for Graph, so we have a de Bruijn graph that we can visualize here. <\/div><div class = \"text-block\">To visualize this we will use a tool called Bandage. This tool is a bit different than the ones we have usually been using since it will not run in the command line. Instead we will download it via the command line, unzip the file, navigate to the file in the File Explorer, and then double-click on the Bandage file to start it. A GUI (Graphical User Interface) will pop up and we will work there. <\/div><div class = \"text-block\">The code for downloading and unzipping the tool is:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">wget <\/span><\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/github.com\/rrwick\/Bandage\/releases\/download\/v0.8.1\/Bandage_Ubuntu_dynamic_v0_8_1.zip<\/span><\/a><\/div><div class = \"text-block\">and<\/div><div class = \"text-block\">unzip <\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">Bandage_Ubuntu_dynamic_v0_8_1.zip<\/span><\/a><\/div><div class = \"text-block\">You should see a file called Bandage if you navigate to your current folder in the File Explorer. Double click on it. <\/div><div class = \"text-block\">A program should pop up with a menu on the top band. Click on File->Load graph and navigate to the FASTG file that SPAdes created. Then click on Draw Graph in the middle of the menu on the left. <\/div><div class = \"text-block\">You should see something like this:<\/div><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/pr-journal\/ba4wa.png\" \/><\/div><div class = \"text-block\">Notice that it's a big tangles mess, but it seems to be in one big chunk for the most part. The individual scaffolds we saw in the previous step are from this big chunk. SPAdes did a pretty good job of traversing the de Bruijn graph and pulling out linear scaffolds, but it couldn't pull out a full linear contiguous genome given how many knots and bubbles and in the graph. That's why we wound up with several scaffolds and not just one. <\/div><div class = \"text-block\">You can play around with the settings as well. If you color by depth of coverage (middle of left left panel) you will see the knots tend to be in high coverage areas. This is becauses these are repetitive regions where the same k-mers turn up in different parts of the genome. This creates complications for de Bruijn graph assembly. <\/div><\/div>"}},{"id":1054725,"guid":"C091A0EF550542D098C1ED20DBC2EB18","order_id":2,"type_id":1,"title":"description","source":{"description":"<div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/pr-journal\/ba4wa.png\" \/><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":690309,"guid":"C4B67570FE7911E8ABCD4D7674DF9E5F","previous_id":690308,"previous_guid":"E9A8B8D0FE6911E8AEFDFD66CEB330C4","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"A539BCD260654F7794E559C8B1B83671","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"B226CA09C42A4F3F9DE3EA2FACF24734","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">A k-mer size of of 17 is quite short, so we can run SPAdes again with a longer k-mer size and see if that helps resolve a complete genome.  So we will move back out of the phage_17 folder and re-run SPAdes with a much longer k-mer length. <\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">cd ..<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">spades.py -1 SRR6764339_1.fastq -2 SRR6764339_2.fastq -o phage_117 -k 117  &> log2.txt<\/span><\/div><div class = \"text-block\">Now go back to Bandage and load up the FASTG file from this latest assembly. Look better? I got something like this:<\/div><div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/pr-journal\/ba4xa.png\" \/><\/div><div class = \"text-block\">So it seems the longer k-mer length really helped resolve those knots and bubbles. This is becuase longer k-mers are less likely to be repeated in different regions of the genome, since they are higher complexity regions. It's unlikely that a 117-bp sequence will be present in different regions, but it's much easier for a 17-bp sequence to be present in multiple locations. <\/div><div class = \"text-block\">If you look at the scaffolds.fasta file for the new assembly you should also see almost all of the sequence is in one large scaffold. So we have our complete genome!<\/div><\/div>"}},{"id":1054725,"guid":"CC49CB721FD246A59DF5C8F9C56A3A94","order_id":2,"type_id":1,"title":"description","source":{"description":"<div style = \"text-align :; float : ;\"><img style = \"\" src = \"https:\/\/s3.amazonaws.com\/pr-journal\/ba4xa.png\" \/><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":null}],"materials":[],"description":"<div class = \"text-blocks\"><\/div>","changed_on":1553021433}