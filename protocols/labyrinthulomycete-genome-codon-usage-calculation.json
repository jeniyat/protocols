{"uri":"labyrinthulomycete-genome-codon-usage-calculation-hgyb3xw","version_id":"0","protocol_name":"Labyrinthulomycete genome codon usage calculation code","protocol_name_html":"Labyrinthulomycete genome codon usage calculation code","is_prepublished":"0","can_edit":"0","parent_id":null,"api_version":"2","is_new_mode":"1","last_modified":"1521180002","type_id":"1","link":"","fork_id":"","public_fork_note":"","number_of_steps":"5","has_versions":"0","first_published_date":"1490810821","publish_date":"2017-03-29 18:07:01","documents":null,"have_protocol_in_step":"0","is_protocol_in_step":"0","vendor_name":"Contributed by users","vendor_link":"https:\/\/www.protocols.io","vendor_logo":"\/img\/vendors\/1.png","mod_mins":"-45","mod_secs":"1","description":"<header>We analyzed the recently available whole genome sequences from two thraustochytrids (Aurantiochytrium limacinum ATCC MYA-1381, Schizochytrium aggregatum ATCC 28209) and one aplanochytrid (Aplanochytrium PBS07) We then calculated the genome-wide relative synonymous codon usage, codon frequencies and GC content for predicted coding sequences from each of the three species. We compared these to other stramenopiles: the diatoms Phaeodactylum tricornutum and Thalassiosira pseudonana, and the oomycete Phytophthora sojae, as well as to the ascomycete fungus Saccharomyces cerevisiae. See <a href=\"https:\/\/you.stonybrook.edu\/labyrinthulomycetes\/coding-properties\/\" target=\"_blank\">this page <\/a>for further description.<\/header><header><\/header><header>This code was run in R version 3.3.2 (2016-10-31)<\/header><header>\n<p><span style=\"font-weight: 400;\">Package info: RCurl_1.95-4.8 bitops_1.0-6 \u00a0\u00a0ape_4.0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0reshape_0.8.6 \u00a0seqinr_3.3-3<\/span><\/p>\n\u00a0<\/header>\n<div>\u00a0<\/div>","is_bookmarked":"0","can_reassign":"1","before_start":"","has_guidelines":"0","materials":[],"warning":"","version_class":"5368","public":"1","is_owner":"1","is_original_owner":"1","created_on":"1490804768","protocol_affiliation":"Stony Brook University","affiliation":null,"doi":"dx.doi.org\/10.17504\/protocols.io.hgyb3xw","doi_status":"2","changed_fork_steps":null,"profile_url":"w2x24423v2","protocol_img":"https:\/\/s3.amazonaws.com\/pr-journal\/izidq2e.png","profile_image":"\/img\/avatars\/011.png","full_name":"Joshua Rest","created_by":"Joshua Rest","private_link":"F9D22E74FFB690D06E6BEC8196045EB0","original_img":"1","username":"joshua-rest","is_retracted":"0","retraction_reason":null,"plos_id":null,"manuscript_citation":null,"journal_name":null,"is_donations_disabled":"0","is_donations_disabled_by_user":"9","item_record_id":224984,"fork_info":[],"compare_forks":[],"protocols":[],"groups":[{"group_id":"108","group_uri":"protg","group_name":"Protist Research to Optimize Tools in Genetics (PROT-G)","group_logo":"https:\/\/s3.amazonaws.com\/pr-journal\/e3addmn.png","requested_uid":null,"request_flag":null,"my_request":"1"},{"group_id":"124","group_uri":"collier-lab","group_name":"Collier Lab","group_logo":"","requested_uid":null,"request_flag":null,"my_request":"1"}],"number_of_shared_runs":[],"ownership_history":[],"keywords":"","transfer_to_user":[],"sub_transfer":false,"is_transfer_pending":false,"number_of_bookmarks":"0","collections":[],"tags":[],"archived":0,"sub_authors":[],"sub_protocols_number":0,"can_edit_shared":0,"shared_runs":[],"is_shared_run":0,"is_shared":1,"banner":null,"contact_badges":[{"badge_id":"2","badge_image":"\/img\/badges\/bronze.svg","badge_description":"Author!"},{"badge_id":"5","badge_image":"\/img\/badges\/earlyadopter.svg","badge_description":"Early adopter"}],"number_of_comments":0,"big_protocol_img":"https:\/\/s3.amazonaws.com\/pr-journal\/izhdq2e.png","big_protocol_img_ofn":"untitled-4-18gpgjl.png","is_locked":0,"is_locked_by":false,"authors":"Joshua Rest, Jackie Collier","authors_list":[{"name":"Joshua Rest","affiliation":"Stony Brook University","username":null,"profile_image":null},{"name":" Jackie Collier","affiliation":"Stony Brook University","username":null,"profile_image":null}],"user":{"profile_image":"\/img\/avatars\/011.png","username":"joshua-rest","full_name":"Joshua Rest","created_by":"Joshua Rest"},"access":{"can_view":"1","can_remove":"0","can_add":"0","can_edit":0,"can_publish":0,"can_get_doi":0,"can_share":"0","can_move":"1","can_transfer":"1","can_download":"1","is_locked":"0"},"is_contact_suspended":0,"guidelines":"","status_id":"1","is_research":"1","status_info":null,"steps":[{"id":"410716","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"1F2F0FAB410F4BFD9800DCA403D52A5D","previous_guid":null,"previous_id":"0","last_modified":"1490805187","components":[{"component_id":"647812","previous_id":0,"original_id":"0","guid":"24CBFB0A2D154F35A719ECA8B9715320","previous_guid":null,"component_type_id":"1","data_id":"0","data":"<p><span style=\"font-weight: 400;\">Coding sequences were downloaded from the following files \/ URLs:<\/span><\/p>\n<p><span style=\"font-weight: 400;\">Schag1_GeneCatalog_CDS_20121220.fasta from http:\/\/genome.jgi.doe.gov\/pages\/dynamicOrganismDownload.jsf?organism=Schag1<\/span><\/p>\n<p><span style=\"font-weight: 400;\">Aurli1_GeneCatalog_CDS_20120618.fasta from http:\/\/genome.jgi.doe.gov\/pages\/dynamicOrganismDownload.jsf?organism=Aurli1<\/span><\/p>\n<p><span style=\"font-weight: 400;\">Aplke1_GeneCatalog_CDS_20121220.fasta from http:\/\/genome.jgi.doe.gov\/pages\/dynamicOrganismDownload.jsf?organism=Aplke1<\/span><\/p>\n<p><span style=\"font-weight: 400;\">Physo3_GeneCatalog_CDS_20110401.fasta from http:\/\/genome.jgi.doe.gov\/pages\/dynamicOrganismDownload.jsf?organism=Physo3<\/span><\/p>\n<p><span style=\"font-weight: 400;\">Thalassiosira_pseudonana.ASM14940v1.30.cds.all.fa from ftp:\/\/ftp.ensemblgenomes.org\/pub\/protists\/release-30\/fasta\/thalassiosira_pseudonana\/cds\/<\/span><\/p>\n<p><span style=\"font-weight: 400;\">Phaeodactylum_tricornutum.ASM15095v2.30.cds.all.fa<\/span><\/p>\n<p><span style=\"font-weight: 400;\">from ftp:\/\/ftp.ensemblgenomes.org\/pub\/protists\/release-30\/fasta\/phaeodactylum_tricornutum\/cds\/<\/span><\/p>\n<p><span style=\"font-weight: 400;\">Saccharomyces_cerevisiae.R64-1-1.30.cds.all.fa<\/span><\/p>\n<p><span style=\"font-weight: 400;\"> from ftp:\/\/ftp.ensemblgenomes.org\/pub\/release-30\/fungi\/fasta\/saccharomyces_cerevisiae\/cds\/<\/span><\/p>\n<p>\u00a0<\/p>","order_id":"0","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p><span style=\"font-weight: 400;\">Coding sequences were downloaded from the following files \/ URLs:<\/span><\/p>\n<p><span style=\"font-weight: 400;\">Schag1_GeneCatalog_CDS_20121220.fasta from http:\/\/genome.jgi.doe.gov\/pages\/dynamicOrganismDownload.jsf?organism=Schag1<\/span><\/p>\n<p><span style=\"font-weight: 400;\">Aurli1_GeneCatalog_CDS_20120618.fasta from http:\/\/genome.jgi.doe.gov\/pages\/dynamicOrganismDownload.jsf?organism=Aurli1<\/span><\/p>\n<p><span style=\"font-weight: 400;\">Aplke1_GeneCatalog_CDS_20121220.fasta from http:\/\/genome.jgi.doe.gov\/pages\/dynamicOrganismDownload.jsf?organism=Aplke1<\/span><\/p>\n<p><span style=\"font-weight: 400;\">Physo3_GeneCatalog_CDS_20110401.fasta from http:\/\/genome.jgi.doe.gov\/pages\/dynamicOrganismDownload.jsf?organism=Physo3<\/span><\/p>\n<p><span style=\"font-weight: 400;\">Thalassiosira_pseudonana.ASM14940v1.30.cds.all.fa from ftp:\/\/ftp.ensemblgenomes.org\/pub\/protists\/release-30\/fasta\/thalassiosira_pseudonana\/cds\/<\/span><\/p>\n<p><span style=\"font-weight: 400;\">Phaeodactylum_tricornutum.ASM15095v2.30.cds.all.fa<\/span><\/p>\n<p><span style=\"font-weight: 400;\">from ftp:\/\/ftp.ensemblgenomes.org\/pub\/protists\/release-30\/fasta\/phaeodactylum_tricornutum\/cds\/<\/span><\/p>\n<p><span style=\"font-weight: 400;\">Saccharomyces_cerevisiae.R64-1-1.30.cds.all.fa<\/span><\/p>\n<p><span style=\"font-weight: 400;\"> from ftp:\/\/ftp.ensemblgenomes.org\/pub\/release-30\/fungi\/fasta\/saccharomyces_cerevisiae\/cds\/<\/span><\/p>\n<p>\u00a0<\/p>"},"is_project":0},{"component_id":"647764","previous_id":"647812","original_id":"0","guid":"7F0A0BFCFBE846FDAEB915831C8CE543","previous_guid":"24CBFB0A2D154F35A719ECA8B9715320","component_type_id":"6","data_id":"0","data":"Coding sequences from Labyrinthulomycete and other genomes","order_id":"1","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"Coding sequences from Labyrinthulomycete and other genomes"},"is_project":0},{"component_id":"647894","previous_id":"647764","original_id":"0","guid":"9806A7823DAC4E60974CD610692F8F6C","previous_guid":"7F0A0BFCFBE846FDAEB915831C8CE543","component_type_id":"9","data_id":"42","data":"","order_id":"2","name":"Dataset","data_by_id":"1","type_id":"9","source_data":{"id":"42","name":"Coding Sequences","link":"","can_edit":"1"},"is_project":0}]},{"id":"410919","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"C5FFD068661E44CC930D082F7C38330D","previous_guid":"1F2F0FAB410F4BFD9800DCA403D52A5D","previous_id":"410716","last_modified":"1490809541","components":[{"component_id":"651021","previous_id":0,"original_id":"0","guid":"BFE58E4EBDFA4240835531AE68AAF828","previous_guid":null,"component_type_id":"1","data_id":"0","data":"<p>\u00a0Load libraries; define file names of coding sequences to be loaded<\/p>","order_id":"0","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>\u00a0Load libraries; define file names of coding sequences to be loaded<\/p>"},"is_project":0},{"component_id":"647952","previous_id":"651021","original_id":"0","guid":"E41920470638469BA9B9360A85A1BD8D","previous_guid":"BFE58E4EBDFA4240835531AE68AAF828","component_type_id":"6","data_id":"0","data":"R: Prepare the workspace","order_id":"1","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"R: Prepare the workspace"},"is_project":0},{"component_id":"648356","previous_id":"647952","original_id":"0","guid":"35D507094319477B9026DB1678EDDE43","previous_guid":"E41920470638469BA9B9360A85A1BD8D","component_type_id":"15","data_id":"1696","data":"","order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"library(seqinr)\nlibrary(reshape)\nlibrary(ape)\nlibrary(RCurl) \neval( expr = parse( text = getURL(\"https:\/\/raw.githubusercontent.com\/talgalili\/R-code-snippets\/master\/boxplot.with.outlier.label.r\")))\n\nallcds <- c(\"Aplke1_GeneCatalog_CDS_20121220.fasta\",\"Aurli1_GeneCatalog_CDS_20120618.fasta\",\"Phaeodactylum_tricornutum.ASM15095v2.30.cds.all.fa\",\"Physo3_GeneCatalog_CDS_20110401.fasta\",\"Saccharomyces_cerevisiae.R64-1-1.30.cds.all.fa\",\"Schag1_GeneCatalog_CDS_20121220.fasta\",\"Thalassiosira_pseudonana.ASM14940v1.30.cds.all.fa\")","description":"","os_name":"","os_version":"","can_edit":"1"},"is_project":0}]},{"id":"411196","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"2792749163E9453AAC9254130C546203","previous_guid":"C5FFD068661E44CC930D082F7C38330D","previous_id":"410919","last_modified":"1490809403","components":[{"component_id":"650770","previous_id":0,"original_id":"0","guid":"1B2957F8C04D47F9B39145423480A718","previous_guid":null,"component_type_id":"1","data_id":"0","data":"<p>Create a vector of GC content values of the coding sequences - one for each genome.<\/p>\n<p>Output example: <a href=\"https:\/\/you.stonybrook.edu\/labyrinthulomycetes\/coding-properties\/\" target=\"_blank\">Table 2<\/a><\/p>","order_id":"0","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>Create a vector of GC content values of the coding sequences - one for each genome.<\/p>\n<p>Output example: <a href=\"https:\/\/you.stonybrook.edu\/labyrinthulomycetes\/coding-properties\/\" target=\"_blank\">Table 2<\/a><\/p>"},"is_project":0},{"component_id":"648233","previous_id":"650770","original_id":"0","guid":"41D0564883DA45368E1CA5A6C7D165FD","previous_guid":"1B2957F8C04D47F9B39145423480A718","component_type_id":"6","data_id":"0","data":"R: Calculate GC content for each species","order_id":"1","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"R: Calculate GC content for each species"},"is_project":0},{"component_id":"650236","previous_id":"648233","original_id":"0","guid":"91D876D017E6415CB3FC06CD02D5B330","previous_guid":"41D0564883DA45368E1CA5A6C7D165FD","component_type_id":"15","data_id":"1700","data":"","order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"gwGC <- lapply(allcds,function(species){\nprint(species)\njgi1 <- read.fasta(species)\njgi1b <- unlist(jgi1)\njgi3b <- GC(jgi1b)\nreturn(jgi3b)\n})\n\ngwGC2 <- do.call(\"rbind\",gwGC)\nrownames(gwGC2) <- c(\"Aplanochytrium kerguelense\",\"Aurantiochytrium limacinum\",\"Phaeodactylum tricornutum\",\"Phytophthora sojae\",\"Saccharomyces cerevisiae\",\"Schizochytrium aggregatum\",\"Thalassiosira pseudonana\")","description":"","os_name":"","os_version":"","can_edit":"1"},"is_project":0}]},{"id":"412358","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"6ECE9904D7034C3A9C17441A7FFD96B2","previous_guid":"2792749163E9453AAC9254130C546203","previous_id":"411196","last_modified":"1490809423","components":[{"component_id":"650975","previous_id":0,"original_id":"0","guid":"D5CBE5C70A014EB3A10CE205B5087BE3","previous_guid":null,"component_type_id":"1","data_id":"0","data":"<p>Calculate frequency or rscu of the 64 codon triplets across all genes in each genome.<\/p>","order_id":"0","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>Calculate frequency or rscu of the 64 codon triplets across all genes in each genome.<\/p>"},"is_project":0},{"component_id":"650240","previous_id":"650975","original_id":"0","guid":"E533B4E4DE40463CB94C71927DC49666","previous_guid":"D5CBE5C70A014EB3A10CE205B5087BE3","component_type_id":"6","data_id":"0","data":"R: Calculate codon usage frequency of rscu use across all coding sequences in each genome","order_id":"1","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"R: Calculate codon usage frequency of rscu use across all coding sequences in each genome"},"is_project":0},{"component_id":"650441","previous_id":"650240","original_id":"0","guid":"98E292374470413D86F986732083666C","previous_guid":"E533B4E4DE40463CB94C71927DC49666","component_type_id":"15","data_id":"1701","data":"","order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"metric <- \"freq\" \u00a0#freq or rscu\u00a0\ngwRscu <- lapply(allcds,function(species){\nprint(species)\njgi1 <- read.fasta(species)\njgi1b <- unlist(jgi1)\njgi3b <- uco(jgi1b, index = metric)\nreturn(jgi3b)\n})\n\ngwRscu2 <- do.call(\"rbind\",gwRscu)\nrownames(gwRscu2) <- c(\"Aplanochytrium kerguelense\",\"Aurantiochytrium limacinum\",\"Phaeodactylum tricornutum\",\"Phytophthora sojae\",\"Saccharomyces cerevisiae\",\"Schizochytrium aggregatum\",\"Thalassiosira pseudonana\")\ngwRscu2b <- gwRscu2\nrownames(gwRscu2b) <- c(\"Ak\",\"Al\",\"Pt\",\"Ps\",\"Sc\",\"Sa\",\"Tp\")\n\nsave(gwRscu2,file=paste(\"gwRscu2\",metric,\"rda\",sep=\".\"))\nsave(gwRscu2b,file=paste(\"gwRscu2b\",metric,\"rda\",sep=\".\"))","description":"","os_name":"","os_version":"","can_edit":"1"},"is_project":0}]},{"id":"412499","is_changed":"0","original_id":"0","is_skipped":"0","is_checked":"0","guid":"493B35E5E037455E9F2E50570E4DCD7E","previous_guid":"6ECE9904D7034C3A9C17441A7FFD96B2","previous_id":"412358","last_modified":"1490809585","components":[{"component_id":"650653","previous_id":0,"original_id":"0","guid":"685C1D056DB1469A81B46536CFE7804C","previous_guid":null,"component_type_id":"1","data_id":"0","data":"<p>\u00a0Make a boxplot of RSCU or codon frequency across genomes, where each column is a codon, with outliers labelled<\/p>\n<p><a href=\"https:\/\/you.stonybrook.edu\/labyrinthulomycetes\/files\/2017\/03\/Untitled-4-18gpgjl.png\" target=\"_blank\">Output example.<\/a><\/p>","order_id":"0","name":"Description","data_by_id":"0","type_id":"1","source_data":{"description":"<p>\u00a0Make a boxplot of RSCU or codon frequency across genomes, where each column is a codon, with outliers labelled<\/p>\n<p><a href=\"https:\/\/you.stonybrook.edu\/labyrinthulomycetes\/files\/2017\/03\/Untitled-4-18gpgjl.png\" target=\"_blank\">Output example.<\/a><\/p>"},"is_project":0},{"component_id":"650475","previous_id":"650653","original_id":"0","guid":"75E5476290114F0AA70C73D13977C367","previous_guid":"685C1D056DB1469A81B46536CFE7804C","component_type_id":"6","data_id":"0","data":"R: Reformat and plot the results.","order_id":"1","name":"Section","data_by_id":"0","type_id":"6","source_data":{"section":"R: Reformat and plot the results."},"is_project":0},{"component_id":"650516","previous_id":"650475","original_id":"0","guid":"618EF9C5ECBC4375BF12B7BD536578EF","previous_guid":"75E5476290114F0AA70C73D13977C367","component_type_id":"15","data_id":"1702","data":"","order_id":"2","name":"Command","data_by_id":"1","type_id":"15","source_data":{"name":"#re-format\ngwRscu3b <- melt(gwRscu2b)\nsave(gwRscu3b,file=paste(\"gwRscu3b\",metric,\"rda\",sep=\".\"))\n\npng(paste(\"Boxgw2\",metric,\"png\",sep=\".\"))\npar(family=\"mono\")\nboxplot.with.outlier.label(gwRscu3b$value~gwRscu3b$X2,gwRscu3b$X1,las=2, cex.axis = 0.7, xlab=\"codon\",ylab=metric)\npoints(gwRscu3$X2,gwRscu3$value,cex=0.5,col=gwRscu3$X1)\nsavefont <- par(font=3) \nlegend(\"topright\",legend=unique(gwRscu3$X1),col=unlist(subset(gwRscu3,X2==\"aaa\",select=X1)),pch=1,cex=0.7)\npar(savefont) \ndev.off()","description":"","os_name":"","os_version":"","can_edit":"1"},"is_project":0}]}]}