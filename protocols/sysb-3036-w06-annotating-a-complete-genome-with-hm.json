{"id":21060,"title":"SYSB 3036 W06: Annotating a Complete Genome with HMMs","title_html":"SYSB 3036 W06: Annotating a Complete Genome with HMMs","image":{"source":"https:\/\/www.protocols.io\/img\/default_protocol.png","placeholder":"https:\/\/www.protocols.io\/img\/default_protocol.png"},"doi":"dx.doi.org\/10.17504\/protocols.io.ytcfwiw","doi_status":2,"uri":"sysb-3036-w06-annotating-a-complete-genome-with-hm-ytcfwiw","type_id":1,"published_on":1551734578,"version_id":0,"created_on":1551719775,"categories":null,"creator":{"name":"Frank Aylward","affiliation":"Virginia Tech","username":"frank-aylward","link":null,"image":{"source":"https:\/\/s3.amazonaws.com\/pr-journal\/v39jtte.png","placeholder":"https:\/\/s3.amazonaws.com\/pr-journal\/v39jtte.png"},"badges":[{"id":4,"image":{"source":"\/img\/badges\/gold.svg","placeholder":"\/img\/badges\/gold.svg"},"name":"Gold power author!"}],"research_interests":null},"journal":null,"journal_name":null,"journal_link":null,"public":1,"has_versions":0,"link":null,"total_collections":0,"number_of_steps":5,"authors":[{"name":"Frank Aylward","affiliation":"Virginia Tech","username":"frank-aylward","link":null,"image":{"source":"https:\/\/s3.amazonaws.com\/pr-journal\/v39jtte.png","placeholder":"https:\/\/s3.amazonaws.com\/pr-journal\/v39jtte.png"},"badges":[],"research_interests":null}],"versions":[],"groups":[],"has_subprotocols":0,"is_subprotocol":0,"is_bookmarked":0,"forks_count":{"private":0,"public":0},"steps":[{"id":716440,"guid":"4835C1503EA111E9B6906966CA13B7BB","previous_id":null,"previous_guid":null,"modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"E725B409D5E9480D96F51C141E0353A4","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"1B8E9E7553C346E4905A1B1E8DE5B732","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">First let's download some files from GitHub:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">git clone <\/span><\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/github.com\/faylward\/hmm_tutorial<\/span><\/a><\/div><div class = \"text-block\">And move inside the new folder and see what is there:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">cd hmm_tutorial<\/span><\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">ls<\/span><\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":716615,"guid":"EB8156103EB711E9A8856B248A393457","previous_id":716440,"previous_guid":"4835C1503EA111E9B6906966CA13B7BB","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"34A013829CDF41CB9FBA47B51193B7C5","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"A4753A7C549A4E1B984A4682BB9F6427","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">In the new file you should see a gzipped file that contains proteins from a mystery genome. We can gunzip it now:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">gunzip mystery_genome_proteins.faa.gz<\/span><\/div><div class = \"text-block\">For this analysis we want to annotate all of the proteins in this genome using a suite of HMMs. We will use the TIGRfam database today. I have uploaded this database onto a Virginia Tech library link, so we can download it with the followingn command. <\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">wget -O tigrfams.tar.gz <\/span><\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/data.lib.vt.edu\/downloads\/pc289j19b<\/span><\/a><\/div><div class = \"text-block\">This should download a .tar.gz file, which is essentially a gzipped folder, also called a \"tarball\". This is a bit different then just a gzipped file, and we need a special command to unzip it. <\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">tar xvfz tigrfams.tar.gz<\/span><\/div><div class = \"text-block\">If you look inside of the tigrfams file you should see two files- one HMM file and one .txt file.<\/div><div class = \"text-block\">The HMM file contains thousands of HMMs all merged together. This is the full TIGRfam database. Note that the file is quite large. <\/div><div class = \"text-block\">The .txt file contains descriptions of each HMM. When we want to annotate a protein we don't just want to know that the best hit was TIGR20034. We also want to know what the function of TIGR20034 is. That's what this file is for.  <\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":716627,"guid":"29C520003EB811E9A8856B248A393457","previous_id":716615,"previous_guid":"EB8156103EB711E9A8856B248A393457","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"009D10F2B8134B948EC703725396965A","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"90D8B965E84B44CCB54C85EE65A561B0","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">\nTo run the initial HMM annotation we can use the hmmsearch command in HMMER3:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">hmmsearch --tblout mystery_genome.hmmout --cut_tc tigrfams\/all_tigrfam.hmm mystery_genome_proteins.faa > full_hmmout.txt<\/span><\/div><div class = \"text-block\">Note that in the command above we are using the --cut_tc option, which specifies that we want to use pre-specified bit score cutoffs to classify these proteins. All hits that have bit scores below the specifications for each HMM will be disregarded, regardless of their e-value. <\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":716629,"guid":"368549003EB811E9A8856B248A393457","previous_id":716627,"previous_guid":"29C520003EB811E9A8856B248A393457","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"445FD5582293411EB9133F15AB5F3D77","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"14B76301F94D4BD0A2BEF987845C12BB","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">After we run the hmmsearch we can parse the results with a Python script that I wrote. <\/div><div class = \"text-block\">This script goes through the tabular hmmsearch output and finds only the best hits for each protein. It also removes the weird space-delimited format that HMMER3 insists on using and converts it into a nice tab-delimited format. <\/div><div class = \"text-block\">We can run it with:<\/div><div class = \"text-block\"><span style = \"font-weight:bold;\">python parse_hmmout.py tigrfams\/profile_annotations.tigr.txt mystery_genome.hmmout > mystery_genome.parsed.hmmout.txt<\/span><\/div><div class = \"text-block\">Note that we need to specify the profile annotations file, since we want the final annotation file to contain the TIGRfam descriptions. <\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":null},{"id":716630,"guid":"40F344A03EB811E9A8856B248A393457","previous_id":716629,"previous_guid":"368549003EB811E9A8856B248A393457","modified_on":0,"protocol_id":0,"components":[{"id":1054723,"guid":"82A8E247F4A549E88429FCF42EA5C764","order_id":1,"type_id":6,"title":"Section","source":{"title":""}},{"id":1054724,"guid":"8C716CDB7D344CA1A7430F914BA40E10","order_id":1,"type_id":1,"title":"description","source":{"description":"<div class = \"text-blocks\"><div class = \"text-block\">Another way to annotate genomes, and get some visualizations of pathway-level annotations, is to use the Kyoto Encyclopedia of Genes and Genomes (KEGG). They host an annotation server here:<\/div><div class = \"text-block\"><a style = \"text-decoration:underline;color:blue;cursor:pointer;\"><span style = \":;\">https:\/\/www.genome.jp\/kaas-bin\/kaas_main<\/span><\/a><\/div><div class = \"text-block\">Upload the protein file, add in your email, and make sure to use the \"For Prokaryotes\" option at the bottom of the page so that the correct reference database is used.  A link will be mailed to you, and you need to click the \"submit\" option in that email for the annotation to begin. After that you will need to wait ~10-45 minutes for the annotation to finish, and the link will be mailed to you again. <\/div><\/div>"}}],"cases":null,"data":null,"section":null,"section_color":null}],"materials":[],"description":null,"changed_on":1551734578}